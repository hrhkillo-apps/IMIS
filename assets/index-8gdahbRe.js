const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pdfGenerator-CzqP8X1l.js","./jspdf.es.min-DFico01g.js","./jspdf.plugin.autotable-DZlIrCiz.js","./dataSynthesizer-nKH26hCw.js","./idGenerator-Dp6YtTpY.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var bY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ON(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var y_={exports:{}},hh={};var Aw;function FN(){if(Aw)return hh;Aw=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,s){var l=null;if(s!==void 0&&(l=""+s),i.key!==void 0&&(l=""+i.key),"key"in i){s={};for(var u in i)u!=="key"&&(s[u]=i[u])}else s=i;return i=s.ref,{$$typeof:r,type:n,key:l,ref:i!==void 0?i:null,props:s}}return hh.Fragment=e,hh.jsx=t,hh.jsxs=t,hh}var bw;function PN(){return bw||(bw=1,y_.exports=FN()),y_.exports}var P=PN(),E_={exports:{}},pt={};var Iw;function MN(){if(Iw)return pt;Iw=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),v=Symbol.iterator;function y(J){return J===null||typeof J!="object"?null:(J=v&&J[v]||J["@@iterator"],typeof J=="function"?J:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function D(J,O,Q){this.props=J,this.context=O,this.refs=S,this.updater=Q||T}D.prototype.isReactComponent={},D.prototype.setState=function(J,O){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,O,"setState")},D.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function U(){}U.prototype=D.prototype;function k(J,O,Q){this.props=J,this.context=O,this.refs=S,this.updater=Q||T}var W=k.prototype=new U;W.constructor=k,E(W,D.prototype),W.isPureReactComponent=!0;var ee=Array.isArray;function X(){}var A={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function C(J,O,Q){var q=Q.ref;return{$$typeof:r,type:J,key:O,ref:q!==void 0?q:null,props:Q}}function B(J,O){return C(J.type,O,J.props)}function N(J){return typeof J=="object"&&J!==null&&J.$$typeof===r}function M(J){var O={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(Q){return O[Q]})}var V=/\/+/g;function xe(J,O){return typeof J=="object"&&J!==null&&J.key!=null?M(""+J.key):O.toString(36)}function ve(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(X,X):(J.status="pending",J.then(function(O){J.status==="pending"&&(J.status="fulfilled",J.value=O)},function(O){J.status==="pending"&&(J.status="rejected",J.reason=O)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function ne(J,O,Q,q,te){var oe=typeof J;(oe==="undefined"||oe==="boolean")&&(J=null);var Te=!1;if(J===null)Te=!0;else switch(oe){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(J.$$typeof){case r:case e:Te=!0;break;case m:return Te=J._init,ne(Te(J._payload),O,Q,q,te)}}if(Te)return te=te(J),Te=q===""?"."+xe(J,0):q,ee(te)?(Q="",Te!=null&&(Q=Te.replace(V,"$&/")+"/"),ne(te,O,Q,"",function(De){return De})):te!=null&&(N(te)&&(te=B(te,Q+(te.key==null||J&&J.key===te.key?"":(""+te.key).replace(V,"$&/")+"/")+Te)),O.push(te)),1;Te=0;var ke=q===""?".":q+":";if(ee(J))for(var be=0;be<J.length;be++)q=J[be],oe=ke+xe(q,be),Te+=ne(q,O,Q,oe,te);else if(be=y(J),typeof be=="function")for(J=be.call(J),be=0;!(q=J.next()).done;)q=q.value,oe=ke+xe(q,be++),Te+=ne(q,O,Q,oe,te);else if(oe==="object"){if(typeof J.then=="function")return ne(ve(J),O,Q,q,te);throw O=String(J),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return Te}function le(J,O,Q){if(J==null)return J;var q=[],te=0;return ne(J,q,"","",function(oe){return O.call(Q,oe,te++)}),q}function Pe(J){if(J._status===-1){var O=J._result;O=O(),O.then(function(Q){(J._status===0||J._status===-1)&&(J._status=1,J._result=Q)},function(Q){(J._status===0||J._status===-1)&&(J._status=2,J._result=Q)}),J._status===-1&&(J._status=0,J._result=O)}if(J._status===1)return J._result.default;throw J._result}var ae=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},Me={map:le,forEach:function(J,O,Q){le(J,function(){O.apply(this,arguments)},Q)},count:function(J){var O=0;return le(J,function(){O++}),O},toArray:function(J){return le(J,function(O){return O})||[]},only:function(J){if(!N(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return pt.Activity=_,pt.Children=Me,pt.Component=D,pt.Fragment=t,pt.Profiler=i,pt.PureComponent=k,pt.StrictMode=n,pt.Suspense=f,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,pt.__COMPILER_RUNTIME={__proto__:null,c:function(J){return A.H.useMemoCache(J)}},pt.cache=function(J){return function(){return J.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(J,O,Q){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var q=E({},J.props),te=J.key;if(O!=null)for(oe in O.key!==void 0&&(te=""+O.key),O)!R.call(O,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&O.ref===void 0||(q[oe]=O[oe]);var oe=arguments.length-2;if(oe===1)q.children=Q;else if(1<oe){for(var Te=Array(oe),ke=0;ke<oe;ke++)Te[ke]=arguments[ke+2];q.children=Te}return C(J.type,te,q)},pt.createContext=function(J){return J={$$typeof:l,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:s,_context:J},J},pt.createElement=function(J,O,Q){var q,te={},oe=null;if(O!=null)for(q in O.key!==void 0&&(oe=""+O.key),O)R.call(O,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(te[q]=O[q]);var Te=arguments.length-2;if(Te===1)te.children=Q;else if(1<Te){for(var ke=Array(Te),be=0;be<Te;be++)ke[be]=arguments[be+2];te.children=ke}if(J&&J.defaultProps)for(q in Te=J.defaultProps,Te)te[q]===void 0&&(te[q]=Te[q]);return C(J,oe,te)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(J){return{$$typeof:u,render:J}},pt.isValidElement=N,pt.lazy=function(J){return{$$typeof:m,_payload:{_status:-1,_result:J},_init:Pe}},pt.memo=function(J,O){return{$$typeof:d,type:J,compare:O===void 0?null:O}},pt.startTransition=function(J){var O=A.T,Q={};A.T=Q;try{var q=J(),te=A.S;te!==null&&te(Q,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(X,ae)}catch(oe){ae(oe)}finally{O!==null&&Q.types!==null&&(O.types=Q.types),A.T=O}},pt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},pt.use=function(J){return A.H.use(J)},pt.useActionState=function(J,O,Q){return A.H.useActionState(J,O,Q)},pt.useCallback=function(J,O){return A.H.useCallback(J,O)},pt.useContext=function(J){return A.H.useContext(J)},pt.useDebugValue=function(){},pt.useDeferredValue=function(J,O){return A.H.useDeferredValue(J,O)},pt.useEffect=function(J,O){return A.H.useEffect(J,O)},pt.useEffectEvent=function(J){return A.H.useEffectEvent(J)},pt.useId=function(){return A.H.useId()},pt.useImperativeHandle=function(J,O,Q){return A.H.useImperativeHandle(J,O,Q)},pt.useInsertionEffect=function(J,O){return A.H.useInsertionEffect(J,O)},pt.useLayoutEffect=function(J,O){return A.H.useLayoutEffect(J,O)},pt.useMemo=function(J,O){return A.H.useMemo(J,O)},pt.useOptimistic=function(J,O){return A.H.useOptimistic(J,O)},pt.useReducer=function(J,O,Q){return A.H.useReducer(J,O,Q)},pt.useRef=function(J){return A.H.useRef(J)},pt.useState=function(J){return A.H.useState(J)},pt.useSyncExternalStore=function(J,O,Q){return A.H.useSyncExternalStore(J,O,Q)},pt.useTransition=function(){return A.H.useTransition()},pt.version="19.2.1",pt}var kw;function nv(){return kw||(kw=1,E_.exports=MN()),E_.exports}var We=nv();const LN=ON(We);var T_={exports:{}},dh={},w_={exports:{}},S_={};var Cw;function VN(){return Cw||(Cw=1,(function(r){function e(ne,le){var Pe=ne.length;ne.push(le);e:for(;0<Pe;){var ae=Pe-1>>>1,Me=ne[ae];if(0<i(Me,le))ne[ae]=le,ne[Pe]=Me,Pe=ae;else break e}}function t(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var le=ne[0],Pe=ne.pop();if(Pe!==le){ne[0]=Pe;e:for(var ae=0,Me=ne.length,J=Me>>>1;ae<J;){var O=2*(ae+1)-1,Q=ne[O],q=O+1,te=ne[q];if(0>i(Q,Pe))q<Me&&0>i(te,Q)?(ne[ae]=te,ne[q]=Pe,ae=q):(ne[ae]=Q,ne[O]=Pe,ae=O);else if(q<Me&&0>i(te,Pe))ne[ae]=te,ne[q]=Pe,ae=q;else break e}}return le}function i(ne,le){var Pe=ne.sortIndex-le.sortIndex;return Pe!==0?Pe:ne.id-le.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();r.unstable_now=function(){return l.now()-u}}var f=[],d=[],m=1,_=null,v=3,y=!1,T=!1,E=!1,S=!1,D=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function W(ne){for(var le=t(d);le!==null;){if(le.callback===null)n(d);else if(le.startTime<=ne)n(d),le.sortIndex=le.expirationTime,e(f,le);else break;le=t(d)}}function ee(ne){if(E=!1,W(ne),!T)if(t(f)!==null)T=!0,X||(X=!0,M());else{var le=t(d);le!==null&&ve(ee,le.startTime-ne)}}var X=!1,A=-1,R=5,C=-1;function B(){return S?!0:!(r.unstable_now()-C<R)}function N(){if(S=!1,X){var ne=r.unstable_now();C=ne;var le=!0;try{e:{T=!1,E&&(E=!1,U(A),A=-1),y=!0;var Pe=v;try{t:{for(W(ne),_=t(f);_!==null&&!(_.expirationTime>ne&&B());){var ae=_.callback;if(typeof ae=="function"){_.callback=null,v=_.priorityLevel;var Me=ae(_.expirationTime<=ne);if(ne=r.unstable_now(),typeof Me=="function"){_.callback=Me,W(ne),le=!0;break t}_===t(f)&&n(f),W(ne)}else n(f);_=t(f)}if(_!==null)le=!0;else{var J=t(d);J!==null&&ve(ee,J.startTime-ne),le=!1}}break e}finally{_=null,v=Pe,y=!1}le=void 0}}finally{le?M():X=!1}}}var M;if(typeof k=="function")M=function(){k(N)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,xe=V.port2;V.port1.onmessage=N,M=function(){xe.postMessage(null)}}else M=function(){D(N,0)};function ve(ne,le){A=D(function(){ne(r.unstable_now())},le)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ne){ne.callback=null},r.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ne?Math.floor(1e3/ne):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_next=function(ne){switch(v){case 1:case 2:case 3:var le=3;break;default:le=v}var Pe=v;v=le;try{return ne()}finally{v=Pe}},r.unstable_requestPaint=function(){S=!0},r.unstable_runWithPriority=function(ne,le){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Pe=v;v=ne;try{return le()}finally{v=Pe}},r.unstable_scheduleCallback=function(ne,le,Pe){var ae=r.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?ae+Pe:ae):Pe=ae,ne){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=Pe+Me,ne={id:m++,callback:le,priorityLevel:ne,startTime:Pe,expirationTime:Me,sortIndex:-1},Pe>ae?(ne.sortIndex=Pe,e(d,ne),t(f)===null&&ne===t(d)&&(E?(U(A),A=-1):E=!0,ve(ee,Pe-ae))):(ne.sortIndex=Me,e(f,ne),T||y||(T=!0,X||(X=!0,M()))),ne},r.unstable_shouldYield=B,r.unstable_wrapCallback=function(ne){var le=v;return function(){var Pe=v;v=le;try{return ne.apply(this,arguments)}finally{v=Pe}}}})(S_)),S_}var Rw;function BN(){return Rw||(Rw=1,w_.exports=VN()),w_.exports}var A_={exports:{}},Pn={};var Dw;function UN(){if(Dw)return Pn;Dw=1;var r=nv();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(f,d,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:f,containerInfo:d,implementation:m}}var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Pn.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,m)},Pn.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},Pn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Pn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Pn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,_=u(m,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:v,fetchPriority:y}):m==="script"&&n.d.X(f,{crossOrigin:_,integrity:v,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Pn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Pn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,_=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Pn.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Pn.requestFormReset=function(f){n.d.r(f)},Pn.unstable_batchedUpdates=function(f,d){return f(d)},Pn.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Pn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Pn.version="19.2.1",Pn}var Nw;function zN(){if(Nw)return A_.exports;Nw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),A_.exports=UN(),A_.exports}var Ow;function jN(){if(Ow)return dh;Ow=1;var r=BN(),e=nv(),t=zN();function n(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var o=a,c=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(c=o.return),a=o.return;while(a)}return o.tag===3?c:null}function l(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function u(a){if(a.tag===31){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function f(a){if(s(a)!==a)throw Error(n(188))}function d(a){var o=a.alternate;if(!o){if(o=s(a),o===null)throw Error(n(188));return o!==a?null:a}for(var c=a,h=o;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return f(g),a;if(x===h)return f(g),o;x=x.sibling}throw Error(n(188))}if(c.return!==h.return)c=g,h=x;else{for(var b=!1,L=g.child;L;){if(L===c){b=!0,c=g,h=x;break}if(L===h){b=!0,h=g,c=x;break}L=L.sibling}if(!b){for(L=x.child;L;){if(L===c){b=!0,c=x,h=g;break}if(L===h){b=!0,h=x,c=g;break}L=L.sibling}if(!b)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:o}function m(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=m(a),o!==null)return o;a=a.sibling}return null}var _=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),k=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),N=Symbol.iterator;function M(a){return a===null||typeof a!="object"?null:(a=N&&a[N]||a["@@iterator"],typeof a=="function"?a:null)}var V=Symbol.for("react.client.reference");function xe(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===V?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case E:return"Fragment";case D:return"Profiler";case S:return"StrictMode";case ee:return"Suspense";case X:return"SuspenseList";case C:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case T:return"Portal";case k:return a.displayName||"Context";case U:return(a._context.displayName||"Context")+".Consumer";case W:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case A:return o=a.displayName||null,o!==null?o:xe(a.type)||"Memo";case R:o=a._payload,a=a._init;try{return xe(a(o))}catch{}}return null}var ve=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe={pending:!1,data:null,method:null,action:null},ae=[],Me=-1;function J(a){return{current:a}}function O(a){0>Me||(a.current=ae[Me],ae[Me]=null,Me--)}function Q(a,o){Me++,ae[Me]=a.current,a.current=o}var q=J(null),te=J(null),oe=J(null),Te=J(null);function ke(a,o){switch(Q(oe,o),Q(te,a),Q(q,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?XT(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=XT(o),a=YT(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}O(q),Q(q,a)}function be(){O(q),O(te),O(oe)}function De(a){a.memoizedState!==null&&Q(Te,a);var o=q.current,c=YT(o,a.type);o!==c&&(Q(te,a),Q(q,c))}function lt(a){te.current===a&&(O(q),O(te)),Te.current===a&&(O(Te),lh._currentValue=Pe)}var Z,wt;function ut(a){if(Z===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Z=o&&o[1]||"",wt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+a+wt}var It=!1;function qe(a,o){if(!a||It)return"";It=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(Ee){var _e=Ee}Reflect.construct(a,[],Re)}else{try{Re.call()}catch(Ee){_e=Ee}a.call(Re.prototype)}}else{try{throw Error()}catch(Ee){_e=Ee}(Re=a())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(Ee){if(Ee&&_e&&typeof Ee.stack=="string")return[Ee.stack,_e.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=h.DetermineComponentFrameRoot(),b=x[0],L=x[1];if(b&&L){var re=b.split(`
`),me=L.split(`
`);for(g=h=0;h<re.length&&!re[h].includes("DetermineComponentFrameRoot");)h++;for(;g<me.length&&!me[g].includes("DetermineComponentFrameRoot");)g++;if(h===re.length||g===me.length)for(h=re.length-1,g=me.length-1;1<=h&&0<=g&&re[h]!==me[g];)g--;for(;1<=h&&0<=g;h--,g--)if(re[h]!==me[g]){if(h!==1||g!==1)do if(h--,g--,0>g||re[h]!==me[g]){var Ae=`
`+re[h].replace(" at new "," at ");return a.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",a.displayName)),Ae}while(1<=h&&0<=g);break}}}finally{It=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?ut(c):""}function Oe(a,o){switch(a.tag){case 26:case 27:case 5:return ut(a.type);case 16:return ut("Lazy");case 13:return a.child!==o&&o!==null?ut("Suspense Fallback"):ut("Suspense");case 19:return ut("SuspenseList");case 0:case 15:return qe(a.type,!1);case 11:return qe(a.type.render,!1);case 1:return qe(a.type,!0);case 31:return ut("Activity");default:return""}}function nt(a){try{var o="",c=null;do o+=Oe(a,c),c=a,a=a.return;while(a);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var gt=Object.prototype.hasOwnProperty,Lt=r.unstable_scheduleCallback,Gr=r.unstable_cancelCallback,fa=r.unstable_shouldYield,Yn=r.unstable_requestPaint,qt=r.unstable_now,sn=r.unstable_getCurrentPriorityLevel,Nn=r.unstable_ImmediatePriority,gi=r.unstable_UserBlockingPriority,et=r.unstable_NormalPriority,yt=r.unstable_LowPriority,rt=r.unstable_IdlePriority,Kt=r.log,Ir=r.unstable_setDisableYieldValue,kt=null,Vt=null;function on(a){if(typeof Kt=="function"&&Ir(a),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(kt,a)}catch{}}var $t=Math.clz32?Math.clz32:ha,Fa=Math.log,ai=Math.LN2;function ha(a){return a>>>=0,a===0?32:31-(Fa(a)/ai|0)|0}var Er=256,qr=262144,Tr=4194304;function $n(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Bi(a,o,c){var h=a.pendingLanes;if(h===0)return 0;var g=0,x=a.suspendedLanes,b=a.pingedLanes;a=a.warmLanes;var L=h&134217727;return L!==0?(h=L&~x,h!==0?g=$n(h):(b&=L,b!==0?g=$n(b):c||(c=L&~a,c!==0&&(g=$n(c))))):(L=h&~x,L!==0?g=$n(L):b!==0?g=$n(b):c||(c=h&~a,c!==0&&(g=$n(c)))),g===0?0:o!==0&&o!==g&&(o&x)===0&&(x=g&-g,c=o&-o,x>=c||x===32&&(c&4194048)!==0)?o:g}function _i(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function xf(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dc(){var a=Tr;return Tr<<=1,(Tr&62914560)===0&&(Tr=4194304),a}function Ui(a){for(var o=[],c=0;31>c;c++)o.push(a);return o}function ls(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function vf(a,o,c,h,g,x){var b=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var L=a.entanglements,re=a.expirationTimes,me=a.hiddenUpdates;for(c=b&~c;0<c;){var Ae=31-$t(c),Re=1<<Ae;L[Ae]=0,re[Ae]=-1;var _e=me[Ae];if(_e!==null)for(me[Ae]=null,Ae=0;Ae<_e.length;Ae++){var Ee=_e[Ae];Ee!==null&&(Ee.lane&=-536870913)}c&=~Re}h!==0&&cs(a,h,0),x!==0&&g===0&&a.tag!==0&&(a.suspendedLanes|=x&~(b&~o))}function cs(a,o,c){a.pendingLanes|=o,a.suspendedLanes&=~o;var h=31-$t(o);a.entangledLanes|=o,a.entanglements[h]=a.entanglements[h]|1073741824|c&261930}function us(a,o){var c=a.entangledLanes|=o;for(a=a.entanglements;c;){var h=31-$t(c),g=1<<h;g&o|a[h]&o&&(a[h]|=o),c&=~g}}function cl(a,o){var c=o&-o;return c=(c&42)!==0?1:fs(c),(c&(a.suspendedLanes|o))!==0?0:c}function fs(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function da(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function F(){var a=le.p;return a!==0?a:(a=window.event,a===void 0?32:xw(a.type))}function K(a,o){var c=le.p;try{return le.p=a,o()}finally{le.p=c}}var z=Math.random().toString(36).slice(2),H="__reactFiber$"+z,G="__reactProps$"+z,Y="__reactContainer$"+z,he="__reactEvents$"+z,Se="__reactListeners$"+z,de="__reactHandles$"+z,ge="__reactResources$"+z,pe="__reactMarker$"+z;function Le(a){delete a[H],delete a[G],delete a[he],delete a[Se],delete a[de]}function Be(a){var o=a[H];if(o)return o;for(var c=a.parentNode;c;){if(o=c[Y]||c[H]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(a=rw(a);a!==null;){if(c=a[H])return c;a=rw(a)}return o}a=c,c=a.parentNode}return null}function Ge(a){if(a=a[H]||a[Y]){var o=a.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return a}return null}function Fe(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(n(33))}function He(a){var o=a[ge];return o||(o=a[ge]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Qe(a){a[pe]=!0}var Qt=new Set,Jt={};function dr(a,o){On(a,o),On(a+"Capture",o)}function On(a,o){for(Jt[a]=o,a=0;a<o.length;a++)Qt.add(o[a])}var ma=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),pa={},xi={};function Xs(a){return gt.call(xi,a)?!0:gt.call(pa,a)?!1:ma.test(a)?xi[a]=!0:(pa[a]=!0,!1)}function Fn(a,o,c){if(Xs(o))if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+c)}}function vi(a,o,c){if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+c)}}function Kr(a,o,c,h){if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(o,c,""+h)}}function dn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ys(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function yf(a,o,c){var h=Object.getOwnPropertyDescriptor(a.constructor.prototype,o);if(!a.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,x=h.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return g.call(this)},set:function(b){c=""+b,x.call(this,b)}}),Object.defineProperty(a,o,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(b){c=""+b},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Zt(a){if(!a._valueTracker){var o=Ys(a)?"checked":"value";a._valueTracker=yf(a,o,""+a[o])}}function ul(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return a&&(h=Ys(a)?a.checked?"true":"false":a.value),a=h,a!==c?(o.setValue(a),!0):!1}function Pa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var fl=/[\n"\\]/g;function si(a){return a.replace(fl,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Nc(a,o,c,h,g,x,b,L){a.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?a.type=b:a.removeAttribute("type"),o!=null?b==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+dn(o)):a.value!==""+dn(o)&&(a.value=""+dn(o)):b!=="submit"&&b!=="reset"||a.removeAttribute("value"),o!=null?Ef(a,b,dn(o)):c!=null?Ef(a,b,dn(c)):h!=null&&a.removeAttribute("value"),g==null&&x!=null&&(a.defaultChecked=!!x),g!=null&&(a.checked=g&&typeof g!="function"&&typeof g!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?a.name=""+dn(L):a.removeAttribute("name")}function Z0(a,o,c,h,g,x,b,L){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(a.type=x),o!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||o!=null)){Zt(a);return}c=c!=null?""+dn(c):"",o=o!=null?""+dn(o):c,L||o===a.value||(a.value=o),a.defaultValue=o}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,a.checked=L?a.checked:!!h,a.defaultChecked=!!h,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.name=b),Zt(a)}function Ef(a,o,c){o==="number"&&Pa(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function $s(a,o,c,h){if(a=a.options,o){o={};for(var g=0;g<c.length;g++)o["$"+c[g]]=!0;for(c=0;c<a.length;c++)g=o.hasOwnProperty("$"+a[c].value),a[c].selected!==g&&(a[c].selected=g),g&&h&&(a[c].defaultSelected=!0)}else{for(c=""+dn(c),o=null,g=0;g<a.length;g++){if(a[g].value===c){a[g].selected=!0,h&&(a[g].defaultSelected=!0);return}o!==null||a[g].disabled||(o=a[g])}o!==null&&(o.selected=!0)}}function ed(a,o,c){if(o!=null&&(o=""+dn(o),o!==a.value&&(a.value=o),c==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=c!=null?""+dn(c):""}function Qs(a,o,c,h){if(o==null){if(h!=null){if(c!=null)throw Error(n(92));if(ve(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),o=c}c=dn(o),a.defaultValue=c,h=a.textContent,h===c&&h!==""&&h!==null&&(a.value=h),Zt(a)}function oi(a,o){if(o){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=o;return}}a.textContent=o}var td=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tf(a,o,c){var h=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":h?a.setProperty(o,c):typeof c!="number"||c===0||td.has(o)?o==="float"?a.cssFloat=c:a[o]=(""+c).trim():a[o]=c+"px"}function wf(a,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(a=a.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?a.setProperty(h,""):h==="float"?a.cssFloat="":a[h]="");for(var g in o)h=o[g],o.hasOwnProperty(g)&&c[g]!==h&&Tf(a,g,h)}else for(var x in o)o.hasOwnProperty(x)&&Tf(a,x,o[x])}function Oc(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Js=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fc(a){return Js.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function ga(){}var Sf=null;function zi(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Zs=null,Ma=null;function hl(a){var o=Ge(a);if(o&&(a=o.stateNode)){var c=a[G]||null;e:switch(a=o.stateNode,o.type){case"input":if(Nc(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+si(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==a&&h.form===a.form){var g=h[G]||null;if(!g)throw Error(n(90));Nc(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<c.length;o++)h=c[o],h.form===a.form&&ul(h)}break e;case"textarea":ed(a,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&$s(a,!!c.multiple,o,!1)}}}var Pc=!1;function eo(a,o,c){if(Pc)return a(o,c);Pc=!0;try{var h=a(o);return h}finally{if(Pc=!1,(Zs!==null||Ma!==null)&&(Yd(),Zs&&(o=Zs,a=Ma,Ma=Zs=null,hl(o),a)))for(o=0;o<a.length;o++)hl(a[o])}}function _a(a,o){var c=a.stateNode;if(c===null)return null;var h=c[G]||null;if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(a=a.type,h=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!h;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dl=!1;if(ji)try{var or={};Object.defineProperty(or,"passive",{get:function(){dl=!0}}),window.addEventListener("test",or,or),window.removeEventListener("test",or,or)}catch{dl=!1}var La=null,Af=null,ml=null;function bf(){if(ml)return ml;var a,o=Af,c=o.length,h,g="value"in La?La.value:La.textContent,x=g.length;for(a=0;a<c&&o[a]===g[a];a++);var b=c-a;for(h=1;h<=b&&o[c-h]===g[x-h];h++);return ml=g.slice(a,1<h?1-h:void 0)}function pl(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function hs(){return!0}function xa(){return!1}function Tn(a){function o(c,h,g,x,b){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=x,this.target=b,this.currentTarget=null;for(var L in a)a.hasOwnProperty(L)&&(c=a[L],this[L]=c?c(x):x[L]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?hs:xa,this.isPropagationStopped=xa,this}return _(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=hs)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=hs)},persist:function(){},isPersistent:hs}),o}var ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Va=Tn(ds),to=_({},ds,{view:0,detail:0}),If=Tn(to),ro,Mc,Ba,Lc=_({},to,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:no,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ba&&(Ba&&a.type==="mousemove"?(ro=a.screenX-Ba.screenX,Mc=a.screenY-Ba.screenY):Mc=ro=0,Ba=a),ro)},movementY:function(a){return"movementY"in a?a.movementY:Mc}}),kf=Tn(Lc),gl=_({},Lc,{dataTransfer:0}),nd=Tn(gl),id=_({},to,{relatedTarget:0}),_l=Tn(id),Cf=_({},ds,{animationName:0,elapsedTime:0,pseudoElement:0}),ad=Tn(Cf),Vc=_({},ds,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),sd=Tn(Vc),od=_({},ds,{data:0}),Ua=Tn(od),ld={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ud={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fd(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=ud[a])?!!o[a]:!1}function no(){return fd}var Qn=_({},to,{key:function(a){if(a.key){var o=ld[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=pl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?cd[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:no,charCode:function(a){return a.type==="keypress"?pl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?pl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),hd=Tn(Qn),dd=_({},Lc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ms=Tn(dd),p=_({},to,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:no}),w=Tn(p),I=_({},ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),j=Tn(I),ue=_({},Lc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),ye=Tn(ue),je=_({},ds,{newState:0,oldState:0}),_t=Tn(je),Br=[9,13,27,32],Wt=ji&&"CompositionEvent"in window,wr=null;ji&&"documentMode"in document&&(wr=document.documentMode);var Hi=ji&&"TextEvent"in window&&!wr,za=ji&&(!Wt||wr&&8<wr&&11>=wr),va=" ",ya=!1;function xl(a,o){switch(a){case"keyup":return Br.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bc(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Uc=!1;function n3(a,o){switch(a){case"compositionend":return Bc(o);case"keypress":return o.which!==32?null:(ya=!0,va);case"textInput":return a=o.data,a===va&&ya?null:a;default:return null}}function i3(a,o){if(Uc)return a==="compositionend"||!Wt&&xl(a,o)?(a=bf(),ml=Af=La=null,Uc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return za&&o.locale!=="ko"?null:o.data;default:return null}}var a3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function aE(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!a3[a.type]:o==="textarea"}function sE(a,o,c,h){Zs?Ma?Ma.push(h):Ma=[h]:Zs=h,o=rm(o,"onChange"),0<o.length&&(c=new Va("onChange","change",null,c,h),a.push({event:c,listeners:o}))}var Rf=null,Df=null;function s3(a){jT(a,0)}function md(a){var o=Fe(a);if(ul(o))return a}function oE(a,o){if(a==="change")return o}var lE=!1;if(ji){var Ig;if(ji){var kg="oninput"in document;if(!kg){var cE=document.createElement("div");cE.setAttribute("oninput","return;"),kg=typeof cE.oninput=="function"}Ig=kg}else Ig=!1;lE=Ig&&(!document.documentMode||9<document.documentMode)}function uE(){Rf&&(Rf.detachEvent("onpropertychange",fE),Df=Rf=null)}function fE(a){if(a.propertyName==="value"&&md(Df)){var o=[];sE(o,Df,a,zi(a)),eo(s3,o)}}function o3(a,o,c){a==="focusin"?(uE(),Rf=o,Df=c,Rf.attachEvent("onpropertychange",fE)):a==="focusout"&&uE()}function l3(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return md(Df)}function c3(a,o){if(a==="click")return md(o)}function u3(a,o){if(a==="input"||a==="change")return md(o)}function f3(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var yi=typeof Object.is=="function"?Object.is:f3;function Nf(a,o){if(yi(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var c=Object.keys(a),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!gt.call(o,g)||!yi(a[g],o[g]))return!1}return!0}function hE(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function dE(a,o){var c=hE(a);a=0;for(var h;c;){if(c.nodeType===3){if(h=a+c.textContent.length,a<=o&&h>=o)return{node:c,offset:o-a};a=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=hE(c)}}function mE(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?mE(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function pE(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=Pa(a.document);o instanceof a.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)a=o.contentWindow;else break;o=Pa(a.document)}return o}function Cg(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var h3=ji&&"documentMode"in document&&11>=document.documentMode,zc=null,Rg=null,Of=null,Dg=!1;function gE(a,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Dg||zc==null||zc!==Pa(h)||(h=zc,"selectionStart"in h&&Cg(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Of&&Nf(Of,h)||(Of=h,h=rm(Rg,"onSelect"),0<h.length&&(o=new Va("onSelect","select",null,o,c),a.push({event:o,listeners:h}),o.target=zc)))}function vl(a,o){var c={};return c[a.toLowerCase()]=o.toLowerCase(),c["Webkit"+a]="webkit"+o,c["Moz"+a]="moz"+o,c}var jc={animationend:vl("Animation","AnimationEnd"),animationiteration:vl("Animation","AnimationIteration"),animationstart:vl("Animation","AnimationStart"),transitionrun:vl("Transition","TransitionRun"),transitionstart:vl("Transition","TransitionStart"),transitioncancel:vl("Transition","TransitionCancel"),transitionend:vl("Transition","TransitionEnd")},Ng={},_E={};ji&&(_E=document.createElement("div").style,"AnimationEvent"in window||(delete jc.animationend.animation,delete jc.animationiteration.animation,delete jc.animationstart.animation),"TransitionEvent"in window||delete jc.transitionend.transition);function yl(a){if(Ng[a])return Ng[a];if(!jc[a])return a;var o=jc[a],c;for(c in o)if(o.hasOwnProperty(c)&&c in _E)return Ng[a]=o[c];return a}var xE=yl("animationend"),vE=yl("animationiteration"),yE=yl("animationstart"),d3=yl("transitionrun"),m3=yl("transitionstart"),p3=yl("transitioncancel"),EE=yl("transitionend"),TE=new Map,Og="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Og.push("scrollEnd");function Ea(a,o){TE.set(a,o),dr(o,[a])}var pd=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Gi=[],Hc=0,Fg=0;function gd(){for(var a=Hc,o=Fg=Hc=0;o<a;){var c=Gi[o];Gi[o++]=null;var h=Gi[o];Gi[o++]=null;var g=Gi[o];Gi[o++]=null;var x=Gi[o];if(Gi[o++]=null,h!==null&&g!==null){var b=h.pending;b===null?g.next=g:(g.next=b.next,b.next=g),h.pending=g}x!==0&&wE(c,g,x)}}function _d(a,o,c,h){Gi[Hc++]=a,Gi[Hc++]=o,Gi[Hc++]=c,Gi[Hc++]=h,Fg|=h,a.lanes|=h,a=a.alternate,a!==null&&(a.lanes|=h)}function Pg(a,o,c,h){return _d(a,o,c,h),xd(a)}function El(a,o){return _d(a,null,null,o),xd(a)}function wE(a,o,c){a.lanes|=c;var h=a.alternate;h!==null&&(h.lanes|=c);for(var g=!1,x=a.return;x!==null;)x.childLanes|=c,h=x.alternate,h!==null&&(h.childLanes|=c),x.tag===22&&(a=x.stateNode,a===null||a._visibility&1||(g=!0)),a=x,x=x.return;return a.tag===3?(x=a.stateNode,g&&o!==null&&(g=31-$t(c),a=x.hiddenUpdates,h=a[g],h===null?a[g]=[o]:h.push(o),o.lane=c|536870912),x):null}function xd(a){if(50<th)throw th=0,G1=null,Error(n(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var Gc={};function g3(a,o,c,h){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ei(a,o,c,h){return new g3(a,o,c,h)}function Mg(a){return a=a.prototype,!(!a||!a.isReactComponent)}function ps(a,o){var c=a.alternate;return c===null?(c=Ei(a.tag,o,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=o,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,o=a.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function SE(a,o){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,o=c.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function vd(a,o,c,h,g,x){var b=0;if(h=a,typeof a=="function")Mg(a)&&(b=1);else if(typeof a=="string")b=EN(a,c,q.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case C:return a=Ei(31,c,o,g),a.elementType=C,a.lanes=x,a;case E:return Tl(c.children,g,x,o);case S:b=8,g|=24;break;case D:return a=Ei(12,c,o,g|2),a.elementType=D,a.lanes=x,a;case ee:return a=Ei(13,c,o,g),a.elementType=ee,a.lanes=x,a;case X:return a=Ei(19,c,o,g),a.elementType=X,a.lanes=x,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case k:b=10;break e;case U:b=9;break e;case W:b=11;break e;case A:b=14;break e;case R:b=16,h=null;break e}b=29,c=Error(n(130,a===null?"null":typeof a,"")),h=null}return o=Ei(b,c,o,g),o.elementType=a,o.type=h,o.lanes=x,o}function Tl(a,o,c,h){return a=Ei(7,a,h,o),a.lanes=c,a}function Lg(a,o,c){return a=Ei(6,a,null,o),a.lanes=c,a}function AE(a){var o=Ei(18,null,null,0);return o.stateNode=a,o}function Vg(a,o,c){return o=Ei(4,a.children!==null?a.children:[],a.key,o),o.lanes=c,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var bE=new WeakMap;function qi(a,o){if(typeof a=="object"&&a!==null){var c=bE.get(a);return c!==void 0?c:(o={value:a,source:o,stack:nt(o)},bE.set(a,o),o)}return{value:a,source:o,stack:nt(o)}}var qc=[],Kc=0,yd=null,Ff=0,Ki=[],Wi=0,io=null,ja=1,Ha="";function gs(a,o){qc[Kc++]=Ff,qc[Kc++]=yd,yd=a,Ff=o}function IE(a,o,c){Ki[Wi++]=ja,Ki[Wi++]=Ha,Ki[Wi++]=io,io=a;var h=ja;a=Ha;var g=32-$t(h)-1;h&=~(1<<g),c+=1;var x=32-$t(o)+g;if(30<x){var b=g-g%5;x=(h&(1<<b)-1).toString(32),h>>=b,g-=b,ja=1<<32-$t(o)+g|c<<g|h,Ha=x+a}else ja=1<<x|c<<g|h,Ha=a}function Bg(a){a.return!==null&&(gs(a,1),IE(a,1,0))}function Ug(a){for(;a===yd;)yd=qc[--Kc],qc[Kc]=null,Ff=qc[--Kc],qc[Kc]=null;for(;a===io;)io=Ki[--Wi],Ki[Wi]=null,Ha=Ki[--Wi],Ki[Wi]=null,ja=Ki[--Wi],Ki[Wi]=null}function kE(a,o){Ki[Wi++]=ja,Ki[Wi++]=Ha,Ki[Wi++]=io,ja=o.id,Ha=o.overflow,io=a}var wn=null,gr=null,Pt=!1,ao=null,Xi=!1,zg=Error(n(519));function so(a){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Pf(qi(o,a)),zg}function CE(a){var o=a.stateNode,c=a.type,h=a.memoizedProps;switch(o[H]=a,o[G]=h,c){case"dialog":Rt("cancel",o),Rt("close",o);break;case"iframe":case"object":case"embed":Rt("load",o);break;case"video":case"audio":for(c=0;c<nh.length;c++)Rt(nh[c],o);break;case"source":Rt("error",o);break;case"img":case"image":case"link":Rt("error",o),Rt("load",o);break;case"details":Rt("toggle",o);break;case"input":Rt("invalid",o),Z0(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Rt("invalid",o);break;case"textarea":Rt("invalid",o),Qs(o,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||h.suppressHydrationWarning===!0||KT(o.textContent,c)?(h.popover!=null&&(Rt("beforetoggle",o),Rt("toggle",o)),h.onScroll!=null&&Rt("scroll",o),h.onScrollEnd!=null&&Rt("scrollend",o),h.onClick!=null&&(o.onclick=ga),o=!0):o=!1,o||so(a,!0)}function RE(a){for(wn=a.return;wn;)switch(wn.tag){case 5:case 31:case 13:Xi=!1;return;case 27:case 3:Xi=!0;return;default:wn=wn.return}}function Wc(a){if(a!==wn)return!1;if(!Pt)return RE(a),Pt=!0,!1;var o=a.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||a_(a.type,a.memoizedProps)),c=!c),c&&gr&&so(a),RE(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));gr=tw(a)}else if(o===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));gr=tw(a)}else o===27?(o=gr,Eo(a.type)?(a=u_,u_=null,gr=a):gr=o):gr=wn?$i(a.stateNode.nextSibling):null;return!0}function wl(){gr=wn=null,Pt=!1}function jg(){var a=ao;return a!==null&&(fi===null?fi=a:fi.push.apply(fi,a),ao=null),a}function Pf(a){ao===null?ao=[a]:ao.push(a)}var Hg=J(null),Sl=null,_s=null;function oo(a,o,c){Q(Hg,o._currentValue),o._currentValue=c}function xs(a){a._currentValue=Hg.current,O(Hg)}function Gg(a,o,c){for(;a!==null;){var h=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),a===c)break;a=a.return}}function qg(a,o,c,h){var g=a.child;for(g!==null&&(g.return=a);g!==null;){var x=g.dependencies;if(x!==null){var b=g.child;x=x.firstContext;e:for(;x!==null;){var L=x;x=g;for(var re=0;re<o.length;re++)if(L.context===o[re]){x.lanes|=c,L=x.alternate,L!==null&&(L.lanes|=c),Gg(x.return,c,a),h||(b=null);break e}x=L.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(n(341));b.lanes|=c,x=b.alternate,x!==null&&(x.lanes|=c),Gg(b,c,a),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===a){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function Xc(a,o,c,h){a=null;for(var g=o,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var L=g.type;yi(g.pendingProps.value,b.value)||(a!==null?a.push(L):a=[L])}}else if(g===Te.current){if(b=g.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(a!==null?a.push(lh):a=[lh])}g=g.return}a!==null&&qg(o,a,c,h),o.flags|=262144}function Ed(a){for(a=a.firstContext;a!==null;){if(!yi(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Al(a){Sl=a,_s=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Sn(a){return DE(Sl,a)}function Td(a,o){return Sl===null&&Al(a),DE(a,o)}function DE(a,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},_s===null){if(a===null)throw Error(n(308));_s=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else _s=_s.next=o;return c}var _3=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(c,h){a.push(h)}};this.abort=function(){o.aborted=!0,a.forEach(function(c){return c()})}},x3=r.unstable_scheduleCallback,v3=r.unstable_NormalPriority,Wr={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kg(){return{controller:new _3,data:new Map,refCount:0}}function Mf(a){a.refCount--,a.refCount===0&&x3(v3,function(){a.controller.abort()})}var Lf=null,Wg=0,Yc=0,$c=null;function y3(a,o){if(Lf===null){var c=Lf=[];Wg=0,Yc=$1(),$c={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Wg++,o.then(NE,NE),o}function NE(){if(--Wg===0&&Lf!==null){$c!==null&&($c.status="fulfilled");var a=Lf;Lf=null,Yc=0,$c=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function E3(a,o){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return a.then(function(){h.status="fulfilled",h.value=o;for(var g=0;g<c.length;g++)(0,c[g])(o)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var OE=ne.S;ne.S=function(a,o){gT=qt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&y3(a,o),OE!==null&&OE(a,o)};var bl=J(null);function Xg(){var a=bl.current;return a!==null?a:mr.pooledCache}function wd(a,o){o===null?Q(bl,bl.current):Q(bl,o.pool)}function FE(){var a=Xg();return a===null?null:{parent:Wr._currentValue,pool:a}}var Qc=Error(n(460)),Yg=Error(n(474)),Sd=Error(n(542)),Ad={then:function(){}};function PE(a){return a=a.status,a==="fulfilled"||a==="rejected"}function ME(a,o,c){switch(c=a[c],c===void 0?a.push(o):c!==o&&(o.then(ga,ga),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,VE(a),a;default:if(typeof o.status=="string")o.then(ga,ga);else{if(a=mr,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=o,a.status="pending",a.then(function(h){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=h}},function(h){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,VE(a),a}throw kl=o,Qc}}function Il(a){try{var o=a._init;return o(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(kl=c,Qc):c}}var kl=null;function LE(){if(kl===null)throw Error(n(459));var a=kl;return kl=null,a}function VE(a){if(a===Qc||a===Sd)throw Error(n(483))}var Jc=null,Vf=0;function bd(a){var o=Vf;return Vf+=1,Jc===null&&(Jc=[]),ME(Jc,a,o)}function Bf(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Id(a,o){throw o.$$typeof===v?Error(n(525)):(a=Object.prototype.toString.call(o),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function BE(a){function o(se,ie){if(a){var fe=se.deletions;fe===null?(se.deletions=[ie],se.flags|=16):fe.push(ie)}}function c(se,ie){if(!a)return null;for(;ie!==null;)o(se,ie),ie=ie.sibling;return null}function h(se){for(var ie=new Map;se!==null;)se.key!==null?ie.set(se.key,se):ie.set(se.index,se),se=se.sibling;return ie}function g(se,ie){return se=ps(se,ie),se.index=0,se.sibling=null,se}function x(se,ie,fe){return se.index=fe,a?(fe=se.alternate,fe!==null?(fe=fe.index,fe<ie?(se.flags|=67108866,ie):fe):(se.flags|=67108866,ie)):(se.flags|=1048576,ie)}function b(se){return a&&se.alternate===null&&(se.flags|=67108866),se}function L(se,ie,fe,Ie){return ie===null||ie.tag!==6?(ie=Lg(fe,se.mode,Ie),ie.return=se,ie):(ie=g(ie,fe),ie.return=se,ie)}function re(se,ie,fe,Ie){var at=fe.type;return at===E?Ae(se,ie,fe.props.children,Ie,fe.key):ie!==null&&(ie.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===R&&Il(at)===ie.type)?(ie=g(ie,fe.props),Bf(ie,fe),ie.return=se,ie):(ie=vd(fe.type,fe.key,fe.props,null,se.mode,Ie),Bf(ie,fe),ie.return=se,ie)}function me(se,ie,fe,Ie){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==fe.containerInfo||ie.stateNode.implementation!==fe.implementation?(ie=Vg(fe,se.mode,Ie),ie.return=se,ie):(ie=g(ie,fe.children||[]),ie.return=se,ie)}function Ae(se,ie,fe,Ie,at){return ie===null||ie.tag!==7?(ie=Tl(fe,se.mode,Ie,at),ie.return=se,ie):(ie=g(ie,fe),ie.return=se,ie)}function Re(se,ie,fe){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=Lg(""+ie,se.mode,fe),ie.return=se,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case y:return fe=vd(ie.type,ie.key,ie.props,null,se.mode,fe),Bf(fe,ie),fe.return=se,fe;case T:return ie=Vg(ie,se.mode,fe),ie.return=se,ie;case R:return ie=Il(ie),Re(se,ie,fe)}if(ve(ie)||M(ie))return ie=Tl(ie,se.mode,fe,null),ie.return=se,ie;if(typeof ie.then=="function")return Re(se,bd(ie),fe);if(ie.$$typeof===k)return Re(se,Td(se,ie),fe);Id(se,ie)}return null}function _e(se,ie,fe,Ie){var at=ie!==null?ie.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return at!==null?null:L(se,ie,""+fe,Ie);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:return fe.key===at?re(se,ie,fe,Ie):null;case T:return fe.key===at?me(se,ie,fe,Ie):null;case R:return fe=Il(fe),_e(se,ie,fe,Ie)}if(ve(fe)||M(fe))return at!==null?null:Ae(se,ie,fe,Ie,null);if(typeof fe.then=="function")return _e(se,ie,bd(fe),Ie);if(fe.$$typeof===k)return _e(se,ie,Td(se,fe),Ie);Id(se,fe)}return null}function Ee(se,ie,fe,Ie,at){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return se=se.get(fe)||null,L(ie,se,""+Ie,at);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case y:return se=se.get(Ie.key===null?fe:Ie.key)||null,re(ie,se,Ie,at);case T:return se=se.get(Ie.key===null?fe:Ie.key)||null,me(ie,se,Ie,at);case R:return Ie=Il(Ie),Ee(se,ie,fe,Ie,at)}if(ve(Ie)||M(Ie))return se=se.get(fe)||null,Ae(ie,se,Ie,at,null);if(typeof Ie.then=="function")return Ee(se,ie,fe,bd(Ie),at);if(Ie.$$typeof===k)return Ee(se,ie,fe,Td(ie,Ie),at);Id(ie,Ie)}return null}function $e(se,ie,fe,Ie){for(var at=null,jt=null,Ze=ie,Et=ie=0,Nt=null;Ze!==null&&Et<fe.length;Et++){Ze.index>Et?(Nt=Ze,Ze=null):Nt=Ze.sibling;var Ht=_e(se,Ze,fe[Et],Ie);if(Ht===null){Ze===null&&(Ze=Nt);break}a&&Ze&&Ht.alternate===null&&o(se,Ze),ie=x(Ht,ie,Et),jt===null?at=Ht:jt.sibling=Ht,jt=Ht,Ze=Nt}if(Et===fe.length)return c(se,Ze),Pt&&gs(se,Et),at;if(Ze===null){for(;Et<fe.length;Et++)Ze=Re(se,fe[Et],Ie),Ze!==null&&(ie=x(Ze,ie,Et),jt===null?at=Ze:jt.sibling=Ze,jt=Ze);return Pt&&gs(se,Et),at}for(Ze=h(Ze);Et<fe.length;Et++)Nt=Ee(Ze,se,Et,fe[Et],Ie),Nt!==null&&(a&&Nt.alternate!==null&&Ze.delete(Nt.key===null?Et:Nt.key),ie=x(Nt,ie,Et),jt===null?at=Nt:jt.sibling=Nt,jt=Nt);return a&&Ze.forEach(function(bo){return o(se,bo)}),Pt&&gs(se,Et),at}function ct(se,ie,fe,Ie){if(fe==null)throw Error(n(151));for(var at=null,jt=null,Ze=ie,Et=ie=0,Nt=null,Ht=fe.next();Ze!==null&&!Ht.done;Et++,Ht=fe.next()){Ze.index>Et?(Nt=Ze,Ze=null):Nt=Ze.sibling;var bo=_e(se,Ze,Ht.value,Ie);if(bo===null){Ze===null&&(Ze=Nt);break}a&&Ze&&bo.alternate===null&&o(se,Ze),ie=x(bo,ie,Et),jt===null?at=bo:jt.sibling=bo,jt=bo,Ze=Nt}if(Ht.done)return c(se,Ze),Pt&&gs(se,Et),at;if(Ze===null){for(;!Ht.done;Et++,Ht=fe.next())Ht=Re(se,Ht.value,Ie),Ht!==null&&(ie=x(Ht,ie,Et),jt===null?at=Ht:jt.sibling=Ht,jt=Ht);return Pt&&gs(se,Et),at}for(Ze=h(Ze);!Ht.done;Et++,Ht=fe.next())Ht=Ee(Ze,se,Et,Ht.value,Ie),Ht!==null&&(a&&Ht.alternate!==null&&Ze.delete(Ht.key===null?Et:Ht.key),ie=x(Ht,ie,Et),jt===null?at=Ht:jt.sibling=Ht,jt=Ht);return a&&Ze.forEach(function(NN){return o(se,NN)}),Pt&&gs(se,Et),at}function ur(se,ie,fe,Ie){if(typeof fe=="object"&&fe!==null&&fe.type===E&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:e:{for(var at=fe.key;ie!==null;){if(ie.key===at){if(at=fe.type,at===E){if(ie.tag===7){c(se,ie.sibling),Ie=g(ie,fe.props.children),Ie.return=se,se=Ie;break e}}else if(ie.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===R&&Il(at)===ie.type){c(se,ie.sibling),Ie=g(ie,fe.props),Bf(Ie,fe),Ie.return=se,se=Ie;break e}c(se,ie);break}else o(se,ie);ie=ie.sibling}fe.type===E?(Ie=Tl(fe.props.children,se.mode,Ie,fe.key),Ie.return=se,se=Ie):(Ie=vd(fe.type,fe.key,fe.props,null,se.mode,Ie),Bf(Ie,fe),Ie.return=se,se=Ie)}return b(se);case T:e:{for(at=fe.key;ie!==null;){if(ie.key===at)if(ie.tag===4&&ie.stateNode.containerInfo===fe.containerInfo&&ie.stateNode.implementation===fe.implementation){c(se,ie.sibling),Ie=g(ie,fe.children||[]),Ie.return=se,se=Ie;break e}else{c(se,ie);break}else o(se,ie);ie=ie.sibling}Ie=Vg(fe,se.mode,Ie),Ie.return=se,se=Ie}return b(se);case R:return fe=Il(fe),ur(se,ie,fe,Ie)}if(ve(fe))return $e(se,ie,fe,Ie);if(M(fe)){if(at=M(fe),typeof at!="function")throw Error(n(150));return fe=at.call(fe),ct(se,ie,fe,Ie)}if(typeof fe.then=="function")return ur(se,ie,bd(fe),Ie);if(fe.$$typeof===k)return ur(se,ie,Td(se,fe),Ie);Id(se,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,ie!==null&&ie.tag===6?(c(se,ie.sibling),Ie=g(ie,fe),Ie.return=se,se=Ie):(c(se,ie),Ie=Lg(fe,se.mode,Ie),Ie.return=se,se=Ie),b(se)):c(se,ie)}return function(se,ie,fe,Ie){try{Vf=0;var at=ur(se,ie,fe,Ie);return Jc=null,at}catch(Ze){if(Ze===Qc||Ze===Sd)throw Ze;var jt=Ei(29,Ze,null,se.mode);return jt.lanes=Ie,jt.return=se,jt}finally{}}}var Cl=BE(!0),UE=BE(!1),lo=!1;function $g(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qg(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function co(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function uo(a,o,c){var h=a.updateQueue;if(h===null)return null;if(h=h.shared,(Xt&2)!==0){var g=h.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),h.pending=o,o=xd(a),wE(a,null,c),o}return _d(a,h,o,c),xd(a)}function Uf(a,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var h=o.lanes;h&=a.pendingLanes,c|=h,o.lanes=c,us(a,c)}}function Jg(a,o){var c=a.updateQueue,h=a.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=b:x=x.next=b,c=c.next}while(c!==null);x===null?g=x=o:x=x.next=o}else g=x=o;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:h.shared,callbacks:h.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=o:a.next=o,c.lastBaseUpdate=o}var Zg=!1;function zf(){if(Zg){var a=$c;if(a!==null)throw a}}function jf(a,o,c,h){Zg=!1;var g=a.updateQueue;lo=!1;var x=g.firstBaseUpdate,b=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var re=L,me=re.next;re.next=null,b===null?x=me:b.next=me,b=re;var Ae=a.alternate;Ae!==null&&(Ae=Ae.updateQueue,L=Ae.lastBaseUpdate,L!==b&&(L===null?Ae.firstBaseUpdate=me:L.next=me,Ae.lastBaseUpdate=re))}if(x!==null){var Re=g.baseState;b=0,Ae=me=re=null,L=x;do{var _e=L.lane&-536870913,Ee=_e!==L.lane;if(Ee?(Dt&_e)===_e:(h&_e)===_e){_e!==0&&_e===Yc&&(Zg=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var $e=a,ct=L;_e=o;var ur=c;switch(ct.tag){case 1:if($e=ct.payload,typeof $e=="function"){Re=$e.call(ur,Re,_e);break e}Re=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=ct.payload,_e=typeof $e=="function"?$e.call(ur,Re,_e):$e,_e==null)break e;Re=_({},Re,_e);break e;case 2:lo=!0}}_e=L.callback,_e!==null&&(a.flags|=64,Ee&&(a.flags|=8192),Ee=g.callbacks,Ee===null?g.callbacks=[_e]:Ee.push(_e))}else Ee={lane:_e,tag:L.tag,payload:L.payload,callback:L.callback,next:null},Ae===null?(me=Ae=Ee,re=Re):Ae=Ae.next=Ee,b|=_e;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;Ee=L,L=Ee.next,Ee.next=null,g.lastBaseUpdate=Ee,g.shared.pending=null}}while(!0);Ae===null&&(re=Re),g.baseState=re,g.firstBaseUpdate=me,g.lastBaseUpdate=Ae,x===null&&(g.shared.lanes=0),go|=b,a.lanes=b,a.memoizedState=Re}}function zE(a,o){if(typeof a!="function")throw Error(n(191,a));a.call(o)}function jE(a,o){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)zE(c[a],o)}var Zc=J(null),kd=J(0);function HE(a,o){a=Is,Q(kd,a),Q(Zc,o),Is=a|o.baseLanes}function e1(){Q(kd,Is),Q(Zc,Zc.current)}function t1(){Is=kd.current,O(Zc),O(kd)}var Ti=J(null),Yi=null;function fo(a){var o=a.alternate;Q(Ur,Ur.current&1),Q(Ti,a),Yi===null&&(o===null||Zc.current!==null||o.memoizedState!==null)&&(Yi=a)}function r1(a){Q(Ur,Ur.current),Q(Ti,a),Yi===null&&(Yi=a)}function GE(a){a.tag===22?(Q(Ur,Ur.current),Q(Ti,a),Yi===null&&(Yi=a)):ho()}function ho(){Q(Ur,Ur.current),Q(Ti,Ti.current)}function wi(a){O(Ti),Yi===a&&(Yi=null),O(Ur)}var Ur=J(0);function Cd(a){for(var o=a;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||l_(c)||c_(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var vs=0,xt=null,lr=null,Xr=null,Rd=!1,eu=!1,Rl=!1,Dd=0,Hf=0,tu=null,T3=0;function Dr(){throw Error(n(321))}function n1(a,o){if(o===null)return!1;for(var c=0;c<o.length&&c<a.length;c++)if(!yi(a[c],o[c]))return!1;return!0}function i1(a,o,c,h,g,x){return vs=x,xt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ne.H=a===null||a.memoizedState===null?I2:v1,Rl=!1,x=c(h,g),Rl=!1,eu&&(x=KE(o,c,h,g)),qE(a),x}function qE(a){ne.H=Kf;var o=lr!==null&&lr.next!==null;if(vs=0,Xr=lr=xt=null,Rd=!1,Hf=0,tu=null,o)throw Error(n(300));a===null||Yr||(a=a.dependencies,a!==null&&Ed(a)&&(Yr=!0))}function KE(a,o,c,h){xt=a;var g=0;do{if(eu&&(tu=null),Hf=0,eu=!1,25<=g)throw Error(n(301));if(g+=1,Xr=lr=null,a.updateQueue!=null){var x=a.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ne.H=k2,x=o(c,h)}while(eu);return x}function w3(){var a=ne.H,o=a.useState()[0];return o=typeof o.then=="function"?Gf(o):o,a=a.useState()[0],(lr!==null?lr.memoizedState:null)!==a&&(xt.flags|=1024),o}function a1(){var a=Dd!==0;return Dd=0,a}function s1(a,o,c){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~c}function o1(a){if(Rd){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Rd=!1}vs=0,Xr=lr=xt=null,eu=!1,Hf=Dd=0,tu=null}function Jn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xr===null?xt.memoizedState=Xr=a:Xr=Xr.next=a,Xr}function zr(){if(lr===null){var a=xt.alternate;a=a!==null?a.memoizedState:null}else a=lr.next;var o=Xr===null?xt.memoizedState:Xr.next;if(o!==null)Xr=o,lr=a;else{if(a===null)throw xt.alternate===null?Error(n(467)):Error(n(310));lr=a,a={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},Xr===null?xt.memoizedState=Xr=a:Xr=Xr.next=a}return Xr}function Nd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gf(a){var o=Hf;return Hf+=1,tu===null&&(tu=[]),a=ME(tu,a,o),o=xt,(Xr===null?o.memoizedState:Xr.next)===null&&(o=o.alternate,ne.H=o===null||o.memoizedState===null?I2:v1),a}function Od(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Gf(a);if(a.$$typeof===k)return Sn(a)}throw Error(n(438,String(a)))}function l1(a){var o=null,c=xt.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var h=xt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Nd(),xt.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(a),h=0;h<a;h++)c[h]=B;return o.index++,c}function ys(a,o){return typeof o=="function"?o(a):o}function Fd(a){var o=zr();return c1(o,lr,a)}function c1(a,o,c){var h=a.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var g=a.baseQueue,x=h.pending;if(x!==null){if(g!==null){var b=g.next;g.next=x.next,x.next=b}o.baseQueue=g=x,h.pending=null}if(x=a.baseState,g===null)a.memoizedState=x;else{o=g.next;var L=b=null,re=null,me=o,Ae=!1;do{var Re=me.lane&-536870913;if(Re!==me.lane?(Dt&Re)===Re:(vs&Re)===Re){var _e=me.revertLane;if(_e===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),Re===Yc&&(Ae=!0);else if((vs&_e)===_e){me=me.next,_e===Yc&&(Ae=!0);continue}else Re={lane:0,revertLane:me.revertLane,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(L=re=Re,b=x):re=re.next=Re,xt.lanes|=_e,go|=_e;Re=me.action,Rl&&c(x,Re),x=me.hasEagerState?me.eagerState:c(x,Re)}else _e={lane:Re,revertLane:me.revertLane,gesture:me.gesture,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(L=re=_e,b=x):re=re.next=_e,xt.lanes|=Re,go|=Re;me=me.next}while(me!==null&&me!==o);if(re===null?b=x:re.next=L,!yi(x,a.memoizedState)&&(Yr=!0,Ae&&(c=$c,c!==null)))throw c;a.memoizedState=x,a.baseState=b,a.baseQueue=re,h.lastRenderedState=x}return g===null&&(h.lanes=0),[a.memoizedState,h.dispatch]}function u1(a){var o=zr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var h=c.dispatch,g=c.pending,x=o.memoizedState;if(g!==null){c.pending=null;var b=g=g.next;do x=a(x,b.action),b=b.next;while(b!==g);yi(x,o.memoizedState)||(Yr=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),c.lastRenderedState=x}return[x,h]}function WE(a,o,c){var h=xt,g=zr(),x=Pt;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=o();var b=!yi((lr||g).memoizedState,c);if(b&&(g.memoizedState=c,Yr=!0),g=g.queue,d1($E.bind(null,h,g,a),[a]),g.getSnapshot!==o||b||Xr!==null&&Xr.memoizedState.tag&1){if(h.flags|=2048,ru(9,{destroy:void 0},YE.bind(null,h,g,c,o),null),mr===null)throw Error(n(349));x||(vs&127)!==0||XE(h,o,c)}return c}function XE(a,o,c){a.flags|=16384,a={getSnapshot:o,value:c},o=xt.updateQueue,o===null?(o=Nd(),xt.updateQueue=o,o.stores=[a]):(c=o.stores,c===null?o.stores=[a]:c.push(a))}function YE(a,o,c,h){o.value=c,o.getSnapshot=h,QE(o)&&JE(a)}function $E(a,o,c){return c(function(){QE(o)&&JE(a)})}function QE(a){var o=a.getSnapshot;a=a.value;try{var c=o();return!yi(a,c)}catch{return!0}}function JE(a){var o=El(a,2);o!==null&&hi(o,a,2)}function f1(a){var o=Jn();if(typeof a=="function"){var c=a;if(a=c(),Rl){on(!0);try{c()}finally{on(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:a},o}function ZE(a,o,c,h){return a.baseState=c,c1(a,lr,typeof h=="function"?h:ys)}function S3(a,o,c,h,g){if(Ld(a))throw Error(n(485));if(a=o.action,a!==null){var x={payload:g,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){x.listeners.push(b)}};ne.T!==null?c(!0):x.isTransition=!1,h(x),c=o.pending,c===null?(x.next=o.pending=x,e2(o,x)):(x.next=c.next,o.pending=c.next=x)}}function e2(a,o){var c=o.action,h=o.payload,g=a.state;if(o.isTransition){var x=ne.T,b={};ne.T=b;try{var L=c(g,h),re=ne.S;re!==null&&re(b,L),t2(a,o,L)}catch(me){h1(a,o,me)}finally{x!==null&&b.types!==null&&(x.types=b.types),ne.T=x}}else try{x=c(g,h),t2(a,o,x)}catch(me){h1(a,o,me)}}function t2(a,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){r2(a,o,h)},function(h){return h1(a,o,h)}):r2(a,o,c)}function r2(a,o,c){o.status="fulfilled",o.value=c,n2(o),a.state=c,o=a.pending,o!==null&&(c=o.next,c===o?a.pending=null:(c=c.next,o.next=c,e2(a,c)))}function h1(a,o,c){var h=a.pending;if(a.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=c,n2(o),o=o.next;while(o!==h)}a.action=null}function n2(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function i2(a,o){return o}function a2(a,o){if(Pt){var c=mr.formState;if(c!==null){e:{var h=xt;if(Pt){if(gr){t:{for(var g=gr,x=Xi;g.nodeType!==8;){if(!x){g=null;break t}if(g=$i(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){gr=$i(g.nextSibling),h=g.data==="F!";break e}}so(h)}h=!1}h&&(o=c[0])}}return c=Jn(),c.memoizedState=c.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i2,lastRenderedState:o},c.queue=h,c=S2.bind(null,xt,h),h.dispatch=c,h=f1(!1),x=x1.bind(null,xt,!1,h.queue),h=Jn(),g={state:o,dispatch:null,action:a,pending:null},h.queue=g,c=S3.bind(null,xt,g,x,c),g.dispatch=c,h.memoizedState=a,[o,c,!1]}function s2(a){var o=zr();return o2(o,lr,a)}function o2(a,o,c){if(o=c1(a,o,i2)[0],a=Fd(ys)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Gf(o)}catch(b){throw b===Qc?Sd:b}else h=o;o=zr();var g=o.queue,x=g.dispatch;return c!==o.memoizedState&&(xt.flags|=2048,ru(9,{destroy:void 0},A3.bind(null,g,c),null)),[h,x,a]}function A3(a,o){a.action=o}function l2(a){var o=zr(),c=lr;if(c!==null)return o2(o,c,a);zr(),o=o.memoizedState,c=zr();var h=c.queue.dispatch;return c.memoizedState=a,[o,h,!1]}function ru(a,o,c,h){return a={tag:a,create:c,deps:h,inst:o,next:null},o=xt.updateQueue,o===null&&(o=Nd(),xt.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=a.next=a:(h=c.next,c.next=a,a.next=h,o.lastEffect=a),a}function c2(){return zr().memoizedState}function Pd(a,o,c,h){var g=Jn();xt.flags|=a,g.memoizedState=ru(1|o,{destroy:void 0},c,h===void 0?null:h)}function Md(a,o,c,h){var g=zr();h=h===void 0?null:h;var x=g.memoizedState.inst;lr!==null&&h!==null&&n1(h,lr.memoizedState.deps)?g.memoizedState=ru(o,x,c,h):(xt.flags|=a,g.memoizedState=ru(1|o,x,c,h))}function u2(a,o){Pd(8390656,8,a,o)}function d1(a,o){Md(2048,8,a,o)}function b3(a){xt.flags|=4;var o=xt.updateQueue;if(o===null)o=Nd(),xt.updateQueue=o,o.events=[a];else{var c=o.events;c===null?o.events=[a]:c.push(a)}}function f2(a){var o=zr().memoizedState;return b3({ref:o,nextImpl:a}),function(){if((Xt&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function h2(a,o){return Md(4,2,a,o)}function d2(a,o){return Md(4,4,a,o)}function m2(a,o){if(typeof o=="function"){a=a();var c=o(a);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function p2(a,o,c){c=c!=null?c.concat([a]):null,Md(4,4,m2.bind(null,o,a),c)}function m1(){}function g2(a,o){var c=zr();o=o===void 0?null:o;var h=c.memoizedState;return o!==null&&n1(o,h[1])?h[0]:(c.memoizedState=[a,o],a)}function _2(a,o){var c=zr();o=o===void 0?null:o;var h=c.memoizedState;if(o!==null&&n1(o,h[1]))return h[0];if(h=a(),Rl){on(!0);try{a()}finally{on(!1)}}return c.memoizedState=[h,o],h}function p1(a,o,c){return c===void 0||(vs&1073741824)!==0&&(Dt&261930)===0?a.memoizedState=o:(a.memoizedState=c,a=xT(),xt.lanes|=a,go|=a,c)}function x2(a,o,c,h){return yi(c,o)?c:Zc.current!==null?(a=p1(a,c,h),yi(a,o)||(Yr=!0),a):(vs&42)===0||(vs&1073741824)!==0&&(Dt&261930)===0?(Yr=!0,a.memoizedState=c):(a=xT(),xt.lanes|=a,go|=a,o)}function v2(a,o,c,h,g){var x=le.p;le.p=x!==0&&8>x?x:8;var b=ne.T,L={};ne.T=L,x1(a,!1,o,c);try{var re=g(),me=ne.S;if(me!==null&&me(L,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ae=E3(re,h);qf(a,o,Ae,bi(a))}else qf(a,o,h,bi(a))}catch(Re){qf(a,o,{then:function(){},status:"rejected",reason:Re},bi())}finally{le.p=x,b!==null&&L.types!==null&&(b.types=L.types),ne.T=b}}function I3(){}function g1(a,o,c,h){if(a.tag!==5)throw Error(n(476));var g=y2(a).queue;v2(a,g,o,Pe,c===null?I3:function(){return E2(a),c(h)})}function y2(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:Pe},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:c},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function E2(a){var o=y2(a);o.next===null&&(o=a.alternate.memoizedState),qf(a,o.next.queue,{},bi())}function _1(){return Sn(lh)}function T2(){return zr().memoizedState}function w2(){return zr().memoizedState}function k3(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var c=bi();a=co(c);var h=uo(o,a,c);h!==null&&(hi(h,o,c),Uf(h,o,c)),o={cache:Kg()},a.payload=o;return}o=o.return}}function C3(a,o,c){var h=bi();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ld(a)?A2(o,c):(c=Pg(a,o,c,h),c!==null&&(hi(c,a,h),b2(c,o,h)))}function S2(a,o,c){var h=bi();qf(a,o,c,h)}function qf(a,o,c,h){var g={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ld(a))A2(o,g);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=o.lastRenderedReducer,x!==null))try{var b=o.lastRenderedState,L=x(b,c);if(g.hasEagerState=!0,g.eagerState=L,yi(L,b))return _d(a,o,g,0),mr===null&&gd(),!1}catch{}finally{}if(c=Pg(a,o,g,h),c!==null)return hi(c,a,h),b2(c,o,h),!0}return!1}function x1(a,o,c,h){if(h={lane:2,revertLane:$1(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Ld(a)){if(o)throw Error(n(479))}else o=Pg(a,c,h,2),o!==null&&hi(o,a,2)}function Ld(a){var o=a.alternate;return a===xt||o!==null&&o===xt}function A2(a,o){eu=Rd=!0;var c=a.pending;c===null?o.next=o:(o.next=c.next,c.next=o),a.pending=o}function b2(a,o,c){if((c&4194048)!==0){var h=o.lanes;h&=a.pendingLanes,c|=h,o.lanes=c,us(a,c)}}var Kf={readContext:Sn,use:Od,useCallback:Dr,useContext:Dr,useEffect:Dr,useImperativeHandle:Dr,useLayoutEffect:Dr,useInsertionEffect:Dr,useMemo:Dr,useReducer:Dr,useRef:Dr,useState:Dr,useDebugValue:Dr,useDeferredValue:Dr,useTransition:Dr,useSyncExternalStore:Dr,useId:Dr,useHostTransitionStatus:Dr,useFormState:Dr,useActionState:Dr,useOptimistic:Dr,useMemoCache:Dr,useCacheRefresh:Dr};Kf.useEffectEvent=Dr;var I2={readContext:Sn,use:Od,useCallback:function(a,o){return Jn().memoizedState=[a,o===void 0?null:o],a},useContext:Sn,useEffect:u2,useImperativeHandle:function(a,o,c){c=c!=null?c.concat([a]):null,Pd(4194308,4,m2.bind(null,o,a),c)},useLayoutEffect:function(a,o){return Pd(4194308,4,a,o)},useInsertionEffect:function(a,o){Pd(4,2,a,o)},useMemo:function(a,o){var c=Jn();o=o===void 0?null:o;var h=a();if(Rl){on(!0);try{a()}finally{on(!1)}}return c.memoizedState=[h,o],h},useReducer:function(a,o,c){var h=Jn();if(c!==void 0){var g=c(o);if(Rl){on(!0);try{c(o)}finally{on(!1)}}}else g=o;return h.memoizedState=h.baseState=g,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:g},h.queue=a,a=a.dispatch=C3.bind(null,xt,a),[h.memoizedState,a]},useRef:function(a){var o=Jn();return a={current:a},o.memoizedState=a},useState:function(a){a=f1(a);var o=a.queue,c=S2.bind(null,xt,o);return o.dispatch=c,[a.memoizedState,c]},useDebugValue:m1,useDeferredValue:function(a,o){var c=Jn();return p1(c,a,o)},useTransition:function(){var a=f1(!1);return a=v2.bind(null,xt,a.queue,!0,!1),Jn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,c){var h=xt,g=Jn();if(Pt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),mr===null)throw Error(n(349));(Dt&127)!==0||XE(h,o,c)}g.memoizedState=c;var x={value:c,getSnapshot:o};return g.queue=x,u2($E.bind(null,h,x,a),[a]),h.flags|=2048,ru(9,{destroy:void 0},YE.bind(null,h,x,c,o),null),c},useId:function(){var a=Jn(),o=mr.identifierPrefix;if(Pt){var c=Ha,h=ja;c=(h&~(1<<32-$t(h)-1)).toString(32)+c,o="_"+o+"R_"+c,c=Dd++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=T3++,o="_"+o+"r_"+c.toString(32)+"_";return a.memoizedState=o},useHostTransitionStatus:_1,useFormState:a2,useActionState:a2,useOptimistic:function(a){var o=Jn();o.memoizedState=o.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=x1.bind(null,xt,!0,c),c.dispatch=o,[a,o]},useMemoCache:l1,useCacheRefresh:function(){return Jn().memoizedState=k3.bind(null,xt)},useEffectEvent:function(a){var o=Jn(),c={impl:a};return o.memoizedState=c,function(){if((Xt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},v1={readContext:Sn,use:Od,useCallback:g2,useContext:Sn,useEffect:d1,useImperativeHandle:p2,useInsertionEffect:h2,useLayoutEffect:d2,useMemo:_2,useReducer:Fd,useRef:c2,useState:function(){return Fd(ys)},useDebugValue:m1,useDeferredValue:function(a,o){var c=zr();return x2(c,lr.memoizedState,a,o)},useTransition:function(){var a=Fd(ys)[0],o=zr().memoizedState;return[typeof a=="boolean"?a:Gf(a),o]},useSyncExternalStore:WE,useId:T2,useHostTransitionStatus:_1,useFormState:s2,useActionState:s2,useOptimistic:function(a,o){var c=zr();return ZE(c,lr,a,o)},useMemoCache:l1,useCacheRefresh:w2};v1.useEffectEvent=f2;var k2={readContext:Sn,use:Od,useCallback:g2,useContext:Sn,useEffect:d1,useImperativeHandle:p2,useInsertionEffect:h2,useLayoutEffect:d2,useMemo:_2,useReducer:u1,useRef:c2,useState:function(){return u1(ys)},useDebugValue:m1,useDeferredValue:function(a,o){var c=zr();return lr===null?p1(c,a,o):x2(c,lr.memoizedState,a,o)},useTransition:function(){var a=u1(ys)[0],o=zr().memoizedState;return[typeof a=="boolean"?a:Gf(a),o]},useSyncExternalStore:WE,useId:T2,useHostTransitionStatus:_1,useFormState:l2,useActionState:l2,useOptimistic:function(a,o){var c=zr();return lr!==null?ZE(c,lr,a,o):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:l1,useCacheRefresh:w2};k2.useEffectEvent=f2;function y1(a,o,c,h){o=a.memoizedState,c=c(h,o),c=c==null?o:_({},o,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var E1={enqueueSetState:function(a,o,c){a=a._reactInternals;var h=bi(),g=co(h);g.payload=o,c!=null&&(g.callback=c),o=uo(a,g,h),o!==null&&(hi(o,a,h),Uf(o,a,h))},enqueueReplaceState:function(a,o,c){a=a._reactInternals;var h=bi(),g=co(h);g.tag=1,g.payload=o,c!=null&&(g.callback=c),o=uo(a,g,h),o!==null&&(hi(o,a,h),Uf(o,a,h))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var c=bi(),h=co(c);h.tag=2,o!=null&&(h.callback=o),o=uo(a,h,c),o!==null&&(hi(o,a,c),Uf(o,a,c))}};function C2(a,o,c,h,g,x,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(h,x,b):o.prototype&&o.prototype.isPureReactComponent?!Nf(c,h)||!Nf(g,x):!0}function R2(a,o,c,h){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==a&&E1.enqueueReplaceState(o,o.state,null)}function Dl(a,o){var c=o;if("ref"in o){c={};for(var h in o)h!=="ref"&&(c[h]=o[h])}if(a=a.defaultProps){c===o&&(c=_({},c));for(var g in a)c[g]===void 0&&(c[g]=a[g])}return c}function D2(a){pd(a)}function N2(a){console.error(a)}function O2(a){pd(a)}function Vd(a,o){try{var c=a.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function F2(a,o,c){try{var h=a.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function T1(a,o,c){return c=co(c),c.tag=3,c.payload={element:null},c.callback=function(){Vd(a,o)},c}function P2(a){return a=co(a),a.tag=3,a}function M2(a,o,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=h.value;a.payload=function(){return g(x)},a.callback=function(){F2(o,c,h)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){F2(o,c,h),typeof g!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var L=h.stack;this.componentDidCatch(h.value,{componentStack:L!==null?L:""})})}function R3(a,o,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=c.alternate,o!==null&&Xc(o,c,g,!0),c=Ti.current,c!==null){switch(c.tag){case 31:case 13:return Yi===null?$d():c.alternate===null&&Nr===0&&(Nr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===Ad?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([h]):o.add(h),W1(a,h,g)),!1;case 22:return c.flags|=65536,h===Ad?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([h]):c.add(h)),W1(a,h,g)),!1}throw Error(n(435,c.tag))}return W1(a,h,g),$d(),!1}if(Pt)return o=Ti.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,h!==zg&&(a=Error(n(422),{cause:h}),Pf(qi(a,c)))):(h!==zg&&(o=Error(n(423),{cause:h}),Pf(qi(o,c))),a=a.current.alternate,a.flags|=65536,g&=-g,a.lanes|=g,h=qi(h,c),g=T1(a.stateNode,h,g),Jg(a,g),Nr!==4&&(Nr=2)),!1;var x=Error(n(520),{cause:h});if(x=qi(x,c),eh===null?eh=[x]:eh.push(x),Nr!==4&&(Nr=2),o===null)return!0;h=qi(h,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,a=g&-g,c.lanes|=a,a=T1(c.stateNode,h,a),Jg(c,a),!1;case 1:if(o=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(_o===null||!_o.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=P2(g),M2(g,a,c,h),Jg(c,g),!1}c=c.return}while(c!==null);return!1}var w1=Error(n(461)),Yr=!1;function An(a,o,c,h){o.child=a===null?UE(o,null,c,h):Cl(o,a.child,c,h)}function L2(a,o,c,h,g){c=c.render;var x=o.ref;if("ref"in h){var b={};for(var L in h)L!=="ref"&&(b[L]=h[L])}else b=h;return Al(o),h=i1(a,o,c,b,x,g),L=a1(),a!==null&&!Yr?(s1(a,o,g),Es(a,o,g)):(Pt&&L&&Bg(o),o.flags|=1,An(a,o,h,g),o.child)}function V2(a,o,c,h,g){if(a===null){var x=c.type;return typeof x=="function"&&!Mg(x)&&x.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=x,B2(a,o,x,h,g)):(a=vd(c.type,null,h,o,o.mode,g),a.ref=o.ref,a.return=o,o.child=a)}if(x=a.child,!D1(a,g)){var b=x.memoizedProps;if(c=c.compare,c=c!==null?c:Nf,c(b,h)&&a.ref===o.ref)return Es(a,o,g)}return o.flags|=1,a=ps(x,h),a.ref=o.ref,a.return=o,o.child=a}function B2(a,o,c,h,g){if(a!==null){var x=a.memoizedProps;if(Nf(x,h)&&a.ref===o.ref)if(Yr=!1,o.pendingProps=h=x,D1(a,g))(a.flags&131072)!==0&&(Yr=!0);else return o.lanes=a.lanes,Es(a,o,g)}return S1(a,o,c,h,g)}function U2(a,o,c,h){var g=h.children,x=a!==null?a.memoizedState:null;if(a===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,a!==null){for(h=o.child=a.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~x}else h=0,o.child=null;return z2(a,o,x,c,h)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&wd(o,x!==null?x.cachePool:null),x!==null?HE(o,x):e1(),GE(o);else return h=o.lanes=536870912,z2(a,o,x!==null?x.baseLanes|c:c,c,h)}else x!==null?(wd(o,x.cachePool),HE(o,x),ho(),o.memoizedState=null):(a!==null&&wd(o,null),e1(),ho());return An(a,o,g,c),o.child}function Wf(a,o){return a!==null&&a.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function z2(a,o,c,h,g){var x=Xg();return x=x===null?null:{parent:Wr._currentValue,pool:x},o.memoizedState={baseLanes:c,cachePool:x},a!==null&&wd(o,null),e1(),GE(o),a!==null&&Xc(a,o,h,!0),o.childLanes=g,null}function Bd(a,o){return o=zd({mode:o.mode,children:o.children},a.mode),o.ref=a.ref,a.child=o,o.return=a,o}function j2(a,o,c){return Cl(o,a.child,null,c),a=Bd(o,o.pendingProps),a.flags|=2,wi(o),o.memoizedState=null,a}function D3(a,o,c){var h=o.pendingProps,g=(o.flags&128)!==0;if(o.flags&=-129,a===null){if(Pt){if(h.mode==="hidden")return a=Bd(o,h),o.lanes=536870912,Wf(null,a);if(r1(o),(a=gr)?(a=ew(a,Xi),a=a!==null&&a.data==="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:io!==null?{id:ja,overflow:Ha}:null,retryLane:536870912,hydrationErrors:null},c=AE(a),c.return=o,o.child=c,wn=o,gr=null)):a=null,a===null)throw so(o);return o.lanes=536870912,null}return Bd(o,h)}var x=a.memoizedState;if(x!==null){var b=x.dehydrated;if(r1(o),g)if(o.flags&256)o.flags&=-257,o=j2(a,o,c);else if(o.memoizedState!==null)o.child=a.child,o.flags|=128,o=null;else throw Error(n(558));else if(Yr||Xc(a,o,c,!1),g=(c&a.childLanes)!==0,Yr||g){if(h=mr,h!==null&&(b=cl(h,c),b!==0&&b!==x.retryLane))throw x.retryLane=b,El(a,b),hi(h,a,b),w1;$d(),o=j2(a,o,c)}else a=x.treeContext,gr=$i(b.nextSibling),wn=o,Pt=!0,ao=null,Xi=!1,a!==null&&kE(o,a),o=Bd(o,h),o.flags|=4096;return o}return a=ps(a.child,{mode:h.mode,children:h.children}),a.ref=o.ref,o.child=a,a.return=o,a}function Ud(a,o){var c=o.ref;if(c===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(o.flags|=4194816)}}function S1(a,o,c,h,g){return Al(o),c=i1(a,o,c,h,void 0,g),h=a1(),a!==null&&!Yr?(s1(a,o,g),Es(a,o,g)):(Pt&&h&&Bg(o),o.flags|=1,An(a,o,c,g),o.child)}function H2(a,o,c,h,g,x){return Al(o),o.updateQueue=null,c=KE(o,h,c,g),qE(a),h=a1(),a!==null&&!Yr?(s1(a,o,x),Es(a,o,x)):(Pt&&h&&Bg(o),o.flags|=1,An(a,o,c,x),o.child)}function G2(a,o,c,h,g){if(Al(o),o.stateNode===null){var x=Gc,b=c.contextType;typeof b=="object"&&b!==null&&(x=Sn(b)),x=new c(h,x),o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=E1,o.stateNode=x,x._reactInternals=o,x=o.stateNode,x.props=h,x.state=o.memoizedState,x.refs={},$g(o),b=c.contextType,x.context=typeof b=="object"&&b!==null?Sn(b):Gc,x.state=o.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(y1(o,c,b,h),x.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(b=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),b!==x.state&&E1.enqueueReplaceState(x,x.state,null),jf(o,h,x,g),zf(),x.state=o.memoizedState),typeof x.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(a===null){x=o.stateNode;var L=o.memoizedProps,re=Dl(c,L);x.props=re;var me=x.context,Ae=c.contextType;b=Gc,typeof Ae=="object"&&Ae!==null&&(b=Sn(Ae));var Re=c.getDerivedStateFromProps;Ae=typeof Re=="function"||typeof x.getSnapshotBeforeUpdate=="function",L=o.pendingProps!==L,Ae||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(L||me!==b)&&R2(o,x,h,b),lo=!1;var _e=o.memoizedState;x.state=_e,jf(o,h,x,g),zf(),me=o.memoizedState,L||_e!==me||lo?(typeof Re=="function"&&(y1(o,c,Re,h),me=o.memoizedState),(re=lo||C2(o,c,re,h,_e,me,b))?(Ae||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=me),x.props=h,x.state=me,x.context=b,h=re):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{x=o.stateNode,Qg(a,o),b=o.memoizedProps,Ae=Dl(c,b),x.props=Ae,Re=o.pendingProps,_e=x.context,me=c.contextType,re=Gc,typeof me=="object"&&me!==null&&(re=Sn(me)),L=c.getDerivedStateFromProps,(me=typeof L=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(b!==Re||_e!==re)&&R2(o,x,h,re),lo=!1,_e=o.memoizedState,x.state=_e,jf(o,h,x,g),zf();var Ee=o.memoizedState;b!==Re||_e!==Ee||lo||a!==null&&a.dependencies!==null&&Ed(a.dependencies)?(typeof L=="function"&&(y1(o,c,L,h),Ee=o.memoizedState),(Ae=lo||C2(o,c,Ae,h,_e,Ee,re)||a!==null&&a.dependencies!==null&&Ed(a.dependencies))?(me||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,Ee,re),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,Ee,re)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=Ee),x.props=h,x.state=Ee,x.context=re,h=Ae):(typeof x.componentDidUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=1024),h=!1)}return x=h,Ud(a,o),h=(o.flags&128)!==0,x||h?(x=o.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:x.render(),o.flags|=1,a!==null&&h?(o.child=Cl(o,a.child,null,g),o.child=Cl(o,null,c,g)):An(a,o,c,g),o.memoizedState=x.state,a=o.child):a=Es(a,o,g),a}function q2(a,o,c,h){return wl(),o.flags|=256,An(a,o,c,h),o.child}var A1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function b1(a){return{baseLanes:a,cachePool:FE()}}function I1(a,o,c){return a=a!==null?a.childLanes&~c:0,o&&(a|=Ai),a}function K2(a,o,c){var h=o.pendingProps,g=!1,x=(o.flags&128)!==0,b;if((b=x)||(b=a!==null&&a.memoizedState===null?!1:(Ur.current&2)!==0),b&&(g=!0,o.flags&=-129),b=(o.flags&32)!==0,o.flags&=-33,a===null){if(Pt){if(g?fo(o):ho(),(a=gr)?(a=ew(a,Xi),a=a!==null&&a.data!=="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:io!==null?{id:ja,overflow:Ha}:null,retryLane:536870912,hydrationErrors:null},c=AE(a),c.return=o,o.child=c,wn=o,gr=null)):a=null,a===null)throw so(o);return c_(a)?o.lanes=32:o.lanes=536870912,null}var L=h.children;return h=h.fallback,g?(ho(),g=o.mode,L=zd({mode:"hidden",children:L},g),h=Tl(h,g,c,null),L.return=o,h.return=o,L.sibling=h,o.child=L,h=o.child,h.memoizedState=b1(c),h.childLanes=I1(a,b,c),o.memoizedState=A1,Wf(null,h)):(fo(o),k1(o,L))}var re=a.memoizedState;if(re!==null&&(L=re.dehydrated,L!==null)){if(x)o.flags&256?(fo(o),o.flags&=-257,o=C1(a,o,c)):o.memoizedState!==null?(ho(),o.child=a.child,o.flags|=128,o=null):(ho(),L=h.fallback,g=o.mode,h=zd({mode:"visible",children:h.children},g),L=Tl(L,g,c,null),L.flags|=2,h.return=o,L.return=o,h.sibling=L,o.child=h,Cl(o,a.child,null,c),h=o.child,h.memoizedState=b1(c),h.childLanes=I1(a,b,c),o.memoizedState=A1,o=Wf(null,h));else if(fo(o),c_(L)){if(b=L.nextSibling&&L.nextSibling.dataset,b)var me=b.dgst;b=me,h=Error(n(419)),h.stack="",h.digest=b,Pf({value:h,source:null,stack:null}),o=C1(a,o,c)}else if(Yr||Xc(a,o,c,!1),b=(c&a.childLanes)!==0,Yr||b){if(b=mr,b!==null&&(h=cl(b,c),h!==0&&h!==re.retryLane))throw re.retryLane=h,El(a,h),hi(b,a,h),w1;l_(L)||$d(),o=C1(a,o,c)}else l_(L)?(o.flags|=192,o.child=a.child,o=null):(a=re.treeContext,gr=$i(L.nextSibling),wn=o,Pt=!0,ao=null,Xi=!1,a!==null&&kE(o,a),o=k1(o,h.children),o.flags|=4096);return o}return g?(ho(),L=h.fallback,g=o.mode,re=a.child,me=re.sibling,h=ps(re,{mode:"hidden",children:h.children}),h.subtreeFlags=re.subtreeFlags&65011712,me!==null?L=ps(me,L):(L=Tl(L,g,c,null),L.flags|=2),L.return=o,h.return=o,h.sibling=L,o.child=h,Wf(null,h),h=o.child,L=a.child.memoizedState,L===null?L=b1(c):(g=L.cachePool,g!==null?(re=Wr._currentValue,g=g.parent!==re?{parent:re,pool:re}:g):g=FE(),L={baseLanes:L.baseLanes|c,cachePool:g}),h.memoizedState=L,h.childLanes=I1(a,b,c),o.memoizedState=A1,Wf(a.child,h)):(fo(o),c=a.child,a=c.sibling,c=ps(c,{mode:"visible",children:h.children}),c.return=o,c.sibling=null,a!==null&&(b=o.deletions,b===null?(o.deletions=[a],o.flags|=16):b.push(a)),o.child=c,o.memoizedState=null,c)}function k1(a,o){return o=zd({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function zd(a,o){return a=Ei(22,a,null,o),a.lanes=0,a}function C1(a,o,c){return Cl(o,a.child,null,c),a=k1(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function W2(a,o,c){a.lanes|=o;var h=a.alternate;h!==null&&(h.lanes|=o),Gg(a.return,o,c)}function R1(a,o,c,h,g,x){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g,treeForkCount:x}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=c,b.tailMode=g,b.treeForkCount=x)}function X2(a,o,c){var h=o.pendingProps,g=h.revealOrder,x=h.tail;h=h.children;var b=Ur.current,L=(b&2)!==0;if(L?(b=b&1|2,o.flags|=128):b&=1,Q(Ur,b),An(a,o,h,c),h=Pt?Ff:0,!L&&a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&W2(a,c,o);else if(a.tag===19)W2(a,c,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(g){case"forwards":for(c=o.child,g=null;c!==null;)a=c.alternate,a!==null&&Cd(a)===null&&(g=c),c=c.sibling;c=g,c===null?(g=o.child,o.child=null):(g=c.sibling,c.sibling=null),R1(o,!1,g,c,x,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,g=o.child,o.child=null;g!==null;){if(a=g.alternate,a!==null&&Cd(a)===null){o.child=g;break}a=g.sibling,g.sibling=c,c=g,g=a}R1(o,!0,c,null,x,h);break;case"together":R1(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function Es(a,o,c){if(a!==null&&(o.dependencies=a.dependencies),go|=o.lanes,(c&o.childLanes)===0)if(a!==null){if(Xc(a,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(n(153));if(o.child!==null){for(a=o.child,c=ps(a,a.pendingProps),o.child=c,c.return=o;a.sibling!==null;)a=a.sibling,c=c.sibling=ps(a,a.pendingProps),c.return=o;c.sibling=null}return o.child}function D1(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&Ed(a)))}function N3(a,o,c){switch(o.tag){case 3:ke(o,o.stateNode.containerInfo),oo(o,Wr,a.memoizedState.cache),wl();break;case 27:case 5:De(o);break;case 4:ke(o,o.stateNode.containerInfo);break;case 10:oo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,r1(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(fo(o),o.flags|=128,null):(c&o.child.childLanes)!==0?K2(a,o,c):(fo(o),a=Es(a,o,c),a!==null?a.sibling:null);fo(o);break;case 19:var g=(a.flags&128)!==0;if(h=(c&o.childLanes)!==0,h||(Xc(a,o,c,!1),h=(c&o.childLanes)!==0),g){if(h)return X2(a,o,c);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Q(Ur,Ur.current),h)break;return null;case 22:return o.lanes=0,U2(a,o,c,o.pendingProps);case 24:oo(o,Wr,a.memoizedState.cache)}return Es(a,o,c)}function Y2(a,o,c){if(a!==null)if(a.memoizedProps!==o.pendingProps)Yr=!0;else{if(!D1(a,c)&&(o.flags&128)===0)return Yr=!1,N3(a,o,c);Yr=(a.flags&131072)!==0}else Yr=!1,Pt&&(o.flags&1048576)!==0&&IE(o,Ff,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(a=Il(o.elementType),o.type=a,typeof a=="function")Mg(a)?(h=Dl(a,h),o.tag=1,o=G2(null,o,a,h,c)):(o.tag=0,o=S1(null,o,a,h,c));else{if(a!=null){var g=a.$$typeof;if(g===W){o.tag=11,o=L2(null,o,a,h,c);break e}else if(g===A){o.tag=14,o=V2(null,o,a,h,c);break e}}throw o=xe(a)||a,Error(n(306,o,""))}}return o;case 0:return S1(a,o,o.type,o.pendingProps,c);case 1:return h=o.type,g=Dl(h,o.pendingProps),G2(a,o,h,g,c);case 3:e:{if(ke(o,o.stateNode.containerInfo),a===null)throw Error(n(387));h=o.pendingProps;var x=o.memoizedState;g=x.element,Qg(a,o),jf(o,h,null,c);var b=o.memoizedState;if(h=b.cache,oo(o,Wr,h),h!==x.cache&&qg(o,[Wr],c,!0),zf(),h=b.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:b.cache},o.updateQueue.baseState=x,o.memoizedState=x,o.flags&256){o=q2(a,o,h,c);break e}else if(h!==g){g=qi(Error(n(424)),o),Pf(g),o=q2(a,o,h,c);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(gr=$i(a.firstChild),wn=o,Pt=!0,ao=null,Xi=!0,c=UE(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(wl(),h===g){o=Es(a,o,c);break e}An(a,o,h,c)}o=o.child}return o;case 26:return Ud(a,o),a===null?(c=sw(o.type,null,o.pendingProps,null))?o.memoizedState=c:Pt||(c=o.type,a=o.pendingProps,h=nm(oe.current).createElement(c),h[H]=o,h[G]=a,bn(h,c,a),Qe(h),o.stateNode=h):o.memoizedState=sw(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return De(o),a===null&&Pt&&(h=o.stateNode=nw(o.type,o.pendingProps,oe.current),wn=o,Xi=!0,g=gr,Eo(o.type)?(u_=g,gr=$i(h.firstChild)):gr=g),An(a,o,o.pendingProps.children,c),Ud(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&Pt&&((g=h=gr)&&(h=lN(h,o.type,o.pendingProps,Xi),h!==null?(o.stateNode=h,wn=o,gr=$i(h.firstChild),Xi=!1,g=!0):g=!1),g||so(o)),De(o),g=o.type,x=o.pendingProps,b=a!==null?a.memoizedProps:null,h=x.children,a_(g,x)?h=null:b!==null&&a_(g,b)&&(o.flags|=32),o.memoizedState!==null&&(g=i1(a,o,w3,null,null,c),lh._currentValue=g),Ud(a,o),An(a,o,h,c),o.child;case 6:return a===null&&Pt&&((a=c=gr)&&(c=cN(c,o.pendingProps,Xi),c!==null?(o.stateNode=c,wn=o,gr=null,a=!0):a=!1),a||so(o)),null;case 13:return K2(a,o,c);case 4:return ke(o,o.stateNode.containerInfo),h=o.pendingProps,a===null?o.child=Cl(o,null,h,c):An(a,o,h,c),o.child;case 11:return L2(a,o,o.type,o.pendingProps,c);case 7:return An(a,o,o.pendingProps,c),o.child;case 8:return An(a,o,o.pendingProps.children,c),o.child;case 12:return An(a,o,o.pendingProps.children,c),o.child;case 10:return h=o.pendingProps,oo(o,o.type,h.value),An(a,o,h.children,c),o.child;case 9:return g=o.type._context,h=o.pendingProps.children,Al(o),g=Sn(g),h=h(g),o.flags|=1,An(a,o,h,c),o.child;case 14:return V2(a,o,o.type,o.pendingProps,c);case 15:return B2(a,o,o.type,o.pendingProps,c);case 19:return X2(a,o,c);case 31:return D3(a,o,c);case 22:return U2(a,o,c,o.pendingProps);case 24:return Al(o),h=Sn(Wr),a===null?(g=Xg(),g===null&&(g=mr,x=Kg(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),o.memoizedState={parent:h,cache:g},$g(o),oo(o,Wr,g)):((a.lanes&c)!==0&&(Qg(a,o),jf(o,null,null,c),zf()),g=a.memoizedState,x=o.memoizedState,g.parent!==h?(g={parent:h,cache:h},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),oo(o,Wr,h)):(h=x.cache,oo(o,Wr,h),h!==g.cache&&qg(o,[Wr],c,!0))),An(a,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Ts(a){a.flags|=4}function N1(a,o,c,h,g){if((o=(a.mode&32)!==0)&&(o=!1),o){if(a.flags|=16777216,(g&335544128)===g)if(a.stateNode.complete)a.flags|=8192;else if(TT())a.flags|=8192;else throw kl=Ad,Yg}else a.flags&=-16777217}function $2(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!fw(o))if(TT())a.flags|=8192;else throw kl=Ad,Yg}function jd(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?Dc():536870912,a.lanes|=o,su|=o)}function Xf(a,o){if(!Pt)switch(a.tailMode){case"hidden":o=a.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:h.sibling=null}}function _r(a){var o=a.alternate!==null&&a.alternate.child===a.child,c=0,h=0;if(o)for(var g=a.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=h,a.childLanes=c,o}function O3(a,o,c){var h=o.pendingProps;switch(Ug(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _r(o),null;case 1:return _r(o),null;case 3:return c=o.stateNode,h=null,a!==null&&(h=a.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),xs(Wr),be(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(Wc(o)?Ts(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,jg())),_r(o),null;case 26:var g=o.type,x=o.memoizedState;return a===null?(Ts(o),x!==null?(_r(o),$2(o,x)):(_r(o),N1(o,g,null,h,c))):x?x!==a.memoizedState?(Ts(o),_r(o),$2(o,x)):(_r(o),o.flags&=-16777217):(a=a.memoizedProps,a!==h&&Ts(o),_r(o),N1(o,g,a,h,c)),null;case 27:if(lt(o),c=oe.current,g=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==h&&Ts(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return _r(o),null}a=q.current,Wc(o)?CE(o):(a=nw(g,h,c),o.stateNode=a,Ts(o))}return _r(o),null;case 5:if(lt(o),g=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==h&&Ts(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return _r(o),null}if(x=q.current,Wc(o))CE(o);else{var b=nm(oe.current);switch(x){case 1:x=b.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:x=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":x=b.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":x=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":x=b.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof h.is=="string"?b.createElement("select",{is:h.is}):b.createElement("select"),h.multiple?x.multiple=!0:h.size&&(x.size=h.size);break;default:x=typeof h.is=="string"?b.createElement(g,{is:h.is}):b.createElement(g)}}x[H]=o,x[G]=h;e:for(b=o.child;b!==null;){if(b.tag===5||b.tag===6)x.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===o)break e;for(;b.sibling===null;){if(b.return===null||b.return===o)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}o.stateNode=x;e:switch(bn(x,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Ts(o)}}return _r(o),N1(o,o.type,a===null?null:a.memoizedProps,o.pendingProps,c),null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==h&&Ts(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(n(166));if(a=oe.current,Wc(o)){if(a=o.stateNode,c=o.memoizedProps,h=null,g=wn,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}a[H]=o,a=!!(a.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||KT(a.nodeValue,c)),a||so(o,!0)}else a=nm(a).createTextNode(h),a[H]=o,o.stateNode=a}return _r(o),null;case 31:if(c=o.memoizedState,a===null||a.memoizedState!==null){if(h=Wc(o),c!==null){if(a===null){if(!h)throw Error(n(318));if(a=o.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[H]=o}else wl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;_r(o),a=!1}else c=jg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return o.flags&256?(wi(o),o):(wi(o),null);if((o.flags&128)!==0)throw Error(n(558))}return _r(o),null;case 13:if(h=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(g=Wc(o),h!==null&&h.dehydrated!==null){if(a===null){if(!g)throw Error(n(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[H]=o}else wl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;_r(o),g=!1}else g=jg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(wi(o),o):(wi(o),null)}return wi(o),(o.flags&128)!==0?(o.lanes=c,o):(c=h!==null,a=a!==null&&a.memoizedState!==null,c&&(h=o.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),x=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==g&&(h.flags|=2048)),c!==a&&c&&(o.child.flags|=8192),jd(o,o.updateQueue),_r(o),null);case 4:return be(),a===null&&e_(o.stateNode.containerInfo),_r(o),null;case 10:return xs(o.type),_r(o),null;case 19:if(O(Ur),h=o.memoizedState,h===null)return _r(o),null;if(g=(o.flags&128)!==0,x=h.rendering,x===null)if(g)Xf(h,!1);else{if(Nr!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(x=Cd(a),x!==null){for(o.flags|=128,Xf(h,!1),a=x.updateQueue,o.updateQueue=a,jd(o,a),o.subtreeFlags=0,a=c,c=o.child;c!==null;)SE(c,a),c=c.sibling;return Q(Ur,Ur.current&1|2),Pt&&gs(o,h.treeForkCount),o.child}a=a.sibling}h.tail!==null&&qt()>Wd&&(o.flags|=128,g=!0,Xf(h,!1),o.lanes=4194304)}else{if(!g)if(a=Cd(x),a!==null){if(o.flags|=128,g=!0,a=a.updateQueue,o.updateQueue=a,jd(o,a),Xf(h,!0),h.tail===null&&h.tailMode==="hidden"&&!x.alternate&&!Pt)return _r(o),null}else 2*qt()-h.renderingStartTime>Wd&&c!==536870912&&(o.flags|=128,g=!0,Xf(h,!1),o.lanes=4194304);h.isBackwards?(x.sibling=o.child,o.child=x):(a=h.last,a!==null?a.sibling=x:o.child=x,h.last=x)}return h.tail!==null?(a=h.tail,h.rendering=a,h.tail=a.sibling,h.renderingStartTime=qt(),a.sibling=null,c=Ur.current,Q(Ur,g?c&1|2:c&1),Pt&&gs(o,h.treeForkCount),a):(_r(o),null);case 22:case 23:return wi(o),t1(),h=o.memoizedState!==null,a!==null?a.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(c&536870912)!==0&&(o.flags&128)===0&&(_r(o),o.subtreeFlags&6&&(o.flags|=8192)):_r(o),c=o.updateQueue,c!==null&&jd(o,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==c&&(o.flags|=2048),a!==null&&O(bl),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),xs(Wr),_r(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function F3(a,o){switch(Ug(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return xs(Wr),be(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return lt(o),null;case 31:if(o.memoizedState!==null){if(wi(o),o.alternate===null)throw Error(n(340));wl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 13:if(wi(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(n(340));wl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return O(Ur),null;case 4:return be(),null;case 10:return xs(o.type),null;case 22:case 23:return wi(o),t1(),a!==null&&O(bl),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return xs(Wr),null;case 25:return null;default:return null}}function Q2(a,o){switch(Ug(o),o.tag){case 3:xs(Wr),be();break;case 26:case 27:case 5:lt(o);break;case 4:be();break;case 31:o.memoizedState!==null&&wi(o);break;case 13:wi(o);break;case 19:O(Ur);break;case 10:xs(o.type);break;case 22:case 23:wi(o),t1(),a!==null&&O(bl);break;case 24:xs(Wr)}}function Yf(a,o){try{var c=o.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&a)===a){h=void 0;var x=c.create,b=c.inst;h=x(),b.destroy=h}c=c.next}while(c!==g)}}catch(L){tr(o,o.return,L)}}function mo(a,o,c){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var x=g.next;h=x;do{if((h.tag&a)===a){var b=h.inst,L=b.destroy;if(L!==void 0){b.destroy=void 0,g=o;var re=c,me=L;try{me()}catch(Ae){tr(g,re,Ae)}}}h=h.next}while(h!==x)}}catch(Ae){tr(o,o.return,Ae)}}function J2(a){var o=a.updateQueue;if(o!==null){var c=a.stateNode;try{jE(o,c)}catch(h){tr(a,a.return,h)}}}function Z2(a,o,c){c.props=Dl(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(h){tr(a,o,h)}}function $f(a,o){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var h=a.stateNode;break;case 30:h=a.stateNode;break;default:h=a.stateNode}typeof c=="function"?a.refCleanup=c(h):c.current=h}}catch(g){tr(a,o,g)}}function Ga(a,o){var c=a.ref,h=a.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){tr(a,o,g)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){tr(a,o,g)}else c.current=null}function eT(a){var o=a.type,c=a.memoizedProps,h=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){tr(a,a.return,g)}}function O1(a,o,c){try{var h=a.stateNode;rN(h,a.type,c,o),h[G]=o}catch(g){tr(a,a.return,g)}}function tT(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Eo(a.type)||a.tag===4}function F1(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||tT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Eo(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function P1(a,o,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(a),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=ga));else if(h!==4&&(h===27&&Eo(a.type)&&(c=a.stateNode,o=null),a=a.child,a!==null))for(P1(a,o,c),a=a.sibling;a!==null;)P1(a,o,c),a=a.sibling}function Hd(a,o,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,o?c.insertBefore(a,o):c.appendChild(a);else if(h!==4&&(h===27&&Eo(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Hd(a,o,c),a=a.sibling;a!==null;)Hd(a,o,c),a=a.sibling}function rT(a){var o=a.stateNode,c=a.memoizedProps;try{for(var h=a.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);bn(o,h,c),o[H]=a,o[G]=c}catch(x){tr(a,a.return,x)}}var ws=!1,$r=!1,M1=!1,nT=typeof WeakSet=="function"?WeakSet:Set,mn=null;function P3(a,o){if(a=a.containerInfo,n_=um,a=pE(a),Cg(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var b=0,L=-1,re=-1,me=0,Ae=0,Re=a,_e=null;t:for(;;){for(var Ee;Re!==c||g!==0&&Re.nodeType!==3||(L=b+g),Re!==x||h!==0&&Re.nodeType!==3||(re=b+h),Re.nodeType===3&&(b+=Re.nodeValue.length),(Ee=Re.firstChild)!==null;)_e=Re,Re=Ee;for(;;){if(Re===a)break t;if(_e===c&&++me===g&&(L=b),_e===x&&++Ae===h&&(re=b),(Ee=Re.nextSibling)!==null)break;Re=_e,_e=Re.parentNode}Re=Ee}c=L===-1||re===-1?null:{start:L,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(i_={focusedElem:a,selectionRange:c},um=!1,mn=o;mn!==null;)if(o=mn,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,mn=a;else for(;mn!==null;){switch(o=mn,x=o.alternate,a=o.flags,o.tag){case 0:if((a&4)!==0&&(a=o.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)g=a[c],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&x!==null){a=void 0,c=o,g=x.memoizedProps,x=x.memoizedState,h=c.stateNode;try{var $e=Dl(c.type,g);a=h.getSnapshotBeforeUpdate($e,x),h.__reactInternalSnapshotBeforeUpdate=a}catch(ct){tr(c,c.return,ct)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,c=a.nodeType,c===9)o_(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":o_(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=o.sibling,a!==null){a.return=o.return,mn=a;break}mn=o.return}}function iT(a,o,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:As(a,c),h&4&&Yf(5,c);break;case 1:if(As(a,c),h&4)if(a=c.stateNode,o===null)try{a.componentDidMount()}catch(b){tr(c,c.return,b)}else{var g=Dl(c.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(g,o,a.__reactInternalSnapshotBeforeUpdate)}catch(b){tr(c,c.return,b)}}h&64&&J2(c),h&512&&$f(c,c.return);break;case 3:if(As(a,c),h&64&&(a=c.updateQueue,a!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{jE(a,o)}catch(b){tr(c,c.return,b)}}break;case 27:o===null&&h&4&&rT(c);case 26:case 5:As(a,c),o===null&&h&4&&eT(c),h&512&&$f(c,c.return);break;case 12:As(a,c);break;case 31:As(a,c),h&4&&oT(a,c);break;case 13:As(a,c),h&4&&lT(a,c),h&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=G3.bind(null,c),uN(a,c))));break;case 22:if(h=c.memoizedState!==null||ws,!h){o=o!==null&&o.memoizedState!==null||$r,g=ws;var x=$r;ws=h,($r=o)&&!x?bs(a,c,(c.subtreeFlags&8772)!==0):As(a,c),ws=g,$r=x}break;case 30:break;default:As(a,c)}}function aT(a){var o=a.alternate;o!==null&&(a.alternate=null,aT(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&Le(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Sr=null,li=!1;function Ss(a,o,c){for(c=c.child;c!==null;)sT(a,o,c),c=c.sibling}function sT(a,o,c){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(kt,c)}catch{}switch(c.tag){case 26:$r||Ga(c,o),Ss(a,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:$r||Ga(c,o);var h=Sr,g=li;Eo(c.type)&&(Sr=c.stateNode,li=!1),Ss(a,o,c),ah(c.stateNode),Sr=h,li=g;break;case 5:$r||Ga(c,o);case 6:if(h=Sr,g=li,Sr=null,Ss(a,o,c),Sr=h,li=g,Sr!==null)if(li)try{(Sr.nodeType===9?Sr.body:Sr.nodeName==="HTML"?Sr.ownerDocument.body:Sr).removeChild(c.stateNode)}catch(x){tr(c,o,x)}else try{Sr.removeChild(c.stateNode)}catch(x){tr(c,o,x)}break;case 18:Sr!==null&&(li?(a=Sr,JT(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),mu(a)):JT(Sr,c.stateNode));break;case 4:h=Sr,g=li,Sr=c.stateNode.containerInfo,li=!0,Ss(a,o,c),Sr=h,li=g;break;case 0:case 11:case 14:case 15:mo(2,c,o),$r||mo(4,c,o),Ss(a,o,c);break;case 1:$r||(Ga(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"&&Z2(c,o,h)),Ss(a,o,c);break;case 21:Ss(a,o,c);break;case 22:$r=(h=$r)||c.memoizedState!==null,Ss(a,o,c),$r=h;break;default:Ss(a,o,c)}}function oT(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{mu(a)}catch(c){tr(o,o.return,c)}}}function lT(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{mu(a)}catch(c){tr(o,o.return,c)}}function M3(a){switch(a.tag){case 31:case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new nT),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new nT),o;default:throw Error(n(435,a.tag))}}function Gd(a,o){var c=M3(a);o.forEach(function(h){if(!c.has(h)){c.add(h);var g=q3.bind(null,a,h);h.then(g,g)}})}function ci(a,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],x=a,b=o,L=b;e:for(;L!==null;){switch(L.tag){case 27:if(Eo(L.type)){Sr=L.stateNode,li=!1;break e}break;case 5:Sr=L.stateNode,li=!1;break e;case 3:case 4:Sr=L.stateNode.containerInfo,li=!0;break e}L=L.return}if(Sr===null)throw Error(n(160));sT(x,b,g),Sr=null,li=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)cT(o,a),o=o.sibling}var Ta=null;function cT(a,o){var c=a.alternate,h=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ci(o,a),ui(a),h&4&&(mo(3,a,a.return),Yf(3,a),mo(5,a,a.return));break;case 1:ci(o,a),ui(a),h&512&&($r||c===null||Ga(c,c.return)),h&64&&ws&&(a=a.updateQueue,a!==null&&(h=a.callbacks,h!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=Ta;if(ci(o,a),ui(a),h&512&&($r||c===null||Ga(c,c.return)),h&4){var x=c!==null?c.memoizedState:null;if(h=a.memoizedState,c===null)if(h===null)if(a.stateNode===null){e:{h=a.type,c=a.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":x=g.getElementsByTagName("title")[0],(!x||x[pe]||x[H]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(h),g.head.insertBefore(x,g.querySelector("head > title"))),bn(x,h,c),x[H]=a,Qe(x),h=x;break e;case"link":var b=cw("link","href",g).get(h+(c.href||""));if(b){for(var L=0;L<b.length;L++)if(x=b[L],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(L,1);break t}}x=g.createElement(h),bn(x,h,c),g.head.appendChild(x);break;case"meta":if(b=cw("meta","content",g).get(h+(c.content||""))){for(L=0;L<b.length;L++)if(x=b[L],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(L,1);break t}}x=g.createElement(h),bn(x,h,c),g.head.appendChild(x);break;default:throw Error(n(468,h))}x[H]=a,Qe(x),h=x}a.stateNode=h}else uw(g,a.type,a.stateNode);else a.stateNode=lw(g,h,a.memoizedProps);else x!==h?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,h===null?uw(g,a.type,a.stateNode):lw(g,h,a.memoizedProps)):h===null&&a.stateNode!==null&&O1(a,a.memoizedProps,c.memoizedProps)}break;case 27:ci(o,a),ui(a),h&512&&($r||c===null||Ga(c,c.return)),c!==null&&h&4&&O1(a,a.memoizedProps,c.memoizedProps);break;case 5:if(ci(o,a),ui(a),h&512&&($r||c===null||Ga(c,c.return)),a.flags&32){g=a.stateNode;try{oi(g,"")}catch($e){tr(a,a.return,$e)}}h&4&&a.stateNode!=null&&(g=a.memoizedProps,O1(a,g,c!==null?c.memoizedProps:g)),h&1024&&(M1=!0);break;case 6:if(ci(o,a),ui(a),h&4){if(a.stateNode===null)throw Error(n(162));h=a.memoizedProps,c=a.stateNode;try{c.nodeValue=h}catch($e){tr(a,a.return,$e)}}break;case 3:if(sm=null,g=Ta,Ta=im(o.containerInfo),ci(o,a),Ta=g,ui(a),h&4&&c!==null&&c.memoizedState.isDehydrated)try{mu(o.containerInfo)}catch($e){tr(a,a.return,$e)}M1&&(M1=!1,uT(a));break;case 4:h=Ta,Ta=im(a.stateNode.containerInfo),ci(o,a),ui(a),Ta=h;break;case 12:ci(o,a),ui(a);break;case 31:ci(o,a),ui(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Gd(a,h)));break;case 13:ci(o,a),ui(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Kd=qt()),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Gd(a,h)));break;case 22:g=a.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,me=ws,Ae=$r;if(ws=me||g,$r=Ae||re,ci(o,a),$r=Ae,ws=me,ui(a),h&8192)e:for(o=a.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(c===null||re||ws||$r||Nl(a)),c=null,o=a;;){if(o.tag===5||o.tag===26){if(c===null){re=c=o;try{if(x=re.stateNode,g)b=x.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{L=re.stateNode;var Re=re.memoizedProps.style,_e=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;L.style.display=_e==null||typeof _e=="boolean"?"":(""+_e).trim()}}catch($e){tr(re,re.return,$e)}}}else if(o.tag===6){if(c===null){re=o;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch($e){tr(re,re.return,$e)}}}else if(o.tag===18){if(c===null){re=o;try{var Ee=re.stateNode;g?ZT(Ee,!0):ZT(re.stateNode,!1)}catch($e){tr(re,re.return,$e)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=a.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Gd(a,c))));break;case 19:ci(o,a),ui(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Gd(a,h)));break;case 30:break;case 21:break;default:ci(o,a),ui(a)}}function ui(a){var o=a.flags;if(o&2){try{for(var c,h=a.return;h!==null;){if(tT(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,x=F1(a);Hd(a,x,g);break;case 5:var b=c.stateNode;c.flags&32&&(oi(b,""),c.flags&=-33);var L=F1(a);Hd(a,L,b);break;case 3:case 4:var re=c.stateNode.containerInfo,me=F1(a);P1(a,me,re);break;default:throw Error(n(161))}}catch(Ae){tr(a,a.return,Ae)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function uT(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;uT(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function As(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)iT(a,o.alternate,o),o=o.sibling}function Nl(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:mo(4,o,o.return),Nl(o);break;case 1:Ga(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&Z2(o,o.return,c),Nl(o);break;case 27:ah(o.stateNode);case 26:case 5:Ga(o,o.return),Nl(o);break;case 22:o.memoizedState===null&&Nl(o);break;case 30:Nl(o);break;default:Nl(o)}a=a.sibling}}function bs(a,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,g=a,x=o,b=x.flags;switch(x.tag){case 0:case 11:case 15:bs(g,x,c),Yf(4,x);break;case 1:if(bs(g,x,c),h=x,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(me){tr(h,h.return,me)}if(h=x,g=h.updateQueue,g!==null){var L=h.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)zE(re[g],L)}catch(me){tr(h,h.return,me)}}c&&b&64&&J2(x),$f(x,x.return);break;case 27:rT(x);case 26:case 5:bs(g,x,c),c&&h===null&&b&4&&eT(x),$f(x,x.return);break;case 12:bs(g,x,c);break;case 31:bs(g,x,c),c&&b&4&&oT(g,x);break;case 13:bs(g,x,c),c&&b&4&&lT(g,x);break;case 22:x.memoizedState===null&&bs(g,x,c),$f(x,x.return);break;case 30:break;default:bs(g,x,c)}o=o.sibling}}function L1(a,o){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&Mf(c))}function V1(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Mf(a))}function wa(a,o,c,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)fT(a,o,c,h),o=o.sibling}function fT(a,o,c,h){var g=o.flags;switch(o.tag){case 0:case 11:case 15:wa(a,o,c,h),g&2048&&Yf(9,o);break;case 1:wa(a,o,c,h);break;case 3:wa(a,o,c,h),g&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Mf(a)));break;case 12:if(g&2048){wa(a,o,c,h),a=o.stateNode;try{var x=o.memoizedProps,b=x.id,L=x.onPostCommit;typeof L=="function"&&L(b,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(re){tr(o,o.return,re)}}else wa(a,o,c,h);break;case 31:wa(a,o,c,h);break;case 13:wa(a,o,c,h);break;case 23:break;case 22:x=o.stateNode,b=o.alternate,o.memoizedState!==null?x._visibility&2?wa(a,o,c,h):Qf(a,o):x._visibility&2?wa(a,o,c,h):(x._visibility|=2,nu(a,o,c,h,(o.subtreeFlags&10256)!==0||!1)),g&2048&&L1(b,o);break;case 24:wa(a,o,c,h),g&2048&&V1(o.alternate,o);break;default:wa(a,o,c,h)}}function nu(a,o,c,h,g){for(g=g&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var x=a,b=o,L=c,re=h,me=b.flags;switch(b.tag){case 0:case 11:case 15:nu(x,b,L,re,g),Yf(8,b);break;case 23:break;case 22:var Ae=b.stateNode;b.memoizedState!==null?Ae._visibility&2?nu(x,b,L,re,g):Qf(x,b):(Ae._visibility|=2,nu(x,b,L,re,g)),g&&me&2048&&L1(b.alternate,b);break;case 24:nu(x,b,L,re,g),g&&me&2048&&V1(b.alternate,b);break;default:nu(x,b,L,re,g)}o=o.sibling}}function Qf(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=a,h=o,g=h.flags;switch(h.tag){case 22:Qf(c,h),g&2048&&L1(h.alternate,h);break;case 24:Qf(c,h),g&2048&&V1(h.alternate,h);break;default:Qf(c,h)}o=o.sibling}}var Jf=8192;function iu(a,o,c){if(a.subtreeFlags&Jf)for(a=a.child;a!==null;)hT(a,o,c),a=a.sibling}function hT(a,o,c){switch(a.tag){case 26:iu(a,o,c),a.flags&Jf&&a.memoizedState!==null&&TN(c,Ta,a.memoizedState,a.memoizedProps);break;case 5:iu(a,o,c);break;case 3:case 4:var h=Ta;Ta=im(a.stateNode.containerInfo),iu(a,o,c),Ta=h;break;case 22:a.memoizedState===null&&(h=a.alternate,h!==null&&h.memoizedState!==null?(h=Jf,Jf=16777216,iu(a,o,c),Jf=h):iu(a,o,c));break;default:iu(a,o,c)}}function dT(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function Zf(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];mn=h,pT(h,a)}dT(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)mT(a),a=a.sibling}function mT(a){switch(a.tag){case 0:case 11:case 15:Zf(a),a.flags&2048&&mo(9,a,a.return);break;case 3:Zf(a);break;case 12:Zf(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,qd(a)):Zf(a);break;default:Zf(a)}}function qd(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];mn=h,pT(h,a)}dT(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:mo(8,o,o.return),qd(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,qd(o));break;default:qd(o)}a=a.sibling}}function pT(a,o){for(;mn!==null;){var c=mn;switch(c.tag){case 0:case 11:case 15:mo(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Mf(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,mn=h;else e:for(c=a;mn!==null;){h=mn;var g=h.sibling,x=h.return;if(aT(h),h===c){mn=null;break e}if(g!==null){g.return=x,mn=g;break e}mn=x}}}var L3={getCacheForType:function(a){var o=Sn(Wr),c=o.data.get(a);return c===void 0&&(c=a(),o.data.set(a,c)),c},cacheSignal:function(){return Sn(Wr).controller.signal}},V3=typeof WeakMap=="function"?WeakMap:Map,Xt=0,mr=null,Ct=null,Dt=0,er=0,Si=null,po=!1,au=!1,B1=!1,Is=0,Nr=0,go=0,Ol=0,U1=0,Ai=0,su=0,eh=null,fi=null,z1=!1,Kd=0,gT=0,Wd=1/0,Xd=null,_o=null,ln=0,xo=null,ou=null,ks=0,j1=0,H1=null,_T=null,th=0,G1=null;function bi(){return(Xt&2)!==0&&Dt!==0?Dt&-Dt:ne.T!==null?$1():F()}function xT(){if(Ai===0)if((Dt&536870912)===0||Pt){var a=qr;qr<<=1,(qr&3932160)===0&&(qr=262144),Ai=a}else Ai=536870912;return a=Ti.current,a!==null&&(a.flags|=32),Ai}function hi(a,o,c){(a===mr&&(er===2||er===9)||a.cancelPendingCommit!==null)&&(lu(a,0),vo(a,Dt,Ai,!1)),ls(a,c),((Xt&2)===0||a!==mr)&&(a===mr&&((Xt&2)===0&&(Ol|=c),Nr===4&&vo(a,Dt,Ai,!1)),qa(a))}function vT(a,o,c){if((Xt&6)!==0)throw Error(n(327));var h=!c&&(o&127)===0&&(o&a.expiredLanes)===0||_i(a,o),g=h?z3(a,o):K1(a,o,!0),x=h;do{if(g===0){au&&!h&&vo(a,o,0,!1);break}else{if(c=a.current.alternate,x&&!B3(c)){g=K1(a,o,!1),x=!1;continue}if(g===2){if(x=o,a.errorRecoveryDisabledLanes&x)var b=0;else b=a.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){o=b;e:{var L=a;g=eh;var re=L.current.memoizedState.isDehydrated;if(re&&(lu(L,b).flags|=256),b=K1(L,b,!1),b!==2){if(B1&&!re){L.errorRecoveryDisabledLanes|=x,Ol|=x,g=4;break e}x=fi,fi=g,x!==null&&(fi===null?fi=x:fi.push.apply(fi,x))}g=b}if(x=!1,g!==2)continue}}if(g===1){lu(a,0),vo(a,o,0,!0);break}e:{switch(h=a,x=g,x){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:vo(h,o,Ai,!po);break e;case 2:fi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(g=Kd+300-qt(),10<g)){if(vo(h,o,Ai,!po),Bi(h,0,!0)!==0)break e;ks=o,h.timeoutHandle=$T(yT.bind(null,h,c,fi,Xd,z1,o,Ai,Ol,su,po,x,"Throttled",-0,0),g);break e}yT(h,c,fi,Xd,z1,o,Ai,Ol,su,po,x,null,-0,0)}}break}while(!0);qa(a)}function yT(a,o,c,h,g,x,b,L,re,me,Ae,Re,_e,Ee){if(a.timeoutHandle=-1,Re=o.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ga},hT(o,x,Re);var $e=(x&62914560)===x?Kd-qt():(x&4194048)===x?gT-qt():0;if($e=wN(Re,$e),$e!==null){ks=x,a.cancelPendingCommit=$e(kT.bind(null,a,o,x,c,h,g,b,L,re,Ae,Re,null,_e,Ee)),vo(a,x,b,!me);return}}kT(a,o,x,c,h,g,b,L,re)}function B3(a){for(var o=a;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],x=g.getSnapshot;g=g.value;try{if(!yi(x(),g))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function vo(a,o,c,h){o&=~U1,o&=~Ol,a.suspendedLanes|=o,a.pingedLanes&=~o,h&&(a.warmLanes|=o),h=a.expirationTimes;for(var g=o;0<g;){var x=31-$t(g),b=1<<x;h[x]=-1,g&=~b}c!==0&&cs(a,c,o)}function Yd(){return(Xt&6)===0?(rh(0),!1):!0}function q1(){if(Ct!==null){if(er===0)var a=Ct.return;else a=Ct,_s=Sl=null,o1(a),Jc=null,Vf=0,a=Ct;for(;a!==null;)Q2(a.alternate,a),a=a.return;Ct=null}}function lu(a,o){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,aN(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),ks=0,q1(),mr=a,Ct=c=ps(a.current,null),Dt=o,er=0,Si=null,po=!1,au=_i(a,o),B1=!1,su=Ai=U1=Ol=go=Nr=0,fi=eh=null,z1=!1,(o&8)!==0&&(o|=o&32);var h=a.entangledLanes;if(h!==0)for(a=a.entanglements,h&=o;0<h;){var g=31-$t(h),x=1<<g;o|=a[g],h&=~x}return Is=o,gd(),c}function ET(a,o){xt=null,ne.H=Kf,o===Qc||o===Sd?(o=LE(),er=3):o===Yg?(o=LE(),er=4):er=o===w1?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Si=o,Ct===null&&(Nr=1,Vd(a,qi(o,a.current)))}function TT(){var a=Ti.current;return a===null?!0:(Dt&4194048)===Dt?Yi===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?a===Yi:!1}function wT(){var a=ne.H;return ne.H=Kf,a===null?Kf:a}function ST(){var a=ne.A;return ne.A=L3,a}function $d(){Nr=4,po||(Dt&4194048)!==Dt&&Ti.current!==null||(au=!0),(go&134217727)===0&&(Ol&134217727)===0||mr===null||vo(mr,Dt,Ai,!1)}function K1(a,o,c){var h=Xt;Xt|=2;var g=wT(),x=ST();(mr!==a||Dt!==o)&&(Xd=null,lu(a,o)),o=!1;var b=Nr;e:do try{if(er!==0&&Ct!==null){var L=Ct,re=Si;switch(er){case 8:q1(),b=6;break e;case 3:case 2:case 9:case 6:Ti.current===null&&(o=!0);var me=er;if(er=0,Si=null,cu(a,L,re,me),c&&au){b=0;break e}break;default:me=er,er=0,Si=null,cu(a,L,re,me)}}U3(),b=Nr;break}catch(Ae){ET(a,Ae)}while(!0);return o&&a.shellSuspendCounter++,_s=Sl=null,Xt=h,ne.H=g,ne.A=x,Ct===null&&(mr=null,Dt=0,gd()),b}function U3(){for(;Ct!==null;)AT(Ct)}function z3(a,o){var c=Xt;Xt|=2;var h=wT(),g=ST();mr!==a||Dt!==o?(Xd=null,Wd=qt()+500,lu(a,o)):au=_i(a,o);e:do try{if(er!==0&&Ct!==null){o=Ct;var x=Si;t:switch(er){case 1:er=0,Si=null,cu(a,o,x,1);break;case 2:case 9:if(PE(x)){er=0,Si=null,bT(o);break}o=function(){er!==2&&er!==9||mr!==a||(er=7),qa(a)},x.then(o,o);break e;case 3:er=7;break e;case 4:er=5;break e;case 7:PE(x)?(er=0,Si=null,bT(o)):(er=0,Si=null,cu(a,o,x,7));break;case 5:var b=null;switch(Ct.tag){case 26:b=Ct.memoizedState;case 5:case 27:var L=Ct;if(b?fw(b):L.stateNode.complete){er=0,Si=null;var re=L.sibling;if(re!==null)Ct=re;else{var me=L.return;me!==null?(Ct=me,Qd(me)):Ct=null}break t}}er=0,Si=null,cu(a,o,x,5);break;case 6:er=0,Si=null,cu(a,o,x,6);break;case 8:q1(),Nr=6;break e;default:throw Error(n(462))}}j3();break}catch(Ae){ET(a,Ae)}while(!0);return _s=Sl=null,ne.H=h,ne.A=g,Xt=c,Ct!==null?0:(mr=null,Dt=0,gd(),Nr)}function j3(){for(;Ct!==null&&!fa();)AT(Ct)}function AT(a){var o=Y2(a.alternate,a,Is);a.memoizedProps=a.pendingProps,o===null?Qd(a):Ct=o}function bT(a){var o=a,c=o.alternate;switch(o.tag){case 15:case 0:o=H2(c,o,o.pendingProps,o.type,void 0,Dt);break;case 11:o=H2(c,o,o.pendingProps,o.type.render,o.ref,Dt);break;case 5:o1(o);default:Q2(c,o),o=Ct=SE(o,Is),o=Y2(c,o,Is)}a.memoizedProps=a.pendingProps,o===null?Qd(a):Ct=o}function cu(a,o,c,h){_s=Sl=null,o1(o),Jc=null,Vf=0;var g=o.return;try{if(R3(a,g,o,c,Dt)){Nr=1,Vd(a,qi(c,a.current)),Ct=null;return}}catch(x){if(g!==null)throw Ct=g,x;Nr=1,Vd(a,qi(c,a.current)),Ct=null;return}o.flags&32768?(Pt||h===1?a=!0:au||(Dt&536870912)!==0?a=!1:(po=a=!0,(h===2||h===9||h===3||h===6)&&(h=Ti.current,h!==null&&h.tag===13&&(h.flags|=16384))),IT(o,a)):Qd(o)}function Qd(a){var o=a;do{if((o.flags&32768)!==0){IT(o,po);return}a=o.return;var c=O3(o.alternate,o,Is);if(c!==null){Ct=c;return}if(o=o.sibling,o!==null){Ct=o;return}Ct=o=a}while(o!==null);Nr===0&&(Nr=5)}function IT(a,o){do{var c=F3(a.alternate,a);if(c!==null){c.flags&=32767,Ct=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(a=a.sibling,a!==null)){Ct=a;return}Ct=a=c}while(a!==null);Nr=6,Ct=null}function kT(a,o,c,h,g,x,b,L,re){a.cancelPendingCommit=null;do Jd();while(ln!==0);if((Xt&6)!==0)throw Error(n(327));if(o!==null){if(o===a.current)throw Error(n(177));if(x=o.lanes|o.childLanes,x|=Fg,vf(a,c,x,b,L,re),a===mr&&(Ct=mr=null,Dt=0),ou=o,xo=a,ks=c,j1=x,H1=g,_T=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,K3(et,function(){return OT(),null})):(a.callbackNode=null,a.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=ne.T,ne.T=null,g=le.p,le.p=2,b=Xt,Xt|=4;try{P3(a,o,c)}finally{Xt=b,le.p=g,ne.T=h}}ln=1,CT(),RT(),DT()}}function CT(){if(ln===1){ln=0;var a=xo,o=ou,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var h=le.p;le.p=2;var g=Xt;Xt|=4;try{cT(o,a);var x=i_,b=pE(a.containerInfo),L=x.focusedElem,re=x.selectionRange;if(b!==L&&L&&L.ownerDocument&&mE(L.ownerDocument.documentElement,L)){if(re!==null&&Cg(L)){var me=re.start,Ae=re.end;if(Ae===void 0&&(Ae=me),"selectionStart"in L)L.selectionStart=me,L.selectionEnd=Math.min(Ae,L.value.length);else{var Re=L.ownerDocument||document,_e=Re&&Re.defaultView||window;if(_e.getSelection){var Ee=_e.getSelection(),$e=L.textContent.length,ct=Math.min(re.start,$e),ur=re.end===void 0?ct:Math.min(re.end,$e);!Ee.extend&&ct>ur&&(b=ur,ur=ct,ct=b);var se=dE(L,ct),ie=dE(L,ur);if(se&&ie&&(Ee.rangeCount!==1||Ee.anchorNode!==se.node||Ee.anchorOffset!==se.offset||Ee.focusNode!==ie.node||Ee.focusOffset!==ie.offset)){var fe=Re.createRange();fe.setStart(se.node,se.offset),Ee.removeAllRanges(),ct>ur?(Ee.addRange(fe),Ee.extend(ie.node,ie.offset)):(fe.setEnd(ie.node,ie.offset),Ee.addRange(fe))}}}}for(Re=[],Ee=L;Ee=Ee.parentNode;)Ee.nodeType===1&&Re.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<Re.length;L++){var Ie=Re[L];Ie.element.scrollLeft=Ie.left,Ie.element.scrollTop=Ie.top}}um=!!n_,i_=n_=null}finally{Xt=g,le.p=h,ne.T=c}}a.current=o,ln=2}}function RT(){if(ln===2){ln=0;var a=xo,o=ou,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var h=le.p;le.p=2;var g=Xt;Xt|=4;try{iT(a,o.alternate,o)}finally{Xt=g,le.p=h,ne.T=c}}ln=3}}function DT(){if(ln===4||ln===3){ln=0,Yn();var a=xo,o=ou,c=ks,h=_T;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?ln=5:(ln=0,ou=xo=null,NT(a,a.pendingLanes));var g=a.pendingLanes;if(g===0&&(_o=null),da(c),o=o.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(kt,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=ne.T,g=le.p,le.p=2,ne.T=null;try{for(var x=a.onRecoverableError,b=0;b<h.length;b++){var L=h[b];x(L.value,{componentStack:L.stack})}}finally{ne.T=o,le.p=g}}(ks&3)!==0&&Jd(),qa(a),g=a.pendingLanes,(c&261930)!==0&&(g&42)!==0?a===G1?th++:(th=0,G1=a):th=0,rh(0)}}function NT(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Mf(o)))}function Jd(){return CT(),RT(),DT(),OT()}function OT(){if(ln!==5)return!1;var a=xo,o=j1;j1=0;var c=da(ks),h=ne.T,g=le.p;try{le.p=32>c?32:c,ne.T=null,c=H1,H1=null;var x=xo,b=ks;if(ln=0,ou=xo=null,ks=0,(Xt&6)!==0)throw Error(n(331));var L=Xt;if(Xt|=4,mT(x.current),fT(x,x.current,b,c),Xt=L,rh(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(kt,x)}catch{}return!0}finally{le.p=g,ne.T=h,NT(a,o)}}function FT(a,o,c){o=qi(c,o),o=T1(a.stateNode,o,2),a=uo(a,o,2),a!==null&&(ls(a,2),qa(a))}function tr(a,o,c){if(a.tag===3)FT(a,a,c);else for(;o!==null;){if(o.tag===3){FT(o,a,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(_o===null||!_o.has(h))){a=qi(c,a),c=P2(2),h=uo(o,c,2),h!==null&&(M2(c,h,o,a),ls(h,2),qa(h));break}}o=o.return}}function W1(a,o,c){var h=a.pingCache;if(h===null){h=a.pingCache=new V3;var g=new Set;h.set(o,g)}else g=h.get(o),g===void 0&&(g=new Set,h.set(o,g));g.has(c)||(B1=!0,g.add(c),a=H3.bind(null,a,o,c),o.then(a,a))}function H3(a,o,c){var h=a.pingCache;h!==null&&h.delete(o),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,mr===a&&(Dt&c)===c&&(Nr===4||Nr===3&&(Dt&62914560)===Dt&&300>qt()-Kd?(Xt&2)===0&&lu(a,0):U1|=c,su===Dt&&(su=0)),qa(a)}function PT(a,o){o===0&&(o=Dc()),a=El(a,o),a!==null&&(ls(a,o),qa(a))}function G3(a){var o=a.memoizedState,c=0;o!==null&&(c=o.retryLane),PT(a,c)}function q3(a,o){var c=0;switch(a.tag){case 31:case 13:var h=a.stateNode,g=a.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=a.stateNode;break;case 22:h=a.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(o),PT(a,c)}function K3(a,o){return Lt(a,o)}var Zd=null,uu=null,X1=!1,em=!1,Y1=!1,yo=0;function qa(a){a!==uu&&a.next===null&&(uu===null?Zd=uu=a:uu=uu.next=a),em=!0,X1||(X1=!0,X3())}function rh(a,o){if(!Y1&&em){Y1=!0;do for(var c=!1,h=Zd;h!==null;){if(a!==0){var g=h.pendingLanes;if(g===0)var x=0;else{var b=h.suspendedLanes,L=h.pingedLanes;x=(1<<31-$t(42|a)+1)-1,x&=g&~(b&~L),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,BT(h,x))}else x=Dt,x=Bi(h,h===mr?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(x&3)===0||_i(h,x)||(c=!0,BT(h,x));h=h.next}while(c);Y1=!1}}function W3(){MT()}function MT(){em=X1=!1;var a=0;yo!==0&&iN()&&(a=yo);for(var o=qt(),c=null,h=Zd;h!==null;){var g=h.next,x=LT(h,o);x===0?(h.next=null,c===null?Zd=g:c.next=g,g===null&&(uu=c)):(c=h,(a!==0||(x&3)!==0)&&(em=!0)),h=g}ln!==0&&ln!==5||rh(a),yo!==0&&(yo=0)}function LT(a,o){for(var c=a.suspendedLanes,h=a.pingedLanes,g=a.expirationTimes,x=a.pendingLanes&-62914561;0<x;){var b=31-$t(x),L=1<<b,re=g[b];re===-1?((L&c)===0||(L&h)!==0)&&(g[b]=xf(L,o)):re<=o&&(a.expiredLanes|=L),x&=~L}if(o=mr,c=Dt,c=Bi(a,a===o?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h=a.callbackNode,c===0||a===o&&(er===2||er===9)||a.cancelPendingCommit!==null)return h!==null&&h!==null&&Gr(h),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||_i(a,c)){if(o=c&-c,o===a.callbackPriority)return o;switch(h!==null&&Gr(h),da(c)){case 2:case 8:c=gi;break;case 32:c=et;break;case 268435456:c=rt;break;default:c=et}return h=VT.bind(null,a),c=Lt(c,h),a.callbackPriority=o,a.callbackNode=c,o}return h!==null&&h!==null&&Gr(h),a.callbackPriority=2,a.callbackNode=null,2}function VT(a,o){if(ln!==0&&ln!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(Jd()&&a.callbackNode!==c)return null;var h=Dt;return h=Bi(a,a===mr?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h===0?null:(vT(a,h,o),LT(a,qt()),a.callbackNode!=null&&a.callbackNode===c?VT.bind(null,a):null)}function BT(a,o){if(Jd())return null;vT(a,o,!0)}function X3(){sN(function(){(Xt&6)!==0?Lt(Nn,W3):MT()})}function $1(){if(yo===0){var a=Yc;a===0&&(a=Er,Er<<=1,(Er&261888)===0&&(Er=256)),yo=a}return yo}function UT(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Fc(""+a)}function zT(a,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,a.id&&c.setAttribute("form",a.id),o.parentNode.insertBefore(c,o),a=new FormData(a),c.parentNode.removeChild(c),a}function Y3(a,o,c,h,g){if(o==="submit"&&c&&c.stateNode===g){var x=UT((g[G]||null).action),b=h.submitter;b&&(o=(o=b[G]||null)?UT(o.formAction):b.getAttribute("formAction"),o!==null&&(x=o,b=null));var L=new Va("action","action",null,h,g);a.push({event:L,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(yo!==0){var re=b?zT(g,b):new FormData(g);g1(c,{pending:!0,data:re,method:g.method,action:x},null,re)}}else typeof x=="function"&&(L.preventDefault(),re=b?zT(g,b):new FormData(g),g1(c,{pending:!0,data:re,method:g.method,action:x},x,re))},currentTarget:g}]})}}for(var Q1=0;Q1<Og.length;Q1++){var J1=Og[Q1],$3=J1.toLowerCase(),Q3=J1[0].toUpperCase()+J1.slice(1);Ea($3,"on"+Q3)}Ea(xE,"onAnimationEnd"),Ea(vE,"onAnimationIteration"),Ea(yE,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(d3,"onTransitionRun"),Ea(m3,"onTransitionStart"),Ea(p3,"onTransitionCancel"),Ea(EE,"onTransitionEnd"),On("onMouseEnter",["mouseout","mouseover"]),On("onMouseLeave",["mouseout","mouseover"]),On("onPointerEnter",["pointerout","pointerover"]),On("onPointerLeave",["pointerout","pointerover"]),dr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),dr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),dr("onBeforeInput",["compositionend","keypress","textInput","paste"]),dr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),dr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),dr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),J3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nh));function jT(a,o){o=(o&4)!==0;for(var c=0;c<a.length;c++){var h=a[c],g=h.event;h=h.listeners;e:{var x=void 0;if(o)for(var b=h.length-1;0<=b;b--){var L=h[b],re=L.instance,me=L.currentTarget;if(L=L.listener,re!==x&&g.isPropagationStopped())break e;x=L,g.currentTarget=me;try{x(g)}catch(Ae){pd(Ae)}g.currentTarget=null,x=re}else for(b=0;b<h.length;b++){if(L=h[b],re=L.instance,me=L.currentTarget,L=L.listener,re!==x&&g.isPropagationStopped())break e;x=L,g.currentTarget=me;try{x(g)}catch(Ae){pd(Ae)}g.currentTarget=null,x=re}}}}function Rt(a,o){var c=o[he];c===void 0&&(c=o[he]=new Set);var h=a+"__bubble";c.has(h)||(HT(o,a,2,!1),c.add(h))}function Z1(a,o,c){var h=0;o&&(h|=4),HT(c,a,h,o)}var tm="_reactListening"+Math.random().toString(36).slice(2);function e_(a){if(!a[tm]){a[tm]=!0,Qt.forEach(function(c){c!=="selectionchange"&&(J3.has(c)||Z1(c,!1,a),Z1(c,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[tm]||(o[tm]=!0,Z1("selectionchange",!1,o))}}function HT(a,o,c,h){switch(xw(o)){case 2:var g=bN;break;case 8:g=IN;break;default:g=p_}c=g.bind(null,o,c,a),g=void 0,!dl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),h?g!==void 0?a.addEventListener(o,c,{capture:!0,passive:g}):a.addEventListener(o,c,!0):g!==void 0?a.addEventListener(o,c,{passive:g}):a.addEventListener(o,c,!1)}function t_(a,o,c,h,g){var x=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var L=h.stateNode.containerInfo;if(L===g)break;if(b===4)for(b=h.return;b!==null;){var re=b.tag;if((re===3||re===4)&&b.stateNode.containerInfo===g)return;b=b.return}for(;L!==null;){if(b=Be(L),b===null)return;if(re=b.tag,re===5||re===6||re===26||re===27){h=x=b;continue e}L=L.parentNode}}h=h.return}eo(function(){var me=x,Ae=zi(c),Re=[];e:{var _e=TE.get(a);if(_e!==void 0){var Ee=Va,$e=a;switch(a){case"keypress":if(pl(c)===0)break e;case"keydown":case"keyup":Ee=hd;break;case"focusin":$e="focus",Ee=_l;break;case"focusout":$e="blur",Ee=_l;break;case"beforeblur":case"afterblur":Ee=_l;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=kf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=nd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=w;break;case xE:case vE:case yE:Ee=ad;break;case EE:Ee=j;break;case"scroll":case"scrollend":Ee=If;break;case"wheel":Ee=ye;break;case"copy":case"cut":case"paste":Ee=sd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=ms;break;case"toggle":case"beforetoggle":Ee=_t}var ct=(o&4)!==0,ur=!ct&&(a==="scroll"||a==="scrollend"),se=ct?_e!==null?_e+"Capture":null:_e;ct=[];for(var ie=me,fe;ie!==null;){var Ie=ie;if(fe=Ie.stateNode,Ie=Ie.tag,Ie!==5&&Ie!==26&&Ie!==27||fe===null||se===null||(Ie=_a(ie,se),Ie!=null&&ct.push(ih(ie,Ie,fe))),ur)break;ie=ie.return}0<ct.length&&(_e=new Ee(_e,$e,null,c,Ae),Re.push({event:_e,listeners:ct}))}}if((o&7)===0){e:{if(_e=a==="mouseover"||a==="pointerover",Ee=a==="mouseout"||a==="pointerout",_e&&c!==Sf&&($e=c.relatedTarget||c.fromElement)&&(Be($e)||$e[Y]))break e;if((Ee||_e)&&(_e=Ae.window===Ae?Ae:(_e=Ae.ownerDocument)?_e.defaultView||_e.parentWindow:window,Ee?($e=c.relatedTarget||c.toElement,Ee=me,$e=$e?Be($e):null,$e!==null&&(ur=s($e),ct=$e.tag,$e!==ur||ct!==5&&ct!==27&&ct!==6)&&($e=null)):(Ee=null,$e=me),Ee!==$e)){if(ct=kf,Ie="onMouseLeave",se="onMouseEnter",ie="mouse",(a==="pointerout"||a==="pointerover")&&(ct=ms,Ie="onPointerLeave",se="onPointerEnter",ie="pointer"),ur=Ee==null?_e:Fe(Ee),fe=$e==null?_e:Fe($e),_e=new ct(Ie,ie+"leave",Ee,c,Ae),_e.target=ur,_e.relatedTarget=fe,Ie=null,Be(Ae)===me&&(ct=new ct(se,ie+"enter",$e,c,Ae),ct.target=fe,ct.relatedTarget=ur,Ie=ct),ur=Ie,Ee&&$e)t:{for(ct=Z3,se=Ee,ie=$e,fe=0,Ie=se;Ie;Ie=ct(Ie))fe++;Ie=0;for(var at=ie;at;at=ct(at))Ie++;for(;0<fe-Ie;)se=ct(se),fe--;for(;0<Ie-fe;)ie=ct(ie),Ie--;for(;fe--;){if(se===ie||ie!==null&&se===ie.alternate){ct=se;break t}se=ct(se),ie=ct(ie)}ct=null}else ct=null;Ee!==null&&GT(Re,_e,Ee,ct,!1),$e!==null&&ur!==null&&GT(Re,ur,$e,ct,!0)}}e:{if(_e=me?Fe(me):window,Ee=_e.nodeName&&_e.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&_e.type==="file")var jt=oE;else if(aE(_e))if(lE)jt=u3;else{jt=l3;var Ze=o3}else Ee=_e.nodeName,!Ee||Ee.toLowerCase()!=="input"||_e.type!=="checkbox"&&_e.type!=="radio"?me&&Oc(me.elementType)&&(jt=oE):jt=c3;if(jt&&(jt=jt(a,me))){sE(Re,jt,c,Ae);break e}Ze&&Ze(a,_e,me),a==="focusout"&&me&&_e.type==="number"&&me.memoizedProps.value!=null&&Ef(_e,"number",_e.value)}switch(Ze=me?Fe(me):window,a){case"focusin":(aE(Ze)||Ze.contentEditable==="true")&&(zc=Ze,Rg=me,Of=null);break;case"focusout":Of=Rg=zc=null;break;case"mousedown":Dg=!0;break;case"contextmenu":case"mouseup":case"dragend":Dg=!1,gE(Re,c,Ae);break;case"selectionchange":if(h3)break;case"keydown":case"keyup":gE(Re,c,Ae)}var Et;if(Wt)e:{switch(a){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else Uc?xl(a,c)&&(Nt="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(Nt="onCompositionStart");Nt&&(za&&c.locale!=="ko"&&(Uc||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&Uc&&(Et=bf()):(La=Ae,Af="value"in La?La.value:La.textContent,Uc=!0)),Ze=rm(me,Nt),0<Ze.length&&(Nt=new Ua(Nt,a,null,c,Ae),Re.push({event:Nt,listeners:Ze}),Et?Nt.data=Et:(Et=Bc(c),Et!==null&&(Nt.data=Et)))),(Et=Hi?n3(a,c):i3(a,c))&&(Nt=rm(me,"onBeforeInput"),0<Nt.length&&(Ze=new Ua("onBeforeInput","beforeinput",null,c,Ae),Re.push({event:Ze,listeners:Nt}),Ze.data=Et)),Y3(Re,a,me,c,Ae)}jT(Re,o)})}function ih(a,o,c){return{instance:a,listener:o,currentTarget:c}}function rm(a,o){for(var c=o+"Capture",h=[];a!==null;){var g=a,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=_a(a,c),g!=null&&h.unshift(ih(a,g,x)),g=_a(a,o),g!=null&&h.push(ih(a,g,x))),a.tag===3)return h;a=a.return}return[]}function Z3(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function GT(a,o,c,h,g){for(var x=o._reactName,b=[];c!==null&&c!==h;){var L=c,re=L.alternate,me=L.stateNode;if(L=L.tag,re!==null&&re===h)break;L!==5&&L!==26&&L!==27||me===null||(re=me,g?(me=_a(c,x),me!=null&&b.unshift(ih(c,me,re))):g||(me=_a(c,x),me!=null&&b.push(ih(c,me,re)))),c=c.return}b.length!==0&&a.push({event:o,listeners:b})}var eN=/\r\n?/g,tN=/\u0000|\uFFFD/g;function qT(a){return(typeof a=="string"?a:""+a).replace(eN,`
`).replace(tN,"")}function KT(a,o){return o=qT(o),qT(a)===o}function cr(a,o,c,h,g,x){switch(c){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||oi(a,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&oi(a,""+h);break;case"className":vi(a,"class",h);break;case"tabIndex":vi(a,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":vi(a,c,h);break;case"style":wf(a,h,x);break;case"data":if(o!=="object"){vi(a,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||c!=="href")){a.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=Fc(""+h),a.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(o!=="input"&&cr(a,o,"name",g.name,g,null),cr(a,o,"formEncType",g.formEncType,g,null),cr(a,o,"formMethod",g.formMethod,g,null),cr(a,o,"formTarget",g.formTarget,g,null)):(cr(a,o,"encType",g.encType,g,null),cr(a,o,"method",g.method,g,null),cr(a,o,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=Fc(""+h),a.setAttribute(c,h);break;case"onClick":h!=null&&(a.onclick=ga);break;case"onScroll":h!=null&&Rt("scroll",a);break;case"onScrollEnd":h!=null&&Rt("scrollend",a);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":a.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){a.removeAttribute("xlink:href");break}c=Fc(""+h),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""+h):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":h===!0?a.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,h):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?a.setAttribute(c,h):a.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?a.removeAttribute(c):a.setAttribute(c,h);break;case"popover":Rt("beforetoggle",a),Rt("toggle",a),Fn(a,"popover",h);break;case"xlinkActuate":Kr(a,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Kr(a,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Kr(a,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Kr(a,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Kr(a,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Kr(a,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Kr(a,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Kr(a,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Kr(a,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Fn(a,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=rd.get(c)||c,Fn(a,c,h))}}function r_(a,o,c,h,g,x){switch(c){case"style":wf(a,h,x);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof h=="string"?oi(a,h):(typeof h=="number"||typeof h=="bigint")&&oi(a,""+h);break;case"onScroll":h!=null&&Rt("scroll",a);break;case"onScrollEnd":h!=null&&Rt("scrollend",a);break;case"onClick":h!=null&&(a.onclick=ga);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Jt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),o=c.slice(2,g?c.length-7:void 0),x=a[G]||null,x=x!=null?x[c]:null,typeof x=="function"&&a.removeEventListener(o,x,g),typeof h=="function")){typeof x!="function"&&x!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(o,h,g);break e}c in a?a[c]=h:h===!0?a.setAttribute(c,""):Fn(a,c,h)}}}function bn(a,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Rt("error",a),Rt("load",a);var h=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var b=c[x];if(b!=null)switch(x){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:cr(a,o,x,b,c,null)}}g&&cr(a,o,"srcSet",c.srcSet,c,null),h&&cr(a,o,"src",c.src,c,null);return;case"input":Rt("invalid",a);var L=x=b=g=null,re=null,me=null;for(h in c)if(c.hasOwnProperty(h)){var Ae=c[h];if(Ae!=null)switch(h){case"name":g=Ae;break;case"type":b=Ae;break;case"checked":re=Ae;break;case"defaultChecked":me=Ae;break;case"value":x=Ae;break;case"defaultValue":L=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,o));break;default:cr(a,o,h,Ae,c,null)}}Z0(a,x,L,re,me,b,g,!1);return;case"select":Rt("invalid",a),h=b=x=null;for(g in c)if(c.hasOwnProperty(g)&&(L=c[g],L!=null))switch(g){case"value":x=L;break;case"defaultValue":b=L;break;case"multiple":h=L;default:cr(a,o,g,L,c,null)}o=x,c=b,a.multiple=!!h,o!=null?$s(a,!!h,o,!1):c!=null&&$s(a,!!h,c,!0);return;case"textarea":Rt("invalid",a),x=g=h=null;for(b in c)if(c.hasOwnProperty(b)&&(L=c[b],L!=null))switch(b){case"value":h=L;break;case"defaultValue":g=L;break;case"children":x=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(n(91));break;default:cr(a,o,b,L,c,null)}Qs(a,h,g,x);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(h=c[re],h!=null))switch(re){case"selected":a.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:cr(a,o,re,h,c,null)}return;case"dialog":Rt("beforetoggle",a),Rt("toggle",a),Rt("cancel",a),Rt("close",a);break;case"iframe":case"object":Rt("load",a);break;case"video":case"audio":for(h=0;h<nh.length;h++)Rt(nh[h],a);break;case"image":Rt("error",a),Rt("load",a);break;case"details":Rt("toggle",a);break;case"embed":case"source":case"link":Rt("error",a),Rt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in c)if(c.hasOwnProperty(me)&&(h=c[me],h!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:cr(a,o,me,h,c,null)}return;default:if(Oc(o)){for(Ae in c)c.hasOwnProperty(Ae)&&(h=c[Ae],h!==void 0&&r_(a,o,Ae,h,c,void 0));return}}for(L in c)c.hasOwnProperty(L)&&(h=c[L],h!=null&&cr(a,o,L,h,c,null))}function rN(a,o,c,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,b=null,L=null,re=null,me=null,Ae=null;for(Ee in c){var Re=c[Ee];if(c.hasOwnProperty(Ee)&&Re!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":re=Re;default:h.hasOwnProperty(Ee)||cr(a,o,Ee,null,h,Re)}}for(var _e in h){var Ee=h[_e];if(Re=c[_e],h.hasOwnProperty(_e)&&(Ee!=null||Re!=null))switch(_e){case"type":x=Ee;break;case"name":g=Ee;break;case"checked":me=Ee;break;case"defaultChecked":Ae=Ee;break;case"value":b=Ee;break;case"defaultValue":L=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,o));break;default:Ee!==Re&&cr(a,o,_e,Ee,h,Re)}}Nc(a,b,L,re,me,Ae,x,g);return;case"select":Ee=b=L=_e=null;for(x in c)if(re=c[x],c.hasOwnProperty(x)&&re!=null)switch(x){case"value":break;case"multiple":Ee=re;default:h.hasOwnProperty(x)||cr(a,o,x,null,h,re)}for(g in h)if(x=h[g],re=c[g],h.hasOwnProperty(g)&&(x!=null||re!=null))switch(g){case"value":_e=x;break;case"defaultValue":L=x;break;case"multiple":b=x;default:x!==re&&cr(a,o,g,x,h,re)}o=L,c=b,h=Ee,_e!=null?$s(a,!!c,_e,!1):!!h!=!!c&&(o!=null?$s(a,!!c,o,!0):$s(a,!!c,c?[]:"",!1));return;case"textarea":Ee=_e=null;for(L in c)if(g=c[L],c.hasOwnProperty(L)&&g!=null&&!h.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:cr(a,o,L,null,h,g)}for(b in h)if(g=h[b],x=c[b],h.hasOwnProperty(b)&&(g!=null||x!=null))switch(b){case"value":_e=g;break;case"defaultValue":Ee=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==x&&cr(a,o,b,g,h,x)}ed(a,_e,Ee);return;case"option":for(var $e in c)if(_e=c[$e],c.hasOwnProperty($e)&&_e!=null&&!h.hasOwnProperty($e))switch($e){case"selected":a.selected=!1;break;default:cr(a,o,$e,null,h,_e)}for(re in h)if(_e=h[re],Ee=c[re],h.hasOwnProperty(re)&&_e!==Ee&&(_e!=null||Ee!=null))switch(re){case"selected":a.selected=_e&&typeof _e!="function"&&typeof _e!="symbol";break;default:cr(a,o,re,_e,h,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ct in c)_e=c[ct],c.hasOwnProperty(ct)&&_e!=null&&!h.hasOwnProperty(ct)&&cr(a,o,ct,null,h,_e);for(me in h)if(_e=h[me],Ee=c[me],h.hasOwnProperty(me)&&_e!==Ee&&(_e!=null||Ee!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,o));break;default:cr(a,o,me,_e,h,Ee)}return;default:if(Oc(o)){for(var ur in c)_e=c[ur],c.hasOwnProperty(ur)&&_e!==void 0&&!h.hasOwnProperty(ur)&&r_(a,o,ur,void 0,h,_e);for(Ae in h)_e=h[Ae],Ee=c[Ae],!h.hasOwnProperty(Ae)||_e===Ee||_e===void 0&&Ee===void 0||r_(a,o,Ae,_e,h,Ee);return}}for(var se in c)_e=c[se],c.hasOwnProperty(se)&&_e!=null&&!h.hasOwnProperty(se)&&cr(a,o,se,null,h,_e);for(Re in h)_e=h[Re],Ee=c[Re],!h.hasOwnProperty(Re)||_e===Ee||_e==null&&Ee==null||cr(a,o,Re,_e,h,Ee)}function WT(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nN(){if(typeof performance.getEntriesByType=="function"){for(var a=0,o=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var g=c[h],x=g.transferSize,b=g.initiatorType,L=g.duration;if(x&&L&&WT(b)){for(b=0,L=g.responseEnd,h+=1;h<c.length;h++){var re=c[h],me=re.startTime;if(me>L)break;var Ae=re.transferSize,Re=re.initiatorType;Ae&&WT(Re)&&(re=re.responseEnd,b+=Ae*(re<L?1:(L-me)/(re-me)))}if(--h,o+=8*(x+b)/(g.duration/1e3),a++,10<a)break}}if(0<a)return o/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var n_=null,i_=null;function nm(a){return a.nodeType===9?a:a.ownerDocument}function XT(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function YT(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function a_(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var s_=null;function iN(){var a=window.event;return a&&a.type==="popstate"?a===s_?!1:(s_=a,!0):(s_=null,!1)}var $T=typeof setTimeout=="function"?setTimeout:void 0,aN=typeof clearTimeout=="function"?clearTimeout:void 0,QT=typeof Promise=="function"?Promise:void 0,sN=typeof queueMicrotask=="function"?queueMicrotask:typeof QT<"u"?function(a){return QT.resolve(null).then(a).catch(oN)}:$T;function oN(a){setTimeout(function(){throw a})}function Eo(a){return a==="head"}function JT(a,o){var c=o,h=0;do{var g=c.nextSibling;if(a.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"||c==="/&"){if(h===0){a.removeChild(g),mu(o);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")ah(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,ah(c);for(var x=c.firstChild;x;){var b=x.nextSibling,L=x.nodeName;x[pe]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=b}}else c==="body"&&ah(a.ownerDocument.body);c=g}while(c);mu(o)}function ZT(a,o){var c=a;a=0;do{var h=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=h}while(c)}function o_(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":o_(c),Le(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function lN(a,o,c,h){for(;a.nodeType===1;){var g=c;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(h){if(!a[pe])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(x=a.getAttribute("rel"),x==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(x!==g.rel||a.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||a.getAttribute("title")!==(g.title==null?null:g.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(x=a.getAttribute("src"),(x!==(g.src==null?null:g.src)||a.getAttribute("type")!==(g.type==null?null:g.type)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&a.getAttribute("name")===x)return a}else return a;if(a=$i(a.nextSibling),a===null)break}return null}function cN(a,o,c){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=$i(a.nextSibling),a===null))return null;return a}function ew(a,o){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=$i(a.nextSibling),a===null))return null;return a}function l_(a){return a.data==="$?"||a.data==="$~"}function c_(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function uN(a,o){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=o;else if(a.data!=="$?"||c.readyState!=="loading")o();else{var h=function(){o(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),a._reactRetry=h}}function $i(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return a}var u_=null;function tw(a){a=a.nextSibling;for(var o=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(o===0)return $i(a.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}a=a.nextSibling}return null}function rw(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return a;o--}else c!=="/$"&&c!=="/&"||o++}a=a.previousSibling}return null}function nw(a,o,c){switch(o=nm(c),a){case"html":if(a=o.documentElement,!a)throw Error(n(452));return a;case"head":if(a=o.head,!a)throw Error(n(453));return a;case"body":if(a=o.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function ah(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);Le(a)}var Qi=new Map,iw=new Set;function im(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Cs=le.d;le.d={f:fN,r:hN,D:dN,C:mN,L:pN,m:gN,X:xN,S:_N,M:vN};function fN(){var a=Cs.f(),o=Yd();return a||o}function hN(a){var o=Ge(a);o!==null&&o.tag===5&&o.type==="form"?E2(o):Cs.r(a)}var fu=typeof document>"u"?null:document;function aw(a,o,c){var h=fu;if(h&&typeof o=="string"&&o){var g=si(o);g='link[rel="'+a+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),iw.has(g)||(iw.add(g),a={rel:a,crossOrigin:c,href:o},h.querySelector(g)===null&&(o=h.createElement("link"),bn(o,"link",a),Qe(o),h.head.appendChild(o)))}}function dN(a){Cs.D(a),aw("dns-prefetch",a,null)}function mN(a,o){Cs.C(a,o),aw("preconnect",a,o)}function pN(a,o,c){Cs.L(a,o,c);var h=fu;if(h&&a&&o){var g='link[rel="preload"][as="'+si(o)+'"]';o==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+si(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+si(c.imageSizes)+'"]')):g+='[href="'+si(a)+'"]';var x=g;switch(o){case"style":x=hu(a);break;case"script":x=du(a)}Qi.has(x)||(a=_({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:a,as:o},c),Qi.set(x,a),h.querySelector(g)!==null||o==="style"&&h.querySelector(sh(x))||o==="script"&&h.querySelector(oh(x))||(o=h.createElement("link"),bn(o,"link",a),Qe(o),h.head.appendChild(o)))}}function gN(a,o){Cs.m(a,o);var c=fu;if(c&&a){var h=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+si(h)+'"][href="'+si(a)+'"]',x=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=du(a)}if(!Qi.has(x)&&(a=_({rel:"modulepreload",href:a},o),Qi.set(x,a),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(oh(x)))return}h=c.createElement("link"),bn(h,"link",a),Qe(h),c.head.appendChild(h)}}}function _N(a,o,c){Cs.S(a,o,c);var h=fu;if(h&&a){var g=He(h).hoistableStyles,x=hu(a);o=o||"default";var b=g.get(x);if(!b){var L={loading:0,preload:null};if(b=h.querySelector(sh(x)))L.loading=5;else{a=_({rel:"stylesheet",href:a,"data-precedence":o},c),(c=Qi.get(x))&&f_(a,c);var re=b=h.createElement("link");Qe(re),bn(re,"link",a),re._p=new Promise(function(me,Ae){re.onload=me,re.onerror=Ae}),re.addEventListener("load",function(){L.loading|=1}),re.addEventListener("error",function(){L.loading|=2}),L.loading|=4,am(b,o,h)}b={type:"stylesheet",instance:b,count:1,state:L},g.set(x,b)}}}function xN(a,o){Cs.X(a,o);var c=fu;if(c&&a){var h=He(c).hoistableScripts,g=du(a),x=h.get(g);x||(x=c.querySelector(oh(g)),x||(a=_({src:a,async:!0},o),(o=Qi.get(g))&&h_(a,o),x=c.createElement("script"),Qe(x),bn(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function vN(a,o){Cs.M(a,o);var c=fu;if(c&&a){var h=He(c).hoistableScripts,g=du(a),x=h.get(g);x||(x=c.querySelector(oh(g)),x||(a=_({src:a,async:!0,type:"module"},o),(o=Qi.get(g))&&h_(a,o),x=c.createElement("script"),Qe(x),bn(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function sw(a,o,c,h){var g=(g=oe.current)?im(g):null;if(!g)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=hu(c.href),c=He(g).hoistableStyles,h=c.get(o),h||(h={type:"style",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=hu(c.href);var x=He(g).hoistableStyles,b=x.get(a);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(a,b),(x=g.querySelector(sh(a)))&&!x._p&&(b.instance=x,b.state.loading=5),Qi.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Qi.set(a,c),x||yN(g,a,c,b.state))),o&&h===null)throw Error(n(528,""));return b}if(o&&h!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=du(c),c=He(g).hoistableScripts,h=c.get(o),h||(h={type:"script",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function hu(a){return'href="'+si(a)+'"'}function sh(a){return'link[rel="stylesheet"]['+a+"]"}function ow(a){return _({},a,{"data-precedence":a.precedence,precedence:null})}function yN(a,o,c,h){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=a.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),bn(o,"link",c),Qe(o),a.head.appendChild(o))}function du(a){return'[src="'+si(a)+'"]'}function oh(a){return"script[async]"+a}function lw(a,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var h=a.querySelector('style[data-href~="'+si(c.href)+'"]');if(h)return o.instance=h,Qe(h),h;var g=_({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(a.ownerDocument||a).createElement("style"),Qe(h),bn(h,"style",g),am(h,c.precedence,a),o.instance=h;case"stylesheet":g=hu(c.href);var x=a.querySelector(sh(g));if(x)return o.state.loading|=4,o.instance=x,Qe(x),x;h=ow(c),(g=Qi.get(g))&&f_(h,g),x=(a.ownerDocument||a).createElement("link"),Qe(x);var b=x;return b._p=new Promise(function(L,re){b.onload=L,b.onerror=re}),bn(x,"link",h),o.state.loading|=4,am(x,c.precedence,a),o.instance=x;case"script":return x=du(c.src),(g=a.querySelector(oh(x)))?(o.instance=g,Qe(g),g):(h=c,(g=Qi.get(x))&&(h=_({},c),h_(h,g)),a=a.ownerDocument||a,g=a.createElement("script"),Qe(g),bn(g,"link",h),a.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,am(h,c.precedence,a));return o.instance}function am(a,o,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,x=g,b=0;b<h.length;b++){var L=h[b];if(L.dataset.precedence===o)x=L;else if(x!==g)break}x?x.parentNode.insertBefore(a,x.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(a,o.firstChild))}function f_(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function h_(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var sm=null;function cw(a,o,c){if(sm===null){var h=new Map,g=sm=new Map;g.set(c,h)}else g=sm,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(a))return h;for(h.set(a,null),c=c.getElementsByTagName(a),g=0;g<c.length;g++){var x=c[g];if(!(x[pe]||x[H]||a==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var b=x.getAttribute(o)||"";b=a+b;var L=h.get(b);L?L.push(x):h.set(b,[x])}}return h}function uw(a,o,c){a=a.ownerDocument||a,a.head.insertBefore(c,o==="title"?a.querySelector("head > title"):null)}function EN(a,o,c){if(c===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function fw(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function TN(a,o,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var g=hu(h.href),x=o.querySelector(sh(g));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(a.count++,a=om.bind(a),o.then(a,a)),c.state.loading|=4,c.instance=x,Qe(x);return}x=o.ownerDocument||o,h=ow(h),(g=Qi.get(g))&&f_(h,g),x=x.createElement("link"),Qe(x);var b=x;b._p=new Promise(function(L,re){b.onload=L,b.onerror=re}),bn(x,"link",h),c.instance=x}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=om.bind(a),o.addEventListener("load",c),o.addEventListener("error",c))}}var d_=0;function wN(a,o){return a.stylesheets&&a.count===0&&cm(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var h=setTimeout(function(){if(a.stylesheets&&cm(a,a.stylesheets),a.unsuspend){var x=a.unsuspend;a.unsuspend=null,x()}},6e4+o);0<a.imgBytes&&d_===0&&(d_=62500*nN());var g=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&cm(a,a.stylesheets),a.unsuspend)){var x=a.unsuspend;a.unsuspend=null,x()}},(a.imgBytes>d_?50:800)+o);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function om(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)cm(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var lm=null;function cm(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,lm=new Map,o.forEach(SN,a),lm=null,om.call(a))}function SN(a,o){if(!(o.state.loading&4)){var c=lm.get(a);if(c)var h=c.get(null);else{c=new Map,lm.set(a,c);for(var g=a.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var b=g[x];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),h=b)}h&&c.set(null,h)}g=o.instance,b=g.getAttribute("data-precedence"),x=c.get(b)||h,x===h&&c.set(null,g),c.set(b,g),this.count++,h=om.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),x?x.parentNode.insertBefore(g,x.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(g,a.firstChild)),o.state.loading|=4}}var lh={$$typeof:k,Provider:null,Consumer:null,_currentValue:Pe,_currentValue2:Pe,_threadCount:0};function AN(a,o,c,h,g,x,b,L,re){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ui(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ui(0),this.hiddenUpdates=Ui(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function hw(a,o,c,h,g,x,b,L,re,me,Ae,Re){return a=new AN(a,o,c,b,re,me,Ae,Re,L),o=1,x===!0&&(o|=24),x=Ei(3,null,null,o),a.current=x,x.stateNode=a,o=Kg(),o.refCount++,a.pooledCache=o,o.refCount++,x.memoizedState={element:h,isDehydrated:c,cache:o},$g(x),a}function dw(a){return a?(a=Gc,a):Gc}function mw(a,o,c,h,g,x){g=dw(g),h.context===null?h.context=g:h.pendingContext=g,h=co(o),h.payload={element:c},x=x===void 0?null:x,x!==null&&(h.callback=x),c=uo(a,h,o),c!==null&&(hi(c,a,o),Uf(c,a,o))}function pw(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<o?c:o}}function m_(a,o){pw(a,o),(a=a.alternate)&&pw(a,o)}function gw(a){if(a.tag===13||a.tag===31){var o=El(a,67108864);o!==null&&hi(o,a,67108864),m_(a,67108864)}}function _w(a){if(a.tag===13||a.tag===31){var o=bi();o=fs(o);var c=El(a,o);c!==null&&hi(c,a,o),m_(a,o)}}var um=!0;function bN(a,o,c,h){var g=ne.T;ne.T=null;var x=le.p;try{le.p=2,p_(a,o,c,h)}finally{le.p=x,ne.T=g}}function IN(a,o,c,h){var g=ne.T;ne.T=null;var x=le.p;try{le.p=8,p_(a,o,c,h)}finally{le.p=x,ne.T=g}}function p_(a,o,c,h){if(um){var g=g_(h);if(g===null)t_(a,o,h,fm,c),vw(a,h);else if(CN(g,a,o,c,h))h.stopPropagation();else if(vw(a,h),o&4&&-1<kN.indexOf(a)){for(;g!==null;){var x=Ge(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var b=$n(x.pendingLanes);if(b!==0){var L=x;for(L.pendingLanes|=2,L.entangledLanes|=2;b;){var re=1<<31-$t(b);L.entanglements[1]|=re,b&=~re}qa(x),(Xt&6)===0&&(Wd=qt()+500,rh(0))}}break;case 31:case 13:L=El(x,2),L!==null&&hi(L,x,2),Yd(),m_(x,2)}if(x=g_(h),x===null&&t_(a,o,h,fm,c),x===g)break;g=x}g!==null&&h.stopPropagation()}else t_(a,o,h,null,c)}}function g_(a){return a=zi(a),__(a)}var fm=null;function __(a){if(fm=null,a=Be(a),a!==null){var o=s(a);if(o===null)a=null;else{var c=o.tag;if(c===13){if(a=l(o),a!==null)return a;a=null}else if(c===31){if(a=u(o),a!==null)return a;a=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return fm=a,null}function xw(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sn()){case Nn:return 2;case gi:return 8;case et:case yt:return 32;case rt:return 268435456;default:return 32}default:return 32}}var x_=!1,To=null,wo=null,So=null,ch=new Map,uh=new Map,Ao=[],kN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vw(a,o){switch(a){case"focusin":case"focusout":To=null;break;case"dragenter":case"dragleave":wo=null;break;case"mouseover":case"mouseout":So=null;break;case"pointerover":case"pointerout":ch.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":uh.delete(o.pointerId)}}function fh(a,o,c,h,g,x){return a===null||a.nativeEvent!==x?(a={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:x,targetContainers:[g]},o!==null&&(o=Ge(o),o!==null&&gw(o)),a):(a.eventSystemFlags|=h,o=a.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),a)}function CN(a,o,c,h,g){switch(o){case"focusin":return To=fh(To,a,o,c,h,g),!0;case"dragenter":return wo=fh(wo,a,o,c,h,g),!0;case"mouseover":return So=fh(So,a,o,c,h,g),!0;case"pointerover":var x=g.pointerId;return ch.set(x,fh(ch.get(x)||null,a,o,c,h,g)),!0;case"gotpointercapture":return x=g.pointerId,uh.set(x,fh(uh.get(x)||null,a,o,c,h,g)),!0}return!1}function yw(a){var o=Be(a.target);if(o!==null){var c=s(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){a.blockedOn=o,K(a.priority,function(){_w(c)});return}}else if(o===31){if(o=u(c),o!==null){a.blockedOn=o,K(a.priority,function(){_w(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function hm(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var c=g_(a.nativeEvent);if(c===null){c=a.nativeEvent;var h=new c.constructor(c.type,c);Sf=h,c.target.dispatchEvent(h),Sf=null}else return o=Ge(c),o!==null&&gw(o),a.blockedOn=c,!1;o.shift()}return!0}function Ew(a,o,c){hm(a)&&c.delete(o)}function RN(){x_=!1,To!==null&&hm(To)&&(To=null),wo!==null&&hm(wo)&&(wo=null),So!==null&&hm(So)&&(So=null),ch.forEach(Ew),uh.forEach(Ew)}function dm(a,o){a.blockedOn===o&&(a.blockedOn=null,x_||(x_=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,RN)))}var mm=null;function Tw(a){mm!==a&&(mm=a,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){mm===a&&(mm=null);for(var o=0;o<a.length;o+=3){var c=a[o],h=a[o+1],g=a[o+2];if(typeof h!="function"){if(__(h||c)===null)continue;break}var x=Ge(c);x!==null&&(a.splice(o,3),o-=3,g1(x,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function mu(a){function o(re){return dm(re,a)}To!==null&&dm(To,a),wo!==null&&dm(wo,a),So!==null&&dm(So,a),ch.forEach(o),uh.forEach(o);for(var c=0;c<Ao.length;c++){var h=Ao[c];h.blockedOn===a&&(h.blockedOn=null)}for(;0<Ao.length&&(c=Ao[0],c.blockedOn===null);)yw(c),c.blockedOn===null&&Ao.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],x=c[h+1],b=g[G]||null;if(typeof x=="function")b||Tw(c);else if(b){var L=null;if(x&&x.hasAttribute("formAction")){if(g=x,b=x[G]||null)L=b.formAction;else if(__(g)!==null)continue}else L=b.action;typeof L=="function"?c[h+1]=L:(c.splice(h,3),h-=3),Tw(c)}}}function ww(){function a(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(b){return g=b})},focusReset:"manual",scroll:"manual"})}function o(){g!==null&&(g(),g=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),g!==null&&(g(),g=null)}}}function v_(a){this._internalRoot=a}pm.prototype.render=v_.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,h=bi();mw(c,h,a,o,null,null)},pm.prototype.unmount=v_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;mw(a.current,2,null,a,null,null),Yd(),o[Y]=null}};function pm(a){this._internalRoot=a}pm.prototype.unstable_scheduleHydration=function(a){if(a){var o=F();a={blockedOn:null,target:a,priority:o};for(var c=0;c<Ao.length&&o!==0&&o<Ao[c].priority;c++);Ao.splice(c,0,a),c===0&&yw(a)}};var Sw=e.version;if(Sw!=="19.2.1")throw Error(n(527,Sw,"19.2.1"));le.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(o),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var DN={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gm.isDisabled&&gm.supportsFiber)try{kt=gm.inject(DN),Vt=gm}catch{}}return dh.createRoot=function(a,o){if(!i(a))throw Error(n(299));var c=!1,h="",g=D2,x=N2,b=O2;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=hw(a,1,!1,null,null,c,h,null,g,x,b,ww),a[Y]=o.current,e_(a),new v_(o)},dh.hydrateRoot=function(a,o,c){if(!i(a))throw Error(n(299));var h=!1,g="",x=D2,b=N2,L=O2,re=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(L=c.onRecoverableError),c.formState!==void 0&&(re=c.formState)),o=hw(a,1,!0,o,c??null,h,g,re,x,b,L,ww),o.context=dw(null),c=o.current,h=bi(),h=fs(h),g=co(h),g.callback=null,uo(c,g,h),c=h,o.current.lanes=c,ls(o,c),qa(o),a[Y]=o.current,e_(a),new pm(o)},dh.version="19.2.1",dh}var Fw;function HN(){if(Fw)return T_.exports;Fw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),T_.exports=jN(),T_.exports}var GN=HN();const qN="modulepreload",KN=function(r,e){return new URL(r,e).href},Pw={},Pr=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let d=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};const l=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");i=d(t.map(m=>{if(m=KN(m,n),m in Pw)return;Pw[m]=!0;const _=m.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(n)for(let T=l.length-1;T>=0;T--){const E=l[T];if(E.href===m&&(!_||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${v}`))return;const y=document.createElement("link");if(y.rel=_?"stylesheet":qN,_||(y.as="script"),y.crossOrigin="",y.href=m,f&&y.setAttribute("nonce",f),document.head.appendChild(y),_)return new Promise((T,E)=>{y.addEventListener("load",T),y.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${m}`)))})}))}function s(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return i.then(l=>{for(const u of l||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})};var Zh={};Zh.version="0.18.5";var Ni=1200,rc=1252,WN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],iv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Bp=function(r){WN.indexOf(r)!=-1&&(rc=iv[0]=r)};function XN(){Bp(1252)}var aa=function(r){Ni=r,Bp(r)};function Up(){aa(1200),XN()}function Zm(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function YN(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function eI(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var Du=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?YN(r.slice(2)):e==254&&t==255?eI(r.slice(2)):e==65279?r.slice(1):r},wh=function(e){return String.fromCharCode(e)},ux=function(e){return String.fromCharCode(e)},Ut;function $N(r){Ut=r,aa=function(e){Ni=e,Bp(e)},Du=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?Ut.utils.decode(1200,Zm(e.slice(2))):e},wh=function(t){return Ni===1200?String.fromCharCode(t):Ut.utils.decode(Ni,[t&255,t>>8])[0]},ux=function(t){return Ut.utils.decode(rc,[t])[0]},CI()}var Lo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function e0(r){for(var e="",t=0,n=0,i=0,s=0,l=0,u=0,f=0,d=0;d<r.length;)t=r.charCodeAt(d++),s=t>>2,n=r.charCodeAt(d++),l=(t&3)<<4|n>>4,i=r.charCodeAt(d++),u=(n&15)<<2|i>>6,f=i&63,isNaN(n)?u=f=64:isNaN(i)&&(f=64),e+=Lo.charAt(s)+Lo.charAt(l)+Lo.charAt(u)+Lo.charAt(f);return e}function Mi(r){var e="",t=0,n=0,i=0,s=0,l=0,u=0,f=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<r.length;)s=Lo.indexOf(r.charAt(d++)),l=Lo.indexOf(r.charAt(d++)),t=s<<2|l>>4,e+=String.fromCharCode(t),u=Lo.indexOf(r.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=Lo.indexOf(r.charAt(d++)),i=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(i));return e}var St=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Hs=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Xo(r){return St?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Mw(r){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Ci=function(e){return St?Hs(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function k0(r){if(typeof ArrayBuffer>"u")return Ci(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function nl(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function QN(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function av(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return av(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var vn=St?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Hs(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function JN(r){for(var e=[],t=0,n=r.length+250,i=Xo(r.length+255),s=0;s<r.length;++s){var l=r.charCodeAt(s);if(l<128)i[t++]=l;else if(l<2048)i[t++]=192|l>>6&31,i[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=r.charCodeAt(++s)&1023;i[t++]=240|l>>8&7,i[t++]=128|l>>2&63,i[t++]=128|u>>6&15|(l&3)<<4,i[t++]=128|u&63}else i[t++]=224|l>>12&15,i[t++]=128|l>>6&63,i[t++]=128|l&63;t>n&&(e.push(i.slice(0,t)),t=0,i=Xo(65535),n=65530)}return e.push(i.slice(0,t)),vn(e)}var Gn=/\u0000/g,Sh=/[\u0001-\u0006]/g;function Fu(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Ia(r,e){var t=""+r;return t.length>=e?t:Or("0",e-t.length)+t}function sv(r,e){var t=""+r;return t.length>=e?t:Or(" ",e-t.length)+t}function ep(r,e){var t=""+r;return t.length>=e?t:t+Or(" ",e-t.length)}function ZN(r,e){var t=""+Math.round(r);return t.length>=e?t:Or("0",e-t.length)+t}function e5(r,e){var t=""+r;return t.length>=e?t:Or("0",e-t.length)+t}var Lw=Math.pow(2,32);function pu(r,e){if(r>Lw||r<-Lw)return ZN(r,e);var t=Math.round(r);return e5(t,e)}function tp(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Vw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],b_=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function t5(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Bw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},r5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rp(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,l=1,u=0,f=1,d=0,m=0,_=Math.floor(i);d<e&&(_=Math.floor(i),u=_*l+s,m=_*d+f,!(i-_<5e-8));)i=1/(i-_),s=l,l=u,f=d,d=m;if(m>e&&(d>e?(m=f,u=s):(m=d,u=l)),!t)return[0,n*u,m];var v=Math.floor(n*u/m);return[v,n*u-v*m,m]}function Vo(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,l=[],u={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)l=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),n<60&&(s=(s+6)%7),t&&(s=l5(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=s,u}var tI=new Date(1899,11,31,0,0,0),n5=tI.getTime(),i5=new Date(1900,2,1,0,0,0);function rI(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=i5&&(t+=1440*60*1e3),(t-(n5+(r.getTimezoneOffset()-tI.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ov(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function a5(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function s5(r){var e=r<0?12:11,t=ov(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function o5(r){var e=ov(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function t0(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=s5(r):e===10?t=r.toFixed(10).substr(0,12):t=o5(r),ov(a5(t.toUpperCase()))}function nc(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):t0(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Li(14,rI(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function l5(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function c5(r,e,t,n){var i="",s=0,l=0,u=t.y,f,d=0;switch(r){case 98:u=t.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=t.m,d=e.length;break;case 3:return b_[t.m-1][1];case 5:return b_[t.m-1][0];default:return b_[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=t.d,d=e.length;break;case 3:return Vw[t.q][0];default:return Vw[t.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(t.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=t.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=t.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Ia(t.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(t.S+t.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(i=Ia(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=u,d=1;break}var m=d>0?Ia(f,d):"";return m}function Bo(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var nI=/%/g;function u5(r,e,t){var n=e.replace(nI,""),i=e.length-n.length;return Fs(r,n,t*Math.pow(10,2*i))+Or("%",i)}function f5(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fs(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function iI(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+iI(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var aI=/# (\?+)( ?)\/( ?)(\d+)/;function h5(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),l=i-s*n,u=n;return t+(s===0?"":""+s)+" "+(l===0?Or(" ",r[1].length+1+r[4].length):sv(l,r[1].length)+r[2]+"/"+r[3]+Ia(u,r[4].length))}function d5(r,e,t){return t+(e===0?"":""+e)+Or(" ",r[1].length+2+r[4].length)}var sI=/^#*0*\.([0#]+)/,oI=/\).*[0#]/,lI=/\(###\) ###\\?-####/;function Zn(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Uw(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function zw(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function m5(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function p5(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Zi(r,e,t){if(r.charCodeAt(0)===40&&!e.match(oI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Zi("n",n,t):"("+Zi("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return f5(r,e,t);if(e.indexOf("%")!==-1)return u5(r,e,t);if(e.indexOf("E")!==-1)return iI(e,t);if(e.charCodeAt(0)===36)return"$"+Zi(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,l,u,f=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+pu(f,e.length);if(e.match(/^[#?]+$/))return i=pu(t,0),i==="0"&&(i=""),i.length>e.length?i:Zn(e.substr(0,e.length-i.length))+i;if(s=e.match(aI))return h5(s,f,d);if(e.match(/^#+0+$/))return d+pu(f,e.length-e.indexOf("0"));if(s=e.match(sI))return i=Uw(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Zn(s[1])).replace(/\.$/,"."+Zn(s[1])).replace(/\.(\d*)$/,function(T,E){return"."+E+Or("0",Zn(s[1]).length-E.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+Uw(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+Bo(pu(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Zi(r,e,-t):Bo(""+(Math.floor(t)+m5(t,s[1].length)))+"."+Ia(zw(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Zi(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fu(Zi(r,e.replace(/[\\-]/g,""),t)),l=0,Fu(Fu(e.replace(/\\/g,"")).replace(/[0#]/g,function(T){return l<i.length?i.charAt(l++):T==="0"?"0":""}));if(e.match(lI))return i=Zi(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=rp(f,Math.pow(10,l)-1,!1),i=""+d,m=Fs("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=ep(u[2],l),m.length<s[4].length&&(m=Zn(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=rp(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?sv(u[1],l)+s[2]+"/"+s[3]+ep(u[2],l):Or(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=pu(t,0),e.length<=i.length?i:Zn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var _=e.indexOf(".")-l,v=e.length-i.length-_;return Zn(e.substr(0,_)+i+e.substr(e.length-v))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=zw(t,s[1].length),t<0?"-"+Zi(r,e,-t):Bo(p5(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?Ia(0,3-T.length):"")+T})+"."+Ia(l,s[1].length);switch(e){case"###,##0.00":return Zi(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=Bo(pu(f,0));return y!=="0"?d+y:"";case"###,###.00":return Zi(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Zi(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function g5(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fs(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function _5(r,e,t){var n=e.replace(nI,""),i=e.length-n.length;return Fs(r,n,t*Math.pow(10,2*i))+Or("%",i)}function cI(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+cI(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Wa(r,e,t){if(r.charCodeAt(0)===40&&!e.match(oI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Wa("n",n,t):"("+Wa("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return g5(r,e,t);if(e.indexOf("%")!==-1)return _5(r,e,t);if(e.indexOf("E")!==-1)return cI(e,t);if(e.charCodeAt(0)===36)return"$"+Wa(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,l,u,f=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+Ia(f,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Zn(e.substr(0,e.length-i.length))+i;if(s=e.match(aI))return d5(s,f,d);if(e.match(/^#+0+$/))return d+Ia(f,e.length-e.indexOf("0"));if(s=e.match(sI))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Zn(s[1])).replace(/\.$/,"."+Zn(s[1])),i=i.replace(/\.(\d*)$/,function(T,E){return"."+E+Or("0",Zn(s[1]).length-E.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+Bo(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Wa(r,e,-t):Bo(""+t)+"."+Or("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Wa(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fu(Wa(r,e.replace(/[\\-]/g,""),t)),l=0,Fu(Fu(e.replace(/\\/g,"")).replace(/[0#]/g,function(T){return l<i.length?i.charAt(l++):T==="0"?"0":""}));if(e.match(lI))return i=Wa(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=rp(f,Math.pow(10,l)-1,!1),i=""+d,m=Fs("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=ep(u[2],l),m.length<s[4].length&&(m=Zn(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=rp(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?sv(u[1],l)+s[2]+"/"+s[3]+ep(u[2],l):Or(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Zn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var _=e.indexOf(".")-l,v=e.length-i.length-_;return Zn(e.substr(0,_)+i+e.substr(e.length-v))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Wa(r,e,-t):Bo(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?Ia(0,3-T.length):"")+T})+"."+Ia(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=Bo(""+f);return y!=="0"?d+y:"";default:if(e.match(/\.[0#?]*$/))return Wa(r,e.slice(0,e.lastIndexOf(".")),t)+Zn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Fs(r,e,t){return(t|0)===t?Wa(r,e,t):Zi(r,e,t)}function x5(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var uI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yc(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":tp(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(uI))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function v5(r,e,t,n){for(var i=[],s="",l=0,u="",f="t",d,m,_,v="H";l<r.length;)switch(u=r.charAt(l)){case"G":if(!tp(r,l))throw new Error("unrecognized character "+u+" in "+r);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(_=r.charCodeAt(++l))!==34&&l<r.length;)s+=String.fromCharCode(_);i[i.length]={t:"t",v:s},++l;break;case"\\":var y=r.charAt(++l),T=y==="("||y===")"?y:"t";i[i.length]={t:T,v:y},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:e},++l;break;case"B":case"b":if(r.charAt(l+1)==="1"||r.charAt(l+1)==="2"){if(d==null&&(d=Vo(e,t,r.charAt(l+1)==="2"),d==null))return"";i[i.length]={t:"X",v:r.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Vo(e,t),d==null))return"";for(s=u;++l<r.length&&r.charAt(l).toLowerCase()===u;)s+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),i[i.length]={t:u,v:s},f=u;break;case"A":case"a":case"":var E={t:u,v:u};if(d==null&&(d=Vo(e,t)),r.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",v="h",l+=3):r.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",l+=5,v="h"):r.substr(l,5).toUpperCase()==="/"?(d!=null&&(E.v=d.H>=12?"":""),E.t="T",l+=5,v="h"):(E.t="t",++l),d==null&&E.t==="T")return"";i[i.length]=E,f=u;break;case"[":for(s=u;r.charAt(l++)!=="]"&&l<r.length;)s+=r.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(uI)){if(d==null&&(d=Vo(e,t),d==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",yc(r)||(i[i.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=u;++l<r.length&&(u=r.charAt(l))==="0";)s+=u;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++l<r.length&&"0#?.,E+-%".indexOf(u=r.charAt(l))>-1;)s+=u;i[i.length]={t:"n",v:s};break;case"?":for(s=u;r.charAt(++l)===u;)s+=u;i[i.length]={t:u,v:s},f=u;break;case"*":++l,(r.charAt(l)==" "||r.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;l<r.length&&"0123456789".indexOf(r.charAt(++l))>-1;)s+=r.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:u,v:u},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+r);i[i.length]={t:"t",v:u},++l;break}var S=0,D=0,U;for(l=i.length-1,f="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=v,f="h",S<1&&(S=1);break;case"s":(U=i[l].v.match(/\.0+$/))&&(D=Math.max(D,U[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=i[l].t;break;case"m":f==="s"&&(i[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[l].v.match(/[Hh]/)&&(S=1),S<2&&i[l].v.match(/[Mm]/)&&(S=2),S<3&&i[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var k="",W;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=c5(i[l].t.charCodeAt(0),i[l].v,d,D),i[l].t="t";break;case"n":case"?":for(W=l+1;i[W]!=null&&((u=i[W].t)==="?"||u==="D"||(u===" "||u==="t")&&i[W+1]!=null&&(i[W+1].t==="?"||i[W+1].t==="t"&&i[W+1].v==="/")||i[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[W].v==="/"||i[W].v===" "&&i[W+1]!=null&&i[W+1].t=="?"));)i[l].v+=i[W].v,i[W]={v:"",t:";"},++W;k+=i[l].v,l=W-1;break;case"G":i[l].t="t",i[l].v=nc(e,t);break}var ee="",X,A;if(k.length>0){k.charCodeAt(0)==40?(X=e<0&&k.charCodeAt(0)===45?-e:e,A=Fs("n",k,X)):(X=e<0&&n>1?-e:e,A=Fs("n",k,X),X<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),W=A.length-1;var R=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){R=l;break}var C=i.length;if(R===i.length&&A.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(W>=i[l].v.length-1?(W-=i[l].v.length,i[l].v=A.substr(W+1,i[l].v.length)):W<0?i[l].v="":(i[l].v=A.substr(0,W+1),W=-1),i[l].t="t",C=l);W>=0&&C<i.length&&(i[C].v=A.substr(0,W+1)+i[C].v)}else if(R!==i.length&&A.indexOf("E")===-1){for(W=A.indexOf(".")-1,l=R;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(m=i[l].v.indexOf(".")>-1&&l===R?i[l].v.indexOf(".")-1:i[l].v.length-1,ee=i[l].v.substr(m+1);m>=0;--m)W>=0&&(i[l].v.charAt(m)==="0"||i[l].v.charAt(m)==="#")&&(ee=A.charAt(W--)+ee);i[l].v=ee,i[l].t="t",C=l}for(W>=0&&C<i.length&&(i[C].v=A.substr(0,W+1)+i[C].v),W=A.indexOf(".")+1,l=R;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==R)){for(m=i[l].v.indexOf(".")>-1&&l===R?i[l].v.indexOf(".")+1:0,ee=i[l].v.substr(0,m);m<i[l].v.length;++m)W<A.length&&(ee+=A.charAt(W++));i[l].v=ee,i[l].t="t",C=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(X=n>1&&e<0&&l>0&&i[l-1].v==="-"?-e:e,i[l].v=Fs(i[l].t,i[l].v,X),i[l].t="t");var B="";for(l=0;l!==i.length;++l)i[l]!=null&&(B+=i[l].v);return B}var jw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hw(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function y5(r,e){var t=x5(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(jw),u=t[1].match(jw);return Hw(e,l)?[n,t[0]]:Hw(e,u)?[n,t[1]]:[n,t[l!=null&&u!=null?2:1]]}return[n,s]}function Li(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:ot)[r],n==null&&(n=t.table&&t.table[Bw[r]]||ot[Bw[r]]),n==null&&(n=r5[r]||"General");break}if(tp(n,0))return nc(e,t);e instanceof Date&&(e=rI(e,t.date1904));var i=y5(n,e);if(tp(i[1]))return nc(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return v5(i[1],e,t,i[0])}function Za(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(ot[t]==null){e<0&&(e=t);continue}if(ot[t]==r){e=t;break}}e<0&&(e=391)}return ot[e]=r,e}function C0(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Za(r[e],e)}function lf(){ot=t5()}var fI={format:Li,load:Za,_table:ot,load_table:C0,parse_date_code:Vo,is_date:yc,get_table:function(){return fI._table=ot}},E5={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function T5(r){var e=typeof r=="number"?ot[r]:r;return e=e.replace(hI,"(\\d+)"),new RegExp("^"+e+"$")}function w5(r,e,t){var n=-1,i=-1,s=-1,l=-1,u=-1,f=-1;(e.match(hI)||[]).forEach(function(_,v){var y=parseInt(t[v+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":l=y;break;case"s":f=y;break;case"m":l>=0?u=y:i=y;break}}),f>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?d:n==-1&&i==-1&&s==-1?m:d+"T"+m}var S5=(function(){var r={};r.version="1.2.0";function e(){for(var A=0,R=new Array(256),C=0;C!=256;++C)A=C,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,R[C]=A;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function n(A){var R=0,C=0,B=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)N[B]=A[B];for(B=0;B!=256;++B)for(C=A[B],R=256+B;R<4096;R+=256)C=N[R]=C>>>8^A[C&255];var M=[];for(B=1;B!=16;++B)M[B-1]=typeof Int32Array<"u"?N.subarray(B*256,B*256+256):N.slice(B*256,B*256+256);return M}var i=n(t),s=i[0],l=i[1],u=i[2],f=i[3],d=i[4],m=i[5],_=i[6],v=i[7],y=i[8],T=i[9],E=i[10],S=i[11],D=i[12],U=i[13],k=i[14];function W(A,R){for(var C=R^-1,B=0,N=A.length;B<N;)C=C>>>8^t[(C^A.charCodeAt(B++))&255];return~C}function ee(A,R){for(var C=R^-1,B=A.length-15,N=0;N<B;)C=k[A[N++]^C&255]^U[A[N++]^C>>8&255]^D[A[N++]^C>>16&255]^S[A[N++]^C>>>24]^E[A[N++]]^T[A[N++]]^y[A[N++]]^v[A[N++]]^_[A[N++]]^m[A[N++]]^d[A[N++]]^f[A[N++]]^u[A[N++]]^l[A[N++]]^s[A[N++]]^t[A[N++]];for(B+=15;N<B;)C=C>>>8^t[(C^A[N++])&255];return~C}function X(A,R){for(var C=R^-1,B=0,N=A.length,M=0,V=0;B<N;)M=A.charCodeAt(B++),M<128?C=C>>>8^t[(C^M)&255]:M<2048?(C=C>>>8^t[(C^(192|M>>6&31))&255],C=C>>>8^t[(C^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,V=A.charCodeAt(B++)&1023,C=C>>>8^t[(C^(240|M>>8&7))&255],C=C>>>8^t[(C^(128|M>>2&63))&255],C=C>>>8^t[(C^(128|V>>6&15|(M&3)<<4))&255],C=C>>>8^t[(C^(128|V&63))&255]):(C=C>>>8^t[(C^(224|M>>12&15))&255],C=C>>>8^t[(C^(128|M>>6&63))&255],C=C>>>8^t[(C^(128|M&63))&255]);return~C}return r.table=t,r.bstr=W,r.buf=ee,r.str=X,r})(),it=(function(){var e={};e.version="1.2.1";function t(F,K){for(var z=F.split("/"),H=K.split("/"),G=0,Y=0,he=Math.min(z.length,H.length);G<he;++G){if(Y=z[G].length-H[G].length)return Y;if(z[G]!=H[G])return z[G]<H[G]?-1:1}return z.length-H.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var K=F.lastIndexOf("/");return K===-1?F:F.slice(0,K+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var K=F.lastIndexOf("/");return K===-1?F:F.slice(K+1)}function s(F,K){typeof K=="string"&&(K=new Date(K));var z=K.getHours();z=z<<6|K.getMinutes(),z=z<<5|K.getSeconds()>>>1,F.write_shift(2,z);var H=K.getFullYear()-1980;H=H<<4|K.getMonth()+1,H=H<<5|K.getDate(),F.write_shift(2,H)}function l(F){var K=F.read_shift(2)&65535,z=F.read_shift(2)&65535,H=new Date,G=z&31;z>>>=5;var Y=z&15;z>>>=4,H.setMilliseconds(0),H.setFullYear(z+1980),H.setMonth(Y-1),H.setDate(G);var he=K&31;K>>>=5;var Se=K&63;return K>>>=6,H.setHours(K),H.setMinutes(Se),H.setSeconds(he<<1),H}function u(F){Rn(F,0);for(var K={},z=0;F.l<=F.length-4;){var H=F.read_shift(2),G=F.read_shift(2),Y=F.l+G,he={};switch(H){case 21589:z=F.read_shift(1),z&1&&(he.mtime=F.read_shift(4)),G>5&&(z&2&&(he.atime=F.read_shift(4)),z&4&&(he.ctime=F.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}F.l=Y,K[H]=he}return K}var f;function d(){return f||(f={})}function m(F,K){if(F[0]==80&&F[1]==75)return Er(F,K);if((F[0]|32)==109&&(F[1]|32)==105)return ls(F,K);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var z=3,H=512,G=0,Y=0,he=0,Se=0,de=0,ge=[],pe=F.slice(0,512);Rn(pe,0);var Le=_(pe);switch(z=Le[0],z){case 3:H=512;break;case 4:H=4096;break;case 0:if(Le[1]==0)return Er(F,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}H!==512&&(pe=F.slice(0,H),Rn(pe,28));var Be=F.slice(0,H);v(pe,z);var Ge=pe.read_shift(4,"i");if(z===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);pe.l+=4,he=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Se=pe.read_shift(4,"i"),G=pe.read_shift(4,"i"),de=pe.read_shift(4,"i"),Y=pe.read_shift(4,"i");for(var Fe=-1,He=0;He<109&&(Fe=pe.read_shift(4,"i"),!(Fe<0));++He)ge[He]=Fe;var Qe=y(F,H);S(de,Y,Qe,H,ge);var Qt=U(Qe,he,ge,H);Qt[he].name="!Directory",G>0&&Se!==V&&(Qt[Se].name="!MiniFAT"),Qt[ge[0]].name="!FAT",Qt.fat_addrs=ge,Qt.ssz=H;var Jt={},dr=[],On=[],ma=[];k(he,Qt,Qe,dr,G,Jt,On,Se),T(On,ma,dr),dr.shift();var pa={FileIndex:On,FullPaths:ma};return K&&K.raw&&(pa.raw={header:Be,sectors:Qe}),pa}function _(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(xe,"Header Signature: "),F.l+=16;var K=F.read_shift(2,"u");return[F.read_shift(2,"u"),K]}function v(F,K){var z=9;switch(F.l+=2,z=F.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function y(F,K){for(var z=Math.ceil(F.length/K)-1,H=[],G=1;G<z;++G)H[G-1]=F.slice(G*K,(G+1)*K);return H[z-1]=F.slice(z*K),H}function T(F,K,z){for(var H=0,G=0,Y=0,he=0,Se=0,de=z.length,ge=[],pe=[];H<de;++H)ge[H]=pe[H]=H,K[H]=z[H];for(;Se<pe.length;++Se)H=pe[Se],G=F[H].L,Y=F[H].R,he=F[H].C,ge[H]===H&&(G!==-1&&ge[G]!==G&&(ge[H]=ge[G]),Y!==-1&&ge[Y]!==Y&&(ge[H]=ge[Y])),he!==-1&&(ge[he]=H),G!==-1&&H!=ge[H]&&(ge[G]=ge[H],pe.lastIndexOf(G)<Se&&pe.push(G)),Y!==-1&&H!=ge[H]&&(ge[Y]=ge[H],pe.lastIndexOf(Y)<Se&&pe.push(Y));for(H=1;H<de;++H)ge[H]===H&&(Y!==-1&&ge[Y]!==Y?ge[H]=ge[Y]:G!==-1&&ge[G]!==G&&(ge[H]=ge[G]));for(H=1;H<de;++H)if(F[H].type!==0){if(Se=H,Se!=ge[Se])do Se=ge[Se],K[H]=K[Se]+"/"+K[H];while(Se!==0&&ge[Se]!==-1&&Se!=ge[Se]);ge[H]=-1}for(K[0]+="/",H=1;H<de;++H)F[H].type!==2&&(K[H]+="/")}function E(F,K,z){for(var H=F.start,G=F.size,Y=[],he=H;z&&G>0&&he>=0;)Y.push(K.slice(he*M,he*M+M)),G-=M,he=Vl(z,he*4);return Y.length===0?we(0):vn(Y).slice(0,F.size)}function S(F,K,z,H,G){var Y=V;if(F===V){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var he=z[F],Se=(H>>>2)-1;if(!he)return;for(var de=0;de<Se&&(Y=Vl(he,de*4))!==V;++de)G.push(Y);S(Vl(he,H-4),K-1,z,H,G)}}function D(F,K,z,H,G){var Y=[],he=[];G||(G=[]);var Se=H-1,de=0,ge=0;for(de=K;de>=0;){G[de]=!0,Y[Y.length]=de,he.push(F[de]);var pe=z[Math.floor(de*4/H)];if(ge=de*4&Se,H<4+ge)throw new Error("FAT boundary crossed: "+de+" 4 "+H);if(!F[pe])break;de=Vl(F[pe],ge)}return{nodes:Y,data:tS([he])}}function U(F,K,z,H){var G=F.length,Y=[],he=[],Se=[],de=[],ge=H-1,pe=0,Le=0,Be=0,Ge=0;for(pe=0;pe<G;++pe)if(Se=[],Be=pe+K,Be>=G&&(Be-=G),!he[Be]){de=[];var Fe=[];for(Le=Be;Le>=0;){Fe[Le]=!0,he[Le]=!0,Se[Se.length]=Le,de.push(F[Le]);var He=z[Math.floor(Le*4/H)];if(Ge=Le*4&ge,H<4+Ge)throw new Error("FAT boundary crossed: "+Le+" 4 "+H);if(!F[He]||(Le=Vl(F[He],Ge),Fe[Le]))break}Y[Be]={nodes:Se,data:tS([de])}}return Y}function k(F,K,z,H,G,Y,he,Se){for(var de=0,ge=H.length?2:0,pe=K[F].data,Le=0,Be=0,Ge;Le<pe.length;Le+=128){var Fe=pe.slice(Le,Le+128);Rn(Fe,64),Be=Fe.read_shift(2),Ge=Gp(Fe,0,Be-ge),H.push(Ge);var He={name:Ge,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},Qe=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Qe!==0&&(He.ct=W(Fe,Fe.l-8));var Qt=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Qt!==0&&(He.mt=W(Fe,Fe.l-8)),He.start=Fe.read_shift(4,"i"),He.size=Fe.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=V,He.name=""),He.type===5?(de=He.start,G>0&&de!==V&&(K[de].name="!StreamData")):He.size>=4096?(He.storage="fat",K[He.start]===void 0&&(K[He.start]=D(z,He.start,K.fat_addrs,K.ssz)),K[He.start].name=He.name,He.content=K[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:de!==V&&He.start!==V&&K[de]&&(He.content=E(He,K[de].data,(K[Se]||{}).data))),He.content&&Rn(He.content,0),Y[Ge]=He,he.push(He)}}function W(F,K){return new Date((xn(F,K+4)/1e7*Math.pow(2,32)+xn(F,K)/1e7-11644473600)*1e3)}function ee(F,K){return d(),m(f.readFileSync(F),K)}function X(F,K){var z=K&&K.type;switch(z||St&&Buffer.isBuffer(F)&&(z="buffer"),z||"base64"){case"file":return ee(F,K);case"base64":return m(Ci(Mi(F)),K);case"binary":return m(Ci(F),K)}return m(F,K)}function A(F,K){var z=K||{},H=z.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=H+"/",F.FileIndex[0]={name:H,type:5}),z.CLSID&&(F.FileIndex[0].clsid=z.CLSID),R(F)}function R(F){var K="Sh33tJ5";if(!it.find(F,"/"+K)){var z=we(4);z[0]=55,z[1]=z[3]=50,z[2]=54,F.FileIndex.push({name:K,type:2,content:z,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+K),C(F)}}function C(F,K){A(F);for(var z=!1,H=!1,G=F.FullPaths.length-1;G>=0;--G){var Y=F.FileIndex[G];switch(Y.type){case 0:H?z=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(Y.R*Y.L*Y.C)&&(z=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!K)){var he=new Date(1987,1,19),Se=0,de=Object.create?Object.create(null):{},ge=[];for(G=0;G<F.FullPaths.length;++G)de[F.FullPaths[G]]=!0,F.FileIndex[G].type!==0&&ge.push([F.FullPaths[G],F.FileIndex[G]]);for(G=0;G<ge.length;++G){var pe=n(ge[G][0]);H=de[pe],H||(ge.push([pe,{name:i(pe).replace("/",""),type:1,clsid:ne,ct:he,mt:he,content:null}]),de[pe]=!0)}for(ge.sort(function(Ge,Fe){return t(Ge[0],Fe[0])}),F.FullPaths=[],F.FileIndex=[],G=0;G<ge.length;++G)F.FullPaths[G]=ge[G][0],F.FileIndex[G]=ge[G][1];for(G=0;G<ge.length;++G){var Le=F.FileIndex[G],Be=F.FullPaths[G];if(Le.name=i(Be).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||ne,G===0)Le.C=ge.length>1?1:-1,Le.size=0,Le.type=5;else if(Be.slice(-1)=="/"){for(Se=G+1;Se<ge.length&&n(F.FullPaths[Se])!=Be;++Se);for(Le.C=Se>=ge.length?-1:Se,Se=G+1;Se<ge.length&&n(F.FullPaths[Se])!=n(Be);++Se);Le.R=Se>=ge.length?-1:Se,Le.type=1}else n(F.FullPaths[G+1]||"")==n(Be)&&(Le.R=G+1),Le.type=2}}}function B(F,K){var z=K||{};if(z.fileType=="mad")return vf(F,z);switch(C(F),z.fileType){case"zip":return Tr(F,z)}var H=(function(Ge){for(var Fe=0,He=0,Qe=0;Qe<Ge.FileIndex.length;++Qe){var Qt=Ge.FileIndex[Qe];if(Qt.content){var Jt=Qt.content.length;Jt>0&&(Jt<4096?Fe+=Jt+63>>6:He+=Jt+511>>9)}}for(var dr=Ge.FullPaths.length+3>>2,On=Fe+7>>3,ma=Fe+127>>7,pa=On+He+dr+ma,xi=pa+127>>7,Xs=xi<=109?0:Math.ceil((xi-109)/127);pa+xi+Xs+127>>7>xi;)Xs=++xi<=109?0:Math.ceil((xi-109)/127);var Fn=[1,Xs,xi,ma,dr,He,Fe,0];return Ge.FileIndex[0].size=Fe<<6,Fn[7]=(Ge.FileIndex[0].start=Fn[0]+Fn[1]+Fn[2]+Fn[3]+Fn[4]+Fn[5])+(Fn[6]+7>>3),Fn})(F),G=we(H[7]<<9),Y=0,he=0;{for(Y=0;Y<8;++Y)G.write_shift(1,ve[Y]);for(Y=0;Y<8;++Y)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),Y=0;Y<3;++Y)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,H[2]),G.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:V),G.write_shift(4,H[3]),G.write_shift(-4,H[1]?H[0]-1:V),G.write_shift(4,H[1]),Y=0;Y<109;++Y)G.write_shift(-4,Y<H[2]?H[1]+Y:-1)}if(H[1])for(he=0;he<H[1];++he){for(;Y<236+he*127;++Y)G.write_shift(-4,Y<H[2]?H[1]+Y:-1);G.write_shift(-4,he===H[1]-1?V:he+1)}var Se=function(Ge){for(he+=Ge;Y<he-1;++Y)G.write_shift(-4,Y+1);Ge&&(++Y,G.write_shift(-4,V))};for(he=Y=0,he+=H[1];Y<he;++Y)G.write_shift(-4,le.DIFSECT);for(he+=H[2];Y<he;++Y)G.write_shift(-4,le.FATSECT);Se(H[3]),Se(H[4]);for(var de=0,ge=0,pe=F.FileIndex[0];de<F.FileIndex.length;++de)pe=F.FileIndex[de],pe.content&&(ge=pe.content.length,!(ge<4096)&&(pe.start=he,Se(ge+511>>9)));for(Se(H[6]+7>>3);G.l&511;)G.write_shift(-4,le.ENDOFCHAIN);for(he=Y=0,de=0;de<F.FileIndex.length;++de)pe=F.FileIndex[de],pe.content&&(ge=pe.content.length,!(!ge||ge>=4096)&&(pe.start=he,Se(ge+63>>6)));for(;G.l&511;)G.write_shift(-4,le.ENDOFCHAIN);for(Y=0;Y<H[4]<<2;++Y){var Le=F.FullPaths[Y];if(!Le||Le.length===0){for(de=0;de<17;++de)G.write_shift(4,0);for(de=0;de<3;++de)G.write_shift(4,-1);for(de=0;de<12;++de)G.write_shift(4,0);continue}pe=F.FileIndex[Y],Y===0&&(pe.start=pe.size?pe.start-1:V);var Be=Y===0&&z.root||pe.name;if(ge=2*(Be.length+1),G.write_shift(64,Be,"utf16le"),G.write_shift(2,ge),G.write_shift(1,pe.type),G.write_shift(1,pe.color),G.write_shift(-4,pe.L),G.write_shift(-4,pe.R),G.write_shift(-4,pe.C),pe.clsid)G.write_shift(16,pe.clsid,"hex");else for(de=0;de<4;++de)G.write_shift(4,0);G.write_shift(4,pe.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,pe.start),G.write_shift(4,pe.size),G.write_shift(4,0)}for(Y=1;Y<F.FileIndex.length;++Y)if(pe=F.FileIndex[Y],pe.size>=4096)if(G.l=pe.start+1<<9,St&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+511&-512;else{for(de=0;de<pe.size;++de)G.write_shift(1,pe.content[de]);for(;de&511;++de)G.write_shift(1,0)}for(Y=1;Y<F.FileIndex.length;++Y)if(pe=F.FileIndex[Y],pe.size>0&&pe.size<4096)if(St&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+63&-64;else{for(de=0;de<pe.size;++de)G.write_shift(1,pe.content[de]);for(;de&63;++de)G.write_shift(1,0)}if(St)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function N(F,K){var z=F.FullPaths.map(function(de){return de.toUpperCase()}),H=z.map(function(de){var ge=de.split("/");return ge[ge.length-(de.slice(-1)=="/"?2:1)]}),G=!1;K.charCodeAt(0)===47?(G=!0,K=z[0].slice(0,-1)+K):G=K.indexOf("/")!==-1;var Y=K.toUpperCase(),he=G===!0?z.indexOf(Y):H.indexOf(Y);if(he!==-1)return F.FileIndex[he];var Se=!Y.match(Sh);for(Y=Y.replace(Gn,""),Se&&(Y=Y.replace(Sh,"!")),he=0;he<z.length;++he)if((Se?z[he].replace(Sh,"!"):z[he]).replace(Gn,"")==Y||(Se?H[he].replace(Sh,"!"):H[he]).replace(Gn,"")==Y)return F.FileIndex[he];return null}var M=64,V=-2,xe="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:xe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(F,K,z){d();var H=B(F,z);f.writeFileSync(K,H)}function ae(F){for(var K=new Array(F.length),z=0;z<F.length;++z)K[z]=String.fromCharCode(F[z]);return K.join("")}function Me(F,K){var z=B(F,K);switch(K&&K.type||"buffer"){case"file":return d(),f.writeFileSync(K.filename,z),z;case"binary":return typeof z=="string"?z:ae(z);case"base64":return e0(typeof z=="string"?z:ae(z));case"buffer":if(St)return Buffer.isBuffer(z)?z:Hs(z);case"array":return typeof z=="string"?Ci(z):z}return z}var J;function O(F){try{var K=F.InflateRaw,z=new K;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)J=F;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function Q(F,K){if(!J)return ai(F,K);var z=J.InflateRaw,H=new z,G=H._processChunk(F.slice(F.l),H._finishFlushFlag);return F.l+=H.bytesRead,G}function q(F){return J?J.deflateRawSync(F):rt(F)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(F){var K=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(K>>16|K>>8|K)&255}for(var be=typeof Uint8Array<"u",De=be?new Uint8Array(256):[],lt=0;lt<256;++lt)De[lt]=ke(lt);function Z(F,K){var z=De[F&255];return K<=8?z>>>8-K:(z=z<<8|De[F>>8&255],K<=16?z>>>16-K:(z=z<<8|De[F>>16&255],z>>>24-K))}function wt(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=6?0:F[H+1]<<8))>>>z&3}function ut(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=5?0:F[H+1]<<8))>>>z&7}function It(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=4?0:F[H+1]<<8))>>>z&15}function qe(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=3?0:F[H+1]<<8))>>>z&31}function Oe(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=1?0:F[H+1]<<8))>>>z&127}function nt(F,K,z){var H=K&7,G=K>>>3,Y=(1<<z)-1,he=F[G]>>>H;return z<8-H||(he|=F[G+1]<<8-H,z<16-H)||(he|=F[G+2]<<16-H,z<24-H)||(he|=F[G+3]<<24-H),he&Y}function gt(F,K,z){var H=K&7,G=K>>>3;return H<=5?F[G]|=(z&7)<<H:(F[G]|=z<<H&255,F[G+1]=(z&7)>>8-H),K+3}function Lt(F,K,z){var H=K&7,G=K>>>3;return z=(z&1)<<H,F[G]|=z,K+1}function Gr(F,K,z){var H=K&7,G=K>>>3;return z<<=H,F[G]|=z&255,z>>>=8,F[G+1]=z,K+8}function fa(F,K,z){var H=K&7,G=K>>>3;return z<<=H,F[G]|=z&255,z>>>=8,F[G+1]=z&255,F[G+2]=z>>>8,K+16}function Yn(F,K){var z=F.length,H=2*z>K?2*z:K+5,G=0;if(z>=K)return F;if(St){var Y=Mw(H);if(F.copy)F.copy(Y);else for(;G<F.length;++G)Y[G]=F[G];return Y}else if(be){var he=new Uint8Array(H);if(he.set)he.set(F);else for(;G<z;++G)he[G]=F[G];return he}return F.length=H,F}function qt(F){for(var K=new Array(F),z=0;z<F;++z)K[z]=0;return K}function sn(F,K,z){var H=1,G=0,Y=0,he=0,Se=0,de=F.length,ge=be?new Uint16Array(32):qt(32);for(Y=0;Y<32;++Y)ge[Y]=0;for(Y=de;Y<z;++Y)F[Y]=0;de=F.length;var pe=be?new Uint16Array(de):qt(de);for(Y=0;Y<de;++Y)ge[G=F[Y]]++,H<G&&(H=G),pe[Y]=0;for(ge[0]=0,Y=1;Y<=H;++Y)ge[Y+16]=Se=Se+ge[Y-1]<<1;for(Y=0;Y<de;++Y)Se=F[Y],Se!=0&&(pe[Y]=ge[Se+16]++);var Le=0;for(Y=0;Y<de;++Y)if(Le=F[Y],Le!=0)for(Se=Z(pe[Y],H)>>H-Le,he=(1<<H+4-Le)-1;he>=0;--he)K[Se|he<<Le]=Le&15|Y<<4;return H}var Nn=be?new Uint16Array(512):qt(512),gi=be?new Uint16Array(32):qt(32);if(!be){for(var et=0;et<512;++et)Nn[et]=0;for(et=0;et<32;++et)gi[et]=0}(function(){for(var F=[],K=0;K<32;K++)F.push(5);sn(F,gi,32);var z=[];for(K=0;K<=143;K++)z.push(8);for(;K<=255;K++)z.push(9);for(;K<=279;K++)z.push(7);for(;K<=287;K++)z.push(8);sn(z,Nn,288)})();var yt=(function(){for(var K=be?new Uint8Array(32768):[],z=0,H=0;z<Te.length-1;++z)for(;H<Te[z+1];++H)K[H]=z;for(;H<32768;++H)K[H]=29;var G=be?new Uint8Array(259):[];for(z=0,H=0;z<oe.length-1;++z)for(;H<oe[z+1];++H)G[H]=z;function Y(Se,de){for(var ge=0;ge<Se.length;){var pe=Math.min(65535,Se.length-ge),Le=ge+pe==Se.length;for(de.write_shift(1,+Le),de.write_shift(2,pe),de.write_shift(2,~pe&65535);pe-- >0;)de[de.l++]=Se[ge++]}return de.l}function he(Se,de){for(var ge=0,pe=0,Le=be?new Uint16Array(32768):[];pe<Se.length;){var Be=Math.min(65535,Se.length-pe);if(Be<10){for(ge=gt(de,ge,+(pe+Be==Se.length)),ge&7&&(ge+=8-(ge&7)),de.l=ge/8|0,de.write_shift(2,Be),de.write_shift(2,~Be&65535);Be-- >0;)de[de.l++]=Se[pe++];ge=de.l*8;continue}ge=gt(de,ge,+(pe+Be==Se.length)+2);for(var Ge=0;Be-- >0;){var Fe=Se[pe];Ge=(Ge<<5^Fe)&32767;var He=-1,Qe=0;if((He=Le[Ge])&&(He|=pe&-32768,He>pe&&(He-=32768),He<pe))for(;Se[He+Qe]==Se[pe+Qe]&&Qe<250;)++Qe;if(Qe>2){Fe=G[Qe],Fe<=22?ge=Gr(de,ge,De[Fe+1]>>1)-1:(Gr(de,ge,3),ge+=5,Gr(de,ge,De[Fe-23]>>5),ge+=3);var Qt=Fe<8?0:Fe-4>>2;Qt>0&&(fa(de,ge,Qe-oe[Fe]),ge+=Qt),Fe=K[pe-He],ge=Gr(de,ge,De[Fe]>>3),ge-=3;var Jt=Fe<4?0:Fe-2>>1;Jt>0&&(fa(de,ge,pe-He-Te[Fe]),ge+=Jt);for(var dr=0;dr<Qe;++dr)Le[Ge]=pe&32767,Ge=(Ge<<5^Se[pe])&32767,++pe;Be-=Qe-1}else Fe<=143?Fe=Fe+48:ge=Lt(de,ge,1),ge=Gr(de,ge,De[Fe]),Le[Ge]=pe&32767,++pe}ge=Gr(de,ge,0)-1}return de.l=(ge+7)/8|0,de.l}return function(de,ge){return de.length<8?Y(de,ge):he(de,ge)}})();function rt(F){var K=we(50+Math.floor(F.length*1.1)),z=yt(F,K);return K.slice(0,z)}var Kt=be?new Uint16Array(32768):qt(32768),Ir=be?new Uint16Array(32768):qt(32768),kt=be?new Uint16Array(128):qt(128),Vt=1,on=1;function $t(F,K){var z=qe(F,K)+257;K+=5;var H=qe(F,K)+1;K+=5;var G=It(F,K)+4;K+=4;for(var Y=0,he=be?new Uint8Array(19):qt(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,ge=be?new Uint8Array(8):qt(8),pe=be?new Uint8Array(8):qt(8),Le=he.length,Be=0;Be<G;++Be)he[te[Be]]=Y=ut(F,K),de<Y&&(de=Y),ge[Y]++,K+=3;var Ge=0;for(ge[0]=0,Be=1;Be<=de;++Be)pe[Be]=Ge=Ge+ge[Be-1]<<1;for(Be=0;Be<Le;++Be)(Ge=he[Be])!=0&&(Se[Be]=pe[Ge]++);var Fe=0;for(Be=0;Be<Le;++Be)if(Fe=he[Be],Fe!=0){Ge=De[Se[Be]]>>8-Fe;for(var He=(1<<7-Fe)-1;He>=0;--He)kt[Ge|He<<Fe]=Fe&7|Be<<3}var Qe=[];for(de=1;Qe.length<z+H;)switch(Ge=kt[Oe(F,K)],K+=Ge&7,Ge>>>=3){case 16:for(Y=3+wt(F,K),K+=2,Ge=Qe[Qe.length-1];Y-- >0;)Qe.push(Ge);break;case 17:for(Y=3+ut(F,K),K+=3;Y-- >0;)Qe.push(0);break;case 18:for(Y=11+Oe(F,K),K+=7;Y-- >0;)Qe.push(0);break;default:Qe.push(Ge),de<Ge&&(de=Ge);break}var Qt=Qe.slice(0,z),Jt=Qe.slice(z);for(Be=z;Be<286;++Be)Qt[Be]=0;for(Be=H;Be<30;++Be)Jt[Be]=0;return Vt=sn(Qt,Kt,286),on=sn(Jt,Ir,30),K}function Fa(F,K){if(F[0]==3&&!(F[1]&3))return[Xo(K),2];for(var z=0,H=0,G=Mw(K||1<<18),Y=0,he=G.length>>>0,Se=0,de=0;(H&1)==0;){if(H=ut(F,z),z+=3,H>>>1)H>>1==1?(Se=9,de=5):(z=$t(F,z),Se=Vt,de=on);else{z&7&&(z+=8-(z&7));var ge=F[z>>>3]|F[(z>>>3)+1]<<8;if(z+=32,ge>0)for(!K&&he<Y+ge&&(G=Yn(G,Y+ge),he=G.length);ge-- >0;)G[Y++]=F[z>>>3],z+=8;continue}for(;;){!K&&he<Y+32767&&(G=Yn(G,Y+32767),he=G.length);var pe=nt(F,z,Se),Le=H>>>1==1?Nn[pe]:Kt[pe];if(z+=Le&15,Le>>>=4,(Le>>>8&255)===0)G[Y++]=Le;else{if(Le==256)break;Le-=257;var Be=Le<8?0:Le-4>>2;Be>5&&(Be=0);var Ge=Y+oe[Le];Be>0&&(Ge+=nt(F,z,Be),z+=Be),pe=nt(F,z,de),Le=H>>>1==1?gi[pe]:Ir[pe],z+=Le&15,Le>>>=4;var Fe=Le<4?0:Le-2>>1,He=Te[Le];for(Fe>0&&(He+=nt(F,z,Fe),z+=Fe),!K&&he<Ge&&(G=Yn(G,Ge+100),he=G.length);Y<Ge;)G[Y]=G[Y-He],++Y}}}return K?[G,z+7>>>3]:[G.slice(0,Y),z+7>>>3]}function ai(F,K){var z=F.slice(F.l||0),H=Fa(z,K);return F.l+=H[1],H[0]}function ha(F,K){if(F)typeof console<"u"&&console.error(K);else throw new Error(K)}function Er(F,K){var z=F;Rn(z,0);var H=[],G=[],Y={FileIndex:H,FullPaths:G};A(Y,{root:K.root});for(var he=z.length-4;(z[he]!=80||z[he+1]!=75||z[he+2]!=5||z[he+3]!=6)&&he>=0;)--he;z.l=he+4,z.l+=4;var Se=z.read_shift(2);z.l+=6;var de=z.read_shift(4);for(z.l=de,he=0;he<Se;++he){z.l+=20;var ge=z.read_shift(4),pe=z.read_shift(4),Le=z.read_shift(2),Be=z.read_shift(2),Ge=z.read_shift(2);z.l+=8;var Fe=z.read_shift(4),He=u(z.slice(z.l+Le,z.l+Le+Be));z.l+=Le+Be+Ge;var Qe=z.l;z.l=Fe+4,qr(z,ge,pe,Y,He),z.l=Qe}return Y}function qr(F,K,z,H,G){F.l+=2;var Y=F.read_shift(2),he=F.read_shift(2),Se=l(F);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var de=F.read_shift(4),ge=F.read_shift(4),pe=F.read_shift(4),Le=F.read_shift(2),Be=F.read_shift(2),Ge="",Fe=0;Fe<Le;++Fe)Ge+=String.fromCharCode(F[F.l++]);if(Be){var He=u(F.slice(F.l,F.l+Be));(He[21589]||{}).mt&&(Se=He[21589].mt),((G||{})[21589]||{}).mt&&(Se=G[21589].mt)}F.l+=Be;var Qe=F.slice(F.l,F.l+ge);switch(he){case 8:Qe=Q(F,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Qt=!1;Y&8&&(de=F.read_shift(4),de==134695760&&(de=F.read_shift(4),Qt=!0),ge=F.read_shift(4),pe=F.read_shift(4)),ge!=K&&ha(Qt,"Bad compressed size: "+K+" != "+ge),pe!=z&&ha(Qt,"Bad uncompressed size: "+z+" != "+pe),us(H,Ge,Qe,{unsafe:!0,mt:Se})}function Tr(F,K){var z=K||{},H=[],G=[],Y=we(1),he=z.compression?8:0,Se=0,de=0,ge=0,pe=0,Le=0,Be=F.FullPaths[0],Ge=Be,Fe=F.FileIndex[0],He=[],Qe=0;for(de=1;de<F.FullPaths.length;++de)if(Ge=F.FullPaths[de].slice(Be.length),Fe=F.FileIndex[de],!(!Fe.size||!Fe.content||Ge=="Sh33tJ5")){var Qt=pe,Jt=we(Ge.length);for(ge=0;ge<Ge.length;++ge)Jt.write_shift(1,Ge.charCodeAt(ge)&127);Jt=Jt.slice(0,Jt.l),He[Le]=S5.buf(Fe.content,0);var dr=Fe.content;he==8&&(dr=q(dr)),Y=we(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,Se),Y.write_shift(2,he),Fe.mt?s(Y,Fe.mt):Y.write_shift(4,0),Y.write_shift(-4,He[Le]),Y.write_shift(4,dr.length),Y.write_shift(4,Fe.content.length),Y.write_shift(2,Jt.length),Y.write_shift(2,0),pe+=Y.length,H.push(Y),pe+=Jt.length,H.push(Jt),pe+=dr.length,H.push(dr),Y=we(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,Se),Y.write_shift(2,he),Y.write_shift(4,0),Y.write_shift(-4,He[Le]),Y.write_shift(4,dr.length),Y.write_shift(4,Fe.content.length),Y.write_shift(2,Jt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,Qt),Qe+=Y.l,G.push(Y),Qe+=Jt.length,G.push(Jt),++Le}return Y=we(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Le),Y.write_shift(2,Le),Y.write_shift(4,Qe),Y.write_shift(4,pe),Y.write_shift(2,0),vn([vn(H),vn(G),Y])}var $n={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Bi(F,K){if(F.ctype)return F.ctype;var z=F.name||"",H=z.match(/\.([^\.]+)$/);return H&&$n[H[1]]||K&&(H=(z=K).match(/[\.\\]([^\.\\])+$/),H&&$n[H[1]])?$n[H[1]]:"application/octet-stream"}function _i(F){for(var K=e0(F),z=[],H=0;H<K.length;H+=76)z.push(K.slice(H,H+76));return z.join(`\r
`)+`\r
`}function xf(F){var K=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var pe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],H=K.split(`\r
`),G=0;G<H.length;++G){var Y=H[G];if(Y.length==0){z.push("");continue}for(var he=0;he<Y.length;){var Se=76,de=Y.slice(he,he+Se);de.charAt(Se-1)=="="?Se--:de.charAt(Se-2)=="="?Se-=2:de.charAt(Se-3)=="="&&(Se-=3),de=Y.slice(he,he+Se),he+=Se,he<Y.length&&(de+="="),z.push(de)}}return z.join(`\r
`)}function Dc(F){for(var K=[],z=0;z<F.length;++z){for(var H=F[z];z<=F.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+F[++z];K.push(H)}for(var G=0;G<K.length;++G)K[G]=K[G].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Ci(K.join(`\r
`))}function Ui(F,K,z){for(var H="",G="",Y="",he,Se=0;Se<10;++Se){var de=K[Se];if(!de||de.match(/^\s*$/))break;var ge=de.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":H=ge[2].trim();break;case"content-type":Y=ge[2].trim();break;case"content-transfer-encoding":G=ge[2].trim();break}}switch(++Se,G.toLowerCase()){case"base64":he=Ci(Mi(K.slice(Se).join("")));break;case"quoted-printable":he=Dc(K.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var pe=us(F,H.slice(z.length),he,{unsafe:!0});Y&&(pe.ctype=Y)}function ls(F,K){if(ae(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=K&&K.root||"",H=(St&&Buffer.isBuffer(F)?F.toString("binary"):ae(F)).split(`\r
`),G=0,Y="";for(G=0;G<H.length;++G)if(Y=H[G],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),z||(z=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),Y.slice(0,z.length)!=z););var he=(H[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Se="--"+(he[1]||""),de=[],ge=[],pe={FileIndex:de,FullPaths:ge};A(pe);var Le,Be=0;for(G=0;G<H.length;++G){var Ge=H[G];Ge!==Se&&Ge!==Se+"--"||(Be++&&Ui(pe,H.slice(Le,G),z),Le=G)}return pe}function vf(F,K){var z=K||{},H=z.boundary||"SheetJS";H="------="+H;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],Y=F.FullPaths[0],he=Y,Se=F.FileIndex[0],de=1;de<F.FullPaths.length;++de)if(he=F.FullPaths[de].slice(Y.length),Se=F.FileIndex[de],!(!Se.size||!Se.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var ge=Se.content,pe=St&&Buffer.isBuffer(ge)?ge.toString("binary"):ae(ge),Le=0,Be=Math.min(1024,pe.length),Ge=0,Fe=0;Fe<=Be;++Fe)(Ge=pe.charCodeAt(Fe))>=32&&Ge<128&&++Le;var He=Le>=Be*4/5;G.push(H),G.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+he),G.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),G.push("Content-Type: "+Bi(Se,he)),G.push(""),G.push(He?xf(pe):_i(pe))}return G.push(H+`--\r
`),G.join(`\r
`)}function cs(F){var K={};return A(K,F),K}function us(F,K,z,H){var G=H&&H.unsafe;G||A(F);var Y=!G&&it.find(F,K);if(!Y){var he=F.FullPaths[0];K.slice(0,he.length)==he?he=K:(he.slice(-1)!="/"&&(he+="/"),he=(he+K).replace("//","/")),Y={name:i(K),type:2},F.FileIndex.push(Y),F.FullPaths.push(he),G||it.utils.cfb_gc(F)}return Y.content=z,Y.size=z?z.length:0,H&&(H.CLSID&&(Y.clsid=H.CLSID),H.mt&&(Y.mt=H.mt),H.ct&&(Y.ct=H.ct)),Y}function cl(F,K){A(F);var z=it.find(F,K);if(z){for(var H=0;H<F.FileIndex.length;++H)if(F.FileIndex[H]==z)return F.FileIndex.splice(H,1),F.FullPaths.splice(H,1),!0}return!1}function fs(F,K,z){A(F);var H=it.find(F,K);if(H){for(var G=0;G<F.FileIndex.length;++G)if(F.FileIndex[G]==H)return F.FileIndex[G].name=i(z),F.FullPaths[G]=z,!0}return!1}function da(F){C(F,!0)}return e.find=N,e.read=X,e.parse=m,e.write=Me,e.writeFile=Pe,e.utils={cfb_new:cs,cfb_add:us,cfb_del:cl,cfb_mov:fs,cfb_gc:da,ReadShift:Nh,CheckField:RI,prep_blob:Rn,bconcat:vn,use_zlib:O,_deflateRaw:rt,_inflateRaw:ai,consts:le},e})();let Uo;function A5(r){Uo=r}function b5(r){return typeof r=="string"?k0(r):Array.isArray(r)?QN(r):r}function R0(r,e,t){if(typeof Uo<"u"&&Uo.writeFileSync)return t?Uo.writeFileSync(r,e,t):Uo.writeFileSync(r,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=k0(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?$a(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([b5(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=r,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(r);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=nl(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+r)}function I5(r){if(typeof Uo<"u")return Uo.readFileSync(r);if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Vr(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function Gw(r,e){for(var t=[],n=Vr(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function zp(r){for(var e=[],t=Vr(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function jp(r){for(var e=[],t=Vr(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function k5(r){for(var e=[],t=Vr(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var np=new Date(1899,11,30,0,0,0);function un(r,e){var t=r.getTime(),n=np.getTime()+(r.getTimezoneOffset()-np.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var dI=new Date,C5=np.getTime()+(dI.getTimezoneOffset()-np.getTimezoneOffset())*6e4,qw=dI.getTimezoneOffset();function Hp(r){var e=new Date;return e.setTime(r*24*60*60*1e3+C5),e.getTimezoneOffset()!==qw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-qw)*6e4),e}function R5(r){var e=0,t=0,n=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(i[s],10)}return e}var Kw=new Date("2017-02-19T19:06:09.000Z"),mI=isNaN(Kw.getFullYear())?new Date("2/19/17"):Kw,D5=mI.getFullYear()==2017;function yr(r,e){var t=new Date(r);if(D5)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(mI.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ic(r,e){if(St&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return $a(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return $a(eI(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return $a(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return $a(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function pr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=pr(r[t]));return e}function Or(r,e){for(var t="";t.length<e;)t+=r;return t}function Ca(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var N5=["january","february","march","april","may","june","july","august","september","october","november","december"];function Hu(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var l=r.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&N5.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var O5=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),l=[s[0]],u=1;u<s.length;++u)l.push(i),l.push(s[u]);return l}})();function pI(r){return r?r.content&&r.type?ic(r.content,!0):r.data?Du(r.data):r.asNodeBuffer&&St?Du(r.asNodeBuffer().toString("binary")):r.asBinary?Du(r.asBinary()):r._data&&r._data.getContent?Du(ic(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function gI(r){if(!r)return null;if(r.data)return Zm(r.data);if(r.asNodeBuffer&&St)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?Zm(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function F5(r){return r&&r.name.slice(-4)===".bin"?gI(r):pI(r)}function ra(r,e){for(var t=r.FullPaths||Vr(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var l=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function lv(r,e){var t=ra(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Zr(r,e,t){if(!t)return F5(lv(r,e));if(!e)return null;try{return Zr(r,e)}catch{return null}}function Ri(r,e,t){if(!t)return pI(lv(r,e));if(!e)return null;try{return Ri(r,e)}catch{return null}}function P5(r,e,t){return gI(lv(r,e))}function Ww(r){for(var e=r.FullPaths||Vr(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Tt(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return St?n=Hs(t):n=JN(t),it.utils.cfb_add(r,e,n)}it.utils.cfb_add(r,e,t)}else r.file(e,t)}function cv(){return it.utils.cfb_new()}function _I(r,e){switch(e.type){case"base64":return it.read(r,{type:"base64"});case"binary":return it.read(r,{type:"binary"});case"buffer":case"array":return it.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ah(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var Hr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,M5=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Xw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,L5=/<[^>]*>/g,Xn=Hr.match(Xw)?Xw:L5,V5=/<\w*:/,B5=/<(\/?)\w+:/;function ht(r,e,t){for(var n={},i=0,s=0;i!==r.length&&!((s=r.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=r.slice(0,i)),i===r.length)return n;var l=r.match(M5),u=0,f="",d=0,m="",_="",v=1;if(l)for(d=0;d!=l.length;++d){for(_=l[d],s=0;s!=_.length&&_.charCodeAt(s)!==61;++s);for(m=_.slice(0,s).trim();_.charCodeAt(s+1)==32;)++s;for(v=(i=_.charCodeAt(s+1))==34||i==39?1:0,f=_.slice(s+1+v,_.length-v),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var y=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[y]&&m.slice(u-3,u)=="ext")continue;n[y]=f,n[y.toLowerCase()]=f}}return n}function as(r){return r.replace(B5,"<$1")}var xI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uv=zp(xI),zt=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(r,function(u,f){return xI[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,l)+t(i.slice(l+3))}})(),fv=/[&<>'"]/g,U5=/[\u0000-\u0008\u000b-\u001f]/g;function ar(r){var e=r+"";return e.replace(fv,function(t){return uv[t]}).replace(U5,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Yw(r){return ar(r).replace(/ /g,"_x0020_")}var vI=/[\u0000-\u001f]/g;function hv(r){var e=r+"";return e.replace(fv,function(t){return uv[t]}).replace(/\n/g,"<br/>").replace(vI,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function z5(r){var e=r+"";return e.replace(fv,function(t){return uv[t]}).replace(vI,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var $w=(function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}})();function j5(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function xr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function I_(r){for(var e="",t=0,n=0,i=0,s=0,l=0,u=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){l=(n&31)<<6,l|=i&63,e+=String.fromCharCode(l);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}l=r.charCodeAt(t++),u=((n&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function Qw(r){var e=Xo(2*r.length),t,n,i=1,s=0,l=0,u;for(n=0;n<r.length;n+=i)i=1,(u=r.charCodeAt(n))<128?t=u:u<224?(t=(u&31)*64+(r.charCodeAt(n+1)&63),i=2):u<240?(t=(u&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(u&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function Jw(r){return Hs(r,"binary").toString("utf8")}var _m="foo bar baz",fr=St&&(Jw(_m)==I_(_m)&&Jw||Qw(_m)==I_(_m)&&Qw)||I_,$a=St?function(r){return Hs(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},r0=(function(){var r={};return function(t,n){var i=t+"|"+(n||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),yI=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}})(),H5=(function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),G5=/<\/?(?:vt:)?variant>/g,q5=/<(?:vt:)([^>]*)>([\s\S]*)</;function Zw(r,e){var t=ht(r),n=r.match(H5(t.baseType))||[],i=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var l=s.replace(G5,"").match(q5);l&&i.push({v:fr(l[2]),t:l[1]})}),i}var EI=/(^\s|\s$|\n)/;function Dn(r,e){return"<"+r+(e.match(EI)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function n0(r){return Vr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Ue(r,e,t){return"<"+r+(t!=null?n0(t):"")+(e!=null?(e.match(EI)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function fx(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function K5(r,e){switch(typeof r){case"string":var t=Ue("vt:lpwstr",ar(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ue((r|0)==r?"vt:i4":"vt:r8",ar(String(r)));case"boolean":return Ue("vt:bool",r?"true":"false")}if(r instanceof Date)return Ue("vt:filetime",fx(r));throw new Error("Unable to serialize "+r)}function dv(r){if(St&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return fr(nl(av(r)));throw new Error("Bad input format: expected Buffer or string")}var i0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,cn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ec=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ki={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function W5(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function X5(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,l=n?-e:e;isFinite(l)?l==0?i=s=0:(i=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var u=0;u<=5;++u,s/=256)r[t+u]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var eS=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},tS=St?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Hs(e)})):eS(r)}:eS,rS=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(Rs(r,i)));return n.join("").replace(Gn,"")},Gp=St?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Gn,""):rS(r,e,t)}:rS,nS=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},TI=St?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):nS(r,e,t)}:nS,iS=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(Su(r,i)));return n.join("")},cf=St?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):iS(e,t,n)}:iS,wI=function(r,e){var t=xn(r,e);return t>0?cf(r,e+4,e+4+t-1):""},mv=wI,SI=function(r,e){var t=xn(r,e);return t>0?cf(r,e+4,e+4+t-1):""},pv=SI,AI=function(r,e){var t=2*xn(r,e);return t>0?cf(r,e+4,e+4+t-1):""},gv=AI,bI=function(e,t){var n=xn(e,t);return n>0?Gp(e,t+4,t+4+n):""},_v=bI,II=function(r,e){var t=xn(r,e);return t>0?cf(r,e+4,e+4+t):""},xv=II,kI=function(r,e){return W5(r,e)},ip=kI,vv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};St&&(mv=function(e,t){if(!Buffer.isBuffer(e))return wI(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},pv=function(e,t){if(!Buffer.isBuffer(e))return SI(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},gv=function(e,t){if(!Buffer.isBuffer(e))return AI(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},_v=function(e,t){if(!Buffer.isBuffer(e))return bI(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},xv=function(e,t){if(!Buffer.isBuffer(e))return II(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},ip=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):kI(e,t)},vv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function CI(){Gp=function(r,e,t){return Ut.utils.decode(1200,r.slice(e,t)).replace(Gn,"")},cf=function(r,e,t){return Ut.utils.decode(65001,r.slice(e,t))},mv=function(r,e){var t=xn(r,e);return t>0?Ut.utils.decode(rc,r.slice(e+4,e+4+t-1)):""},pv=function(r,e){var t=xn(r,e);return t>0?Ut.utils.decode(Ni,r.slice(e+4,e+4+t-1)):""},gv=function(r,e){var t=2*xn(r,e);return t>0?Ut.utils.decode(1200,r.slice(e+4,e+4+t-1)):""},_v=function(r,e){var t=xn(r,e);return t>0?Ut.utils.decode(1200,r.slice(e+4,e+4+t)):""},xv=function(r,e){var t=xn(r,e);return t>0?Ut.utils.decode(65001,r.slice(e+4,e+4+t)):""}}typeof Ut<"u"&&CI();var Su=function(r,e){return r[e]},Rs=function(r,e){return r[e+1]*256+r[e]},Y5=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},xn=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Vl=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},$5=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Nh(r,e){var t="",n,i,s=[],l,u,f,d;switch(e){case"dbcs":if(d=this.l,St&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(f=0;f<r;++f)t+=String.fromCharCode(Rs(this,d)),d+=2;r*=2;break;case"utf8":t=cf(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Gp(this,this.l,this.l+r);break;case"wstr":if(typeof Ut<"u")t=Ut.utils.decode(Ni,this.slice(this.l,this.l+2*r));else return Nh.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":t=mv(this,this.l),r=4+xn(this,this.l);break;case"lpstr-cp":t=pv(this,this.l),r=4+xn(this,this.l);break;case"lpwstr":t=gv(this,this.l),r=4+2*xn(this,this.l);break;case"lpp4":r=4+xn(this,this.l),t=_v(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+xn(this,this.l),t=xv(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(l=Su(this,this.l+r++))!==0;)s.push(wh(l));t=s.join("");break;case"_wstr":for(r=0,t="";(l=Rs(this,this.l+r))!==0;)s.push(wh(l)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",d=this.l,f=0;f<r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Su(this,d),this.l=d+1,u=Nh.call(this,r-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(wh(Rs(this,d))),d+=2}t=s.join(""),r*=2;break;case"cpstr":if(typeof Ut<"u"){t=Ut.utils.decode(Ni,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(t="",d=this.l,f=0;f!=r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Su(this,d),this.l=d+1,u=Nh.call(this,r-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(wh(Su(this,d))),d+=1}t=s.join("");break;default:switch(r){case 1:return n=Su(this,this.l),this.l++,n;case 2:return n=(e==="i"?Y5:Rs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(r>0?Vl:$5)(this,this.l),this.l+=4,n):(i=xn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=ip(this,this.l):i=ip([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=TI(this,this.l,r);break}}return this.l+=r,t}var Q5=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},J5=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},Z5=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function eO(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)Z5(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){if(typeof Ut<"u"&&rc==874)for(i=0;i!=e.length;++i){var s=Ut.utils.encode(rc,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var u=e.charCodeAt(i);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Q5(this,e,this.l);break;case 8:if(n=8,t==="f"){X5(this,e,this.l);break}case 16:break;case-4:n=4,J5(this,e,this.l);break}return this.l+=n,this}function RI(r,e){var t=TI(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Rn(r,e){r.l=e,r.read_shift=Nh,r.chk=RI,r.write_shift=eO}function Wn(r,e){r.l+=e}function we(r){var e=Xo(r);return Rn(e,0),e}function Gs(r,e,t){if(r){var n,i,s;Rn(r,r.l||0);for(var l=r.length,u=0,f=0;r.l<l;){u=r.read_shift(1),u&128&&(u=(u&127)+((r.read_shift(1)&127)<<7));var d=u0[u]||u0[65535];for(n=r.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=r.read_shift(1))&127)<<7*i;f=r.l+s;var m=d.f&&d.f(r,s,t);if(r.l=f,e(m,d,u))return}}}function pi(){var r=[],e=St?256:2048,t=function(d){var m=we(d);return Rn(m,0),m},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(i(),n=t(Math.max(d+1,e)))},l=function(){return i(),vn(r)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:u,end:l,_bufs:r}}function Ne(r,e,t,n){var i=+e,s;if(!isNaN(i)){n||(n=u0[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=r.next(s);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&vv(t)&&r.push(t)}}function Oh(r,e,t){var n=pr(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function aS(r,e,t){var n=pr(r);return n.s=Oh(n.s,e.s,t),n.e=Oh(n.e,e.s,t),n}function Fh(r,e){if(r.cRel&&r.c<0)for(r=pr(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=pr(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=ft(r);return!r.cRel&&r.cRel!=null&&(t=nO(t)),!r.rRel&&r.rRel!=null&&(t=tO(t)),t}function k_(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+vr(r.s.c)+":"+(r.e.cRel?"":"$")+vr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Mr(r.s.r)+":"+(r.e.rRel?"":"$")+Mr(r.e.r):Fh(r.s,e.biff)+":"+Fh(r.e,e.biff)}function yv(r){return parseInt(rO(r),10)-1}function Mr(r){return""+(r+1)}function tO(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function rO(r){return r.replace(/\$(\d+)$/,"$1")}function Ev(r){for(var e=iO(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function vr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function nO(r){return r.replace(/^([A-Z])/,"$$$1")}function iO(r){return r.replace(/^\$([A-Z])/,"$1")}function aO(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Cr(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function ft(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function ii(r){var e=r.indexOf(":");return e==-1?{s:Cr(r),e:Cr(r)}:{s:Cr(r.slice(0,e)),e:Cr(r.slice(e+1))}}function vt(r,e){return typeof e>"u"||typeof e=="number"?vt(r.s,r.e):(typeof r!="string"&&(r=ft(r)),typeof e!="string"&&(e=ft(e)),r==e?r:r+":"+e)}function Ft(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function sS(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Li(r.z,t?un(e):e)}catch{}try{return r.w=Li((r.XF||{}).numFmtId||(t?14:0),t?un(e):e)}catch{return""+e}}function rs(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?qs[r.v]||r.v:e==null?sS(r,r.v):sS(r,e))}function il(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function DI(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),l=0,u=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Cr(n.origin):n.origin;l=f.r,u=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=Ft(s["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var _=0;_!=e.length;++_)if(e[_]){if(!Array.isArray(e[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[_].length;++v)if(!(typeof e[_][v]>"u")){var y={v:e[_][v]},T=l+_,E=u+v;if(d.s.r>T&&(d.s.r=T),d.s.c>E&&(d.s.c=E),d.e.r<T&&(d.e.r=T),d.e.c<E&&(d.e.c=E),e[_][v]&&typeof e[_][v]=="object"&&!Array.isArray(e[_][v])&&!(e[_][v]instanceof Date))y=e[_][v];else if(Array.isArray(y.v)&&(y.f=e[_][v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||ot[14],n.cellDates?(y.t="d",y.w=Li(y.z,un(y.v))):(y.t="n",y.v=un(y.v),y.w=Li(y.z,y.v))):y.t="s";if(i)s[T]||(s[T]=[]),s[T][E]&&s[T][E].z&&(y.z=s[T][E].z),s[T][E]=y;else{var S=ft({c:E,r:T});s[S]&&s[S].z&&(y.z=s[S].z),s[S]=y}}}return d.s.c<1e7&&(s["!ref"]=vt(d)),s}function uf(r,e){return DI(null,r,e)}function sO(r){return r.read_shift(4,"i")}function Ra(r,e){return e||(e=we(4)),e.write_shift(4,r),e}function qn(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function yn(r,e){var t=!1;return e==null&&(t=!0,e=we(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function oO(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function lO(r,e){return e||(e=we(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Tv(r,e){var t=r.l,n=r.read_shift(1),i=qn(r),s=[],l={t:i,h:i};if((n&1)!==0){for(var u=r.read_shift(4),f=0;f!=u;++f)s.push(oO(r));l.r=s}else l.r=[{ich:0,ifnt:0}];return r.l=t+e,l}function cO(r,e){var t=!1;return e==null&&(t=!0,e=we(15+4*r.t.length)),e.write_shift(1,0),yn(r.t,e),t?e.slice(0,e.l):e}var uO=Tv;function fO(r,e){var t=!1;return e==null&&(t=!0,e=we(23+4*r.t.length)),e.write_shift(1,1),yn(r.t,e),e.write_shift(4,1),lO({},e),t?e.slice(0,e.l):e}function ua(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Tc(r,e){return e==null&&(e=we(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function wc(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Sc(r,e){return e==null&&(e=we(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var hO=qn,NI=yn;function wv(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function ap(r,e){var t=!1;return e==null&&(t=!0,e=we(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var dO=qn,hx=wv,Sv=ap;function Av(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?ip([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Vl(e,0)>>2;return t?i/100:i}function OI(r,e){e==null&&(e=we(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function FI(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function mO(r,e){return e||(e=we(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Ac=FI,ff=mO;function jn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ac(r,e){return(e||we(8)).write_shift(8,r,"f")}function pO(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),l=r.read_shift(1),u=r.read_shift(1),f=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=ql[i];d&&(e.rgb=s0(d));break;case 2:e.rgb=s0([l,u,f]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function sp(r,e){if(e||(e=we(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function gO(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function _O(r,e){e||(e=we(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function PI(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function xO(r){return PI(r,1)}function vO(r){return PI(r,2)}var bv=2,di=3,xm=11,oS=12,op=19,vm=64,yO=65,EO=71,TO=4108,wO=4126,pn=80,MI=81,SO=[pn,MI],dx={1:{n:"CodePage",t:bv},2:{n:"Category",t:pn},3:{n:"PresentationFormat",t:pn},4:{n:"ByteCount",t:di},5:{n:"LineCount",t:di},6:{n:"ParagraphCount",t:di},7:{n:"SlideCount",t:di},8:{n:"NoteCount",t:di},9:{n:"HiddenCount",t:di},10:{n:"MultimediaClipCount",t:di},11:{n:"ScaleCrop",t:xm},12:{n:"HeadingPairs",t:TO},13:{n:"TitlesOfParts",t:wO},14:{n:"Manager",t:pn},15:{n:"Company",t:pn},16:{n:"LinksUpToDate",t:xm},17:{n:"CharacterCount",t:di},19:{n:"SharedDoc",t:xm},22:{n:"HyperlinksChanged",t:xm},23:{n:"AppVersion",t:di,p:"version"},24:{n:"DigSig",t:yO},26:{n:"ContentType",t:pn},27:{n:"ContentStatus",t:pn},28:{n:"Language",t:pn},29:{n:"Version",t:pn},255:{},2147483648:{n:"Locale",t:op},2147483651:{n:"Behavior",t:op},1919054434:{}},mx={1:{n:"CodePage",t:bv},2:{n:"Title",t:pn},3:{n:"Subject",t:pn},4:{n:"Author",t:pn},5:{n:"Keywords",t:pn},6:{n:"Comments",t:pn},7:{n:"Template",t:pn},8:{n:"LastAuthor",t:pn},9:{n:"RevNumber",t:pn},10:{n:"EditTime",t:vm},11:{n:"LastPrinted",t:vm},12:{n:"CreatedDate",t:vm},13:{n:"ModifiedDate",t:vm},14:{n:"PageCount",t:di},15:{n:"WordCount",t:di},16:{n:"CharCount",t:di},17:{n:"Thumbnail",t:EO},18:{n:"Application",t:pn},19:{n:"DocSecurity",t:di},255:{},2147483648:{n:"Locale",t:op},2147483651:{n:"Behavior",t:op},1919054434:{}},lS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function bO(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var IO=bO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ql=pr(IO),qs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},LI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},px={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ym={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Iv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function kO(r){var e=Iv();if(!r||!r.match)return e;var t={};if((r.match(Xn)||[]).forEach(function(n){var i=ht(n);switch(i[0].replace(V5,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[px[i.ContentType]]!==void 0&&e[px[i.ContentType]].push(i.PartName);break}}),e.xmlns!==cn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function VI(r,e){var t=k5(px),n=[],i;n[n.length]=Hr,n[n.length]=Ue("Types",null,{xmlns:cn.CT,"xmlns:xsd":cn.xsd,"xmlns:xsi":cn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ue("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){r[f]&&r[f].length>0&&(i=r[f][0],n[n.length]=Ue("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ym[f][e.bookType]||ym[f].xlsx}))},l=function(f){(r[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:ym[f][e.bookType]||ym[f].xlsx})})},u=function(f){(r[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:t[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function a0(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Ph(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(Xn)||[]).forEach(function(i){var s=ht(i);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:Ah(s.Target,e);t[u]=l,n[s.Id]=l}}),t["!id"]=n,t}function Pu(r){var e=[Hr,Ue("Relationships",null,{xmlns:cn.RELS})];return Vr(r["!id"]).forEach(function(t){e[e.length]=Ue("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function nr(r,e,t,n,i,s){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}var CO="application/vnd.oasis.opendocument.spreadsheet";function RO(r,e){for(var t=dv(r),n,i;n=i0.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ht(n[0],!1),i.path=="/"&&i.type!==CO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function DO(r){var e=[Hr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function cS(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function NO(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function OO(r){var e=[Hr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(cS(r[t][0],r[t][1])),e.push(NO("",r[t][0]));return e.push(cS("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function BI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zh.version+"</meta:generator></office:meta></office:document-meta>"}var oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],FO=(function(){for(var r=new Array(oa.length),e=0;e<oa.length;++e){var t=oa[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r})();function UI(r){var e={};r=fr(r);for(var t=0;t<oa.length;++t){var n=oa[t],i=r.match(FO[t]);i!=null&&i.length>0&&(e[n[1]]=zt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=yr(e[n[1]]))}return e}function C_(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=ar(e),n[n.length]=t?Ue(r,e,t):Dn(r,e))}function zI(r,e){var t=e||{},n=[Hr,Ue("cp:coreProperties",null,{"xmlns:cp":cn.CORE_PROPS,"xmlns:dc":cn.dc,"xmlns:dcterms":cn.dcterms,"xmlns:dcmitype":cn.dcmitype,"xmlns:xsi":cn.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&C_("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:fx(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&C_("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:fx(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=oa.length;++s){var l=oa[s],u=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:r?r[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&C_(l[0],u,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Kl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function HI(r,e,t,n){var i=[];if(typeof r=="string")i=Zw(r,n);else for(var s=0;s<r.length;++s)i=i.concat(r[s].map(function(m){return{v:m}}));var l=typeof e=="string"?Zw(e,n).map(function(m){return m.v}):e,u=0,f=0;if(l.length>0)for(var d=0;d!==i.length;d+=2){switch(f=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(u,u+f);break}u+=f}}function PO(r,e,t){var n={};return e||(e={}),r=fr(r),Kl.forEach(function(i){var s=(r.match(r0(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=zt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var l=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&HI(n.HeadingPairs,n.TitlesOfParts,e,t),e}function GI(r){var e=[],t=Ue;return r||(r={}),r.Application="SheetJS",e[e.length]=Hr,e[e.length]=Ue("Properties",null,{xmlns:cn.EXT_PROPS,"xmlns:vt":cn.vt}),Kl.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ar(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+ar(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var MO=/<[^>]+>[^<]*/g;function LO(r,e){var t={},n="",i=r.match(MO);if(i)for(var s=0;s!=i.length;++s){var l=i[s],u=ht(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=zt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[n]=zt(m);break;case"bool":t[n]=xr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(m);break;case"filetime":case"date":t[n]=yr(m);break;case"cy":case"error":t[n]=zt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return t}function qI(r){var e=[Hr,Ue("Properties",null,{xmlns:cn.CUST_PROPS,"xmlns:vt":cn.vt})];if(!r)return e.join("");var t=1;return Vr(r).forEach(function(i){++t,e[e.length]=Ue("property",K5(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:ar(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var gx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},R_;function VO(r,e,t){R_||(R_=zp(gx)),e=R_[e]||e,r[e]=t}function BO(r,e){var t=[];return Vr(gx).map(function(n){for(var i=0;i<oa.length;++i)if(oa[i][1]==n)return oa[i];for(i=0;i<Kl.length;++i)if(Kl[i][1]==n)return Kl[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Dn(gx[n[1]]||n[1],i))}}),Ue("DocumentProperties",t.join(""),{xmlns:ki.o})}function UO(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Vr(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var l=0;l<oa.length;++l)if(s==oa[l][1])return;for(l=0;l<Kl.length;++l)if(s==Kl[l][1])return;for(l=0;l<t.length;++l)if(s==t[l])return;var u=r[s],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),i.push(Ue(Yw(s),u,{"dt:dt":f}))}}),e&&Vr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var l=e[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),i.push(Ue(Yw(s),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+ki.o+'">'+i.join("")+"</"+n+">"}function kv(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zO(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var l=we(8);return l.write_shift(4,n),l.write_shift(4,i),l}function KI(r,e,t){var n=r.l,i=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return i}function WI(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function XI(r,e,t){return e===31?WI(r):KI(r,e,t)}function _x(r,e,t){return XI(r,e,t===!1?0:4)}function jO(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return XI(r,e,0)}function HO(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var i=r.l;t[n]=r.read_shift(0,"lpwstr").replace(Gn,""),r.l-i&2&&(r.l+=2)}return t}function GO(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(Gn,"");return t}function qO(r){var e=r.l,t=lp(r,MI);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=lp(r,di);return[t,n]}function KO(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(qO(r));return t}function uS(r,e){for(var t=r.read_shift(4),n={},i=0;i!=t;++i){var s=r.read_shift(4),l=r.read_shift(4);n[s]=r.read_shift(l,e===1200?"utf16le":"utf8").replace(Gn,"").replace(Sh,"!"),e===1200&&l%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function YI(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function WO(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function lp(r,e,t){var n=r.read_shift(2),i,s=t||{};if(r.l+=2,e!==oS&&n!==e&&SO.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===oS?n:e){case 2:return i=r.read_shift(2,"i"),s.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return KI(r,n,4).replace(Gn,"");case 31:return WI(r);case 64:return kv(r);case 65:return YI(r);case 71:return WO(r);case 80:return _x(r,n,!s.raw).replace(Gn,"");case 81:return jO(r,n).replace(Gn,"");case 4108:return KO(r);case 4126:case 4127:return n==4127?HO(r):GO(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function fS(r,e){var t=we(4),n=we(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=we(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=zO(e);break;case 31:case 80:for(n=we(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return vn([t,n])}function hS(r,e){var t=r.l,n=r.read_shift(4),i=r.read_shift(4),s=[],l=0,u=0,f=-1,d={};for(l=0;l!=i;++l){var m=r.read_shift(4),_=r.read_shift(4);s[l]=[m,_+t]}s.sort(function(U,k){return U[1]-k[1]});var v={};for(l=0;l!=i;++l){if(r.l!==s[l][1]){var y=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:r.l+2===s[l][1]&&(r.l+=2,y=!1);break;case 80:r.l<=s[l][1]&&(r.l=s[l][1],y=!1);break;case 4108:r.l<=s[l][1]&&(r.l=s[l][1],y=!1);break}if((!e||l==0)&&r.l<=s[l][1]&&(y=!1,r.l=s[l][1]),y)throw new Error("Read Error: Expected address "+s[l][1]+" at "+r.l+" :"+l)}if(e){var T=e[s[l][0]];if(v[T.n]=lp(r,T.t,{raw:!0}),T.p==="version"&&(v[T.n]=String(v[T.n]>>16)+"."+("0000"+String(v[T.n]&65535)).slice(-4)),T.n=="CodePage")switch(v[T.n]){case 0:v[T.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:aa(u=v[T.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[T.n])}}else if(s[l][0]===1){if(u=v.CodePage=lp(r,bv),aa(u),f!==-1){var E=r.l;r.l=s[f][1],d=uS(r,u),r.l=E}}else if(s[l][0]===0){if(u===0){f=l,r.l=s[l+1][1];continue}d=uS(r,u)}else{var S=d[s[l][0]],D;switch(r[r.l]){case 65:r.l+=4,D=YI(r);break;case 30:r.l+=4,D=_x(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,D=_x(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,D=r.read_shift(4,"i");break;case 19:r.l+=4,D=r.read_shift(4);break;case 5:r.l+=4,D=r.read_shift(8,"f");break;case 11:r.l+=4,D=jr(r,4);break;case 64:r.l+=4,D=yr(kv(r));break;default:throw new Error("unparsed value: "+r[r.l])}v[S]=D}}return r.l=t+n,v}var $I=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function XO(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function dS(r,e,t){var n=we(8),i=[],s=[],l=8,u=0,f=we(8),d=we(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),s.push(f),i.push(d),l+=8+f.length,!e){d=we(8),d.write_shift(4,0),i.unshift(d);var m=[we(4)];for(m[0].write_shift(4,r.length),u=0;u<r.length;++u){var _=r[u][0];for(f=we(8+2*(_.length+1)+(_.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,_.length+1),f.write_shift(0,_,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=vn(m),s.unshift(f),l+=8+f.length}for(u=0;u<r.length;++u)if(!(e&&!e[r[u][0]])&&!($I.indexOf(r[u][0])>-1||jI.indexOf(r[u][0])>-1)&&r[u][1]!=null){var v=r[u][1],y=0;if(e){y=+e[r[u][0]];var T=t[y];if(T.p=="version"&&typeof v=="string"){var E=v.split(".");v=(+E[0]<<16)+(+E[1]||0)}f=fS(T.t,v)}else{var S=XO(v);S==-1&&(S=31,v=String(v)),f=fS(S,v)}s.push(f),d=we(8),d.write_shift(4,e?y:2+u),i.push(d),l+=8+f.length}var D=8*(s.length+1);for(u=0;u<s.length;++u)i[u].write_shift(4,D),D+=s[u].length;return n.write_shift(4,l),n.write_shift(4,s.length),vn([n].concat(i).concat(s))}function mS(r,e,t){var n=r.content;if(!n)return{};Rn(n,0);var i,s,l,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==it.utils.consts.HEADER_CLSID&&m!==t)throw new Error("Bad PropertySet CLSID "+m);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(l=n.read_shift(16),f=n.read_shift(4));var _=hS(n,e),v={SystemIdentifier:d};for(var y in _)v[y]=_[y];if(v.FMTID=s,i===1)return v;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var T;try{T=hS(n,null)}catch{}for(y in T)v[y]=T[y];return v.FMTID=[s,l],v}function pS(r,e,t,n,i,s){var l=we(i?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,it.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,i?68:48);var f=dS(r,t,n);if(u.push(f),i){var d=dS(i,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),u.push(d)}return vn(u)}function Io(r,e){return r.read_shift(e),null}function YO(r,e){e||(e=we(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function $O(r,e,t){for(var n=[],i=r.l+e;r.l<i;)n.push(t(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return n}function jr(r,e){return r.read_shift(e)===1}function ei(r,e){return e||(e=we(2)),e.write_shift(2,+!!r),e}function en(r){return r.read_shift(2,"u")}function na(r,e){return e||(e=we(2)),e.write_shift(2,r),e}function QI(r,e){return $O(r,e,en)}function QO(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function JI(r,e,t){return t||(t=we(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function D0(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=Ni;if(t&&t.biff>=8&&(Ni=1200),!t||t.biff==8){var l=r.read_shift(1);l&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var u=n?r.read_shift(n,i):"";return Ni=s,u}function JO(r){var e=Ni;Ni=1200;var t=r.read_shift(2),n=r.read_shift(1),i=n&4,s=n&8,l=1+(n&1),u=0,f,d={};s&&(u=r.read_shift(2)),i&&(f=r.read_shift(4));var m=l==2?"dbcs-cont":"sbcs-cont",_=t===0?"":r.read_shift(t,m);return s&&(r.l+=4*u),i&&(r.l+=f),d.t=_,s||(d.raw="<t>"+d.t+"</t>",d.r=d.t),Ni=e,d}function ZO(r){var e=r.t||"",t=we(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=we(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return vn(i)}function sc(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function N0(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):sc(r,n,t)}function bc(r,e,t){if(t.biff>5)return N0(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function ZI(r,e,t){return t||(t=we(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function e6(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function t6(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var i=r.read_shift((n?e-24:e)>>1,"utf16le").replace(Gn,"");return n&&(r.l+=24),i}function r6(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=r.read_shift(s>>1,"utf16le").replace(Gn,"");return t+l}function n6(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return t6(r);case"0303000000000000c000000000000046":return r6(r);default:throw new Error("Unsupported Moniker "+t)}}function Em(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(Gn,""):"";return t}function gS(r,e){e||(e=we(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function i6(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=r.read_shift(2);r.l+=2;var s,l,u,f,d="",m,_;i&16&&(s=Em(r,t-r.l)),i&128&&(l=Em(r,t-r.l)),(i&257)===257&&(u=Em(r,t-r.l)),(i&257)===1&&(f=n6(r,t-r.l)),i&8&&(d=Em(r,t-r.l)),i&32&&(m=r.read_shift(16)),i&64&&(_=kv(r)),r.l=t;var v=l||u||f||"";v&&d&&(v+="#"+d),v||(v="#"+d),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var y={Target:v};return m&&(y.guid=m),_&&(y.time=_),s&&(y.Tooltip=s),y}function a6(r){var e=we(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)e.write_shift(4,l[t]);if(s==28)n=n.slice(1),gS(n,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));var u=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(u.length+1)),t=0;t<u.length;++t)e.write_shift(2,u.charCodeAt(t));e.write_shift(2,0),s&8&&gS(i>-1?n.slice(i+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),t=0;t<n.length-3*f;++t)e.write_shift(1,n.charCodeAt(t+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function ek(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),i=r.read_shift(1);return[e,t,n,i]}function tk(r,e){var t=ek(r);return t[3]=0,t}function ss(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function oc(r,e,t,n){return n||(n=we(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function s6(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function o6(r,e,t){return e===0?"":bc(r,e,t)}function l6(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),l=r.read_shift(n,"i");return[i,s,l]}function rk(r){var e=r.read_shift(2),t=Av(r);return[e,t]}function c6(r,e,t){r.l+=4,e-=4;var n=r.l+e,i=D0(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,i}function qp(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function nk(r,e){return e||(e=we(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function ik(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),i=r.read_shift(1);return{s:{c:n,r:e},e:{c:i,r:t}}}var u6=ik;function ak(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function f6(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function h6(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function Mn(r){r.l+=2,r.l+=r.read_shift(2)}var d6={0:Mn,4:Mn,5:Mn,6:Mn,7:h6,8:Mn,9:Mn,10:Mn,11:Mn,12:Mn,13:f6,14:Mn,15:Mn,16:Mn,17:Mn,18:Mn,19:Mn,20:Mn,21:ak};function m6(r,e){for(var t=r.l+e,n=[];r.l<t;){var i=r.read_shift(2);r.l-=2;try{n.push(d6[i](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function Tm(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function Cv(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=we(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function p6(r,e){return e===0||r.read_shift(2),1200}function g6(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,i=bc(r,0,t);return r.read_shift(e+n-r.l),i}function _6(r,e){var t=!e||e.biff==8,n=we(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function x6(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function v6(r,e,t){var n=r.read_shift(4),i=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=D0(r,0,t);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:s,name:l}}function y6(r,e){var t=!e||e.biff>=8?2:1,n=we(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function E6(r,e){for(var t=r.l+e,n=r.read_shift(4),i=r.read_shift(4),s=[],l=0;l!=i&&r.l<t;++l)s.push(JO(r));return s.Count=n,s.Unique=i,s}function T6(r,e){var t=we(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=ZO(r[i]);var s=vn([t].concat(n));return s.parts=[t.length].concat(n.map(function(l){return l.length})),s}function w6(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function S6(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function A6(r){var e=s6(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function b6(r){return r.read_shift(2),r.read_shift(4)}function _S(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var i=r.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function I6(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),l=r.read_shift(2),u=r.read_shift(2),f=r.read_shift(2),d=r.read_shift(2);return{Pos:[e,t],Dim:[n,i],Flags:s,CurTab:l,FirstTab:u,Selected:f,TabRatio:d}}function k6(){var r=we(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function C6(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function R6(r){var e=we(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function D6(){}function N6(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=D0(r,0,t),n}function O6(r,e){var t=r.name||"Arial",n=e&&e.biff==5,i=n?15+t.length:16+2*t.length,s=we(i);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function F6(r){var e=ss(r);return e.isst=r.read_shift(4),e}function P6(r,e,t,n){var i=we(10);return oc(r,e,n,i),i.write_shift(4,t),i}function M6(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,i=ss(r);t.biff==2&&r.l++;var s=N0(r,n-r.l,t);return i.val=s,i}function L6(r,e,t,n,i){var s=!i||i.biff==8,l=we(8+ +s+(1+s)*t.length);return oc(r,e,n,l),l.write_shift(2,t.length),s&&l.write_shift(1,1),l.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),l}function V6(r,e,t){var n=r.read_shift(2),i=bc(r,0,t);return[n,i]}function B6(r,e,t,n){var i=t&&t.biff==5;n||(n=we(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var U6=bc;function xS(r,e,t){var n=r.l+e,i=t.biff==8||!t.biff?4:2,s=r.read_shift(i),l=r.read_shift(i),u=r.read_shift(2),f=r.read_shift(2);return r.l=n,{s:{r:s,c:u},e:{r:l,c:f}}}function z6(r,e){var t=e.biff==8||!e.biff?4:2,n=we(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function j6(r){var e=r.read_shift(2),t=r.read_shift(2),n=rk(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function H6(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(rk(r));if(r.l!==t)throw new Error("MulRK read error");var l=r.read_shift(2);if(s.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:s}}function G6(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var l=r.read_shift(2);if(s.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:s}}function q6(r,e,t,n){var i={},s=r.read_shift(4),l=r.read_shift(4),u=r.read_shift(4),f=r.read_shift(2);return i.patternType=AO[u>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=f&127,i.icvBack=f>>7&127,i.fsxButton=f>>14&1),i}function K6(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=q6(r,e,n.fStyle,t),n}function vS(r,e,t,n){var i=t&&t.biff==5;n||(n=we(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function W6(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function X6(r){var e=we(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function yS(r,e,t){var n=ss(r);(t.biff==2||e==9)&&++r.l;var i=QO(r);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function Y6(r,e,t,n,i,s){var l=we(8);return oc(r,e,n,l),JI(t,s,l),l}function $6(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=ss(r),i=jn(r);return n.val=i,n}function Q6(r,e,t,n){var i=we(14);return oc(r,e,n,i),ac(t,i),i}var ES=o6;function J6(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=sc(r,s),u=[];n>r.l;)u.push(N0(r));return[s,i,l,u]}function TS(r,e,t){var n=r.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=c6(r,e-2,t)),s.body=i||r.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var Z6=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function wS(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(1),l=r.read_shift(1),u=r.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),f=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var d=sc(r,l,t);i&32&&(d=Z6[d.charCodeAt(0)]);var m=n-r.l;t&&t.biff==2&&--m;var _=n==r.l||u===0||!(m>0)?[]:m9(r,m,t,u);return{chKey:s,Name:d,itab:f,rgce:_}}function sk(r,e,t){if(t.biff<8)return eF(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(l6(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function eF(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=D0(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function tF(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),i=r.read_shift(2),s=sc(r,n,t),l=sc(r,i,t);return[s,l]}function rF(r,e,t){var n=ik(r);r.l++;var i=r.read_shift(1);return e-=8,[p9(r,e,t),i,n]}function SS(r,e,t){var n=u6(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,h9(r,e,t)]}function nF(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function iF(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),l=r.read_shift(2),u=bc(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:i},u,l,s]}}function aF(r,e,t){return iF(r,e,t)}function sF(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(qp(r));return t}function oF(r){var e=we(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)nk(r[t],e);return e}function lF(r,e,t){if(t&&t.biff<8)return uF(r,e,t);var n=ak(r),i=m6(r,e-22,n[1]);return{cmo:n,ft:i}}var cF={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=t,{fmt:n}}};function uF(r,e,t){r.l+=4;var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var l=[];return l.push((cF[n]||Wn)(r,e,t)),{cmo:[i,n,s],ft:l}}function fF(r,e,t){var n=r.l,i="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:l=e6(r,6,t);var u=r.read_shift(2);r.read_shift(2),en(r,2);var f=r.read_shift(2);r.l+=f;for(var d=1;d<r.lens.length-1;++d){if(r.l-n!=r.lens[d])throw new Error("TxO: bad continue record");var m=r[r.l],_=sc(r,r.lens[d+1]-r.lens[d]-1);if(i+=_,i.length>=(m?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return r.l=n+e,{t:i}}catch{return r.l=n+e,{t:i}}}function hF(r,e){var t=qp(r);r.l+=16;var n=i6(r,e-24);return[t,n]}function dF(r){var e=we(24),t=Cr(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return vn([e,a6(r[1])])}function mF(r,e){r.read_shift(2);var t=qp(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Gn,""),[t,n]}function pF(r){var e=r[1].Tooltip,t=we(10+2*(e.length+1));t.write_shift(2,2048);var n=Cr(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function gF(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=lS[t]||t,t=r.read_shift(2),e[1]=lS[t]||t,e}function _F(r){return r||(r=we(4)),r.write_shift(2,1),r.write_shift(2,1),r}function xF(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(tk(r));return t}function vF(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(tk(r));return t}function yF(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function ok(r,e,t){if(!t.cellStyles)return Wn(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),l=r.read_shift(n),u=r.read_shift(n),f=r.read_shift(2);n==2&&(r.l+=2);var d={s:i,e:s,w:l,ixfe:u,flags:f};return(t.biff>=5||!t.biff)&&(d.level=f>>8&7),d}function EF(r,e){var t=we(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function TF(r,e){var t={};return e<32||(r.l+=16,t.header=jn(r),t.footer=jn(r),r.l+=2),t}function wF(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var i=r.read_shift(1);return r.l+=3,i&16&&(n.area=!0),n}function SF(r){for(var e=we(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var AF=ss,bF=QI,IF=N0;function kF(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,i}function CF(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=ss(r);++r.l;var i=bc(r,e-7,t);return n.t="str",n.val=i,n}function RF(r){var e=ss(r);++r.l;var t=jn(r);return e.t="n",e.val=t,e}function DF(r,e,t){var n=we(15);return M0(n,r,e),n.write_shift(8,t,"f"),n}function NF(r){var e=ss(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function OF(r,e,t){var n=we(9);return M0(n,r,e),n.write_shift(2,t),n}function FF(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function PF(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function MF(r,e,t){var n=r.l+e,i=ss(r),s=r.read_shift(2),l=sc(r,s,t);return r.l=n,i.t="str",i.val=l,i}var LF=[2,3,48,49,131,139,140,245],xx=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=zp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,f){var d=[],m=Xo(1);switch(f.type){case"base64":m=Ci(Mi(u));break;case"binary":m=Ci(u);break;case"buffer":case"array":m=u;break}Rn(m,0);var _=m.read_shift(1),v=!!(_&136),y=!1,T=!1;switch(_){case 2:break;case 3:break;case 48:y=!0,v=!0;break;case 49:y=!0,v=!0;break;case 131:break;case 139:break;case 140:T=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var E=0,S=521;_==2&&(E=m.read_shift(2)),m.l+=3,_!=2&&(E=m.read_shift(4)),E>1048576&&(E=1e6),_!=2&&(S=m.read_shift(2));var D=m.read_shift(2),U=f.codepage||1252;_!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(U=r[m[m.l]]),m.l+=1,m.l+=2),T&&(m.l+=36);for(var k=[],W={},ee=Math.min(m.length,_==2?521:S-10-(y?264:0)),X=T?32:11;m.l<ee&&m[m.l]!=13;)switch(W={},W.name=Ut.utils.decode(U,m.slice(m.l,m.l+X)).replace(/[\u0000\r\n].*$/g,""),m.l+=X,W.type=String.fromCharCode(m.read_shift(1)),_!=2&&!T&&(W.offset=m.read_shift(4)),W.len=m.read_shift(1),_==2&&(W.offset=m.read_shift(2)),W.dec=m.read_shift(1),W.name.length&&k.push(W),_!=2&&(m.l+=T?13:14),W.type){case"B":(!y||W.len!=8)&&f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(m[m.l]!==13&&(m.l=S-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=S;var A=0,R=0;for(d[0]=[],R=0;R!=k.length;++R)d[0][R]=k[R].name;for(;E-- >0;){if(m[m.l]===42){m.l+=D;continue}for(++m.l,d[++A]=[],R=0,R=0;R!=k.length;++R){var C=m.slice(m.l,m.l+k[R].len);m.l+=k[R].len,Rn(C,0);var B=Ut.utils.decode(U,C);switch(k[R].type){case"C":B.trim().length&&(d[A][R]=B.replace(/\s+$/,""));break;case"D":B.length===8?d[A][R]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):d[A][R]=B;break;case"F":d[A][R]=parseFloat(B.trim());break;case"+":case"I":d[A][R]=T?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":d[A][R]=!0;break;case"N":case"F":d[A][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));d[A][R]="##MEMO##"+(T?parseInt(B.trim(),10):C.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(d[A][R]=+B||0);break;case"@":d[A][R]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":d[A][R]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":d[A][R]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][R]=-C.read_shift(-8,"f");break;case"B":if(y&&k[R].len==8){d[A][R]=C.read_shift(8,"f");break}case"G":case"P":C.l+=k[R].len;break;case"0":if(k[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[R].type)}}}if(_!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=k,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=uf(t(u,d),d);return m["!cols"]=d.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete d.DBF,m}function i(u,f){try{return il(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var d=f||{};if(+d.codepage>=0&&aa(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=pi(),_=fp(u,{header:1,raw:!0,cellDates:!0}),v=_[0],y=_.slice(1),T=u["!cols"]||[],E=0,S=0,D=0,U=1;for(E=0;E<v.length;++E){if(((T[E]||{}).DBF||{}).name){v[E]=T[E].DBF.name,++D;continue}if(v[E]!=null){if(++D,typeof v[E]=="number"&&(v[E]=v[E].toString(10)),typeof v[E]!="string")throw new Error("DBF Invalid column name "+v[E]+" |"+typeof v[E]+"|");if(v.indexOf(v[E])!==E){for(S=0;S<1024;++S)if(v.indexOf(v[E]+"_"+S)==-1){v[E]+="_"+S;break}}}}var k=Ft(u["!ref"]),W=[],ee=[],X=[];for(E=0;E<=k.e.c-k.s.c;++E){var A="",R="",C=0,B=[];for(S=0;S<y.length;++S)y[S][E]!=null&&B.push(y[S][E]);if(B.length==0||v[E]==null){W[E]="?";continue}for(S=0;S<B.length;++S){switch(typeof B[S]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=B[S]instanceof Date?"D":"C";break;default:R="C"}C=Math.max(C,String(B[S]).length),A=A&&A!=R?"C":R}C>250&&(C=250),R=((T[E]||{}).DBF||{}).type,R=="C"&&T[E].DBF.len>C&&(C=T[E].DBF.len),A=="B"&&R=="N"&&(A="N",X[E]=T[E].DBF.dec,C=T[E].DBF.len),ee[E]=A=="C"||R=="N"?C:s[A]||0,U+=ee[E],W[E]=A}var N=m.next(32);for(N.write_shift(4,318902576),N.write_shift(4,y.length),N.write_shift(2,296+32*D),N.write_shift(2,U),E=0;E<4;++E)N.write_shift(4,0);for(N.write_shift(4,0|(+e[rc]||3)<<8),E=0,S=0;E<v.length;++E)if(v[E]!=null){var M=m.next(32),V=(v[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,V,"sbcs"),M.write_shift(1,W[E]=="?"?"C":W[E],"sbcs"),M.write_shift(4,S),M.write_shift(1,ee[E]||s[W[E]]||0),M.write_shift(1,X[E]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),S+=ee[E]||s[W[E]]||0}var xe=m.next(264);for(xe.write_shift(4,13),E=0;E<65;++E)xe.write_shift(4,0);for(E=0;E<y.length;++E){var ve=m.next(U);for(ve.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(W[S]){case"L":ve.write_shift(1,y[E][S]==null?63:y[E][S]?84:70);break;case"B":ve.write_shift(8,y[E][S]||0,"f");break;case"N":var ne="0";for(typeof y[E][S]=="number"&&(ne=y[E][S].toFixed(X[S]||0)),D=0;D<ee[S]-ne.length;++D)ve.write_shift(1,32);ve.write_shift(1,ne,"sbcs");break;case"D":y[E][S]?(ve.write_shift(4,("0000"+y[E][S].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(y[E][S].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+y[E][S].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var le=String(y[E][S]!=null?y[E][S]:"").slice(0,ee[S]);for(ve.write_shift(1,le,"sbcs"),D=0;D<ee[S]-le.length;++D)ve.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}})(),lk=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Vr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(v,y){var T=r[y];return typeof T=="number"?ux(T):T},n=function(v,y,T){var E=y.charCodeAt(0)-32<<4|T.charCodeAt(0)-48;return E==59?v:ux(E)};r["|"]=254;function i(v,y){switch(y.type){case"base64":return s(Mi(v),y);case"binary":return s(v,y);case"buffer":return s(St&&Buffer.isBuffer(v)?v.toString("binary"):nl(v),y);case"array":return s(ic(v),y)}throw new Error("Unrecognized type "+y.type)}function s(v,y){var T=v.split(/[\n\r]+/),E=-1,S=-1,D=0,U=0,k=[],W=[],ee=null,X={},A=[],R=[],C=[],B=0,N;for(+y.codepage>=0&&aa(+y.codepage);D!==T.length;++D){B=0;var M=T[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),V=M.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),xe=V[0],ve;if(M.length>0)switch(xe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&W.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,le=!1,Pe=!1,ae=!1,Me=-1,J=-1;for(U=1;U<V.length;++U)switch(V[U].charAt(0)){case"A":break;case"X":S=parseInt(V[U].slice(1))-1,le=!0;break;case"Y":for(E=parseInt(V[U].slice(1))-1,le||(S=0),N=k.length;N<=E;++N)k[N]=[];break;case"K":ve=V[U].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(Ca(ve))?isNaN(Hu(ve).getDate())||(ve=yr(ve)):(ve=Ca(ve),ee!==null&&yc(ee)&&(ve=Hp(ve))),typeof Ut<"u"&&typeof ve=="string"&&(y||{}).type!="string"&&(y||{}).codepage&&(ve=Ut.utils.decode(y.codepage,ve)),ne=!0;break;case"E":ae=!0;var O=Mu(V[U].slice(1),{r:E,c:S});k[E][S]=[k[E][S],O];break;case"S":Pe=!0,k[E][S]=[k[E][S],"S5S"];break;case"G":break;case"R":Me=parseInt(V[U].slice(1))-1;break;case"C":J=parseInt(V[U].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}if(ne&&(k[E][S]&&k[E][S].length==2?k[E][S][0]=ve:k[E][S]=ve,ee=null),Pe){if(ae)throw new Error("SYLK shared formula cannot have own formula");var Q=Me>-1&&k[Me][J];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");k[E][S][1]=bk(Q[1],{r:E-Me,c:S-J})}break;case"F":var q=0;for(U=1;U<V.length;++U)switch(V[U].charAt(0)){case"X":S=parseInt(V[U].slice(1))-1,++q;break;case"Y":for(E=parseInt(V[U].slice(1))-1,N=k.length;N<=E;++N)k[N]=[];break;case"M":B=parseInt(V[U].slice(1))/20;break;case"F":break;case"G":break;case"P":ee=W[parseInt(V[U].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=V[U].slice(1).split(" "),N=parseInt(C[0],10);N<=parseInt(C[1],10);++N)B=parseInt(C[2],10),R[N-1]=B===0?{hidden:!0}:{wch:B},Yo(R[N-1]);break;case"C":S=parseInt(V[U].slice(1))-1,R[S]||(R[S]={});break;case"R":E=parseInt(V[U].slice(1))-1,A[E]||(A[E]={}),B>0?(A[E].hpt=B,A[E].hpx=qu(B)):B===0&&(A[E].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}q<1&&(ee=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}}return A.length>0&&(X["!rows"]=A),R.length>0&&(X["!cols"]=R),y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),[k,X]}function l(v,y){var T=i(v,y),E=T[0],S=T[1],D=uf(E,y);return Vr(S).forEach(function(U){D[U]=S[U]}),D}function u(v,y){return il(l(v,y),y)}function f(v,y,T,E){var S="C;Y"+(T+1)+";X"+(E+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+Pv(v.f,{r:T,c:E}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,y){y.forEach(function(T,E){var S="F;W"+(E+1)+" "+(E+1)+" ";T.hidden?S+="0":(typeof T.width=="number"&&!T.wpx&&(T.wpx=o0(T.width)),typeof T.wpx=="number"&&!T.wch&&(T.wch=l0(T.wpx)),typeof T.wch=="number"&&(S+=Math.round(T.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function m(v,y){y.forEach(function(T,E){var S="F;";T.hidden?S+="M0;":T.hpt?S+="M"+20*T.hpt+";":T.hpx&&(S+="M"+20*c0(T.hpx)+";"),S.length>2&&v.push(S+"R"+(E+1))})}function _(v,y){var T=["ID;PWXL;N;E"],E=[],S=Ft(v["!ref"]),D,U=Array.isArray(v),k=`\r
`;T.push("P;PGeneral"),T.push("F;P0;DG0G8;M255"),v["!cols"]&&d(T,v["!cols"]),v["!rows"]&&m(T,v["!rows"]),T.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var W=S.s.r;W<=S.e.r;++W)for(var ee=S.s.c;ee<=S.e.c;++ee){var X=ft({r:W,c:ee});D=U?(v[W]||[])[ee]:v[X],!(!D||D.v==null&&(!D.f||D.F))&&E.push(f(D,v,W,ee))}return T.join(k)+k+E.join(k)+k+"E"+k}return{to_workbook:u,to_sheet:l,from_sheet:_}})(),ck=(function(){function r(s,l){switch(l.type){case"base64":return e(Mi(s),l);case"binary":return e(s,l);case"buffer":return e(St&&Buffer.isBuffer(s)?s.toString("binary"):nl(s),l);case"array":return e(ic(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var u=s.split(`
`),f=-1,d=-1,m=0,_=[];m!==u.length;++m){if(u[m].trim()==="BOT"){_[++f]=[],d=0;continue}if(!(f<0)){var v=u[m].trim().split(","),y=v[0],T=v[1];++m;for(var E=u[m]||"";(E.match(/["]/g)||[]).length&1&&m<u.length-1;)E+=`
`+u[++m];switch(E=E.trim(),+y){case-1:if(E==="BOT"){_[++f]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?_[f][d]=!0:E==="FALSE"?_[f][d]=!1:isNaN(Ca(T))?isNaN(Hu(T).getDate())?_[f][d]=T:_[f][d]=yr(T):_[f][d]=Ca(T),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),_[f][d++]=E!==""?E:null;break}if(E==="EOD")break}}return l&&l.sheetRows&&(_=_.slice(0,l.sheetRows)),_}function t(s,l){return uf(r(s,l),l)}function n(s,l){return il(t(s,l),l)}var i=(function(){var s=function(f,d,m,_,v){f.push(d),f.push(m+","+_),f.push('"'+v.replace(/"/g,'""')+'"')},l=function(f,d,m,_){f.push(d+","+m),f.push(d==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(f){var d=[],m=Ft(f["!ref"]),_,v=Array.isArray(f);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,m.e.r-m.s.r+1,""),s(d,"TUPLES",0,m.e.c-m.s.c+1,""),s(d,"DATA",0,0,"");for(var y=m.s.r;y<=m.e.r;++y){l(d,-1,0,"BOT");for(var T=m.s.c;T<=m.e.c;++T){var E=ft({r:y,c:T});if(_=v?(f[y]||[])[T]:f[E],!_){l(d,1,0,"");continue}switch(_.t){case"n":var S=_.w;!S&&_.v!=null&&(S=_.v),S==null?_.f&&!_.F?l(d,1,0,"="+_.f):l(d,1,0,""):l(d,0,S,"V");break;case"b":l(d,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=Li(_.z||ot[14],un(yr(_.v)))),l(d,0,_.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var D=`\r
`,U=d.join(D);return U}})();return{to_workbook:n,to_sheet:t,from_sheet:i}})(),uk=(function(){function r(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(_,v){for(var y=_.split(`
`),T=-1,E=-1,S=0,D=[];S!==y.length;++S){var U=y[S].trim().split(":");if(U[0]==="cell"){var k=Cr(U[1]);if(D.length<=k.r)for(T=D.length;T<=k.r;++T)D[T]||(D[T]=[]);switch(T=k.r,E=k.c,U[2]){case"t":D[T][E]=r(U[3]);break;case"v":D[T][E]=+U[3];break;case"vtf":var W=U[U.length-1];case"vtc":switch(U[3]){case"nl":D[T][E]=!!+U[4];break;default:D[T][E]=+U[4];break}U[2]=="vtf"&&(D[T][E]=[D[T][E],W])}}}return v&&v.sheetRows&&(D=D.slice(0,v.sheetRows)),D}function n(_,v){return uf(t(_,v),v)}function i(_,v){return il(n(_,v),v)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(_){if(!_||!_["!ref"])return"";for(var v=[],y=[],T,E="",S=ii(_["!ref"]),D=Array.isArray(_),U=S.s.r;U<=S.e.r;++U)for(var k=S.s.c;k<=S.e.c;++k)if(E=ft({r:U,c:k}),T=D?(_[U]||[])[k]:_[E],!(!T||T.v==null||T.t==="z")){switch(y=["cell",E,"t"],T.t){case"s":case"str":y.push(e(T.v));break;case"n":T.f?(y[2]="vtf",y[3]="n",y[4]=T.v,y[5]=e(T.f)):(y[2]="v",y[3]=T.v);break;case"b":y[2]="vt"+(T.f?"f":"c"),y[3]="nl",y[4]=T.v?"1":"0",y[5]=e(T.f||(T.v?"TRUE":"FALSE"));break;case"d":var W=un(yr(T.v));y[2]="vtc",y[3]="nd",y[4]=""+W,y[5]=T.w||Li(T.z||ot[14],W);break;case"e":continue}v.push(y.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(_){return[s,l,u,l,d(_),f].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:m}})(),Gu=(function(){function r(m,_,v,y,T){T.raw?_[v][y]=m:m===""||(m==="TRUE"?_[v][y]=!0:m==="FALSE"?_[v][y]=!1:isNaN(Ca(m))?isNaN(Hu(m).getDate())?_[v][y]=m:_[v][y]=yr(m):_[v][y]=Ca(m))}function e(m,_){var v=_||{},y=[];if(!m||m.length===0)return y;for(var T=m.split(/[\r\n]/),E=T.length-1;E>=0&&T[E].length===0;)--E;for(var S=10,D=0,U=0;U<=E;++U)D=T[U].indexOf(" "),D==-1?D=T[U].length:D++,S=Math.max(S,D);for(U=0;U<=E;++U){y[U]=[];var k=0;for(r(T[U].slice(0,S).trim(),y,U,k,v),k=1;k<=(T[U].length-S)/10+1;++k)r(T[U].slice(S+(k-1)*10,S+k*10).trim(),y,U,k,v)}return v.sheetRows&&(y=y.slice(0,v.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(m){for(var _={},v=!1,y=0,T=0;y<m.length;++y)(T=m.charCodeAt(y))==34?v=!v:!v&&T in t&&(_[T]=(_[T]||0)+1);T=[];for(y in _)Object.prototype.hasOwnProperty.call(_,y)&&T.push([_[y],y]);if(!T.length){_=n;for(y in _)Object.prototype.hasOwnProperty.call(_,y)&&T.push([_[y],y])}return T.sort(function(E,S){return E[0]-S[0]||n[E[1]]-n[S[1]]}),t[T.pop()[1]]||44}function s(m,_){var v=_||{},y="",T=v.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(y=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(y=m.charAt(4),m=m.slice(6)):y=i(m.slice(0,1024)):v&&v.FS?y=v.FS:y=i(m.slice(0,1024));var S=0,D=0,U=0,k=0,W=0,ee=y.charCodeAt(0),X=!1,A=0,R=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var C=v.dateNF!=null?T5(v.dateNF):null;function B(){var N=m.slice(k,W),M={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)M.t="z";else if(v.raw)M.t="s",M.v=N;else if(N.trim().length===0)M.t="s",M.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(M.t="s",M.v=N.slice(2,-1).replace(/""/g,'"')):JP(N)?(M.t="n",M.f=N.slice(1)):(M.t="s",M.v=N);else if(N=="TRUE")M.t="b",M.v=!0;else if(N=="FALSE")M.t="b",M.v=!1;else if(!isNaN(U=Ca(N)))M.t="n",v.cellText!==!1&&(M.w=N),M.v=U;else if(!isNaN(Hu(N).getDate())||C&&N.match(C)){M.z=v.dateNF||ot[14];var V=0;C&&N.match(C)&&(N=w5(N,v.dateNF,N.match(C)||[]),V=1),v.cellDates?(M.t="d",M.v=yr(N,V)):(M.t="n",M.v=un(yr(N,V))),v.cellText!==!1&&(M.w=Li(M.z,M.v instanceof Date?un(M.v):M.v)),v.cellNF||delete M.z}else M.t="s",M.v=N;if(M.t=="z"||(v.dense?(T[S]||(T[S]=[]),T[S][D]=M):T[ft({c:D,r:S})]=M),k=W+1,R=m.charCodeAt(k),E.e.c<D&&(E.e.c=D),E.e.r<S&&(E.e.r=S),A==ee)++D;else if(D=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;W<m.length;++W)switch(A=m.charCodeAt(W)){case 34:R===34&&(X=!X);break;case ee:case 10:case 13:if(!X&&B())break e;break}return W-k>0&&B(),T["!ref"]=vt(E),T}function l(m,_){return!(_&&_.PRN)||_.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,_):uf(e(m,_),_)}function u(m,_){var v="",y=_.type=="string"?[0,0,0,0]:Gv(m,_);switch(_.type){case"base64":v=Mi(m);break;case"binary":v=m;break;case"buffer":_.codepage==65001?v=m.toString("utf8"):_.codepage&&typeof Ut<"u"?v=Ut.utils.decode(_.codepage,m):v=St&&Buffer.isBuffer(m)?m.toString("binary"):nl(m);break;case"array":v=ic(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+_.type)}return y[0]==239&&y[1]==187&&y[2]==191?v=fr(v.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?v=fr(v):_.type=="binary"&&typeof Ut<"u"&&_.codepage&&(v=Ut.utils.decode(_.codepage,Ut.utils.encode(28591,v))),v.slice(0,19)=="socialcalc:version:"?uk.to_sheet(_.type=="string"?v:fr(v),_):l(v,_)}function f(m,_){return il(u(m,_),_)}function d(m){for(var _=[],v=Ft(m["!ref"]),y,T=Array.isArray(m),E=v.s.r;E<=v.e.r;++E){for(var S=[],D=v.s.c;D<=v.e.c;++D){var U=ft({r:E,c:D});if(y=T?(m[E]||[])[D]:m[U],!y||y.v==null){S.push("          ");continue}for(var k=(y.w||(rs(y),y.w)||"").slice(0,10);k.length<10;)k+=" ";S.push(k+(D===0?" ":""))}_.push(S.join(""))}return _.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}})();function VF(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var i=lk.to_workbook(r,t);return t.WTF=n,i}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Gu.to_workbook(r,e)}}var Wl=(function(){function r(O,Q,q){if(O){Rn(O,O.l||0);for(var te=q.Enum||Me;O.l<O.length;){var oe=O.read_shift(2),Te=te[oe]||te[65535],ke=O.read_shift(2),be=O.l+ke,De=Te.f&&Te.f(O,ke,q);if(O.l=be,Q(De,Te,oe))return}}}function e(O,Q){switch(Q.type){case"base64":return t(Ci(Mi(O)),Q);case"binary":return t(Ci(O),Q);case"buffer":case"array":return t(O,Q)}throw"Unsupported type "+Q.type}function t(O,Q){if(!O)return O;var q=Q||{},te=q.dense?[]:{},oe="Sheet1",Te="",ke=0,be={},De=[],lt=[],Z={s:{r:0,c:0},e:{r:0,c:0}},wt=q.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)q.Enum=Me,r(O,function(Oe,nt,gt){switch(gt){case 0:q.vers=Oe,Oe>=4096&&(q.qpro=!0);break;case 6:Z=Oe;break;case 204:Oe&&(Te=Oe);break;case 222:Te=Oe;break;case 15:case 51:q.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:gt==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=q.dateNF||ot[14],q.cellDates&&(Oe[1].t="d",Oe[1].v=Hp(Oe[1].v))),q.qpro&&Oe[3]>ke&&(te["!ref"]=vt(Z),be[oe]=te,De.push(oe),te=q.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ke=Oe[3],oe=Te||"Sheet"+(ke+1),Te="");var Lt=q.dense?(te[Oe[0].r]||[])[Oe[0].c]:te[ft(Oe[0])];if(Lt){Lt.t=Oe[1].t,Lt.v=Oe[1].v,Oe[1].z!=null&&(Lt.z=Oe[1].z),Oe[1].f!=null&&(Lt.f=Oe[1].f);break}q.dense?(te[Oe[0].r]||(te[Oe[0].r]=[]),te[Oe[0].r][Oe[0].c]=Oe[1]):te[ft(Oe[0])]=Oe[1];break}},q);else if(O[2]==26||O[2]==14)q.Enum=J,O[2]==14&&(q.qpro=!0,O.l=0),r(O,function(Oe,nt,gt){switch(gt){case 204:oe=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>ke&&(te["!ref"]=vt(Z),be[oe]=te,De.push(oe),te=q.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ke=Oe[3],oe="Sheet"+(ke+1)),wt>0&&Oe[0].r>=wt)break;q.dense?(te[Oe[0].r]||(te[Oe[0].r]=[]),te[Oe[0].r][Oe[0].c]=Oe[1]):te[ft(Oe[0])]=Oe[1],Z.e.c<Oe[0].c&&(Z.e.c=Oe[0].c),Z.e.r<Oe[0].r&&(Z.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(lt[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:lt[Oe[0]]=Oe[1],Oe[0]==ke&&(oe=Oe[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(te["!ref"]=vt(Z),be[Te||oe]=te,De.push(Te||oe),!lt.length)return{SheetNames:De,Sheets:be};for(var ut={},It=[],qe=0;qe<lt.length;++qe)be[De[qe]]?(It.push(lt[qe]||De[qe]),ut[lt[qe]]=be[lt[qe]]||be[De[qe]]):(It.push(lt[qe]),ut[lt[qe]]={"!ref":"A1"});return{SheetNames:It,Sheets:ut}}function n(O,Q){var q=Q||{};if(+q.codepage>=0&&aa(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var te=pi(),oe=Ft(O["!ref"]),Te=Array.isArray(O),ke=[];ze(te,0,s(1030)),ze(te,6,f(oe));for(var be=Math.min(oe.e.r,8191),De=oe.s.r;De<=be;++De)for(var lt=Mr(De),Z=oe.s.c;Z<=oe.e.c;++Z){De===oe.s.r&&(ke[Z]=vr(Z));var wt=ke[Z]+lt,ut=Te?(O[De]||[])[Z]:O[wt];if(!(!ut||ut.t=="z"))if(ut.t=="n")(ut.v|0)==ut.v&&ut.v>=-32768&&ut.v<=32767?ze(te,13,y(De,Z,ut.v)):ze(te,14,E(De,Z,ut.v));else{var It=rs(ut);ze(te,15,_(De,Z,It.slice(0,239)))}}return ze(te,1),te.end()}function i(O,Q){var q=Q||{};if(+q.codepage>=0&&aa(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var te=pi();ze(te,0,l(O));for(var oe=0,Te=0;oe<O.SheetNames.length;++oe)(O.Sheets[O.SheetNames[oe]]||{})["!ref"]&&ze(te,27,ae(O.SheetNames[oe],Te++));var ke=0;for(oe=0;oe<O.SheetNames.length;++oe){var be=O.Sheets[O.SheetNames[oe]];if(!(!be||!be["!ref"])){for(var De=Ft(be["!ref"]),lt=Array.isArray(be),Z=[],wt=Math.min(De.e.r,8191),ut=De.s.r;ut<=wt;++ut)for(var It=Mr(ut),qe=De.s.c;qe<=De.e.c;++qe){ut===De.s.r&&(Z[qe]=vr(qe));var Oe=Z[qe]+It,nt=lt?(be[ut]||[])[qe]:be[Oe];if(!(!nt||nt.t=="z"))if(nt.t=="n")ze(te,23,B(ut,qe,ke,nt.v));else{var gt=rs(nt);ze(te,22,A(ut,qe,ke,gt.slice(0,239)))}}++ke}}return ze(te,1),te.end()}function s(O){var Q=we(2);return Q.write_shift(2,O),Q}function l(O){var Q=we(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var q=0,te=0,oe=0,Te=0;Te<O.SheetNames.length;++Te){var ke=O.SheetNames[Te],be=O.Sheets[ke];if(!(!be||!be["!ref"])){++oe;var De=ii(be["!ref"]);q<De.e.r&&(q=De.e.r),te<De.e.c&&(te=De.e.c)}}return q>8191&&(q=8191),Q.write_shift(2,q),Q.write_shift(1,oe),Q.write_shift(1,te),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function u(O,Q,q){var te={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&q.qpro?(te.s.c=O.read_shift(1),O.l++,te.s.r=O.read_shift(2),te.e.c=O.read_shift(1),O.l++,te.e.r=O.read_shift(2),te):(te.s.c=O.read_shift(2),te.s.r=O.read_shift(2),Q==12&&q.qpro&&(O.l+=2),te.e.c=O.read_shift(2),te.e.r=O.read_shift(2),Q==12&&q.qpro&&(O.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function f(O){var Q=we(8);return Q.write_shift(2,O.s.c),Q.write_shift(2,O.s.r),Q.write_shift(2,O.e.c),Q.write_shift(2,O.e.r),Q}function d(O,Q,q){var te=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(te[0].c=O.read_shift(1),te[3]=O.read_shift(1),te[0].r=O.read_shift(2),O.l+=2):(te[2]=O.read_shift(1),te[0].c=O.read_shift(2),te[0].r=O.read_shift(2)),te}function m(O,Q,q){var te=O.l+Q,oe=d(O,Q,q);if(oe[1].t="s",q.vers==20768){O.l++;var Te=O.read_shift(1);return oe[1].v=O.read_shift(Te,"utf8"),oe}return q.qpro&&O.l++,oe[1].v=O.read_shift(te-O.l,"cstr"),oe}function _(O,Q,q){var te=we(7+q.length);te.write_shift(1,255),te.write_shift(2,Q),te.write_shift(2,O),te.write_shift(1,39);for(var oe=0;oe<te.length;++oe){var Te=q.charCodeAt(oe);te.write_shift(1,Te>=128?95:Te)}return te.write_shift(1,0),te}function v(O,Q,q){var te=d(O,Q,q);return te[1].v=O.read_shift(2,"i"),te}function y(O,Q,q){var te=we(7);return te.write_shift(1,255),te.write_shift(2,Q),te.write_shift(2,O),te.write_shift(2,q,"i"),te}function T(O,Q,q){var te=d(O,Q,q);return te[1].v=O.read_shift(8,"f"),te}function E(O,Q,q){var te=we(13);return te.write_shift(1,255),te.write_shift(2,Q),te.write_shift(2,O),te.write_shift(8,q,"f"),te}function S(O,Q,q){var te=O.l+Q,oe=d(O,Q,q);if(oe[1].v=O.read_shift(8,"f"),q.qpro)O.l=te;else{var Te=O.read_shift(2);W(O.slice(O.l,O.l+Te),oe),O.l+=Te}return oe}function D(O,Q,q){var te=Q&32768;return Q&=-32769,Q=(te?O:0)+(Q>=8192?Q-16384:Q),(te?"":"$")+(q?vr(Q):Mr(Q))}var U={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function W(O,Q){Rn(O,0);for(var q=[],te=0,oe="",Te="",ke="",be="";O.l<O.length;){var De=O[O.l++];switch(De){case 0:q.push(O.read_shift(8,"f"));break;case 1:Te=D(Q[0].c,O.read_shift(2),!0),oe=D(Q[0].r,O.read_shift(2),!1),q.push(Te+oe);break;case 2:{var lt=D(Q[0].c,O.read_shift(2),!0),Z=D(Q[0].r,O.read_shift(2),!1);Te=D(Q[0].c,O.read_shift(2),!0),oe=D(Q[0].r,O.read_shift(2),!1),q.push(lt+Z+":"+Te+oe)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(O.read_shift(2));break;case 6:{for(var wt="";De=O[O.l++];)wt+=String.fromCharCode(De);q.push('"'+wt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:be=q.pop(),ke=q.pop(),q.push(["AND","OR"][De-20]+"("+ke+","+be+")");break;default:if(De<32&&k[De])be=q.pop(),ke=q.pop(),q.push(ke+k[De]+be);else if(U[De]){if(te=U[De][1],te==69&&(te=O[O.l++]),te>q.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+q.join("|")+"|");return}var ut=q.slice(-te);q.length-=te,q.push(U[De][0]+"("+ut.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}q.length==1?Q[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function ee(O){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=O.read_shift(2),Q[3]=O[O.l++],Q[0].c=O[O.l++],Q}function X(O,Q){var q=ee(O);return q[1].t="s",q[1].v=O.read_shift(Q-4,"cstr"),q}function A(O,Q,q,te){var oe=we(6+te.length);oe.write_shift(2,O),oe.write_shift(1,q),oe.write_shift(1,Q),oe.write_shift(1,39);for(var Te=0;Te<te.length;++Te){var ke=te.charCodeAt(Te);oe.write_shift(1,ke>=128?95:ke)}return oe.write_shift(1,0),oe}function R(O,Q){var q=ee(O);q[1].v=O.read_shift(2);var te=q[1].v>>1;if(q[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return q[1].v=te,q}function C(O,Q){var q=ee(O),te=O.read_shift(4),oe=O.read_shift(4),Te=O.read_shift(2);if(Te==65535)return te===0&&oe===3221225472?(q[1].t="e",q[1].v=15):te===0&&oe===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ke=Te&32768;return Te=(Te&32767)-16446,q[1].v=(1-ke*2)*(oe*Math.pow(2,Te+32)+te*Math.pow(2,Te)),q}function B(O,Q,q,te){var oe=we(14);if(oe.write_shift(2,O),oe.write_shift(1,q),oe.write_shift(1,Q),te==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var Te=0,ke=0,be=0,De=0;return te<0&&(Te=1,te=-te),ke=Math.log2(te)|0,te/=Math.pow(2,ke-31),De=te>>>0,(De&2147483648)==0&&(te/=2,++ke,De=te>>>0),te-=De,De|=2147483648,De>>>=0,te*=Math.pow(2,32),be=te>>>0,oe.write_shift(4,be),oe.write_shift(4,De),ke+=16383+(Te?32768:0),oe.write_shift(2,ke),oe}function N(O,Q){var q=C(O);return O.l+=Q-14,q}function M(O,Q){var q=ee(O),te=O.read_shift(4);return q[1].v=te>>6,q}function V(O,Q){var q=ee(O),te=O.read_shift(8,"f");return q[1].v=te,q}function xe(O,Q){var q=V(O);return O.l+=Q-10,q}function ve(O,Q){return O[O.l+Q-1]==0?O.read_shift(Q,"cstr"):""}function ne(O,Q){var q=O[O.l++];q>Q-1&&(q=Q-1);for(var te="";te.length<q;)te+=String.fromCharCode(O[O.l++]);return te}function le(O,Q,q){if(!(!q.qpro||Q<21)){var te=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var oe=O.read_shift(Q-21,"cstr");return[te,oe]}}function Pe(O,Q){for(var q={},te=O.l+Q;O.l<te;){var oe=O.read_shift(2);if(oe==14e3){for(q[oe]=[0,""],q[oe][0]=O.read_shift(2);O[O.l];)q[oe][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return q}function ae(O,Q){var q=we(5+O.length);q.write_shift(2,14e3),q.write_shift(2,Q);for(var te=0;te<O.length;++te){var oe=O.charCodeAt(te);q[q.l++]=oe>127?95:oe}return q[q.l++]=0,q}var Me={0:{n:"BOF",f:en},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:T},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:xe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})();function BF(r){var e={},t=r.match(Xn),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=ht(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=iv[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var UF=(function(){var r=r0("t"),e=r0("rPr");function t(s){var l=s.match(r);if(!l)return{t:"s",v:""};var u={t:"s",v:zt(l[1])},f=s.match(e);return f&&(u.s=BF(f[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(t).filter(function(u){return u.v})}})(),zF=(function(){var e=/(\r\n|\n)/g;function t(i,s,l){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),i.b&&(s.push("<b>"),l.push("</b>")),i.i&&(s.push("<i>"),l.push("</i>")),i.strike&&(s.push("<s>"),l.push("</s>"));var f=i.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),jF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,HF=/<(?:\w+:)?r>/,GF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Rv(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=zt(fr(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=fr(r),t&&(n.h=hv(n.t))):r.match(HF)&&(n.r=fr(r),n.t=zt(fr((r.replace(GF,"").match(jF)||[]).join("").replace(Xn,""))),t&&(n.h=zF(UF(n.r)))),n):{t:""}}var qF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,KF=/<(?:\w+:)?(?:si|sstItem)>/g,WF=/<\/(?:\w+:)?(?:si|sstItem)>/;function XF(r,e){var t=[],n="";if(!r)return t;var i=r.match(qF);if(i){n=i[2].replace(KF,"").split(WF);for(var s=0;s!=n.length;++s){var l=Rv(n[s].trim(),e);l!=null&&(t[t.length]=l)}i=ht(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}var YF=/^\s|\s$|[\t\n\r]/;function fk(r,e){if(!e.bookSST)return"";var t=[Hr];t[t.length]=Ue("sst",null,{xmlns:Ec[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(YF)&&(s+=' xml:space="preserve"'),s+=">"+ar(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function $F(r){return[r.read_shift(4),r.read_shift(4)]}function QF(r,e){var t=[],n=!1;return Gs(r,function(s,l,u){switch(u){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),t}function JF(r,e){return e||(e=we(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var ZF=cO;function e8(r){var e=pi();Ne(e,159,JF(r));for(var t=0;t<r.length;++t)Ne(e,19,ZF(r[t]));return Ne(e,160),e.end()}function hk(r){if(typeof Ut<"u")return Ut.utils.encode(rc,r);for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Ps(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function t8(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Ps(r,4),e.U=Ps(r,4),e.W=Ps(r,4),e}function r8(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},i=r.read_shift(4),s=[];i-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function n8(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r8(r));return e}function i8(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function a8(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Ps(r,4),e.U=Ps(r,4),e.W=Ps(r,4),e}function s8(r){var e=a8(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function dk(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function mk(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function o8(r){var e=Ps(r);switch(e.Minor){case 2:return[e.Minor,l8(r)];case 3:return[e.Minor,c8()];case 4:return[e.Minor,u8(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function l8(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=dk(r,t),i=mk(r,r.length-r.l);return{t:"Std",h:n,v:i}}function c8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function u8(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(Xn,function(s){var l=ht(s);switch(as(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function f8(r,e){var t={},n=t.EncryptionVersionInfo=Ps(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var i=r.read_shift(4);return e-=4,t.EncryptionHeader=dk(r,i),e-=i,t.EncryptionVerifier=mk(r,e),t}function h8(r){var e={},t=e.EncryptionVersionInfo=Ps(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function Dv(r){var e=0,t,n=hk(r),i=n.length+1,s,l,u,f,d;for(t=Xo(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)l=t[s],u=(e&16384)===0?0:1,f=e<<1&32767,d=u|f,e=d^l;return e^52811}var pk=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,u){return n(l^u)},s=function(l){for(var u=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],_=0;_!=7;++_)m&64&&(u^=t[f]),m*=2,--f;return u};return function(l){for(var u=hk(l),f=s(u),d=u.length,m=Xo(16),_=0;_!=16;++_)m[_]=0;var v,y,T;for((d&1)===1&&(v=f>>8,m[d]=i(r[0],v),--d,v=f&255,y=u[u.length-1],m[d]=i(y,v));d>0;)--d,v=f>>8,m[d]=i(u[d],v),--d,v=f&255,m[d]=i(u[d],v);for(d=15,T=15-u.length;T>0;)v=f>>8,m[d]=i(r[T],v),--d,--T,v=f&255,m[d]=i(u[d],v),--d,--T;return m}})(),d8=function(r,e,t,n,i){i||(i=e),n||(n=pk(r));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=n[t],l=(l>>5|l<<3)&255,i[s]=l,++t;return[i,t,n]},m8=function(r){var e=0,t=pk(r);return function(n){var i=d8("",n,e,t);return e=i[1],i[0]}};function p8(r,e,t,n){var i={key:en(r),verificationBytes:en(r)};return t.password&&(i.verifier=Dv(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=m8(t.password)),i}function g8(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=h8(r):n.Data=f8(r,e),n}function _8(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?g8(r,e-2,n):p8(r,t.biff>=8?e:e-2,t,n),n}var gk=(function(){function r(i,s){switch(s.type){case"base64":return e(Mi(i),s);case"binary":return e(i,s);case"buffer":return e(St&&Buffer.isBuffer(i)?i.toString("binary"):nl(i),s);case"array":return e(ic(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var l=s||{},u=l.dense?[]:{},f=i.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,_){Array.isArray(u)&&(u[_]=[]);for(var v=/\\\w+\b/g,y=0,T,E=-1;T=v.exec(m);){switch(T[0]){case"\\cell":var S=m.slice(y,v.lastIndex-T[0].length);if(S[0]==" "&&(S=S.slice(1)),++E,S.length){var D={v:S,t:"s"};Array.isArray(u)?u[_][E]=D:u[ft({r:_,c:E})]=D}break}y=v.lastIndex}E>d.e.c&&(d.e.c=E)}),u["!ref"]=vt(d),u}function t(i,s){return il(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],l=Ft(i["!ref"]),u,f=Array.isArray(i),d=l.s.r;d<=l.e.r;++d){s.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var _=ft({r:d,c:m});u=f?(i[d]||[])[m]:i[_],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(rs(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}})();function x8(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function s0(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function v8(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(e,t,n),s=Math.min(e,t,n),l=i-s;if(l===0)return[0,0,e];var u=0,f=0,d=i+s;switch(f=l/(d>1?2-d:d),i){case e:u=((t-n)/l+6)%6;break;case t:u=(n-e)/l+2;break;case n:u=(e-t)/l+4;break}return[u/6,f,d/2]}function y8(r){var e=r[0],t=r[1],n=r[2],i=t*2*(n<.5?n:1-n),s=n-i/2,l=[s,s,s],u=6*e,f;if(t!==0)switch(u|0){case 0:case 6:f=i*u,l[0]+=i,l[1]+=f;break;case 1:f=i*(2-u),l[0]+=f,l[1]+=i;break;case 2:f=i*(u-2),l[1]+=i,l[2]+=f;break;case 3:f=i*(4-u),l[1]+=f,l[2]+=i;break;case 4:f=i*(u-4),l[2]+=i,l[0]+=f;break;case 5:f=i*(6-u),l[2]+=f,l[0]+=i;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function cp(r,e){if(e===0)return r;var t=v8(x8(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),s0(y8(t))}var _k=6,E8=15,T8=1,zn=_k;function o0(r){return Math.floor((r+Math.round(128/zn)/256)*zn)}function l0(r){return Math.floor((r-5)/zn*100+.5)/100}function up(r){return Math.round((r*zn+5)/zn*256)/256}function D_(r){return up(l0(o0(r)))}function Nv(r){var e=Math.abs(r-D_(r)),t=zn;if(e>.005)for(zn=T8;zn<E8;++zn)Math.abs(r-D_(r))<=e&&(e=Math.abs(r-D_(r)),t=zn);zn=t}function Yo(r){r.width?(r.wpx=o0(r.width),r.wch=l0(r.wpx),r.MDW=zn):r.wpx?(r.wch=l0(r.wpx),r.width=up(r.wch),r.MDW=zn):typeof r.wch=="number"&&(r.width=up(r.wch),r.wpx=o0(r.width),r.MDW=zn),r.customWidth&&delete r.customWidth}var w8=96,xk=w8;function c0(r){return r*96/xk}function qu(r){return r*xk/96}var S8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function A8(r,e,t,n){e.Borders=[];var i={},s=!1;(r[0].match(Xn)||[]).forEach(function(l){var u=ht(l);switch(as(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=xr(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=xr(u.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function b8(r,e,t,n){e.Fills=[];var i={},s=!1;(r[0].match(Xn)||[]).forEach(function(l){var u=ht(l);switch(as(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function I8(r,e,t,n){e.Fonts=[];var i={},s=!1;(r[0].match(Xn)||[]).forEach(function(l){var u=ht(l);switch(as(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=fr(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?xr(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?xr(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?xr(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?xr(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?xr(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?xr(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?xr(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=iv[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=xr(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var f=ql[i.color.index];i.color.index==81&&(f=ql[1]),f||(f=ql[1]),i.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=cp(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function k8(r,e,t){e.NumberFmt=[];for(var n=Vr(ot),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ot[n[i]];var s=r[0].match(Xn);if(s)for(i=0;i<s.length;++i){var l=ht(s[i]);switch(as(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=zt(fr(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Za(u,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function C8(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=Ue("numFmt",null,{numFmtId:n,formatCode:ar(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var wm=["numFmtId","fillId","fontId","borderId","xfId"],Sm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function R8(r,e,t){e.CellXf=[];var n,i=!1;(r[0].match(Xn)||[]).forEach(function(s){var l=ht(s),u=0;switch(as(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<wm.length;++u)n[wm[u]]&&(n[wm[u]]=parseInt(n[wm[u]],10));for(u=0;u<Sm.length;++u)n[Sm[u]]&&(n[Sm[u]]=xr(n[Sm[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=xr(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function D8(r){var e=[];return e[e.length]=Ue("cellXfs",null),r.forEach(function(t){e[e.length]=Ue("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var N8=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=u.match(e))&&k8(_,m,d),(_=u.match(i))&&I8(_,m,f,d),(_=u.match(n))&&b8(_,m,f,d),(_=u.match(s))&&A8(_,m,f,d),(_=u.match(t))&&R8(_,m,d),m}})();function vk(r,e){var t=[Hr,Ue("styleSheet",null,{xmlns:Ec[0],"xmlns:vt":cn.vt})],n;return r.SSF&&(n=C8(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=D8(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function O8(r,e){var t=r.read_shift(2),n=qn(r);return[t,n]}function F8(r,e,t){t||(t=we(6+4*e.length)),t.write_shift(2,r),yn(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function P8(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=gO(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=r.read_shift(1);l!=0&&(n.underline=l);var u=r.read_shift(1);u>0&&(n.family=u);var f=r.read_shift(1);switch(f>0&&(n.charset=f),r.l++,n.color=pO(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=qn(r),n}function M8(r,e){e||(e=we(153)),e.write_shift(2,r.sz*20),_O(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),sp(r.color,e);var n=0;return n=2,e.write_shift(1,n),yn(r.name,e),e.length>e.l?e.slice(0,e.l):e}var L8=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],N_,V8=Wn;function AS(r,e){e||(e=we(84)),N_||(N_=zp(L8));var t=N_[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(sp({auto:1},e),sp({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function B8(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function yk(r,e,t){t||(t=we(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function mh(r,e){return e||(e=we(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var U8=Wn;function z8(r,e){return e||(e=we(51)),e.write_shift(1,0),mh(null,e),mh(null,e),mh(null,e),mh(null,e),mh(null,e),e.length>e.l?e.slice(0,e.l):e}function j8(r,e){return e||(e=we(52)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ap(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function H8(r,e,t){var n=we(2052);return n.write_shift(4,r),ap(e,n),ap(t,n),n.length>n.l?n.slice(0,n.l):n}function G8(r,e,t){var n={};n.NumberFmt=[];for(var i in ot)n.NumberFmt[i]=ot[i];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return Gs(r,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],Za(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=cp(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(m),l=!0;break;case 38:s.pop(),l=!1;break;default:if(d.T>0)s.push(m);else if(d.T<0)s.pop();else if(!l||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function q8(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(Ne(r,615,Ra(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ne(r,44,F8(i,e[i]))}),Ne(r,616))}}function K8(r){var e=1;Ne(r,611,Ra(e)),Ne(r,43,M8({sz:12,color:{theme:1},name:"Calibri",family:2})),Ne(r,612)}function W8(r){var e=2;Ne(r,603,Ra(e)),Ne(r,45,AS({patternType:"none"})),Ne(r,45,AS({patternType:"gray125"})),Ne(r,604)}function X8(r){var e=1;Ne(r,613,Ra(e)),Ne(r,46,z8()),Ne(r,614)}function Y8(r){var e=1;Ne(r,626,Ra(e)),Ne(r,47,yk({numFmtId:0},65535)),Ne(r,627)}function $8(r,e){Ne(r,617,Ra(e.length)),e.forEach(function(t){Ne(r,47,yk(t,0))}),Ne(r,618)}function Q8(r){var e=1;Ne(r,619,Ra(e)),Ne(r,48,j8({xfId:0,name:"Normal"})),Ne(r,620)}function J8(r){var e=0;Ne(r,505,Ra(e)),Ne(r,506)}function Z8(r){var e=0;Ne(r,508,H8(e,"TableStyleMedium9","PivotStyleMedium4")),Ne(r,509)}function eP(r,e){var t=pi();return Ne(t,278),q8(t,r.SSF),K8(t),W8(t),X8(t),Y8(t),$8(t,e.cellXfs),Q8(t),J8(t),Z8(t),Ne(t,279),t.end()}var tP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function rP(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(Xn)||[]).forEach(function(i){var s=ht(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[tP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function nP(){}function iP(){}var aP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,sP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,oP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function lP(r,e,t){e.themeElements={};var n;[["clrScheme",aP,rP],["fontScheme",sP,nP],["fmtScheme",oP,iP]].forEach(function(i){if(!(n=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,t)})}var cP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ek(r,e){(!r||r.length===0)&&(r=Ov());var t,n={};if(!(t=r.match(cP)))throw new Error("themeElements not found in theme");return lP(t[0],n,e),n.raw=r,n}function Ov(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Hr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function uP(r,e,t){var n=r.l+e,i=r.read_shift(4);if(i!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var l;try{l=_I(s,{type:"array"})}catch{return}var u=Ri(l,"theme/theme/theme1.xml",!0);if(u)return Ek(u,t)}}function fP(r){return r.read_shift(4)}function hP(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=dP(r,4);break;case 2:e.xclrValue=ek(r);break;case 3:e.xclrValue=fP(r);break;case 4:r.l+=4;break}return r.l+=8,e}function dP(r,e){return Wn(r,e)}function mP(r,e){return Wn(r,e)}function pP(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=hP(r);break;case 6:n[1]=mP(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function gP(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),s=[];i-- >0;)s.push(pP(r,t-r.l));return{ixfe:n,ext:s}}function _P(r,e){e.forEach(function(t){t[0]})}function xP(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:qn(r)}}function vP(r){var e=we(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),yn(r.name,e),e.slice(0,e.l)}function yP(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function EP(r){var e=we(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function TP(r,e){var t=we(8+2*e.length);return t.write_shift(4,r),yn(e,t),t.slice(0,t.l)}function wP(r){return r.l+=4,r.read_shift(4)!=0}function SP(r,e){var t=we(8);return t.write_shift(4,r),t.write_shift(4,1),t}function AP(r,e,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],l=!1,u=2;return Gs(r,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(_){u==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):u==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:s.push(m),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!d.T){if(!l||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function bP(){var r=pi();return Ne(r,332),Ne(r,334,Ra(1)),Ne(r,335,vP({name:"XLDAPR",version:12e4,flags:3496657072})),Ne(r,336),Ne(r,339,TP(1,"XLDAPR")),Ne(r,52),Ne(r,35,Ra(514)),Ne(r,4096,Ra(0)),Ne(r,4097,na(1)),Ne(r,36),Ne(r,53),Ne(r,340),Ne(r,337,SP(1)),Ne(r,51,EP([[1,0]])),Ne(r,338),Ne(r,333),r.end()}function IP(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var i=!1,s=2,l;return r.replace(Xn,function(u){var f=ht(u);switch(as(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):s==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function Tk(){var r=[Hr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function kP(r){var e=[];if(!r)return e;var t=1;return(r.match(Xn)||[]).forEach(function(n){var i=ht(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function CP(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=ft(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function RP(r,e,t){var n=[];return Gs(r,function(s,l,u){switch(u){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function DP(r,e,t,n){if(!r)return r;var i=n||{},s=!1;Gs(r,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function NP(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var Nu=1024;function wk(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[Ue("xml",null,{"xmlns:v":ki.v,"xmlns:o":ki.o,"xmlns:x":ki.x,"xmlns:mv":ki.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Nu<r*1e3;)Nu+=1e3;return e.forEach(function(s){var l=Cr(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ue("v:fill",f,u),m={on:"t",obscured:"t"};++Nu,i=i.concat(["<v:shape"+n0({id:"_x0000_s"+Nu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ue("v:shadow",null,m),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Dn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Dn("x:AutoFill","False"),Dn("x:Row",String(l.r)),Dn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function bS(r,e,t,n){var i=Array.isArray(r),s;e.forEach(function(l){var u=Cr(l.ref);if(i?(r[u.r]||(r[u.r]=[]),s=r[u.r][u.c]):s=r[l.ref],!s){s={t:"z"},i?r[u.r][u.c]=s:r[l.ref]=s;var f=Ft(r["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=vt(f);d!==r["!ref"]&&(r["!ref"]=d)}s.c||(s.c=[]);var m={a:l.author,t:l.t,r:l.r,T:t};l.h&&(m.h=l.h);for(var _=s.c.length-1;_>=0;--_){if(!t&&s.c[_].T)return;t&&!s.c[_].T&&s.c.splice(_,1)}if(t&&n){for(_=0;_<n.length;++_)if(m.a==n[_].id){m.a=n[_].name||m.a;break}}s.c.push(m)})}function OP(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&t.push(u[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=ht(u[0]),d={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=Cr(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var _=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!_&&!!_[1]&&Rv(_[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function Sk(r){var e=[Hr,Ue("comments",null,{xmlns:Ec[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var s=ar(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(i=t.indexOf(ar(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Dn("t",ar(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;e.push(Dn("t",ar(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function FP(r,e){var t=[],n=!1,i={},s=0;return r.replace(Xn,function(u,f){var d=ht(u);switch(as(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=f+u.length;break;case"</text>":i.t=r.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),t}function PP(r,e,t){var n=[Hr,Ue("ThreadedComments",null,{xmlns:cn.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var s="";(i[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};u==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(Ue("threadedComment",Dn("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function MP(r,e){var t=[],n=!1;return r.replace(Xn,function(s){var l=ht(s);switch(as(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),t}function LP(r){var e=[Hr,Ue("personList",null,{xmlns:cn.TCMNT,"xmlns:x":Ec[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(Ue("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function VP(r){var e={};e.iauthor=r.read_shift(4);var t=Ac(r);return e.rfx=t.s,e.ref=ft(t.s),r.l+=16,e}function BP(r,e){return e==null&&(e=we(36)),e.write_shift(4,r[1].iauthor),ff(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var UP=qn;function zP(r){return yn(r.slice(0,54))}function jP(r,e){var t=[],n=[],i={},s=!1;return Gs(r,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}function HP(r){var e=pi(),t=[];return Ne(e,628),Ne(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ne(e,632,zP(i.a)))})}),Ne(e,631),Ne(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Cr(n[0]),e:Cr(n[0])};Ne(e,635,BP([s,i])),i.t&&i.t.length>0&&Ne(e,637,fO(i)),Ne(e,636),delete i.iauthor})}),Ne(e,634),Ne(e,629),e.end()}var GP="application/vnd.ms-office.vbaProject";function qP(r){var e=it.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(e,i,r.FileIndex[n].content)}}),it.write(e)}function KP(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&it.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var Ak=["xlsb","xlsm","xlam","biff8","xla"];function WP(){return{"!type":"dialog"}}function XP(){return{"!type":"dialog"}}function YP(){return{"!type":"macro"}}function $P(){return{"!type":"macro"}}var Mu=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,l){var u=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=e.c:--m,f?d+=e.r:--d,i+(u?"":"$")+vr(m)+(f?"":"$")+Mr(d)}return function(i,s){return e=s,i.replace(r,t)}})(),Fv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Pv=(function(){return function(e,t){return e.replace(Fv,function(n,i,s,l,u,f){var d=Ev(l)-(s?0:t.c),m=yv(f)-(u?0:t.r),_=m==0?"":u?m+1:"["+m+"]",v=d==0?"":s?d+1:"["+d+"]";return i+"R"+_+"C"+v})}})();function bk(r,e){return r.replace(Fv,function(t,n,i,s,l,u){return n+(i=="$"?i+s:vr(Ev(s)+e.c))+(l=="$"?l+u:Mr(yv(u)+e.r))})}function QP(r,e,t){var n=ii(e),i=n.s,s=Cr(t),l={r:s.r-i.r,c:s.c-i.c};return bk(r,l)}function JP(r){return r.length!=1}function IS(r){return r.replace(/_xlfn\./g,"")}function Qr(r){r.l+=1}function $o(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Ik(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return kk(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),l=$o(r),u=$o(r);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function kk(r){var e=$o(r),t=$o(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function ZP(r,e,t){if(t.biff<8)return kk(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=$o(r),l=$o(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Ck(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return eM(r);var n=r.read_shift(t&&t.biff==12?4:2),i=$o(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function eM(r){var e=$o(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function tM(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function rM(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return nM(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),l=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;i>524287;)i-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:l,rRel:u}}function nM(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function iM(r,e,t){var n=(r[r.l++]&96)>>5,i=Ik(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function aM(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var l=Ik(r,s,t);return[n,i,l]}function sM(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function oM(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function lM(r,e,t){var n=(r[r.l++]&96)>>5,i=ZP(r,e-1,t);return[n,i]}function cM(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function kS(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function uM(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function fM(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function hM(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function dM(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function mM(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function Rk(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function pM(r){return r.read_shift(2),Rk(r)}function gM(r){return r.read_shift(2),Rk(r)}function _M(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=Ck(r,0,t);return[n,i]}function xM(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=rM(r,0,t);return[n,i]}function vM(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=Ck(r,0,t);return[n,i,s]}function yM(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[w9[i],Ok[i],n]}function EM(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:TM(r);return[i,(s[0]===0?Ok:T9)[s[1]]]}function TM(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function wM(r,e,t){r.l+=t&&t.biff==2?3:4}function SM(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function AM(r){return r.l++,qs[r.read_shift(1)]}function bM(r){return r.l++,r.read_shift(2)}function IM(r){return r.l++,r.read_shift(1)!==0}function kM(r){return r.l++,jn(r)}function CM(r,e,t){return r.l++,D0(r,e-1,t)}function RM(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=jr(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=qs[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=jn(r);break;case 2:t[1]=bc(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function DM(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?Ac:qp)(r));return i}function NM(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var u=0;u!=i;++u)l[s][u]=RM(r,t.biff);return l}function OM(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function FM(r,e,t){if(t.biff==5)return PM(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function PM(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function MM(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function LM(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function VM(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function BM(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var UM=Wn,zM=Wn,jM=Wn;function O0(r,e,t){return r.l+=2,[tM(r)]}function Mv(r){return r.l+=6,[]}var HM=O0,GM=Mv,qM=Mv,KM=O0;function Dk(r){return r.l+=2,[en(r),r.read_shift(2)&1]}var WM=O0,XM=Dk,YM=Mv,$M=O0,QM=O0,JM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ZM(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),l=JM[t>>2&31];return{ixti:e,coltype:t&3,rt:l,idx:n,c:i,C:s}}function e9(r){return r.l+=2,[r.read_shift(4)]}function t9(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function r9(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function n9(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function i9(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function a9(r){return r.l+=4,[0,0]}var CS={1:{n:"PtgExp",f:SM},2:{n:"PtgTbl",f:jM},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:CM},26:{n:"PtgSheet",f:t9},27:{n:"PtgEndSheet",f:r9},28:{n:"PtgErr",f:AM},29:{n:"PtgBool",f:IM},30:{n:"PtgInt",f:bM},31:{n:"PtgNum",f:kM},32:{n:"PtgArray",f:cM},33:{n:"PtgFunc",f:yM},34:{n:"PtgFuncVar",f:EM},35:{n:"PtgName",f:OM},36:{n:"PtgRef",f:_M},37:{n:"PtgArea",f:iM},38:{n:"PtgMemArea",f:MM},39:{n:"PtgMemErr",f:UM},40:{n:"PtgMemNoMem",f:zM},41:{n:"PtgMemFunc",f:LM},42:{n:"PtgRefErr",f:VM},43:{n:"PtgAreaErr",f:sM},44:{n:"PtgRefN",f:xM},45:{n:"PtgAreaN",f:lM},46:{n:"PtgMemAreaN",f:n9},47:{n:"PtgMemNoMemN",f:i9},57:{n:"PtgNameX",f:FM},58:{n:"PtgRef3d",f:vM},59:{n:"PtgArea3d",f:aM},60:{n:"PtgRefErr3d",f:BM},61:{n:"PtgAreaErr3d",f:oM},255:{}},s9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},o9={1:{n:"PtgElfLel",f:Dk},2:{n:"PtgElfRw",f:$M},3:{n:"PtgElfCol",f:HM},6:{n:"PtgElfRwV",f:QM},7:{n:"PtgElfColV",f:KM},10:{n:"PtgElfRadical",f:WM},11:{n:"PtgElfRadicalS",f:YM},13:{n:"PtgElfColS",f:GM},15:{n:"PtgElfColSV",f:qM},16:{n:"PtgElfRadicalLel",f:XM},25:{n:"PtgList",f:ZM},29:{n:"PtgSxName",f:e9},255:{}},l9={0:{n:"PtgAttrNoop",f:a9},1:{n:"PtgAttrSemi",f:mM},2:{n:"PtgAttrIf",f:hM},4:{n:"PtgAttrChoose",f:uM},8:{n:"PtgAttrGoto",f:fM},16:{n:"PtgAttrSum",f:wM},32:{n:"PtgAttrBaxcel",f:kS},33:{n:"PtgAttrBaxcel",f:kS},64:{n:"PtgAttrSpace",f:pM},65:{n:"PtgAttrSpaceSemi",f:gM},128:{n:"PtgAttrIfError",f:dM},255:{}};function F0(r,e,t,n){if(n.biff<8)return Wn(r,e);for(var i=r.l+e,s=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=NM(r,0,n),s.push(t[l][1]);break;case"PtgMemArea":t[l][2]=DM(r,t[l][1],n),s.push(t[l][2]);break;case"PtgExp":n&&n.biff==12&&(t[l][1][1]=r.read_shift(4),s.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return e=i-r.l,e!==0&&s.push(Wn(r,e)),s}function P0(r,e,t){for(var n=r.l+e,i,s,l=[];n!=r.l;)e=n-r.l,s=r[r.l],i=CS[s]||CS[s9[s]],(s===24||s===25)&&(i=(s===24?o9:l9)[r[r.l+1]]),!i||!i.f?Wn(r,e):l.push([i.n,i.f(r,e,t)]);return l}function c9(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var u9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function f9(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function Nk(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function RS(r,e,t){var n=Nk(r,e,t);return n=="#REF"?n:f9(n,t)}function Un(r,e,t,n,i){var s=i&&i.biff||8,l={s:{c:0,r:0}},u=[],f,d,m,_=0,v=0,y,T="";if(!r[0]||!r[0][0])return"";for(var E=-1,S="",D=0,U=r[0].length;D<U;++D){var k=r[0][D];switch(k[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),E>=0){switch(r[0][E][1][0]){case 0:S=Or(" ",r[0][E][1][1]);break;case 1:S=Or("\r",r[0][E][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][E][1][0])}d=d+S,E=-1}u.push(d+u9[k[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Oh(k[1][1],l,i),u.push(Fh(m,s));break;case"PtgRefN":m=t?Oh(k[1][1],t,i):k[1][1],u.push(Fh(m,s));break;case"PtgRef3d":_=k[1][1],m=Oh(k[1][2],l,i),T=RS(n,_,i),u.push(T+"!"+Fh(m,s));break;case"PtgFunc":case"PtgFuncVar":var W=k[1][0],ee=k[1][1];W||(W=0),W&=127;var X=W==0?[]:u.slice(-W);u.length-=W,ee==="User"&&(ee=X.shift()),u.push(ee+"("+X.join(",")+")");break;case"PtgBool":u.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(k[1]);break;case"PtgNum":u.push(String(k[1]));break;case"PtgStr":u.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(k[1]);break;case"PtgAreaN":y=aS(k[1][1],t?{s:t}:l,i),u.push(k_(y,i));break;case"PtgArea":y=aS(k[1][1],l,i),u.push(k_(y,i));break;case"PtgArea3d":_=k[1][1],y=k[1][2],T=RS(n,_,i),u.push(T+"!"+k_(y,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=k[1][2];var A=(n.names||[])[v-1]||(n[0]||[])[v],R=A?A.Name:"SH33TJSNAME"+String(v);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),u.push(R);break;case"PtgNameX":var C=k[1][1];v=k[1][2];var B;if(i.biff<=5)C<0&&(C=-C),n[C]&&(B=n[C][v]);else{var N="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][v]&&n[C][v].itab>0&&(N=n.SheetNames[n[C][v].itab-1]+"!"):N=n.SheetNames[v-1]+"!"),n[C]&&n[C][v])N+=n[C][v].Name;else if(n[0]&&n[0][v])N+=n[0][v].Name;else{var M=(Nk(n,C,i)||"").split(";;");M[v-1]?N=M[v-1]:N+="SH33TJSERRX"}u.push(N);break}B||(B={Name:"SH33TJSERRY"}),u.push(B.Name);break;case"PtgParen":var V="(",xe=")";if(E>=0){switch(S="",r[0][E][1][0]){case 2:V=Or(" ",r[0][E][1][1])+V;break;case 3:V=Or("\r",r[0][E][1][1])+V;break;case 4:xe=Or(" ",r[0][E][1][1])+xe;break;case 5:xe=Or("\r",r[0][E][1][1])+xe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][E][1][0])}E=-1}u.push(V+u.pop()+xe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:k[1][1],r:k[1][0]};var ve={c:t.c,r:t.r};if(n.sharedf[ft(m)]){var ne=n.sharedf[ft(m)];u.push(Un(ne,l,ve,n,i))}else{var le=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push(Un(d[1],l,ve,n,i)),le=!0;break}le||u.push(k[1])}break;case"PtgArray":u.push("{"+c9(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&E>=0&&Pe.indexOf(r[0][D][0])==-1){k=r[0][E];var ae=!0;switch(k[1][0]){case 4:ae=!1;case 0:S=Or(" ",k[1][1]);break;case 5:ae=!1;case 1:S=Or("\r",k[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}u.push((ae?S:"")+u.pop()+(ae?"":S)),E=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function h9(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,l=r.read_shift(i);if(l==65535)return[[],Wn(r,e-2)];var u=P0(r,l,t);return e!==l+i&&(s=F0(r,e-l-i,u,t)),r.l=n,[u,s]}function d9(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,l=r.read_shift(i);if(l==65535)return[[],Wn(r,e-2)];var u=P0(r,l,t);return e!==l+i&&(s=F0(r,e-l-i,u,t)),r.l=n,[u,s]}function m9(r,e,t,n){var i=r.l+e,s=P0(r,n,t),l;return i!==r.l&&(l=F0(r,i-r.l,s,t)),[s,l]}function p9(r,e,t){var n=r.l+e,i,s=r.read_shift(2),l=P0(r,s,t);return s==65535?[[],Wn(r,e-2)]:(e!==s+2&&(i=F0(r,n-s-2,l,t)),[l,i])}function g9(r){var e;if(Rs(r,r.l+6)!==65535)return[jn(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function _9(r){if(r==null){var e=we(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return ac(r);return ac(0)}function O_(r,e,t){var n=r.l+e,i=ss(r);t.biff==2&&++r.l;var s=g9(r),l=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var u=d9(r,n-r.l,t);return{cell:i,val:s[0],formula:u,shared:l>>3&1,tt:s[1]}}function x9(r,e,t,n,i){var s=oc(e,t,i),l=_9(r.v),u=we(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=we(r.bf.length),m=0;m<r.bf.length;++m)d[m]=r.bf[m];var _=vn([s,l,u,d]);return _}function Kp(r,e,t){var n=r.read_shift(4),i=P0(r,n,t),s=r.read_shift(4),l=s>0?F0(r,s,i,t):null;return[i,l]}var v9=Kp,Wp=Kp,y9=Kp,E9=Kp,T9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ok={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},w9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function DS(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function S9(r){var e="of:="+r.replace(Fv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function F_(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function A9(r){return r.replace(/\./,"!")}var Mh={},Lu={},Lh=typeof Map<"u";function Lv(r,e,t){var n=0,i=r.length;if(t){if(Lh?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Lh?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(Lh?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Xp(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(zn=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=l0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=up(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Xl(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function al(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,s=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){Za(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(r[i].numFmtId===n)return i;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Fk(r,e,t,n,i,s){try{n.cellNF&&(r.z=ot[e])}catch(u){if(n.WTF)throw u}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=yr(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(ot[e]==null&&Za(E5[e]||"General",e),r.t==="e")r.w=r.w||qs[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=t0(r.v);else if(r.t==="d"){var l=un(r.v);(l|0)===l?r.w=l.toString(10):r.w=t0(l)}else{if(r.v===void 0)return"";r.w=nc(r.v,Lu)}else r.t==="d"?r.w=Li(e,un(r.v),Lu):r.w=Li(e,r.v,Lu)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=cp(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=cp(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&s.Fills)throw u}}}function b9(r,e,t){if(r&&r["!ref"]){var n=Ft(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function I9(r,e){var t=Ft(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=vt(t))}var k9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,C9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,R9=/<(?:\w:)?hyperlink [^>]*>/mg,D9=/"(\w*:\w*)"/,N9=/<(?:\w:)?col\b[^>]*[\/]?>/g,O9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,F9=/<(?:\w:)?pageMargins[^>]*\/>/g,Pk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,P9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,M9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function L9(r,e,t,n,i,s,l){if(!r)return r;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",_=r.match(C9);_?(d=r.slice(0,_.index),m=r.slice(_.index+_[0].length)):d=m=r;var v=d.match(Pk);v?Vv(v[0],u,i,t):(v=d.match(P9))&&B9(v[0],v[1]||"",u,i,t);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var T=d.slice(y,y+50).match(D9);T&&I9(u,T[1])}var E=d.match(M9);E&&E[1]&&J9(E[1],i);var S=[];if(e.cellStyles){var D=d.match(N9);D&&W9(S,D)}_&&tL(_[1],u,e,f,s,l);var U=m.match(O9);U&&(u["!autofilter"]=Y9(U[0]));var k=[],W=m.match(k9);if(W)for(y=0;y!=W.length;++y)k[y]=Ft(W[y].slice(W[y].indexOf('"')+1));var ee=m.match(R9);ee&&G9(u,ee,n);var X=m.match(F9);if(X&&(u["!margins"]=q9(ht(X[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=vt(f)),e.sheetRows>0&&u["!ref"]){var A=Ft(u["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=vt(A))}return S.length>0&&(u["!cols"]=S),k.length>0&&(u["!merges"]=k),u}function V9(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+vt(r[t])+'"/>';return e+"</mergeCells>"}function Vv(r,e,t,n){var i=ht(r);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=zt(fr(i.codeName)))}function B9(r,e,t,n,i){Vv(r.slice(0,r.indexOf(">")),t,n,i)}function U9(r,e,t,n,i){var s=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[t];try{e.Workbook&&(f=e.Workbook.Sheets[t].CodeName||f)}catch{}s=!0,l.codeName=$a(ar(f))}if(r&&r["!outline"]){var d={summaryBelow:1,summaryRight:1};r["!outline"].above&&(d.summaryBelow=0),r["!outline"].left&&(d.summaryRight=0),u=(u||"")+Ue("outlinePr",null,d)}!s&&!u||(i[i.length]=Ue("sheetPr",u,l))}var z9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],j9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function H9(r){var e={sheet:1};return z9.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),j9.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=Dv(r.password).toString(16).toUpperCase()),Ue("sheetProtection",null,e)}function G9(r,e,t){for(var n=Array.isArray(r),i=0;i!=e.length;++i){var s=ht(fr(e[i]),!0);if(!s.ref)return;var l=((t||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+zt(s.location))):(s.Target="#"+zt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=Ft(s.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var m=ft({c:d,r:f});n?(r[f]||(r[f]=[]),r[f][d]||(r[f][d]={t:"z",v:void 0}),r[f][d].l=s):(r[m]||(r[m]={t:"z",v:void 0}),r[m].l=s)}}}function q9(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function K9(r){return Xl(r),Ue("pageMargins",null,r)}function W9(r,e){for(var t=!1,n=0;n!=e.length;++n){var i=ht(e[n],!0);i.hidden&&(i.hidden=xr(i.hidden));var s=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,Nv(i.width)),Yo(i);s<=l;)r[s++]=pr(i)}}function X9(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=Ue("col",null,Xp(i,n)));return t[t.length]="</cols>",t.join("")}function Y9(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function $9(r,e,t,n){var i=typeof r.ref=="string"?r.ref:vt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,l=ii(i);l.s.r==l.e.r&&(l.e.r=ii(e["!ref"]).e.r,i=vt(l));for(var u=0;u<s.length;++u){var f=s[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),Ue("autoFilter",null,{ref:i})}var Q9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function J9(r,e){e.Views||(e.Views=[{}]),(r.match(Q9)||[]).forEach(function(t,n){var i=ht(t);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),xr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function Z9(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,i),{})}function eL(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",s=r.t,l=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=qs[r.v];break;case"d":n&&n.cellDates?i=yr(r.v,-1).toISOString():(r=pr(r),r.t="n",i=""+(r.v=un(yr(r.v)))),typeof r.z>"u"&&(r.z=ot[14]);break;default:i=r.v;break}var u=Dn("v",ar(i)),f={r:e},d=al(n.cellXfs,r,n);switch(d!==0&&(f.s=d),r.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Dn("v",""+Lv(n.Strings,r.v,n.revStrings)),f.t="s";break}f.t="str";break}if(r.t!=s&&(r.t=s,r.v=l),typeof r.f=="string"&&r.f){var m=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;u=Ue("f",ar(r.f),m)+(r.v!=null?u:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(f.cm=1),Ue("c",u,f)}var tL=(function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=r0("v"),l=r0("f");return function(f,d,m,_,v,y){for(var T=0,E="",S=[],D=[],U=0,k=0,W=0,ee="",X,A,R=0,C=0,B,N,M=0,V=0,xe=Array.isArray(y.CellXf),ve,ne=[],le=[],Pe=Array.isArray(d),ae=[],Me={},J=!1,O=!!m.sheetStubs,Q=f.split(e),q=0,te=Q.length;q!=te;++q){E=Q[q].trim();var oe=E.length;if(oe!==0){var Te=0;e:for(T=0;T<oe;++T)switch(E[T]){case">":if(E[T-1]!="/"){++T;break e}if(m&&m.cellStyles){if(A=ht(E.slice(Te,T),!0),R=A.r!=null?parseInt(A.r,10):R+1,C=-1,m.sheetRows&&m.sheetRows<R)continue;Me={},J=!1,A.ht&&(J=!0,Me.hpt=parseFloat(A.ht),Me.hpx=qu(Me.hpt)),A.hidden=="1"&&(J=!0,Me.hidden=!0),A.outlineLevel!=null&&(J=!0,Me.level=+A.outlineLevel),J&&(ae[R-1]=Me)}break;case"<":Te=T;break}if(Te>=T)break;if(A=ht(E.slice(Te,T),!0),R=A.r!=null?parseInt(A.r,10):R+1,C=-1,!(m.sheetRows&&m.sheetRows<R)){_.s.r>R-1&&(_.s.r=R-1),_.e.r<R-1&&(_.e.r=R-1),m&&m.cellStyles&&(Me={},J=!1,A.ht&&(J=!0,Me.hpt=parseFloat(A.ht),Me.hpx=qu(Me.hpt)),A.hidden=="1"&&(J=!0,Me.hidden=!0),A.outlineLevel!=null&&(J=!0,Me.level=+A.outlineLevel),J&&(ae[R-1]=Me)),S=E.slice(T).split(r);for(var ke=0;ke!=S.length&&S[ke].trim().charAt(0)=="<";++ke);for(S=S.slice(ke),T=0;T!=S.length;++T)if(E=S[T].trim(),E.length!==0){if(D=E.match(t),U=T,k=0,W=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,D!=null&&D.length===2){for(U=0,ee=D[1],k=0;k!=ee.length&&!((W=ee.charCodeAt(k)-64)<1||W>26);++k)U=26*U+W;--U,C=U}else++C;for(k=0;k!=E.length&&E.charCodeAt(k)!==62;++k);if(++k,A=ht(E.slice(0,k),!0),A.r||(A.r=ft({r:R-1,c:C})),ee=E.slice(k),X={t:""},(D=ee.match(s))!=null&&D[1]!==""&&(X.v=zt(D[1])),m.cellFormula){if((D=ee.match(l))!=null&&D[1]!==""){if(X.f=zt(fr(D[1])).replace(/\r\n/g,`
`),m.xlfn||(X.f=IS(X.f)),D[0].indexOf('t="array"')>-1)X.F=(ee.match(i)||[])[1],X.F.indexOf(":")>-1&&ne.push([Ft(X.F),X.F]);else if(D[0].indexOf('t="shared"')>-1){N=ht(D[0]);var be=zt(fr(D[1]));m.xlfn||(be=IS(be)),le[parseInt(N.si,10)]=[N,be,A.r]}}else(D=ee.match(/<f[^>]*\/>/))&&(N=ht(D[0]),le[N.si]&&(X.f=QP(le[N.si][1],le[N.si][2],A.r)));var De=Cr(A.r);for(k=0;k<ne.length;++k)De.r>=ne[k][0].s.r&&De.r<=ne[k][0].e.r&&De.c>=ne[k][0].s.c&&De.c<=ne[k][0].e.c&&(X.F=ne[k][1])}if(A.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(O)X.t="z";else continue;else X.t=A.t||"n";switch(_.s.c>C&&(_.s.c=C),_.e.c<C&&(_.e.c=C),X.t){case"n":if(X.v==""||X.v==null){if(!O)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!O)continue;X.t="z"}else B=Mh[parseInt(X.v,10)],X.v=B.t,X.r=B.r,m.cellHTML&&(X.h=B.h);break;case"str":X.t="s",X.v=X.v!=null?fr(X.v):"",m.cellHTML&&(X.h=hv(X.v));break;case"inlineStr":D=ee.match(n),X.t="s",D!=null&&(B=Rv(D[1]))?(X.v=B.t,m.cellHTML&&(X.h=B.h)):X.v="";break;case"b":X.v=xr(X.v);break;case"d":m.cellDates?X.v=yr(X.v,1):(X.v=un(yr(X.v,1)),X.t="n");break;case"e":(!m||m.cellText!==!1)&&(X.w=X.v),X.v=LI[X.v];break}if(M=V=0,ve=null,xe&&A.s!==void 0&&(ve=y.CellXf[A.s],ve!=null&&(ve.numFmtId!=null&&(M=ve.numFmtId),m.cellStyles&&ve.fillId!=null&&(V=ve.fillId))),Fk(X,M,V,m,v,y),m.cellDates&&xe&&X.t=="n"&&yc(ot[M])&&(X.t="d",X.v=Hp(X.v)),A.cm&&m.xlmeta){var lt=(m.xlmeta.Cell||[])[+A.cm-1];lt&&lt.type=="XLDAPR"&&(X.D=!0)}if(Pe){var Z=Cr(A.r);d[Z.r]||(d[Z.r]=[]),d[Z.r][Z.c]=X}else d[A.r]=X}}}}ae.length>0&&(d["!rows"]=ae)}})();function rL(r,e,t,n){var i=[],s=[],l=Ft(r["!ref"]),u="",f,d="",m=[],_=0,v=0,y=r["!rows"],T=Array.isArray(r),E={r:d},S,D=-1;for(v=l.s.c;v<=l.e.c;++v)m[v]=vr(v);for(_=l.s.r;_<=l.e.r;++_){for(s=[],d=Mr(_),v=l.s.c;v<=l.e.c;++v){f=m[v]+d;var U=T?(r[_]||[])[v]:r[f];U!==void 0&&(u=eL(U,f,r,e))!=null&&s.push(u)}(s.length>0||y&&y[_])&&(E={r:d},y&&y[_]&&(S=y[_],S.hidden&&(E.hidden=1),D=-1,S.hpx?D=c0(S.hpx):S.hpt&&(D=S.hpt),D>-1&&(E.ht=D,E.customHeight=1),S.level&&(E.outlineLevel=S.level)),i[i.length]=Ue("row",s.join(""),E))}if(y)for(;_<y.length;++_)y&&y[_]&&(E={r:_+1},S=y[_],S.hidden&&(E.hidden=1),D=-1,S.hpx?D=c0(S.hpx):S.hpt&&(D=S.hpt),D>-1&&(E.ht=D,E.customHeight=1),S.level&&(E.outlineLevel=S.level),i[i.length]=Ue("row","",E));return i.join("")}function Mk(r,e,t,n){var i=[Hr,Ue("worksheet",null,{xmlns:Ec[0],"xmlns:r":cn.r})],s=t.SheetNames[r],l=0,u="",f=t.Sheets[s];f==null&&(f={});var d=f["!ref"]||"A1",m=Ft(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=vt(m)}n||(n={}),f["!comments"]=[];var _=[];U9(f,t,r,e,i),i[i.length]=Ue("dimension",null,{ref:d}),i[i.length]=Z9(f,e,r,t),e.sheetFormat&&(i[i.length]=Ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(i[i.length]=X9(f,f["!cols"])),i[l=i.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=rL(f,e),u.length>0&&(i[i.length]=u)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),f["!protect"]&&(i[i.length]=H9(f["!protect"])),f["!autofilter"]!=null&&(i[i.length]=$9(f["!autofilter"],f,t,r)),f["!merges"]!=null&&f["!merges"].length>0&&(i[i.length]=V9(f["!merges"]));var v=-1,y,T=-1;return f["!links"].length>0&&(i[i.length]="<hyperlinks>",f["!links"].forEach(function(E){E[1].Target&&(y={ref:E[0]},E[1].Target.charAt(0)!="#"&&(T=nr(n,-1,ar(E[1].Target).replace(/#.*$/,""),bt.HLINK),y["r:id"]="rId"+T),(v=E[1].Target.indexOf("#"))>-1&&(y.location=ar(E[1].Target.slice(v+1))),E[1].Tooltip&&(y.tooltip=ar(E[1].Tooltip)),i[i.length]=Ue("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(i[i.length]=K9(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Dn("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:d}))),_.length>0&&(T=nr(n,-1,"../drawings/drawing"+(r+1)+".xml",bt.DRAW),i[i.length]=Ue("drawing",null,{"r:id":"rId"+T}),f["!drawing"]=_),f["!comments"].length>0&&(T=nr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML),i[i.length]=Ue("legacyDrawing",null,{"r:id":"rId"+T}),f["!legacy"]=T),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function nL(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function iL(r,e,t){var n=we(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;i.hpx?s=c0(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var _=-1,v=-1,y=m<<10;y<m+1<<10;++y){d.c=y;var T=Array.isArray(t)?(t[d.r]||[])[d.c]:t[ft(d)];T&&(_<0&&(_=y),v=y)}_<0||(++u,n.write_shift(4,_),n.write_shift(4,v))}var E=n.l;return n.l=f,n.write_shift(4,u),n.l=E,n.length>n.l?n.slice(0,n.l):n}function aL(r,e,t,n){var i=iL(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&Ne(r,0,i)}var sL=Ac,oL=ff;function lL(){}function cL(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=hO(r),t}function uL(r,e,t){t==null&&(t=we(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return sp({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),NI(r,t),t.slice(0,t.l)}function fL(r){var e=ua(r);return[e]}function hL(r,e,t){return t==null&&(t=we(8)),Tc(e,t)}function dL(r){var e=wc(r);return[e]}function mL(r,e,t){return t==null&&(t=we(4)),Sc(e,t)}function pL(r){var e=ua(r),t=r.read_shift(1);return[e,t,"b"]}function gL(r,e,t){return t==null&&(t=we(9)),Tc(e,t),t.write_shift(1,r.v?1:0),t}function _L(r){var e=wc(r),t=r.read_shift(1);return[e,t,"b"]}function xL(r,e,t){return t==null&&(t=we(5)),Sc(e,t),t.write_shift(1,r.v?1:0),t}function vL(r){var e=ua(r),t=r.read_shift(1);return[e,t,"e"]}function yL(r,e,t){return t==null&&(t=we(9)),Tc(e,t),t.write_shift(1,r.v),t}function EL(r){var e=wc(r),t=r.read_shift(1);return[e,t,"e"]}function TL(r,e,t){return t==null&&(t=we(8)),Sc(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function wL(r){var e=ua(r),t=r.read_shift(4);return[e,t,"s"]}function SL(r,e,t){return t==null&&(t=we(12)),Tc(e,t),t.write_shift(4,e.v),t}function AL(r){var e=wc(r),t=r.read_shift(4);return[e,t,"s"]}function bL(r,e,t){return t==null&&(t=we(8)),Sc(e,t),t.write_shift(4,e.v),t}function IL(r){var e=ua(r),t=jn(r);return[e,t,"n"]}function kL(r,e,t){return t==null&&(t=we(16)),Tc(e,t),ac(r.v,t),t}function Lk(r){var e=wc(r),t=jn(r);return[e,t,"n"]}function CL(r,e,t){return t==null&&(t=we(12)),Sc(e,t),ac(r.v,t),t}function RL(r){var e=ua(r),t=Av(r);return[e,t,"n"]}function DL(r,e,t){return t==null&&(t=we(12)),Tc(e,t),OI(r.v,t),t}function NL(r){var e=wc(r),t=Av(r);return[e,t,"n"]}function OL(r,e,t){return t==null&&(t=we(8)),Sc(e,t),OI(r.v,t),t}function FL(r){var e=ua(r),t=Tv(r);return[e,t,"is"]}function PL(r){var e=ua(r),t=qn(r);return[e,t,"str"]}function ML(r,e,t){return t==null&&(t=we(12+4*r.v.length)),Tc(e,t),yn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function LL(r){var e=wc(r),t=qn(r);return[e,t,"str"]}function VL(r,e,t){return t==null&&(t=we(8+4*r.v.length)),Sc(e,t),yn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function BL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=r.read_shift(1),l=[i,s,"b"];if(t.cellFormula){r.l+=2;var u=Wp(r,n-r.l,t);l[3]=Un(u,null,i,t.supbooks,t)}else r.l=n;return l}function UL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=r.read_shift(1),l=[i,s,"e"];if(t.cellFormula){r.l+=2;var u=Wp(r,n-r.l,t);l[3]=Un(u,null,i,t.supbooks,t)}else r.l=n;return l}function zL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=jn(r),l=[i,s,"n"];if(t.cellFormula){r.l+=2;var u=Wp(r,n-r.l,t);l[3]=Un(u,null,i,t.supbooks,t)}else r.l=n;return l}function jL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=qn(r),l=[i,s,"str"];if(t.cellFormula){r.l+=2;var u=Wp(r,n-r.l,t);l[3]=Un(u,null,i,t.supbooks,t)}else r.l=n;return l}var HL=Ac,GL=ff;function qL(r,e){return e==null&&(e=we(4)),e.write_shift(4,r),e}function KL(r,e){var t=r.l+e,n=Ac(r),i=wv(r),s=qn(r),l=qn(r),u=qn(r);r.l=t;var f={rfx:n,relId:i,loc:s,display:u};return l&&(f.Tooltip=l),f}function WL(r,e){var t=we(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));ff({s:Cr(r[0]),e:Cr(r[0])},t),Sv("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return yn(i||"",t),yn(r[1].Tooltip||"",t),yn("",t),t.slice(0,t.l)}function XL(){}function YL(r,e,t){var n=r.l+e,i=FI(r),s=r.read_shift(1),l=[i];if(l[2]=s,t.cellFormula){var u=v9(r,n-r.l,t);l[1]=u}else r.l=n;return l}function $L(r,e,t){var n=r.l+e,i=Ac(r),s=[i];if(t.cellFormula){var l=E9(r,n-r.l,t);s[1]=l,r.l=n}else r.l=n;return s}function QL(r,e,t){t==null&&(t=we(18));var n=Xp(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var Vk=["left","right","top","bottom","header","footer"];function JL(r){var e={};return Vk.forEach(function(t){e[t]=jn(r)}),e}function ZL(r,e){return e==null&&(e=we(48)),Xl(r),Vk.forEach(function(t){ac(r[t],e)}),e}function eV(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function tV(r,e,t){t==null&&(t=we(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function rV(r){var e=we(24);return e.write_shift(4,4),e.write_shift(4,1),ff(r,e),e}function nV(r,e){return e==null&&(e=we(66)),e.write_shift(2,r.password?Dv(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function iV(){}function aV(){}function sV(r,e,t,n,i,s,l){if(!r)return r;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,v=!1,y,T,E,S,D,U,k,W,ee,X=[];u.biff=12,u["!row"]=0;var A=0,R=!1,C=[],B={},N=u.supbooks||i.supbooks||[[]];if(N.sharedf=B,N.arrayf=C,N.SheetNames=i.SheetNames||i.Sheets.map(function(Pe){return Pe.name}),!u.supbooks&&(u.supbooks=N,i.Names))for(var M=0;M<i.Names.length;++M)N[0][M+1]=i.Names[M];var V=[],xe=[],ve=!1;u0[16]={n:"BrtShortReal",f:Lk};var ne;if(Gs(r,function(ae,Me,J){if(!v)switch(J){case 148:d=ae;break;case 0:y=ae,u.sheetRows&&u.sheetRows<=y.r&&(v=!0),W=Mr(S=y.r),u["!row"]=y.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=qu(ae.hpt)),xe[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(T={t:ae[2]},ae[2]){case"n":T.v=ae[1];break;case"s":k=Mh[ae[1]],T.v=k.t,T.r=k.r;break;case"b":T.v=!!ae[1];break;case"e":T.v=ae[1],u.cellText!==!1&&(T.w=qs[T.v]);break;case"str":T.t="s",T.v=ae[1];break;case"is":T.t="s",T.v=ae[1].t;break}if((E=l.CellXf[ae[0].iStyleRef])&&Fk(T,E.numFmtId,null,u,s,l),D=ae[0].c==-1?D+1:ae[0].c,u.dense?(f[S]||(f[S]=[]),f[S][D]=T):f[vr(D)+W]=T,u.cellFormula){for(R=!1,A=0;A<C.length;++A){var O=C[A];y.r>=O[0].s.r&&y.r<=O[0].e.r&&D>=O[0].s.c&&D<=O[0].e.c&&(T.F=vt(O[0]),R=!0)}!R&&ae.length>3&&(T.f=ae[3])}if(m.s.r>y.r&&(m.s.r=y.r),m.s.c>D&&(m.s.c=D),m.e.r<y.r&&(m.e.r=y.r),m.e.c<D&&(m.e.c=D),u.cellDates&&E&&T.t=="n"&&yc(ot[E.numFmtId])){var Q=Vo(T.v);Q&&(T.t="d",T.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}ne&&(ne.type=="XLDAPR"&&(T.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||_)break;T={t:"z",v:void 0},D=ae[0].c==-1?D+1:ae[0].c,u.dense?(f[S]||(f[S]=[]),f[S][D]=T):f[vr(D)+W]=T,m.s.r>y.r&&(m.s.r=y.r),m.s.c>D&&(m.s.c=D),m.e.r<y.r&&(m.e.r=y.r),m.e.c<D&&(m.e.c=D),ne&&(ne.type=="XLDAPR"&&(T.D=!0),ne=void 0);break;case 176:X.push(ae);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ae-1];break;case 494:var q=n["!id"][ae.relId];for(q?(ae.Target=q.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=q):ae.relId==""&&(ae.Target="#"+ae.loc),S=ae.rfx.s.r;S<=ae.rfx.e.r;++S)for(D=ae.rfx.s.c;D<=ae.rfx.e.c;++D)u.dense?(f[S]||(f[S]=[]),f[S][D]||(f[S][D]={t:"z",v:void 0}),f[S][D].l=ae):(U=ft({c:D,r:S}),f[U]||(f[U]={t:"z",v:void 0}),f[U].l=ae);break;case 426:if(!u.cellFormula)break;C.push(ae),ee=u.dense?f[S][D]:f[vr(D)+W],ee.f=Un(ae[1],m,{r:y.r,c:D},N,u),ee.F=vt(ae[0]);break;case 427:if(!u.cellFormula)break;B[ft(ae[0].s)]=ae[1],ee=u.dense?f[S][D]:f[vr(D)+W],ee.f=Un(ae[1],m,{r:y.r,c:D},N,u);break;case 60:if(!u.cellStyles)break;for(;ae.e>=ae.s;)V[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},ve||(ve=!0,Nv(ae.w/256)),Yo(V[ae.e+1]);break;case 161:f["!autofilter"]={ref:vt(ae)};break;case 476:f["!margins"]=ae;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),ae.name&&(i.Sheets[t].CodeName=ae.name),(ae.above||ae.left)&&(f["!outline"]={above:ae.above,left:ae.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ae.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!Me.T){if(!_||u.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=vt(d||m)),u.sheetRows&&f["!ref"]){var le=Ft(f["!ref"]);u.sheetRows<=+le.e.r&&(le.e.r=u.sheetRows-1,le.e.r>m.e.r&&(le.e.r=m.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>m.e.c&&(le.e.c=m.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),f["!fullref"]=f["!ref"],f["!ref"]=vt(le))}return X.length>0&&(f["!merges"]=X),V.length>0&&(f["!cols"]=V),xe.length>0&&(f["!rows"]=xe),f}function oV(r,e,t,n,i,s,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=pr(e),e.z=e.z||ot[14],e.v=un(yr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r:t,c:n};switch(f.s=al(i.cellXfs,e,i),e.l&&s["!links"].push([ft(f),e.l]),e.c&&s["!comments"].push([ft(f),e.c]),e.t){case"s":case"str":return i.bookSST?(u=Lv(i.Strings,e.v,i.revStrings),f.t="s",f.v=u,l?Ne(r,18,bL(e,f)):Ne(r,7,SL(e,f))):(f.t="str",l?Ne(r,17,VL(e,f)):Ne(r,6,ML(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Ne(r,13,OL(e,f)):Ne(r,2,DL(e,f)):l?Ne(r,16,CL(e,f)):Ne(r,5,kL(e,f)),!0;case"b":return f.t="b",l?Ne(r,15,xL(e,f)):Ne(r,4,gL(e,f)),!0;case"e":return f.t="e",l?Ne(r,14,TL(e,f)):Ne(r,3,yL(e,f)),!0}return l?Ne(r,12,mL(e,f)):Ne(r,1,hL(e,f)),!0}function lV(r,e,t,n){var i=Ft(e["!ref"]||"A1"),s,l="",u=[];Ne(r,145);var f=Array.isArray(e),d=i.e.r;e["!rows"]&&(d=Math.max(i.e.r,e["!rows"].length-1));for(var m=i.s.r;m<=d;++m){l=Mr(m),aL(r,e,i,m);var _=!1;if(m<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){m===i.s.r&&(u[v]=vr(v)),s=u[v]+l;var y=f?(e[m]||[])[v]:e[s];if(!y){_=!1;continue}_=oV(r,y,m,v,n,e,_)}}Ne(r,146)}function cV(r,e){!e||!e["!merges"]||(Ne(r,177,qL(e["!merges"].length)),e["!merges"].forEach(function(t){Ne(r,176,GL(t))}),Ne(r,178))}function uV(r,e){!e||!e["!cols"]||(Ne(r,390),e["!cols"].forEach(function(t,n){t&&Ne(r,60,QL(n,t))}),Ne(r,391))}function fV(r,e){!e||!e["!ref"]||(Ne(r,648),Ne(r,649,rV(Ft(e["!ref"]))),Ne(r,650))}function hV(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=nr(t,-1,n[1].Target.replace(/#.*$/,""),bt.HLINK);Ne(r,494,WL(n,i))}}),delete e["!links"]}function dV(r,e,t,n){if(e["!comments"].length>0){var i=nr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",bt.VML);Ne(r,551,Sv("rId"+i)),e["!legacy"]=i}}function mV(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:vt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,u=ii(s);u.s.r==u.e.r&&(u.e.r=ii(e["!ref"]).e.r,s=vt(u));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+t.SheetNames[n]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Ne(r,161,ff(Ft(s))),Ne(r,162)}}function pV(r,e,t){Ne(r,133),Ne(r,137,tV(e,t)),Ne(r,138),Ne(r,134)}function gV(r,e){e["!protect"]&&Ne(r,535,nV(e["!protect"]))}function _V(r,e,t,n){var i=pi(),s=t.SheetNames[r],l=t.Sheets[s]||{},u=s;try{t&&t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}var f=Ft(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ne(i,129),(t.vbaraw||l["!outline"])&&Ne(i,147,uL(u,l["!outline"])),Ne(i,148,oL(f)),pV(i,l,t.Workbook),uV(i,l),lV(i,l,r,e),gV(i,l),mV(i,l,t,r),cV(i,l),hV(i,l,n),l["!margins"]&&Ne(i,476,ZL(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&fV(i,l),dV(i,l,r,n),Ne(i,130),i.end()}function xV(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=t?+l[2]:l[2])});var i=zt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function vV(r,e,t,n,i,s){var l=s||{"!type":"chart"};if(!r)return s;var u=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var v=xV(_);m.s.r=m.s.c=0,m.e.c=u,d=vr(u),v[0].forEach(function(y,T){l[d+Mr(T)]={t:"n",v:y,z:v[1]},f=T}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(l["!ref"]=vt(m)),l}function yV(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,u=r.match(Pk);return u&&Vv(u[0],s,i,t),(l=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function EV(r,e){r.l+=10;var t=qn(r);return{name:t}}function TV(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Gs(r,function(f,d,m){switch(m){case 550:s["!rel"]=f;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),f.name&&(i.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Bv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],wV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SV=[],AV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function NS(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=xr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function OS(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=xr(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function Bk(r){OS(r.WBProps,Bv),OS(r.CalcPr,AV),NS(r.WBView,wV),NS(r.Sheets,SV),Lu.date1904=xr(r.WBProps.date1904)}function bV(r){return!r.Workbook||!r.Workbook.WBProps?"false":xr(r.Workbook.WBProps.date1904)?"true":"false"}var IV="][*?/\\".split("");function Uk(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return IV.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function kV(r,e,t){r.forEach(function(n,i){Uk(n);for(var s=0;s<i;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var l=e&&e[i]&&e[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function zk(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];kV(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)b9(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var CV=/<\w+:workbook/;function RV(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},l=0;if(r.replace(Xn,function(f,d){var m=ht(f);switch(as(m[0])){case"<?xml":break;case"<workbook":f.match(CV)&&(i="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=m[i];break;case"</workbook>":break;case"<fileVersion":delete m[0],t.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Bv.forEach(function(_){if(m[_[0]]!=null)switch(_[2]){case"bool":t.WBProps[_[0]]=xr(m[_[0]]);break;case"int":t.WBProps[_[0]]=parseInt(m[_[0]],10);break;default:t.WBProps[_[0]]=m[_[0]]}}),m.codeName&&(t.WBProps.CodeName=fr(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],t.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=zt(fr(m.name)),delete m[0],t.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=fr(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),xr(m.hidden||"0")&&(s.Hidden=!0),l=d+f.length;break;case"</definedName>":s.Ref=zt(fr(r.slice(l,d))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],t.CalcPr=m;break;case"<calcPr/>":delete m[0],t.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Ec.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Bk(t),t}function jk(r){var e=[Hr];e[e.length]=Ue("workbook",null,{xmlns:Ec[0],"xmlns:r":cn.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(Bv.forEach(function(u){r.Workbook.WBProps[u[0]]!=null&&r.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=r.Workbook.WBProps[u[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ue("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var l={name:ar(r.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Ue("sheet",null,l)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Ue("definedName",ar(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function DV(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=hx(r),t.name=qn(r),t}function NV(r,e){return e||(e=we(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Sv(r.strRelID,e),yn(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function OV(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?qn(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function FV(r,e){e||(e=we(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),NI(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function PV(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function MV(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=dO(r),l=y9(r,0,t),u=wv(r);r.l=n;var f={Name:s,Ptg:l};return i<268435455&&(f.Sheet=i),u&&(f.Comment=u),f}function LV(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],u0[16]={n:"BrtFRTArchID$",f:PV},Gs(r,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Un(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(m),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),Bk(t),t.Names=s,t.supbooks=l,t}function VV(r,e){Ne(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ne(r,156,NV(i))}Ne(r,144)}function BV(r,e){e||(e=we(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return yn("SheetJS",e),yn(Zh.version,e),yn(Zh.version,e),yn("7262",e),e.length>e.l?e.slice(0,e.l):e}function UV(r,e){e||(e=we(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function zV(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&s==-1&&(s=n);s>i||(Ne(r,135),Ne(r,158,UV(i)),Ne(r,136))}}function jV(r,e){var t=pi();return Ne(t,131),Ne(t,128,BV()),Ne(t,153,FV(r.Workbook&&r.Workbook.WBProps||null)),zV(t,r),VV(t,r),Ne(t,132),t.end()}function HV(r,e,t){return e.slice(-4)===".bin"?LV(r,t):RV(r,t)}function GV(r,e,t,n,i,s,l,u){return e.slice(-4)===".bin"?sV(r,n,t,i,s,l,u):L9(r,n,t,i,s,l,u)}function qV(r,e,t,n,i,s,l,u){return e.slice(-4)===".bin"?TV(r,n,t,i,s):yV(r,n,t,i,s)}function KV(r,e,t,n,i,s,l,u){return e.slice(-4)===".bin"?YP():$P()}function WV(r,e,t,n,i,s,l,u){return e.slice(-4)===".bin"?WP():XP()}function XV(r,e,t,n){return e.slice(-4)===".bin"?G8(r,t,n):N8(r,t,n)}function YV(r,e,t){return Ek(r,t)}function $V(r,e,t){return e.slice(-4)===".bin"?QF(r,t):XF(r,t)}function QV(r,e,t){return e.slice(-4)===".bin"?jP(r,t):OP(r,t)}function JV(r,e,t){return e.slice(-4)===".bin"?RP(r):kP(r)}function ZV(r,e,t,n){return t.slice(-4)===".bin"?DP(r,e,t,n):void 0}function eB(r,e,t){return e.slice(-4)===".bin"?AP(r,e,t):IP(r,e,t)}function tB(r,e,t){return(e.slice(-4)===".bin"?jV:jk)(r)}function rB(r,e,t,n,i){return(e.slice(-4)===".bin"?_V:Mk)(r,t,n,i)}function nB(r,e,t){return(e.slice(-4)===".bin"?eP:vk)(r,t)}function iB(r,e,t){return(e.slice(-4)===".bin"?e8:fk)(r,t)}function aB(r,e,t){return(e.slice(-4)===".bin"?HP:Sk)(r)}function sB(r){return(r.slice(-4)===".bin"?bP:Tk)()}var Hk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Gk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Sa(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=r.match(Hk),s,l,u,f;if(i)for(f=0;f!=i.length;++f)s=i[f].match(Gk),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(l+1),n[u]=s[2].slice(1,s[2].length-1));return n}function oB(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(Hk),i,s,l,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(Gk),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),t[l]=i[2].slice(1,i[2].length-1));return t}var Vh;function lB(r,e){var t=Vh[r]||zt(r);return t==="General"?nc(e):Li(t,e)}function cB(r,e,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=xr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=yr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[zt(e)]=i}function uB(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||qs[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=t0(r.v):r.w=nc(r.v):r.w=lB(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=Vh[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&yc(n)){var i=Vo(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function fB(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=S8[n.Pattern]||n.Pattern)}r[e.ID]=e}function hB(r,e,t,n,i,s,l,u,f,d){var m="General",_=n.StyleID,v={};d=d||{};var y=[],T=0;for(_===void 0&&u&&(_=u.StyleID),_===void 0&&l&&(_=l.StyleID);s[_]!==void 0&&(s[_].nf&&(m=s[_].nf),s[_].Interior&&y.push(s[_].Interior),!!s[_].Parent);)_=s[_].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=xr(r);break;case"String":n.t="s",n.r=$w(zt(r)),n.v=r.indexOf("<")>-1?zt(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(yr(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=zt(r):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=LI[r],d.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=$w(e||r));break}if(uB(n,m,d),d.cellFormula!==!1)if(n.Formula){var E=zt(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=Mu(E,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Mu("RC:RC",i):n.ArrayRange&&(n.F=Mu(n.ArrayRange,i),f.push([Ft(n.F),n.F]))}else for(T=0;T<f.length;++T)i.r>=f[T][0].s.r&&i.r<=f[T][0].e.r&&i.c>=f[T][0].s.c&&i.c<=f[T][0].e.c&&(n.F=f[T][1]);d.cellStyles&&(y.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function dB(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function P_(r,e){var t=e||{};lf();var n=Du(dv(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof Ut<"u"?n=Ut.utils.decode(65001,Zm(n)):n=fr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=pr(t);return l.type="string",Gu.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(nt){i.indexOf("<"+nt)>=0&&(s=!0)}),s)return YB(n,t);Vh={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,m={},_=[],v=t.dense?[]:{},y="",T={},E={},S=Sa('<Data ss:Type="String">'),D=0,U=0,k=0,W={s:{r:2e6,c:2e6},e:{r:0,c:0}},ee={},X={},A="",R=0,C=[],B={},N={},M=0,V=[],xe=[],ve={},ne=[],le,Pe=!1,ae=[],Me=[],J={},O=0,Q=0,q={Sheets:[],WBProps:{date1904:!1}},te={};i0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";u=i0.exec(n);)switch(u[3]=(oe=u[3]).toLowerCase()){case"data":if(oe=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?hB(n.slice(D,u.index),A,S,f[f.length-1][0]=="comment"?ve:T,{c:U,r:k},ee,ne[U],E,ae,t):(A="",S=Sa(u[0]),D=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(xe.length>0&&(T.c=xe),(!t.sheetRows||t.sheetRows>k)&&T.v!==void 0&&(t.dense?(v[k]||(v[k]=[]),v[k][U]=T):v[vr(U)+Mr(k)]=T),T.HRef&&(T.l={Target:zt(T.HRef)},T.HRefScreenTip&&(T.l.Tooltip=T.HRefScreenTip),delete T.HRef,delete T.HRefScreenTip),(T.MergeAcross||T.MergeDown)&&(O=U+(parseInt(T.MergeAcross,10)|0),Q=k+(parseInt(T.MergeDown,10)|0),C.push({s:{c:U,r:k},e:{c:O,r:Q}})),!t.sheetStubs)T.MergeAcross?U=O+1:++U;else if(T.MergeAcross||T.MergeDown){for(var Te=U;Te<=O;++Te)for(var ke=k;ke<=Q;++ke)(Te>U||ke>k)&&(t.dense?(v[ke]||(v[ke]=[]),v[ke][Te]={t:"z"}):v[vr(Te)+Mr(ke)]={t:"z"});U=O+1}else++U;else T=oB(u[0]),T.Index&&(U=+T.Index-1),U<W.s.c&&(W.s.c=U),U>W.e.c&&(W.e.c=U),u[0].slice(-2)==="/>"&&++U,xe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(k<W.s.r&&(W.s.r=k),k>W.e.r&&(W.e.r=k),u[0].slice(-2)==="/>"&&(E=Sa(u[0]),E.Index&&(k=+E.Index-1)),U=0,++k):(E=Sa(u[0]),E.Index&&(k=+E.Index-1),J={},(E.AutoFitHeight=="0"||E.Height)&&(J.hpx=parseInt(E.Height,10),J.hpt=c0(J.hpx),Me[k]=J),E.Hidden=="1"&&(J.hidden=!0,Me[k]=J));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));_.push(y),W.s.r<=W.e.r&&W.s.c<=W.e.c&&(v["!ref"]=vt(W),t.sheetRows&&t.sheetRows<=W.e.r&&(v["!fullref"]=v["!ref"],W.e.r=t.sheetRows-1,v["!ref"]=vt(W))),C.length&&(v["!merges"]=C),ne.length>0&&(v["!cols"]=ne),Me.length>0&&(v["!rows"]=Me),m[y]=v}else W={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=U=0,f.push([u[3],!1]),d=Sa(u[0]),y=zt(d.Name),v=t.dense?[]:{},C=[],ae=[],Me=[],te={name:y,Hidden:0},q.Sheets.push(te);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),ne=[],Pe=!1}break;case"style":u[1]==="/"?fB(ee,X,t):X=Sa(u[0]);break;case"numberformat":X.nf=zt(Sa(u[0]).Format||"General"),Vh[X.nf]&&(X.nf=Vh[X.nf]);for(var be=0;be!=392&&ot[be]!=X.nf;++be);if(be==392){for(be=57;be!=392;++be)if(ot[be]==null){Za(X.nf,be);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(le=Sa(u[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!Pe&&le.wpx>10){Pe=!0,zn=_k;for(var De=0;De<ne.length;++De)ne[De]&&Yo(ne[De])}Pe&&Yo(le),ne[le.Index-1||ne.length]=le;for(var lt=0;lt<+le.Span;++lt)ne[ne.length]=pr(le);break;case"namedrange":if(u[1]==="/")break;q.Names||(q.Names=[]);var Z=ht(u[0]),wt={Name:Z.Name,Ref:Mu(Z.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(wt.Sheet=q.Sheets.length-1),q.Names.push(wt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=n.slice(R,u.index):R=u.index+u[0].length;break;case"interior":if(!t.cellStyles)break;X.Interior=Sa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?VO(B,oe,n.slice(M,u.index)):M=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));dB(ve),xe.push(ve)}else f.push([u[3],!1]),d=Sa(u[0]),ve={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var ut=Sa(u[0]);v["!autofilter"]={ref:Mu(ut.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return VS(n,t);var It=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:It=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:It=!1}break;case"excelworkbook":switch(u[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:It=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:It=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(M,u.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else M=u.index+u[0].length;break;case"header":v["!margins"]||Xl(v["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(v["!margins"].header=+ht(u[0]).Margin);break;case"footer":v["!margins"]||Xl(v["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(v["!margins"].footer=+ht(u[0]).Margin);break;case"pagemargins":var qe=ht(u[0]);v["!margins"]||Xl(v["!margins"]={},"xlml"),isNaN(+qe.Top)||(v["!margins"].top=+qe.Top),isNaN(+qe.Left)||(v["!margins"].left=+qe.Left),isNaN(+qe.Right)||(v["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(v["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:It=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:It=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:It=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:It=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:It=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:It=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:It=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:It=!1}break;case"smarttags":break;default:It=!1;break}if(It||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?cB(N,oe,V,n.slice(M,u.index)):(V=u,M=u.index+u[0].length);break}if(t.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var Oe={};return!t.bookSheets&&!t.bookProps&&(Oe.Sheets=m),Oe.SheetNames=_,Oe.Workbook=q,Oe.SSF=pr(ot),Oe.Props=B,Oe.Custprops=N,Oe}function vx(r,e){switch(jv(e=e||{}),e.type||"base64"){case"base64":return P_(Mi(r),e);case"binary":case"buffer":case"file":return P_(r,e);case"array":return P_(nl(r),e)}}function mB(r,e){var t=[];return r.Props&&t.push(BO(r.Props,e)),r.Custprops&&t.push(UO(r.Props,r.Custprops)),t.join("")}function pB(){return""}function gB(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ue("NumberFormat",null,{"ss:Format":ar(ot[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};t.push(Ue("Style",s.join(""),l))}),Ue("Styles",t.join(""))}function qk(r){return Ue("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+Pv(r.Ref,{r:0,c:0})})}function _B(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(qk(i)))}return Ue("Names",t.join(""))}function xB(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],l=0;l<i.length;++l){var u=i[l];u.Sheet==t&&(u.Name.match(/^_xlfn\./)||s.push(qk(u)))}return s.join("")}function vB(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(Ue("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(Ue("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(Ue("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(Ue("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(Dn("ProtectContents","True")),r["!protect"].objects&&i.push(Dn("ProtectObjects","True")),r["!protect"].scenarios&&i.push(Dn("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(Dn("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(Dn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){r["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":Ue("WorksheetOptions",i.join(""),{xmlns:ki.x})}function yB(r){return r.map(function(e){var t=j5(e.t||""),n=Ue("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":e.a})}).join("")}function EB(r,e,t,n,i,s,l){if(!r||r.v==null&&r.f==null)return"";var u={};if(r.f&&(u["ss:Formula"]="="+ar(Pv(r.f,l))),r.F&&r.F.slice(0,e.length)==e){var f=Cr(r.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(r.l&&r.l.Target&&(u["ss:HRef"]=ar(r.l.Target),r.l.Tooltip&&(u["x:HRefScreenTip"]=ar(r.l.Tooltip))),t["!merges"])for(var d=t["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(u["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(u["ss:MergeDown"]=d[m].e.r-d[m].s.r));var _="",v="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":_="Number",v=String(r.v);break;case"b":_="Boolean",v=r.v?"1":"0";break;case"e":_="Error",v=qs[r.v];break;case"d":_="DateTime",v=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||ot[14]);break;case"s":_="String",v=z5(r.v||"");break}var y=al(n.cellXfs,r,n);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=l.c+1;var T=r.v!=null?v:"",E=r.t=="z"?"":'<Data ss:Type="'+_+'">'+T+"</Data>";return(r.c||[]).length>0&&(E+=yB(r.c)),Ue("Cell",E,u)}function TB(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=qu(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function wB(r,e,t,n){if(!r["!ref"])return"";var i=Ft(r["!ref"]),s=r["!merges"]||[],l=0,u=[];r["!cols"]&&r["!cols"].forEach(function(S,D){Yo(S);var U=!!S.width,k=Xp(D,S),W={"ss:Index":D+1};U&&(W["ss:Width"]=o0(k.width)),S.hidden&&(W["ss:Hidden"]="1"),u.push(Ue("Column",null,W))});for(var f=Array.isArray(r),d=i.s.r;d<=i.e.r;++d){for(var m=[TB(d,(r["!rows"]||[])[d])],_=i.s.c;_<=i.e.c;++_){var v=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>_)&&!(s[l].s.r>d)&&!(s[l].e.c<_)&&!(s[l].e.r<d)){(s[l].s.c!=_||s[l].s.r!=d)&&(v=!0);break}if(!v){var y={r:d,c:_},T=ft(y),E=f?(r[d]||[])[_]:r[T];m.push(EB(E,T,r,e,t,n,y))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function SB(r,e,t){var n=[],i=t.SheetNames[r],s=t.Sheets[i],l=s?xB(s,e,r,t):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?wB(s,e,r,t):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(vB(s,e,r,t)),n.join("")}function AB(r,e){e||(e={}),r.SSF||(r.SSF=pr(ot)),r.SSF&&(lf(),C0(r.SSF),e.revssf=jp(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],al(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(mB(r,e)),t.push(pB()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(Ue("Worksheet",SB(n,e,r),{"ss:Name":ar(r.SheetNames[n])}));return t[2]=gB(r,e),t[3]=_B(r),Hr+Ue("Workbook",t.join(""),{xmlns:ki.ss,"xmlns:o":ki.o,"xmlns:x":ki.x,"xmlns:ss":ki.ss,"xmlns:dt":ki.dt,"xmlns:html":ki.html})}function bB(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=xO(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=vO(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var IB=[60,1084,2066,2165,2175];function kB(r,e,t,n,i){var s=n,l=[],u=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}l.push(u),t.l+=s;for(var f=Rs(t,t.l),d=yx[f],m=0;d!=null&&IB.indexOf(f)>-1;)s=Rs(t,t.l+2),m=t.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=t.slice(m,t.l+4+s),l.push(u),t.l+=4+s,d=yx[f=Rs(t,t.l)];var _=vn(l);Rn(_,0);var v=0;_.lens=[];for(var y=0;y<l.length;++y)_.lens.push(v),v+=l[y].length;if(_.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+_.length+" < "+n;return e.f(_,_.length,i)}function Ka(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=ot[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||qs[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=t0(r.v):r.w=nc(r.v):r.w=Li(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&yc(ot[n]||String(n))){var i=Vo(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Am(r,e,t){return{v:r,ixfe:e,t}}function CB(r,e){var t={opts:{}},n={},i=e.dense?[]:{},s={},l={},u=null,f=[],d="",m={},_,v="",y,T,E,S,D={},U=[],k,W,ee=[],X=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},C=function(rt){return rt<8?ql[rt]:rt<64&&X[rt-8]||ql[rt]},B=function(rt,Kt,Ir){var kt=Kt.XF.data;if(!(!kt||!kt.patternType||!Ir||!Ir.cellStyles)){Kt.s={},Kt.s.patternType=kt.patternType;var Vt;(Vt=s0(C(kt.icvFore)))&&(Kt.s.fgColor={rgb:Vt}),(Vt=s0(C(kt.icvBack)))&&(Kt.s.bgColor={rgb:Vt})}},N=function(rt,Kt,Ir){if(!(J>1)&&!(Ir.sheetRows&&rt.r>=Ir.sheetRows)){if(Ir.cellStyles&&Kt.XF&&Kt.XF.data&&B(rt,Kt,Ir),delete Kt.ixfe,delete Kt.XF,_=rt,v=ft(rt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<l.s.r&&(l.s.r=rt.r),rt.c<l.s.c&&(l.s.c=rt.c),rt.r+1>l.e.r&&(l.e.r=rt.r+1),rt.c+1>l.e.c&&(l.e.c=rt.c+1),Ir.cellFormula&&Kt.f){for(var kt=0;kt<U.length;++kt)if(!(U[kt][0].s.c>rt.c||U[kt][0].s.r>rt.r)&&!(U[kt][0].e.c<rt.c||U[kt][0].e.r<rt.r)){Kt.F=vt(U[kt][0]),(U[kt][0].s.c!=rt.c||U[kt][0].s.r!=rt.r)&&delete Kt.f,Kt.f&&(Kt.f=""+Un(U[kt][1],l,rt,ae,M));break}}Ir.dense?(i[rt.r]||(i[rt.r]=[]),i[rt.r][rt.c]=Kt):i[v]=Kt}},M={enc:!1,sbcch:0,snames:[],sharedf:D,arrayf:U,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var V,xe=[],ve=[],ne=[],le=[],Pe=!1,ae=[];ae.SheetNames=M.snames,ae.sharedf=M.sharedf,ae.arrayf=M.arrayf,ae.names=[],ae.XTI=[];var Me=0,J=0,O=0,Q=[],q=[],te;M.codepage=1200,aa(1200);for(var oe=!1;r.l<r.length-1;){var Te=r.l,ke=r.read_shift(2);if(ke===0&&Me===10)break;var be=r.l===r.length?0:r.read_shift(2),De=yx[ke];if(De&&De.f){if(e.bookSheets&&Me===133&&ke!==133)break;if(Me=ke,De.r===2||De.r==12){var lt=r.read_shift(2);if(be-=2,!M.enc&&lt!==ke&&((lt&255)<<8|lt>>8)!==ke)throw new Error("rt mismatch: "+lt+"!="+ke);De.r==12&&(r.l+=10,be-=10)}var Z={};if(ke===10?Z=De.f(r,be,M):Z=kB(ke,De,r,be,M),J==0&&[9,521,1033,2057].indexOf(Me)===-1)continue;switch(ke){case 34:t.opts.Date1904=A.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(M.enc||(r.l=0),M.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=Z;break;case 66:var wt=Number(Z);switch(wt){case 21010:wt=1200;break;case 32768:wt=1e4;break;case 32769:wt=1252;break}aa(M.codepage=wt),oe=!0;break;case 317:M.rrtabid=Z;break;case 25:M.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:M.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(i["!type"]="dialog"),Z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:ee.push(Z);break;case 430:ae.push([Z]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(Z);break;case 24:case 536:te={Name:Z.Name,Ref:Un(Z.rgce,l,null,ae,M)},Z.itab>0&&(te.Sheet=Z.itab-1),ae.names.push(te),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(q[Z.itab-1]={ref:vt(Z.rgce[0][0][1][2])});break;case 22:M.ExternCount=Z;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(Z),ae.XTI=ae.XTI.concat(Z);break;case 2196:if(M.biff<8)break;te!=null&&(te.Comment=Z[1]);break;case 18:i["!protect"]=Z;break;case 19:Z!==0&&M.WTF&&console.error("Password verifier: "+Z);break;case 133:s[Z.pos]=Z,M.snames.push(Z.name);break;case 10:{if(--J)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=vt(l),e.sheetRows&&e.sheetRows<=l.e.r){var ut=l.e.r;l.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=vt(l),l.e.r=ut}l.e.r++,l.e.c++}xe.length>0&&(i["!merges"]=xe),ve.length>0&&(i["!objects"]=ve),ne.length>0&&(i["!cols"]=ne),le.length>0&&(i["!rows"]=le),A.Sheets.push(R)}d===""?m=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),M.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(M.biff=5,oe=!0,aa(M.codepage=28591)),M.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(M.biff=2),J++)break;if(i=e.dense?[]:{},M.biff<8&&!oe&&(oe=!0,aa(M.codepage=e.codepage||1252)),M.biff<5||Z.BIFFVer==0&&Z.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var It={pos:r.l-be,name:d};s[It.pos]=It,M.snames.push(d)}else d=(s[Te]||{name:""}).name;Z.dt==32&&(i["!type"]="chart"),Z.dt==64&&(i["!type"]="macro"),xe=[],ve=[],M.arrayf=U=[],ne=[],le=[],Pe=!1,R={Hidden:(s[Te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[Z.r]||[])[Z.c]:i[ft({c:Z.c,r:Z.r})])&&++Z.c,k={ixfe:Z.ixfe,XF:ee[Z.ixfe]||{},v:Z.val,t:"n"},O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:Z.c,r:Z.r},k,e);break;case 5:case 517:k={ixfe:Z.ixfe,XF:ee[Z.ixfe],v:Z.val,t:Z.t},O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:Z.c,r:Z.r},k,e);break;case 638:k={ixfe:Z.ixfe,XF:ee[Z.ixfe],v:Z.rknum,t:"n"},O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:Z.c,r:Z.r},k,e);break;case 189:for(var qe=Z.c;qe<=Z.C;++qe){var Oe=Z.rkrec[qe-Z.c][0];k={ixfe:Oe,XF:ee[Oe],v:Z.rkrec[qe-Z.c][1],t:"n"},O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:qe,r:Z.r},k,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){u=Z;break}if(k=Am(Z.val,Z.cell.ixfe,Z.tt),k.XF=ee[k.ixfe],e.cellFormula){var nt=Z.formula;if(nt&&nt[0]&&nt[0][0]&&nt[0][0][0]=="PtgExp"){var gt=nt[0][0][1][0],Lt=nt[0][0][1][1],Gr=ft({r:gt,c:Lt});D[Gr]?k.f=""+Un(Z.formula,l,Z.cell,ae,M):k.F=((e.dense?(i[gt]||[])[Lt]:i[Gr])||{}).F}else k.f=""+Un(Z.formula,l,Z.cell,ae,M)}O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N(Z.cell,k,e),u=Z}break;case 7:case 519:if(u)u.val=Z,k=Am(Z,u.cell.ixfe,"s"),k.XF=ee[k.ixfe],e.cellFormula&&(k.f=""+Un(u.formula,l,u.cell,ae,M)),O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N(u.cell,k,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{U.push(Z);var fa=ft(Z[0].s);if(y=e.dense?(i[Z[0].s.r]||[])[Z[0].s.c]:i[fa],e.cellFormula&&y){if(!u||!fa||!y)break;y.f=""+Un(Z[1],l,Z[0],ae,M),y.F=vt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(v){if(!u)break;D[ft(u.cell)]=Z[0],y=e.dense?(i[u.cell.r]||[])[u.cell.c]:i[ft(u.cell)],(y||{}).f=""+Un(Z[0],l,_,ae,M)}}break;case 253:k=Am(f[Z.isst].t,Z.ixfe,"s"),f[Z.isst].h&&(k.h=f[Z.isst].h),k.XF=ee[k.ixfe],O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:Z.c,r:Z.r},k,e);break;case 513:e.sheetStubs&&(k={ixfe:Z.ixfe,XF:ee[Z.ixfe],t:"z"},O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:Z.c,r:Z.r},k,e));break;case 190:if(e.sheetStubs)for(var Yn=Z.c;Yn<=Z.C;++Yn){var qt=Z.ixfe[Yn-Z.c];k={ixfe:qt,XF:ee[qt],t:"z"},O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:Yn,r:Z.r},k,e)}break;case 214:case 516:case 4:k=Am(Z.val,Z.ixfe,"s"),k.XF=ee[k.ixfe],O>0&&(k.z=Q[k.ixfe>>8&63]),Ka(k,e,t.opts.Date1904),N({c:Z.c,r:Z.r},k,e);break;case 0:case 512:J===1&&(l=Z);break;case 252:f=Z;break;case 1054:if(M.biff==4){Q[O++]=Z[1];for(var sn=0;sn<O+163&&ot[sn]!=Z[1];++sn);sn>=163&&Za(Z[1],O+163)}else Za(Z[1],Z[0]);break;case 30:{Q[O++]=Z;for(var Nn=0;Nn<O+163&&ot[Nn]!=Z;++Nn);Nn>=163&&Za(Z,O+163)}break;case 229:xe=xe.concat(Z);break;case 93:ve[Z.cmo[0]]=M.lastobj=Z;break;case 438:M.lastobj.TxO=Z;break;case 127:M.lastobj.ImData=Z;break;case 440:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(E=Z[0].s.c;E<=Z[0].e.c;++E)y=e.dense?(i[S]||[])[E]:i[ft({c:E,r:S})],y&&(y.l=Z[1]);break;case 2048:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(E=Z[0].s.c;E<=Z[0].e.c;++E)y=e.dense?(i[S]||[])[E]:i[ft({c:E,r:S})],y&&y.l&&(y.l.Tooltip=Z[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;y=e.dense?(i[Z[0].r]||[])[Z[0].c]:i[ft(Z[0])];var gi=ve[Z[2]];y||(e.dense?(i[Z[0].r]||(i[Z[0].r]=[]),y=i[Z[0].r][Z[0].c]={t:"z"}):y=i[ft(Z[0])]={t:"z"},l.e.r=Math.max(l.e.r,Z[0].r),l.s.r=Math.min(l.s.r,Z[0].r),l.e.c=Math.max(l.e.c,Z[0].c),l.s.c=Math.min(l.s.c,Z[0].c)),y.c||(y.c=[]),T={a:Z[1],t:gi.TxO.t},y.c.push(T)}break;case 2173:_P(ee[Z.ixfe],Z.ext);break;case 125:{if(!M.cellStyles)break;for(;Z.e>=Z.s;)ne[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},Pe||(Pe=!0,Nv(Z.w/256)),Yo(ne[Z.e+1])}break;case 520:{var et={};Z.level!=null&&(le[Z.r]=et,et.level=Z.level),Z.hidden&&(le[Z.r]=et,et.hidden=!0),Z.hpt&&(le[Z.r]=et,et.hpt=Z.hpt,et.hpx=qu(Z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Xl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=Z;break;case 161:i["!margins"]||Xl(i["!margins"]={}),i["!margins"].header=Z.header,i["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(A.Views[0].RTL=!0);break;case 146:X=Z;break;case 2198:V=Z;break;case 140:W=Z;break;case 442:d?R.CodeName=Z||R.name:A.WBProps.CodeName=Z||"ThisWorkbook";break}}else De||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),r.l+=be}return t.SheetNames=Vr(s).sort(function(yt,rt){return Number(yt)-Number(rt)}).map(function(yt){return s[yt].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&m["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=m)):t.Preamble=m,t.Sheets&&q.forEach(function(yt,rt){t.Sheets[t.SheetNames[rt]]["!autofilter"]=yt}),t.Strings=f,t.SSF=pr(ot),M.enc&&(t.Encryption=M.enc),V&&(t.Themes=V),t.Metadata={},W!==void 0&&(t.Metadata.Country=W),ae.names.length>0&&(A.Names=ae.names),t.Workbook=A,t}var Bh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function RB(r,e,t){var n=it.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=mS(n,dx,Bh.DSI);for(var s in i)e[s]=i[s]}catch(d){if(t.WTF)throw d}var l=it.find(r,"/!SummaryInformation");if(l&&l.size>0)try{var u=mS(l,mx,Bh.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(d){if(t.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(HI(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function DB(r,e){var t=[],n=[],i=[],s=0,l,u=Gw(dx,"n"),f=Gw(mx,"n");if(r.Props)for(l=Vr(r.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(u,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:i).push([l[s],r.Props[l[s]]]);if(r.Custprops)for(l=Vr(r.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(u,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:i).push([l[s],r.Custprops[l[s]]]);var d=[];for(s=0;s<i.length;++s)$I.indexOf(i[s][0])>-1||jI.indexOf(i[s][0])>-1||i[s][1]!=null&&d.push(i[s]);n.length&&it.utils.cfb_add(e,"/SummaryInformation",pS(n,Bh.SI,f,mx)),(t.length||d.length)&&it.utils.cfb_add(e,"/DocumentSummaryInformation",pS(t,Bh.DSI,u,dx,d.length?d:null,Bh.UDI))}function Uv(r,e){e||(e={}),jv(e),Up(),e.codepage&&Bp(e.codepage);var t,n;if(r.FullPaths){if(it.find(r,"/encryption"))throw new Error("File is password-protected");t=it.find(r,"!CompObj"),n=it.find(r,"/Workbook")||it.find(r,"/Book")}else{switch(e.type){case"base64":r=Ci(Mi(r));break;case"binary":r=Ci(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}Rn(r,0),n={content:r}}var i,s;if(t&&bB(t),e.bookProps&&!e.bookSheets)i={};else{var l=St?"buffer":"array";if(n&&n.content)i=CB(n.content,e);else if((s=it.find(r,"PerfectOffice_MAIN"))&&s.content)i=Wl.to_workbook(s.content,(e.type=l,e));else if((s=it.find(r,"NativeContent_MAIN"))&&s.content)i=Wl.to_workbook(s.content,(e.type=l,e));else throw(s=it.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&it.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=qP(r))}var u={};return r.FullPaths&&RB(r,u,e),i.Props=i.Custprops=u,e.bookFiles&&(i.cfb=r),i}function NB(r,e){var t=e||{},n=it.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return it.utils.cfb_add(n,i,Kk(r,t)),t.biff==8&&(r.Props||r.Custprops)&&DB(r,n),t.biff==8&&r.vbaraw&&KP(n,it.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var u0={0:{f:nL},1:{f:fL},2:{f:RL},3:{f:vL},4:{f:pL},5:{f:IL},6:{f:PL},7:{f:wL},8:{f:jL},9:{f:zL},10:{f:BL},11:{f:UL},12:{f:dL},13:{f:NL},14:{f:EL},15:{f:_L},16:{f:Lk},17:{f:LL},18:{f:AL},19:{f:Tv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:MV},40:{},42:{},43:{f:P8},44:{f:O8},45:{f:V8},46:{f:U8},47:{f:B8},48:{},49:{f:sO},50:{},51:{f:yP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ok},62:{f:FL},63:{f:CP},64:{f:iV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Wn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:cL},148:{f:sL,p:16},151:{f:XL},152:{},153:{f:OV},154:{},155:{},156:{f:DV},157:{},158:{},159:{T:1,f:$F},160:{T:-1},161:{T:1,f:Ac},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:HL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:xP},336:{T:-1},337:{f:wP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:YL},427:{f:$L},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:lL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UP},633:{T:1},634:{T:-1},635:{T:1,f:VP},636:{T:-1},637:{f:uO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:aV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},yx={6:{f:O_},10:{f:Io},12:{f:en},13:{f:en},14:{f:jr},15:{f:jr},16:{f:jn},17:{f:jr},18:{f:jr},19:{f:en},20:{f:ES},21:{f:ES},23:{f:sk},24:{f:wS},25:{f:jr},26:{},27:{},28:{f:aF},29:{},34:{f:jr},35:{f:TS},38:{f:jn},39:{f:jn},40:{f:jn},41:{f:jn},42:{f:jr},43:{f:jr},47:{f:_8},49:{f:N6},51:{f:en},60:{},61:{f:I6},64:{f:jr},65:{f:D6},66:{f:en},77:{},80:{},81:{},82:{},85:{f:en},89:{},90:{},91:{},92:{f:g6},93:{f:lF},94:{},95:{f:jr},96:{},97:{},99:{f:jr},125:{f:ok},128:{f:W6},129:{f:x6},130:{f:en},131:{f:jr},132:{f:jr},133:{f:v6},134:{},140:{f:gF},141:{f:en},144:{},146:{f:vF},151:{},152:{},153:{},154:{},155:{},156:{f:en},157:{},158:{},160:{f:bF},161:{f:TF},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:H6},190:{f:G6},193:{f:Io},197:{},198:{},199:{},200:{},201:{},202:{f:jr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:en},220:{},221:{f:jr},222:{},224:{f:K6},225:{f:p6},226:{f:Io},227:{},229:{f:sF},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:E6},253:{f:F6},255:{f:w6},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:QI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jr},353:{f:Io},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:J6},431:{f:jr},432:{},433:{},434:{},437:{},438:{f:fF},439:{f:jr},440:{f:hF},441:{},442:{f:N0},443:{},444:{f:en},445:{},446:{},448:{f:Io},449:{f:b6,r:2},450:{f:Io},512:{f:xS},513:{f:AF},515:{f:$6},516:{f:M6},517:{f:yS},519:{f:IF},520:{f:S6},523:{},545:{f:SS},549:{f:_S},566:{},574:{f:C6},638:{f:j6},659:{},1048:{},1054:{f:V6},1084:{},1212:{f:rF},2048:{f:mF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Tm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Io},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:yF,r:12},2173:{f:gP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:tF,r:12},2197:{},2198:{f:uP,r:12},2199:{},2200:{},2201:{},2202:{f:nF,r:12},2203:{f:Io},2204:{},2205:{},2206:{},2207:{},2211:{f:A6},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:en},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:wF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:xF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:xS},1:{},2:{f:NF},3:{f:RF},4:{f:CF},5:{f:yS},7:{f:FF},8:{},9:{f:Tm},11:{},22:{f:en},30:{f:U6},31:{},32:{},33:{f:SS},36:{},37:{f:_S},50:{f:PF},62:{},52:{},67:{},68:{f:en},69:{},86:{},126:{},127:{f:kF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:MF},223:{},234:{},354:{},421:{},518:{f:O_},521:{f:Tm},536:{f:wS},547:{f:TS},561:{},579:{},1030:{f:O_},1033:{f:Tm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(r,e,t,n){var i=e;if(!isNaN(i)){var s=n||(t||[]).length||0,l=r.next(4);l.write_shift(2,i),l.write_shift(2,s),s>0&&vv(t)&&r.push(t)}}function OB(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return ze(r,e,t,i);var s=e;if(!isNaN(s)){for(var l=t.parts||[],u=0,f=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var m=r.next(4);for(m.write_shift(2,s),m.write_shift(2,d),r.push(t.slice(f,f+d)),f+=d;f<i;){for(m=r.next(4),m.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;m.write_shift(2,d),r.push(t.slice(f,f+d)),f+=d}}}function M0(r,e,t){return r||(r=we(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function FB(r,e,t,n){var i=we(9);return M0(i,r,e),JI(t,n||"b",i),i}function PB(r,e,t){var n=we(8+2*t.length);return M0(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function MB(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?un(yr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ze(r,2,OF(t,n,i)):ze(r,3,DF(t,n,i));return;case"b":case"e":ze(r,5,FB(t,n,e.v,e.t));return;case"s":case"str":ze(r,4,PB(t,n,(e.v||"").slice(0,255)));return}ze(r,1,M0(null,t,n))}function LB(r,e,t,n){var i=Array.isArray(e),s=Ft(e["!ref"]||"A1"),l,u="",f=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=vt(s)}for(var d=s.s.r;d<=s.e.r;++d){u=Mr(d);for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(f[m]=vr(m)),l=f[m]+u;var _=i?(e[d]||[])[m]:e[l];_&&MB(r,_,d,m)}}}function VB(r,e){for(var t=e||{},n=pi(),i=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ze(n,t.biff==4?1033:t.biff==3?521:9,Cv(r,16,t)),LB(n,r.Sheets[r.SheetNames[i]],i,t),ze(n,10),n.end()}function BB(r,e,t){ze(r,49,O6({sz:12,name:"Arial"},t))}function UB(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ze(r,1054,B6(i,e[i],t))})}function zB(r,e){var t=we(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ze(r,2151,t),t=we(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),nk(Ft(e["!ref"]||"A1"),t),t.write_shift(4,4),ze(r,2152,t)}function jB(r,e){for(var t=0;t<16;++t)ze(r,224,vS({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ze(r,224,vS(n,0,e))})}function HB(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];ze(r,440,dF(n)),n[1].Tooltip&&ze(r,2048,pF(n))}delete e["!links"]}function GB(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&ze(r,125,EF(Xp(i,n),i))})}}function qB(r,e,t,n,i){var s=16+al(i.cellXfs,e,i);if(e.v==null&&!e.bf){ze(r,513,oc(t,n,s));return}if(e.bf)ze(r,6,x9(e,t,n,i,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?un(yr(e.v)):e.v;ze(r,515,Q6(t,n,l,s));break;case"b":case"e":ze(r,517,Y6(t,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var u=Lv(i.Strings,e.v,i.revStrings);ze(r,253,P6(t,n,u,s))}else ze(r,516,L6(t,n,(e.v||"").slice(0,255),s,i));break;default:ze(r,513,oc(t,n,s))}}function KB(r,e,t){var n=pi(),i=t.SheetNames[r],s=t.Sheets[i]||{},l=(t||{}).Workbook||{},u=(l.Sheets||[])[r]||{},f=Array.isArray(s),d=e.biff==8,m,_="",v=[],y=Ft(s["!ref"]||"A1"),T=d?65536:16384;if(y.e.c>255||y.e.r>=T){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,T-1)}ze(n,2057,Cv(t,16,e)),ze(n,13,na(1)),ze(n,12,na(100)),ze(n,15,ei(!0)),ze(n,17,ei(!1)),ze(n,16,ac(.001)),ze(n,95,ei(!0)),ze(n,42,ei(!1)),ze(n,43,ei(!1)),ze(n,130,na(1)),ze(n,128,X6()),ze(n,131,ei(!1)),ze(n,132,ei(!1)),d&&GB(n,s["!cols"]),ze(n,512,z6(y,e)),d&&(s["!links"]=[]);for(var E=y.s.r;E<=y.e.r;++E){_=Mr(E);for(var S=y.s.c;S<=y.e.c;++S){E===y.s.r&&(v[S]=vr(S)),m=v[S]+_;var D=f?(s[E]||[])[S]:s[m];D&&(qB(n,D,E,S,e),d&&D.l&&s["!links"].push([m,D.l]))}}var U=u.CodeName||u.name||i;return d&&ze(n,574,R6((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&ze(n,229,oF(s["!merges"])),d&&HB(n,s),ze(n,442,ZI(U)),d&&zB(n,s),ze(n,10),n.end()}function WB(r,e,t){var n=pi(),i=(r||{}).Workbook||{},s=i.Sheets||[],l=i.WBProps||{},u=t.biff==8,f=t.biff==5;if(ze(n,2057,Cv(r,5,t)),t.bookType=="xla"&&ze(n,135),ze(n,225,u?na(1200):null),ze(n,193,YO(2)),f&&ze(n,191),f&&ze(n,192),ze(n,226),ze(n,92,_6("SheetJS",t)),ze(n,66,na(u?1200:1252)),u&&ze(n,353,na(0)),u&&ze(n,448),ze(n,317,SF(r.SheetNames.length)),u&&r.vbaraw&&ze(n,211),u&&r.vbaraw){var d=l.CodeName||"ThisWorkbook";ze(n,442,ZI(d))}ze(n,156,na(17)),ze(n,25,ei(!1)),ze(n,18,ei(!1)),ze(n,19,na(0)),u&&ze(n,431,ei(!1)),u&&ze(n,444,na(0)),ze(n,61,k6()),ze(n,64,ei(!1)),ze(n,141,na(0)),ze(n,34,ei(bV(r)=="true")),ze(n,14,ei(!0)),u&&ze(n,439,ei(!1)),ze(n,218,na(0)),BB(n,r,t),UB(n,r.SSF,t),jB(n,t),u&&ze(n,352,ei(!1));var m=n.end(),_=pi();u&&ze(_,140,_F()),u&&t.Strings&&OB(_,252,T6(t.Strings)),ze(_,10);var v=_.end(),y=pi(),T=0,E=0;for(E=0;E<r.SheetNames.length;++E)T+=(u?12:11)+(u?2:1)*r.SheetNames[E].length;var S=m.length+T+v.length;for(E=0;E<r.SheetNames.length;++E){var D=s[E]||{};ze(y,133,y6({pos:S,hs:D.Hidden||0,dt:0,name:r.SheetNames[E]},t)),S+=e[E].length}var U=y.end();if(T!=U.length)throw new Error("BS8 "+T+" != "+U.length);var k=[];return m.length&&k.push(m),U.length&&k.push(U),v.length&&k.push(v),vn(k)}function XB(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=pr(ot)),r&&r.SSF&&(lf(),C0(r.SSF),t.revssf=jp(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hv(t),t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=KB(i,t,r);return n.unshift(WB(r,n,t)),vn(n)}function Kk(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=ii(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return XB(r,e);case 4:case 3:case 2:return VB(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function FS(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),l=i.index,u=s&&s.index||r.length,f=O5(r.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,_=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},T=[];for(l=0;l<f.length;++l){var E=f[l].trim(),S=E.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}m=0;continue}if(!(S!="<td"&&S!="<th")){var D=E.split(/<\/t[dh]>/i);for(u=0;u<D.length;++u){var U=D[u].trim();if(U.match(/<t[dh]/i)){for(var k=U,W=0;k.charAt(0)=="<"&&(W=k.indexOf(">"))>-1;)k=k.slice(W+1);for(var ee=0;ee<T.length;++ee){var X=T[ee];X.s.c==m&&X.s.r<d&&d<=X.e.r&&(m=X.e.c+1,ee=-1)}var A=ht(U.slice(0,U.indexOf(">")));v=A.colspan?+A.colspan:1,((_=+A.rowspan)>1||v>1)&&T.push({s:{r:d,c:m},e:{r:d+(_||1)-1,c:m+v-1}});var R=A.t||A["data-t"]||"";if(!k.length){m+=v;continue}if(k=yI(k),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>m&&(y.s.c=m),y.e.c<m&&(y.e.c=m),!k.length){m+=v;continue}var C={t:"s",v:k};t.raw||!k.trim().length||R=="s"||(k==="TRUE"?C={t:"b",v:!0}:k==="FALSE"?C={t:"b",v:!1}:isNaN(Ca(k))?isNaN(Hu(k).getDate())||(C={t:"d",v:yr(k)},t.cellDates||(C={t:"n",v:un(C.v)}),C.z=t.dateNF||ot[14]):C={t:"n",v:Ca(k)}),t.dense?(n[d]||(n[d]=[]),n[d][m]=C):n[ft({r:d,c:m})]=C,m+=v}}}}return n["!ref"]=vt(y),T.length&&(n["!merges"]=T),n}function Wk(r,e,t,n){for(var i=r["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,d=0;d<i.length;++d)if(!(i[d].s.r>t||i[d].s.c>l)&&!(i[d].e.r<t||i[d].e.c<l)){if(i[d].s.r<t||i[d].s.c<l){u=-1;break}u=i[d].e.r-i[d].s.r+1,f=i[d].e.c-i[d].s.c+1;break}if(!(u<0)){var m=ft({r:t,c:l}),_=n.dense?(r[t]||[])[l]:r[m],v=_&&_.v!=null&&(_.h||hv(_.w||(rs(_),_.w)||""))||"",y={};u>1&&(y.rowspan=u),f>1&&(y.colspan=f),n.editable?v='<span contenteditable="true">'+v+"</span>":_&&(y["data-t"]=_&&_.t||"z",_.v!=null&&(y["data-v"]=_.v),_.z!=null&&(y["data-z"]=_.z),_.l&&(_.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+_.l.Target+'">'+v+"</a>")),y.id=(n.id||"sjs")+"-"+m,s.push(Ue("td",v,y))}}var T="<tr>";return T+s.join("")+"</tr>"}var Xk='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Yk="</body></html>";function YB(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return il(FS(t[0],e),e);var n=Xv();return t.forEach(function(i,s){Yv(n,FS(i,e),"Sheet"+(s+1))}),n}function $k(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Qk(r,e){var t=e||{},n=t.header!=null?t.header:Xk,i=t.footer!=null?t.footer:Yk,s=[n],l=ii(r["!ref"]);t.dense=Array.isArray(r),s.push($k(r,l,t));for(var u=l.s.r;u<=l.e.r;++u)s.push(Wk(r,l,u,t));return s.push("</table>"+i),s.join("")}function Jk(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Cr(n.origin):n.origin;i=l.r,s=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var m=ii(r["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),i==-1&&(d.e.r=i=m.e.r+1)}var _=[],v=0,y=r["!rows"]||(r["!rows"]=[]),T=0,E=0,S=0,D=0,U=0,k=0;for(r["!cols"]||(r["!cols"]=[]);T<u.length&&E<f;++T){var W=u[T];if(PS(W)){if(n.display)continue;y[E]={hidden:!0}}var ee=W.children;for(S=D=0;S<ee.length;++S){var X=ee[S];if(!(n.display&&PS(X))){var A=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):yI(X.innerHTML),R=X.getAttribute("data-z")||X.getAttribute("z");for(v=0;v<_.length;++v){var C=_[v];C.s.c==D+s&&C.s.r<E+i&&E+i<=C.e.r&&(D=C.e.c+1-s,v=-1)}k=+X.getAttribute("colspan")||1,((U=+X.getAttribute("rowspan")||1)>1||k>1)&&_.push({s:{r:E+i,c:D+s},e:{r:E+i+(U||1)-1,c:D+s+(k||1)-1}});var B={t:"s",v:A},N=X.getAttribute("data-t")||X.getAttribute("t")||"";A!=null&&(A.length==0?B.t=N||"z":n.raw||A.trim().length==0||N=="s"||(A==="TRUE"?B={t:"b",v:!0}:A==="FALSE"?B={t:"b",v:!1}:isNaN(Ca(A))?isNaN(Hu(A).getDate())||(B={t:"d",v:yr(A)},n.cellDates||(B={t:"n",v:un(B.v)}),B.z=n.dateNF||ot[14]):B={t:"n",v:Ca(A)})),B.z===void 0&&R!=null&&(B.z=R);var M="",V=X.getElementsByTagName("A");if(V&&V.length)for(var xe=0;xe<V.length&&!(V[xe].hasAttribute("href")&&(M=V[xe].getAttribute("href"),M.charAt(0)!="#"));++xe);M&&M.charAt(0)!="#"&&(B.l={Target:M}),n.dense?(r[E+i]||(r[E+i]=[]),r[E+i][D+s]=B):r[ft({c:D+s,r:E+i})]=B,d.e.c<D+s&&(d.e.c=D+s),D+=k}}++E}return _.length&&(r["!merges"]=(r["!merges"]||[]).concat(_)),d.e.r=Math.max(d.e.r,E-1+i),r["!ref"]=vt(d),E>=f&&(r["!fullref"]=vt((d.e.r=u.length-T+E-1+i,d))),r}function Zk(r,e){var t=e||{},n=t.dense?[]:{};return Jk(n,r,e)}function $B(r,e){return il(Zk(r,e),e)}function PS(r){var e="",t=QB(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function QB(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function JB(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=zt(e.replace(/<[^>]*>/g,""));return[t]}var MS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function eC(r,e){var t=e||{},n=dv(r),i=[],s,l,u={name:""},f="",d=0,m,_,v={},y=[],T=t.dense?[]:{},E,S,D={value:""},U="",k=0,W=[],ee=-1,X=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,C={},B=[],N={},M=0,V=0,xe=[],ve=1,ne=1,le=[],Pe={Names:[]},ae={},Me=["",""],J=[],O={},Q="",q=0,te=!1,oe=!1,Te=0;for(i0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=i0.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?T["!ref"]=vt(A):T["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=A.e.r&&(T["!fullref"]=T["!ref"],A.e.r=t.sheetRows-1,T["!ref"]=vt(A)),B.length&&(T["!merges"]=B),xe.length&&(T["!rows"]=xe),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),y.push(m.name),v[m.name]=T,oe=!1):E[0].charAt(E[0].length-2)!=="/"&&(m=ht(E[0],!1),ee=X=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,T=t.dense?[]:{},B=[],xe=[],oe=!0);break;case"table-row-group":E[1]==="/"?--R:++R;break;case"table-row":case"":if(E[1]==="/"){ee+=ve,ve=1;break}if(_=ht(E[0],!1),_.?ee=_.-1:ee==-1&&(ee=0),ve=+_["number-rows-repeated"]||1,ve<10)for(Te=0;Te<ve;++Te)R>0&&(xe[ee+Te]={level:R});X=-1;break;case"covered-table-cell":E[1]!=="/"&&++X,t.sheetStubs&&(t.dense?(T[ee]||(T[ee]=[]),T[ee][X]={t:"z"}):T[ft({r:ee,c:X})]={t:"z"}),U="",W=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++X,D=ht(E[0],!1),ne=parseInt(D["number-columns-repeated"]||"1",10),S={t:"z",v:null},D.formula&&t.cellFormula!=!1&&(S.f=DS(zt(D.formula))),(D.||D["value-type"])=="string"&&(S.t="s",S.v=zt(D["string-value"]||""),t.dense?(T[ee]||(T[ee]=[]),T[ee][X]=S):T[ft({r:ee,c:X})]=S),X+=ne-1;else if(E[1]!=="/"){++X,U="",k=0,W=[],ne=1;var ke=ve?ee+ve-1:ee;if(X>A.e.c&&(A.e.c=X),X<A.s.c&&(A.s.c=X),ee<A.s.r&&(A.s.r=ee),ke>A.e.r&&(A.e.r=ke),D=ht(E[0],!1),J=[],O={},S={t:D.||D["value-type"],v:null},t.cellFormula)if(D.formula&&(D.formula=zt(D.formula)),D["number-matrix-columns-spanned"]&&D["number-matrix-rows-spanned"]&&(M=parseInt(D["number-matrix-rows-spanned"],10)||0,V=parseInt(D["number-matrix-columns-spanned"],10)||0,N={s:{r:ee,c:X},e:{r:ee+M-1,c:X+V-1}},S.F=vt(N),le.push([N,S.F])),D.formula)S.f=DS(D.formula);else for(Te=0;Te<le.length;++Te)ee>=le[Te][0].s.r&&ee<=le[Te][0].e.r&&X>=le[Te][0].s.c&&X<=le[Te][0].e.c&&(S.F=le[Te][1]);switch((D["number-columns-spanned"]||D["number-rows-spanned"])&&(M=parseInt(D["number-rows-spanned"],10)||0,V=parseInt(D["number-columns-spanned"],10)||0,N={s:{r:ee,c:X},e:{r:ee+M-1,c:X+V-1}},B.push(N)),D["number-columns-repeated"]&&(ne=parseInt(D["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=xr(D["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(D.value);break;case"percentage":S.t="n",S.v=parseFloat(D.value);break;case"currency":S.t="n",S.v=parseFloat(D.value);break;case"date":S.t="d",S.v=yr(D["date-value"]),t.cellDates||(S.t="n",S.v=un(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=R5(D["time-value"])/86400,t.cellDates&&(S.t="d",S.v=Hp(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(D.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",D["string-value"]!=null&&(U=zt(D["string-value"]),W=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(te=!1,S.t==="s"&&(S.v=U||"",W.length&&(S.R=W),te=k==0),ae.Target&&(S.l=ae),J.length>0&&(S.c=J,J=[]),U&&t.cellText!==!1&&(S.w=U),te&&(S.t="z",delete S.v),(!te||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=ee))for(var be=0;be<ve;++be){if(ne=parseInt(D["number-columns-repeated"]||"1",10),t.dense)for(T[ee+be]||(T[ee+be]=[]),T[ee+be][X]=be==0?S:pr(S);--ne>0;)T[ee+be][X+ne]=pr(S);else for(T[ft({r:ee+be,c:X})]=S;--ne>0;)T[ft({r:ee+be,c:X+ne})]=pr(S);A.e.c<=X&&(A.e.c=X)}ne=parseInt(D["number-columns-repeated"]||"1",10),X+=ne-1,ne=0,S={},U="",W=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((s=i.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((s=i.pop())[0]!==E[3])throw"Bad state: "+s;O.t=U,W.length&&(O.R=W),O.a=Q,J.push(O)}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);Q="",q=0,U="",k=0,W=[];break;case"creator":E[1]==="/"?Q=n.slice(q,E.index):q=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((s=i.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);U="",k=0,W=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(C[u.name]=f,(s=i.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&(f="",u=ht(E[0],!1),i.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=ht(E[0],!1),f+=MS[E[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=ht(E[0],!1),f+=MS[E[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,E.index);break}else d=E.index+E[0].length;break;case"named-range":l=ht(E[0],!1),Me=F_(l["cell-range-address"]);var De={Name:l.name,Ref:Me[0]+"!"+Me[1]};oe&&(De.Sheet=y.length),Pe.Names.push(De);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(E[1]==="/"&&(!D||!D["string-value"])){var lt=JB(n.slice(k,E.index));U=(U.length>0?U+`
`:"")+lt[0]}else ht(E[0],!1),k=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{Me=F_(ht(E[0])["target-range-address"]),v[Me[0]]["!autofilter"]={ref:Me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ae=ht(E[0],!1),!ae.href)break;ae.Target=zt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Me=F_(ae.Target.slice(1)),ae.Target="#"+Me[0]+"!"+Me[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(E)}}var Z={Sheets:v,SheetNames:y,Workbook:Pe};return t.bookSheets&&delete Z.Sheets,Z}function LS(r,e){e=e||{},ra(r,"META-INF/manifest.xml")&&RO(Zr(r,"META-INF/manifest.xml"),e);var t=Ri(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=eC(fr(t),e);return ra(r,"meta.xml")&&(n.Props=UI(Zr(r,"meta.xml"))),n}function VS(r,e){return eC(r,e)}var ZB=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+n0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Hr+e}})(),BS=(function(){var r=function(s){return ar(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,l,u){var f=[];f.push('      <table:table table:name="'+ar(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,m=0,_=ii(s["!ref"]||"A1"),v=s["!merges"]||[],y=0,T=Array.isArray(s);if(s["!cols"])for(m=0;m<=_.e.c;++m)f.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var E="",S=s["!rows"]||[];for(d=0;d<_.s.r;++d)E=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+E+`></table:table-row>
`);for(;d<=_.e.r;++d){for(E=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+E+`>
`),m=0;m<_.s.c;++m)f.push(e);for(;m<=_.e.c;++m){var D=!1,U={},k="";for(y=0;y!=v.length;++y)if(!(v[y].s.c>m)&&!(v[y].s.r>d)&&!(v[y].e.c<m)&&!(v[y].e.r<d)){(v[y].s.c!=m||v[y].s.r!=d)&&(D=!0),U["table:number-columns-spanned"]=v[y].e.c-v[y].s.c+1,U["table:number-rows-spanned"]=v[y].e.r-v[y].s.r+1;break}if(D){f.push(t);continue}var W=ft({r:d,c:m}),ee=T?(s[d]||[])[m]:s[W];if(ee&&ee.f&&(U["table:formula"]=ar(S9(ee.f)),ee.F&&ee.F.slice(0,W.length)==W)){var X=ii(ee.F);U["table:number-matrix-columns-spanned"]=X.e.c-X.s.c+1,U["table:number-matrix-rows-spanned"]=X.e.r-X.s.r+1}if(!ee){f.push(e);continue}switch(ee.t){case"b":k=ee.v?"TRUE":"FALSE",U["office:value-type"]="boolean",U["office:boolean-value"]=ee.v?"true":"false";break;case"n":k=ee.w||String(ee.v||0),U["office:value-type"]="float",U["office:value"]=ee.v||0;break;case"s":case"str":k=ee.v==null?"":ee.v,U["office:value-type"]="string";break;case"d":k=ee.w||yr(ee.v).toISOString(),U["office:value-type"]="date",U["office:date-value"]=yr(ee.v).toISOString(),U["table:style-name"]="ce1";break;default:f.push(e);continue}var A=r(k);if(ee.l&&ee.l.Target){var R=ee.l.Target;R=R.charAt(0)=="#"?"#"+A9(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),A=Ue("text:a",A,{"xlink:href":R.replace(/&/g,"&amp;")})}f.push("          "+Ue("table:table-cell",Ue("text:p",A,{}),U)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},i=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var _=d["!cols"][m];if(_.width==null&&_.wpx==null&&_.wch==null)continue;Yo(_),_.ods=u;var v=d["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),s.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var _=d["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+_+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,u){var f=[Hr],d=n0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=n0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(BI().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),i(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var _=0;_!=l.SheetNames.length;++_)f.push(n(l.Sheets[l.SheetNames[_]],l,_));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function tC(r,e){if(e.bookType=="fods")return BS(r,e);var t=cv(),n="",i=[],s=[];return n="mimetype",Tt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(t,n,BS(r,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Tt(t,n,ZB(r,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Tt(t,n,Hr+BI()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Tt(t,n,OO(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(t,n,DO(i)),t}function lc(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Ex(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):fr(nl(r))}function e7(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Ci($a(r))}function t7(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function Qo(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function US(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function r7(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,i=e+13;i>=e;--i)n=n*256+r[i];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function n7(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)r[e+s]=i&255;r[e+15]|=t>=0?0:128}function f0(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function rr(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Lr(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Gt(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=f0(r,t),s=i&7;i=Math.floor(i/8);var l=0,u;if(i==0)break;switch(s){case 0:{for(var f=t[0];r[t[0]++]>=128;);u=r.slice(f,t[0])}break;case 5:l=4,u=r.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,u=r.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=f0(r,t),u=r.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:s};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function In(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(rr(n*8+i.type)),i.type==2&&e.push(rr(i.data.length)),e.push(i.data))})}),Qo(e)}function zv(r,e){return r?.map(function(t){return e(t.data)})||[]}function ea(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=f0(r,n),s=Gt(r.slice(n[0],n[0]+i));n[0]+=i;var l={id:Lr(s[1][0].data),messages:[]};s[2].forEach(function(u){var f=Gt(u.data),d=Lr(f[3][0].data);l.messages.push({meta:f,data:r.slice(n[0],n[0]+d)}),n[0]+=d}),(e=s[3])!=null&&e[0]&&(l.merge=Lr(s[3][0].data)>>>0>0),t.push(l)}return t}function gu(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:rr(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:rr(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:rr(l.data.length)}],n[2].push({data:In(l.meta),type:2})});var s=In(n);e.push(rr(s.length)),e.push(s),i.forEach(function(l){return e.push(l)})}),Qo(e)}function i7(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=f0(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var l=e[t[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[t[0]],u>1&&(l|=e[t[0]+1]<<8),u>2&&(l|=e[t[0]+2]<<16),u>3&&(l|=e[t[0]+3]<<24),l>>>=0,l++,t[0]+=u}i.push(e.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,d=0;if(s==1?(d=(e[t[0]]>>2&7)+4,f=(e[t[0]++]&224)<<3,f|=e[t[0]++]):(d=(e[t[0]++]>>2)+1,s==2?(f=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(f=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Qo(i)],f==0)throw new Error("Invalid offset 0");if(f>i[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(i.push(i[0].slice(-f)),d-=f;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-f,-f+d))}}var m=Qo(i);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function ta(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(i7(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Qo(e)}function _u(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=rr(n),l=s.length;e.push(s),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,t+=n}return Qo(e)}function a7(r,e,t,n){var i=lc(r),s=i.getUint32(4,!0),l=(n>1?12:8)+US(s&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,m=new Date(2001,0,1);s&512&&(u=i.getUint32(l,!0),l+=4),l+=US(s&(n>1?12288:4096))*4,s&16&&(f=i.getUint32(l,!0),l+=4),s&32&&(d=i.getFloat64(l,!0),l+=8),s&64&&(m.setTime(m.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var _;switch(r[2]){case 0:break;case 2:_={t:"n",v:d};break;case 3:_={t:"s",v:e[f]};break;case 5:_={t:"d",v:m};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(u>-1)_={t:"s",v:t[u]};else if(f>-1)_={t:"s",v:e[f]};else if(!isNaN(d))_={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return _}function s7(r,e,t){var n=lc(r),i=n.getUint32(8,!0),s=12,l=-1,u=-1,f=NaN,d=NaN,m=new Date(2001,0,1);i&1&&(f=r7(r,s),s+=16),i&2&&(d=n.getFloat64(s,!0),s+=8),i&4&&(m.setTime(m.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(u=n.getUint32(s,!0),s+=4),i&16&&(l=n.getUint32(s,!0),s+=4);var _;switch(r[1]){case 0:break;case 2:_={t:"n",v:f};break;case 3:_={t:"s",v:e[u]};break;case 5:_={t:"d",v:m};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(l>-1)_={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:_={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return _}function M_(r,e){var t=new Uint8Array(32),n=lc(t),i=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,n7(t,i,r.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,i)}function L_(r,e){var t=new Uint8Array(32),n=lc(t),i=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),s|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,i)}function o7(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return a7(r,e,t,r[0]);case 5:return s7(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function Vn(r){var e=Gt(r);return f0(e[1][0].data)}function zS(r,e){var t=Gt(e.data),n=Lr(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(l){var u=Gt(l.data),f=Lr(u[1][0].data)>>>0;switch(n){case 1:s[f]=Ex(u[3][0].data);break;case 8:{var d=r[Vn(u[9][0].data)][0],m=Gt(d.data),_=r[Vn(m[1][0].data)][0],v=Lr(_.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var y=Gt(_.data);s[f]=y[3].map(function(T){return Ex(T.data)}).join("")}break}}),s}function l7(r,e){var t,n,i,s,l,u,f,d,m,_,v,y,T,E,S=Gt(r),D=Lr(S[1][0].data)>>>0,U=Lr(S[2][0].data)>>>0,k=((n=(t=S[8])==null?void 0:t[0])==null?void 0:n.data)&&Lr(S[8][0].data)>0||!1,W,ee;if((s=(i=S[7])==null?void 0:i[0])!=null&&s.data&&e!=0)W=(u=(l=S[7])==null?void 0:l[0])==null?void 0:u.data,ee=(d=(f=S[6])==null?void 0:f[0])==null?void 0:d.data;else if((_=(m=S[4])==null?void 0:m[0])!=null&&_.data&&e!=1)W=(y=(v=S[4])==null?void 0:v[0])==null?void 0:y.data,ee=(E=(T=S[3])==null?void 0:T[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var X=k?4:1,A=lc(W),R=[],C=0;C<W.length/2;++C){var B=A.getUint16(C*2,!0);B<65535&&R.push([C,B])}if(R.length!=U)throw"Expected ".concat(U," cells, found ").concat(R.length);var N=[];for(C=0;C<R.length-1;++C)N[R[C][0]]=ee.subarray(R[C][1]*X,R[C+1][1]*X);return R.length>=1&&(N[R[R.length-1][0]]=ee.subarray(R[R.length-1][1]*X)),{R:D,cells:N}}function c7(r,e){var t,n=Gt(e.data),i=(t=n?.[7])!=null&&t[0]?Lr(n[7][0].data)>>>0>0?1:0:-1,s=zv(n[5],function(l){return l7(l,i)});return{nrows:Lr(n[4][0].data)>>>0,data:s.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=f}),l},[])}}function u7(r,e,t){var n,i=Gt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Lr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Lr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=vt(s);var l=Gt(i[4][0].data),u=zS(r,r[Vn(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?zS(r,r[Vn(l[17][0].data)][0]):[],d=Gt(l[3][0].data),m=0;d[1].forEach(function(_){var v=Gt(_.data),y=r[Vn(v[2][0].data)][0],T=Lr(y.meta[1][0].data);if(T!=6002)throw new Error("6001 unexpected reference to ".concat(T));var E=c7(r,y);E.data.forEach(function(S,D){S.forEach(function(U,k){var W=ft({r:m+D,c:k}),ee=o7(U,u,f);ee&&(t[W]=ee)})}),m+=E.nrows})}function f7(r,e){var t=Gt(e.data),n={"!ref":"A1"},i=r[Vn(t[2][0].data)],s=Lr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return u7(r,i[0],n),n}function h7(r,e){var t,n=Gt(e.data),i={name:(t=n[1])!=null&&t[0]?Ex(n[1][0].data):"",sheets:[]},s=zv(n[2],Vn);return s.forEach(function(l){r[l].forEach(function(u){var f=Lr(u.meta[1][0].data);f==6e3&&i.sheets.push(f7(r,u))})}),i}function d7(r,e){var t=Xv(),n=Gt(e.data),i=zv(n[1],Vn);if(i.forEach(function(s){r[s].forEach(function(l){var u=Lr(l.meta[1][0].data);if(u==2){var f=h7(r,l);f.sheets.forEach(function(d,m){Yv(t,d,m==0?f.name:f.name+"_"+m,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function V_(r){var e,t,n,i,s={},l=[];if(r.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=ta(f.content)}catch(_){return console.log("?? "+f.content.length+" "+(_.message||_))}var m;try{m=ea(d)}catch(_){return console.log("## "+(_.message||_))}m.forEach(function(_){s[_.id]=_.messages,l.push(_.id)})}}),!l.length)throw new Error("File has no messages");var u=((i=(n=(t=(e=s?.[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Lr(s[1][0].meta[1][0].data)==1&&s[1][0];if(u||l.forEach(function(f){s[f].forEach(function(d){var m=Lr(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return d7(s,u)}function m7(r,e,t){var n,i,s,l;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(s=r[8])==null?void 0:s[0])==null?void 0:l.data)&&Lr(r[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=lc(r[7][0].data),m=0,_=[],v=lc(r[4][0].data),y=0,T=[],E=0;E<e.length;++E){if(e[E]==null){d.setUint16(E*2,65535,!0),v.setUint16(E*2,65535);continue}d.setUint16(E*2,m,!0),v.setUint16(E*2,y,!0);var S,D;switch(typeof e[E]){case"string":S=M_({t:"s",v:e[E]},t),D=L_({t:"s",v:e[E]},t);break;case"number":S=M_({t:"n",v:e[E]},t),D=L_({t:"n",v:e[E]},t);break;case"boolean":S=M_({t:"b",v:e[E]},t),D=L_({t:"b",v:e[E]},t);break;default:throw new Error("Unsupported value "+e[E])}_.push(S),m+=S.length,T.push(D),y+=D.length,++f}for(r[2][0].data=rr(f);E<r[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),v.setUint16(E*2,65535,!0);return r[6][0].data=Qo(_),r[3][0].data=Qo(T),f}function p7(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ii(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(vt(n)));var s=fp(t,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(Q){return Q.forEach(function(q){typeof q=="string"&&l.push(q)})});var u={},f=[],d=it.read(e.numbers,{type:"base64"});d.FileIndex.map(function(Q,q){return[Q,d.FullPaths[q]]}).forEach(function(Q){var q=Q[0],te=Q[1];if(q.type==2&&q.name.match(/\.iwa/)){var oe=q.content,Te=ta(oe),ke=ea(Te);ke.forEach(function(be){f.push(be.id),u[be.id]={deps:[],location:te,type:Lr(be.messages[0].meta[1][0].data)}})}}),f.sort(function(Q,q){return Q-q});var m=f.filter(function(Q){return Q>1}).map(function(Q){return[Q,rr(Q)]});d.FileIndex.map(function(Q,q){return[Q,d.FullPaths[q]]}).forEach(function(Q){var q=Q[0];if(Q[1],!!q.name.match(/\.iwa/)){var te=ea(ta(q.content));te.forEach(function(oe){oe.messages.forEach(function(Te){m.forEach(function(ke){oe.messages.some(function(be){return Lr(be.meta[1][0].data)!=11006&&t7(be.data,ke[1])})&&u[ke[0]].deps.push(oe.id)})})})}});for(var _=it.find(d,u[1].location),v=ea(ta(_.content)),y,T=0;T<v.length;++T){var E=v[T];E.id==1&&(y=E)}var S=Vn(Gt(y.messages[0].data)[1][0].data);for(_=it.find(d,u[S].location),v=ea(ta(_.content)),T=0;T<v.length;++T)E=v[T],E.id==S&&(y=E);for(S=Vn(Gt(y.messages[0].data)[2][0].data),_=it.find(d,u[S].location),v=ea(ta(_.content)),T=0;T<v.length;++T)E=v[T],E.id==S&&(y=E);for(S=Vn(Gt(y.messages[0].data)[2][0].data),_=it.find(d,u[S].location),v=ea(ta(_.content)),T=0;T<v.length;++T)E=v[T],E.id==S&&(y=E);var D=Gt(y.messages[0].data);{D[6][0].data=rr(n.e.r+1),D[7][0].data=rr(n.e.c+1);var U=Vn(D[46][0].data),k=it.find(d,u[U].location),W=ea(ta(k.content));{for(var ee=0;ee<W.length&&W[ee].id!=U;++ee);if(W[ee].id!=U)throw"Bad ColumnRowUIDMapArchive";var X=Gt(W[ee].messages[0].data);X[1]=[],X[2]=[],X[3]=[];for(var A=0;A<=n.e.c;++A){var R=[];R[1]=R[2]=[{type:0,data:rr(A+420690)}],X[1].push({type:2,data:In(R)}),X[2].push({type:0,data:rr(A)}),X[3].push({type:0,data:rr(A)})}X[4]=[],X[5]=[],X[6]=[];for(var C=0;C<=n.e.r;++C)R=[],R[1]=R[2]=[{type:0,data:rr(C+726270)}],X[4].push({type:2,data:In(R)}),X[5].push({type:0,data:rr(C)}),X[6].push({type:0,data:rr(C)});W[ee].messages[0].data=In(X)}k.content=_u(gu(W)),k.size=k.content.length,delete D[46];var B=Gt(D[4][0].data);{B[7][0].data=rr(n.e.r+1);var N=Gt(B[1][0].data),M=Vn(N[2][0].data);k=it.find(d,u[M].location),W=ea(ta(k.content));{if(W[0].id!=M)throw"Bad HeaderStorageBucket";var V=Gt(W[0].messages[0].data);for(C=0;C<s.length;++C){var xe=Gt(V[2][0].data);xe[1][0].data=rr(C),xe[4][0].data=rr(s[C].length),V[2][C]={type:V[2][0].type,data:In(xe)}}W[0].messages[0].data=In(V)}k.content=_u(gu(W)),k.size=k.content.length;var ve=Vn(B[2][0].data);k=it.find(d,u[ve].location),W=ea(ta(k.content));{if(W[0].id!=ve)throw"Bad HeaderStorageBucket";for(V=Gt(W[0].messages[0].data),A=0;A<=n.e.c;++A)xe=Gt(V[2][0].data),xe[1][0].data=rr(A),xe[4][0].data=rr(n.e.r+1),V[2][A]={type:V[2][0].type,data:In(xe)};W[0].messages[0].data=In(V)}k.content=_u(gu(W)),k.size=k.content.length;var ne=Vn(B[4][0].data);(function(){for(var Q=it.find(d,u[ne].location),q=ea(ta(Q.content)),te,oe=0;oe<q.length;++oe){var Te=q[oe];Te.id==ne&&(te=Te)}var ke=Gt(te.messages[0].data);{ke[3]=[];var be=[];l.forEach(function(Z,wt){be[1]=[{type:0,data:rr(wt)}],be[2]=[{type:0,data:rr(1)}],be[3]=[{type:2,data:e7(Z)}],ke[3].push({type:2,data:In(be)})})}te.messages[0].data=In(ke);var De=gu(q),lt=_u(De);Q.content=lt,Q.size=Q.content.length})();var le=Gt(B[3][0].data);{var Pe=le[1][0];delete le[2];var ae=Gt(Pe.data);{var Me=Vn(ae[2][0].data);(function(){for(var Q=it.find(d,u[Me].location),q=ea(ta(Q.content)),te,oe=0;oe<q.length;++oe){var Te=q[oe];Te.id==Me&&(te=Te)}var ke=Gt(te.messages[0].data);{delete ke[6],delete le[7];var be=new Uint8Array(ke[5][0].data);ke[5]=[];for(var De=0,lt=0;lt<=n.e.r;++lt){var Z=Gt(be);De+=m7(Z,s[lt],l),Z[1][0].data=rr(lt),ke[5].push({data:In(Z),type:2})}ke[1]=[{type:0,data:rr(n.e.c+1)}],ke[2]=[{type:0,data:rr(n.e.r+1)}],ke[3]=[{type:0,data:rr(De)}],ke[4]=[{type:0,data:rr(n.e.r+1)}]}te.messages[0].data=In(ke);var wt=gu(q),ut=_u(wt);Q.content=ut,Q.size=Q.content.length})()}Pe.data=In(ae)}B[3][0].data=In(le)}D[4][0].data=In(B)}y.messages[0].data=In(D);var J=gu(v),O=_u(J);return _.content=O,_.size=_.content.length,d}function rC(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function jv(r){rC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function Hv(r){rC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function g7(r){return bt.WS.indexOf(r)>-1?"sheet":r==bt.CS?"chart":r==bt.DS?"dialog":r==bt.MS?"macro":r&&r.length?r:"sheet"}function _7(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,g7(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function x7(r,e,t,n,i,s,l,u,f,d,m,_){try{s[n]=Ph(Ri(r,t,!0),e);var v=Zr(r,e),y;switch(u){case"sheet":y=GV(v,e,i,f,s[n],d,m,_);break;case"chart":if(y=qV(v,e,i,f,s[n],d,m,_),!y||!y["!drawel"])break;var T=Ah(y["!drawel"].Target,e),E=a0(T),S=NP(Ri(r,T,!0),Ph(Ri(r,E,!0),T)),D=Ah(S,T),U=a0(D);y=vV(Ri(r,D,!0),D,f,Ph(Ri(r,U,!0),D),d,y);break;case"macro":y=KV(v,e,i,f,s[n],d,m,_);break;case"dialog":y=WV(v,e,i,f,s[n],d,m,_);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=y;var k=[];s&&s[n]&&Vr(s[n]).forEach(function(W){var ee="";if(s[n][W].Type==bt.CMNT){ee=Ah(s[n][W].Target,e);var X=QV(Zr(r,ee,!0),ee,f);if(!X||!X.length)return;bS(y,X,!1)}s[n][W].Type==bt.TCMNT&&(ee=Ah(s[n][W].Target,e),k=k.concat(FP(Zr(r,ee,!0),f)))}),k&&k.length&&bS(y,k,!0,f.people||[])}catch(W){if(f.WTF)throw W}}function Ji(r){return r.charAt(0)=="/"?r.slice(1):r}function nC(r,e){if(lf(),e=e||{},jv(e),ra(r,"META-INF/manifest.xml")||ra(r,"objectdata.xml"))return LS(r,e);if(ra(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof V_<"u"){if(r.FileIndex)return V_(r);var t=it.utils.cfb_new();return Ww(r).forEach(function(xe){Tt(t,xe,P5(r,xe))}),V_(t)}throw new Error("Unsupported NUMBERS file")}if(!ra(r,"[Content_Types].xml"))throw ra(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ra(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ww(r),i=kO(Ri(r,"[Content_Types].xml")),s=!1,l,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",Zr(r,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!Zr(r,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(Mh=[],i.sst)try{Mh=$V(Zr(r,Ji(i.sst)),i.sst,e)}catch(xe){if(e.WTF)throw xe}e.cellStyles&&i.themes.length&&(f=YV(Ri(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=XV(Zr(r,Ji(i.style)),i.style,f,e))}i.links.map(function(xe){try{var ve=Ph(Ri(r,a0(Ji(xe))),xe);return ZV(Zr(r,Ji(xe)),ve,xe,e)}catch{}});var m=HV(Zr(r,Ji(i.workbooks[0])),i.workbooks[0],e),_={},v="";i.coreprops.length&&(v=Zr(r,Ji(i.coreprops[0]),!0),v&&(_=UI(v)),i.extprops.length!==0&&(v=Zr(r,Ji(i.extprops[0]),!0),v&&PO(v,_,e)));var y={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(v=Ri(r,Ji(i.custprops[0]),!0),v&&(y=LO(v,e)));var T={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ve){return ve.name}):_.Worksheets&&_.SheetNames.length>0&&(l=_.SheetNames),e.bookProps&&(T.Props=_,T.Custprops=y),e.bookSheets&&typeof l<"u"&&(T.SheetNames=l),e.bookSheets?T.SheetNames:e.bookProps))return T;l={};var E={};e.bookDeps&&i.calcchain&&(E=JV(Zr(r,Ji(i.calcchain)),i.calcchain));var S=0,D={},U,k;{var W=m.Sheets;_.Worksheets=W.length,_.SheetNames=[];for(var ee=0;ee!=W.length;++ee)_.SheetNames[ee]=W[ee].name}var X=s?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),R=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");ra(r,R)||(R="xl/_rels/workbook."+X+".rels");var C=Ph(Ri(r,R,!0),R.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=eB(Zr(r,Ji(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=MP(Zr(r,Ji(i.people[0])),e)),C&&(C=_7(C,m.Sheets));var B=Zr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=_.Worksheets;++S){var N="sheet";if(C&&C[S]?(U="xl/"+C[S][1].replace(/[\/]?xl\//,""),ra(r,U)||(U=C[S][1]),ra(r,U)||(U=R.replace(/_rels\/.*$/,"")+C[S][1]),N=C[S][2]):(U="xl/worksheets/sheet"+(S+1-B)+"."+X,U=U.replace(/sheet0\./,"sheet.")),k=U.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(_.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,V=0;V!=e.sheets.length;++V)typeof e.sheets[V]=="number"&&e.sheets[V]==S&&(M=1),typeof e.sheets[V]=="string"&&e.sheets[V].toLowerCase()==_.SheetNames[S].toLowerCase()&&(M=1);if(!M)continue e}}x7(r,U,k,_.SheetNames[S],S,D,l,N,e,m,f,d)}return T={Directory:i,Workbook:m,Props:_,Custprops:y,Deps:E,Sheets:l,SheetNames:_.SheetNames,Strings:Mh,Styles:d,Themes:f,SSF:pr(ot)},e&&e.bookFiles&&(r.files?(T.keys=n,T.files=r.files):(T.keys=[],T.files={},r.FullPaths.forEach(function(xe,ve){xe=xe.replace(/^Root Entry[\/]/,""),T.keys.push(xe),T.files[xe]=r.FileIndex[ve]}))),e&&e.bookVBA&&(i.vba.length>0?T.vbaraw=Zr(r,Ji(i.vba[0]),!0):i.defaults&&i.defaults.bin===GP&&(T.vbaraw=Zr(r,"xl/vbaProject.bin",!0))),T}function v7(r,e){var t=e||{},n="Workbook",i=it.find(r,n);try{if(n="/!DataSpaces/Version",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(t8(i.content),n="/!DataSpaces/DataSpaceMap",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=n8(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=i8(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);s8(i.content)}catch{}if(n="/EncryptionInfo",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=o8(i.content);if(n="/EncryptedPackage",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,t.password||"",t);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function y7(r,e){return e.bookType=="ods"?tC(r,e):e.bookType=="numbers"?p7(r,e):e.bookType=="xlsb"?E7(r,e):iC(r,e)}function E7(r,e){Nu=1024,r&&!r.SSF&&(r.SSF=pr(ot)),r&&r.SSF&&(lf(),C0(r.SSF),e.revssf=jp(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Lh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=Ak.indexOf(e.bookType)>-1,i=Iv();Hv(e=e||{});var s=cv(),l="",u=0;if(e.cellXfs=[],al(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),l="docProps/core.xml",Tt(s,l,zI(r.Props,e)),i.coreprops.push(l),nr(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var f=[],d=0;d<r.SheetNames.length;++d)(r.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(r.SheetNames[d]);r.Props.SheetNames=f}for(r.Props.Worksheets=r.Props.SheetNames.length,Tt(s,l,GI(r.Props)),i.extprops.push(l),nr(e.rels,3,l,bt.EXT_PROPS),r.Custprops!==r.Props&&Vr(r.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(s,l,qI(r.Custprops)),i.custprops.push(l),nr(e.rels,4,l,bt.CUST_PROPS)),u=1;u<=r.SheetNames.length;++u){var m={"!id":{}},_=r.Sheets[r.SheetNames[u-1]],v=(_||{})["!type"]||"sheet";switch(v){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,Tt(s,l,rB(u-1,l,e,r,m)),i.sheets.push(l),nr(e.wbrels,-1,"worksheets/sheet"+u+"."+t,bt.WS[0])}if(_){var y=_["!comments"],T=!1,E="";y&&y.length>0&&(E="xl/comments"+u+"."+t,Tt(s,E,aB(y,E)),i.comments.push(E),nr(m,-1,"../comments"+u+"."+t,bt.CMNT),T=!0),_["!legacy"]&&T&&Tt(s,"xl/drawings/vmlDrawing"+u+".vml",wk(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}m["!id"].rId1&&Tt(s,a0(l),Pu(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,Tt(s,l,iB(e.Strings,l,e)),i.strs.push(l),nr(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,Tt(s,l,tB(r,l)),i.workbooks.push(l),nr(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",Tt(s,l,Ov(r.Themes,e)),i.themes.push(l),nr(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,Tt(s,l,nB(r,l,e)),i.styles.push(l),nr(e.wbrels,-1,"styles."+t,bt.STY),r.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(s,l,r.vbaraw),i.vba.push(l),nr(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,Tt(s,l,sB(l)),i.metadata.push(l),nr(e.wbrels,-1,"metadata."+t,bt.XLMETA),Tt(s,"[Content_Types].xml",VI(i,e)),Tt(s,"_rels/.rels",Pu(e.rels)),Tt(s,"xl/_rels/workbook."+t+".rels",Pu(e.wbrels)),delete e.revssf,delete e.ssf,s}function iC(r,e){Nu=1024,r&&!r.SSF&&(r.SSF=pr(ot)),r&&r.SSF&&(lf(),C0(r.SSF),e.revssf=jp(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Lh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=Ak.indexOf(e.bookType)>-1,i=Iv();Hv(e=e||{});var s=cv(),l="",u=0;if(e.cellXfs=[],al(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),l="docProps/core.xml",Tt(s,l,zI(r.Props,e)),i.coreprops.push(l),nr(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var f=[],d=0;d<r.SheetNames.length;++d)(r.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(r.SheetNames[d]);r.Props.SheetNames=f}r.Props.Worksheets=r.Props.SheetNames.length,Tt(s,l,GI(r.Props)),i.extprops.push(l),nr(e.rels,3,l,bt.EXT_PROPS),r.Custprops!==r.Props&&Vr(r.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(s,l,qI(r.Custprops)),i.custprops.push(l),nr(e.rels,4,l,bt.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=r.SheetNames.length;++u){var _={"!id":{}},v=r.Sheets[r.SheetNames[u-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,Tt(s,l,Mk(u-1,e,r,_)),i.sheets.push(l),nr(e.wbrels,-1,"worksheets/sheet"+u+"."+t,bt.WS[0])}if(v){var T=v["!comments"],E=!1,S="";if(T&&T.length>0){var D=!1;T.forEach(function(U){U[1].forEach(function(k){k.T==!0&&(D=!0)})}),D&&(S="xl/threadedComments/threadedComment"+u+"."+t,Tt(s,S,PP(T,m,e)),i.threadedcomments.push(S),nr(_,-1,"../threadedComments/threadedComment"+u+"."+t,bt.TCMNT)),S="xl/comments"+u+"."+t,Tt(s,S,Sk(T)),i.comments.push(S),nr(_,-1,"../comments"+u+"."+t,bt.CMNT),E=!0}v["!legacy"]&&E&&Tt(s,"xl/drawings/vmlDrawing"+u+".vml",wk(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}_["!id"].rId1&&Tt(s,a0(l),Pu(_))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,Tt(s,l,fk(e.Strings,e)),i.strs.push(l),nr(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,Tt(s,l,jk(r)),i.workbooks.push(l),nr(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",Tt(s,l,Ov(r.Themes,e)),i.themes.push(l),nr(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,Tt(s,l,vk(r,e)),i.styles.push(l),nr(e.wbrels,-1,"styles."+t,bt.STY),r.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(s,l,r.vbaraw),i.vba.push(l),nr(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,Tt(s,l,Tk()),i.metadata.push(l),nr(e.wbrels,-1,"metadata."+t,bt.XLMETA),m.length>1&&(l="xl/persons/person.xml",Tt(s,l,LP(m)),i.people.push(l),nr(e.wbrels,-1,"persons/person.xml",bt.PEOPLE)),Tt(s,"[Content_Types].xml",VI(i,e)),Tt(s,"_rels/.rels",Pu(e.rels)),Tt(s,"xl/_rels/workbook."+t+".rels",Pu(e.wbrels)),delete e.revssf,delete e.ssf,s}function Gv(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Mi(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function T7(r,e){return it.find(r,"EncryptedPackage")?v7(r,e):Uv(r,e)}function w7(r,e){var t,n=r,i=e||{};return i.type||(i.type=St&&Buffer.isBuffer(r)?"buffer":"base64"),t=_I(n,i),nC(t,i)}function aC(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return vx(r.slice(t),e);default:break e}return Gu.to_workbook(r,e)}function S7(r,e){var t="",n=Gv(r,e);switch(e.type){case"base64":t=Mi(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=ic(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=fr(t)),e.type="binary",aC(t,e)}function A7(r,e){var t=r;return e.type=="base64"&&(t=Mi(t)),t=Ut.utils.decode(1200,t.slice(2),"str"),e.type="binary",aC(t,e)}function b7(r){return r.match(/[^\x00-\x7F]/)?$a(r):r}function B_(r,e,t,n){return n?(t.type="string",Gu.to_workbook(r,t)):Gu.to_workbook(e,t)}function Ku(r,e){Up();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Ku(new Uint8Array(r),(t=pr(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Lu={},t.dateNF&&(Lu.dateNF=t.dateNF),t.type||(t.type=St&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=St?"buffer":"binary",n=I5(r),typeof Uint8Array<"u"&&!St&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=b7(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return t=pr(t),t.type="array",Ku(av(n),t)}switch((i=Gv(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return T7(it.read(n,t),t);break;case 9:if(i[1]<=8)return Uv(n,t);break;case 60:return vx(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return VF(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return ck.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?w7(n,t):B_(r,n,t,s);case 239:return i[3]===60?vx(n,t):B_(r,n,t,s);case 255:if(i[1]===254)return A7(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return Wl.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Wl.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return xx.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return gk.to_workbook(n,t);break;case 10:case 13:case 32:return S7(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return LF.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?xx.to_workbook(n,t):B_(r,n,t,s)}function jS(r,e){var t=e||{};return t.type="file",Ku(r,t)}function sC(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return R0(e.file,it.write(r,{type:St?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return it.write(r,e)}function I7(r,e){var t=pr(e||{}),n=y7(r,t);return oC(n,t)}function k7(r,e){var t=pr(e||{}),n=iC(r,t);return oC(n,t)}function oC(r,e){var t={},n=St?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?it.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(k0(i))}return e.password&&typeof encrypt_agile<"u"?sC(encrypt_agile(i,e.password),e):e.type==="file"?R0(e.file,i):e.type=="string"?fr(i):i}function C7(r,e){var t=e||{},n=NB(r,t);return sC(n,t)}function Xa(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return e0($a(n));case"binary":return $a(n);case"string":return r;case"file":return R0(e.file,n,"utf8");case"buffer":return St?Hs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Xa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function R7(r,e){switch(e.type){case"base64":return e0(r);case"binary":return r;case"string":return r;case"file":return R0(e.file,r,"binary");case"buffer":return St?Hs(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function bm(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?e0(t):e.type=="string"?fr(t):t;case"file":return R0(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function qv(r,e){Up(),zk(r);var t=pr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=qv(r,t);return t.type="array",k0(n)}return k7(r,t)}function Yp(r,e){Up(),zk(r);var t=pr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Yp(r,t);return t.type="array",k0(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Xa(AB(r,t),t);case"slk":case"sylk":return Xa(lk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return Xa(Qk(r.Sheets[r.SheetNames[i]],t),t);case"txt":return R7(uC(r.Sheets[r.SheetNames[i]],t),t);case"csv":return Xa(Wv(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return Xa(ck.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return bm(xx.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return Xa(Gu.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return Xa(gk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return Xa(uk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return Xa(tC(r,t),t);case"wk1":return bm(Wl.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return bm(Wl.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),bm(Kk(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),C7(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return I7(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Kv(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Yl(r,e,t){var n=t||{};return n.type="file",n.file=e,Kv(n),Yp(r,n)}function D7(r,e,t){var n=t||{};return n.type="file",n.file=e,Kv(n),qv(r,n)}function N7(r,e,t,n){var i=t||{};i.type="file",i.file=r,Kv(i),i.type="buffer";var s=n;return s instanceof Function||(s=t),Uo.writeFile(r,Yp(e,i),s)}function lC(r,e,t,n,i,s,l,u){var f=Mr(t),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),_=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:t,enumerable:!1})}catch{v.__rowNum__=t}else v.__rowNum__=t;if(!l||r[t])for(var y=e.s.c;y<=e.e.c;++y){var T=l?r[t][y]:r[n[y]+f];if(T===void 0||T.t===void 0){if(d===void 0)continue;s[y]!=null&&(v[s[y]]=d);continue}var E=T.v;switch(T.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+T.t)}if(s[y]!=null){if(E==null)if(T.t=="e"&&E===null)v[s[y]]=null;else if(d!==void 0)v[s[y]]=d;else if(m&&E===null)v[s[y]]=null;else continue;else v[s[y]]=m&&(T.t!=="n"||T.t==="n"&&u.rawNumbers!==!1)?E:rs(T,E,u);E!=null&&(_=!1)}}return{row:v,isempty:_}}function fp(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:r["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=Ft(m);break;case"number":f=Ft(r["!ref"]),f.s.r=m;break;default:f=m}n>0&&(i=0);var _=Mr(f.s.r),v=[],y=[],T=0,E=0,S=Array.isArray(r),D=f.s.r,U=0,k={};S&&!r[D]&&(r[D]=[]);var W=d.skipHidden&&r["!cols"]||[],ee=d.skipHidden&&r["!rows"]||[];for(U=f.s.c;U<=f.e.c;++U)if(!(W[U]||{}).hidden)switch(v[U]=vr(U),t=S?r[D][U]:r[v[U]+_],n){case 1:s[U]=U-f.s.c;break;case 2:s[U]=v[U];break;case 3:s[U]=d.header[U-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=l=rs(t,null,d),E=k[l]||0,!E)k[l]=1;else{do u=l+"_"+E++;while(k[u]);k[l]=E,k[u]=1}s[U]=u}for(D=f.s.r+i;D<=f.e.r;++D)if(!(ee[D]||{}).hidden){var X=lC(r,f,D,v,n,s,S,d);(X.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[T++]=X.row)}return y.length=T,y}var HS=/"/g;function cC(r,e,t,n,i,s,l,u){for(var f=!0,d=[],m="",_=Mr(t),v=e.s.c;v<=e.e.c;++v)if(n[v]){var y=u.dense?(r[t]||[])[v]:r[n[v]+_];if(y==null)m="";else if(y.v!=null){f=!1,m=""+(u.rawNumbers&&y.t=="n"?y.v:rs(y,null,u));for(var T=0,E=0;T!==m.length;++T)if((E=m.charCodeAt(T))===i||E===s||E===34||u.forceQuotes){m='"'+m.replace(HS,'""')+'"';break}m=="ID"&&(m='"ID"')}else y.f!=null&&!y.F?(f=!1,m="="+y.f,m.indexOf(",")>=0&&(m='"'+m.replace(HS,'""')+'"')):m="";d.push(m)}return u.blankrows===!1&&f?null:d.join(l)}function Wv(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=Ft(r["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",_=[];n.dense=Array.isArray(r);for(var v=n.skipHidden&&r["!cols"]||[],y=n.skipHidden&&r["!rows"]||[],T=i.s.c;T<=i.e.c;++T)(v[T]||{}).hidden||(_[T]=vr(T));for(var E=0,S=i.s.r;S<=i.e.r;++S)(y[S]||{}).hidden||(m=cC(r,i,S,_,l,f,s,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&t.push((E++?u:"")+m)));return delete n.dense,t.join("")}function uC(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Wv(r,e);if(typeof Ut>"u"||e.type=="string")return t;var n=Ut.utils.encode(1200,t,"str");return""+n}function O7(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=Ft(r["!ref"]),s="",l=[],u,f=[],d=Array.isArray(r);for(u=i.s.c;u<=i.e.c;++u)l[u]=vr(u);for(var m=i.s.r;m<=i.e.r;++m)for(s=Mr(m),u=i.s.c;u<=i.e.c;++u)if(e=l[u]+s,t=d?(r[m]||[])[u]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}f[f.length]=e+"="+n}return f}function fC(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},l=0,u=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Cr(n.origin):n.origin;l=f.r,u=f.c}var d,m={s:{c:0,r:0},e:{c:u,r:l+e.length-1+i}};if(s["!ref"]){var _=Ft(s["!ref"]);m.e.c=Math.max(m.e.c,_.e.c),m.e.r=Math.max(m.e.r,_.e.r),l==-1&&(l=_.e.r+1,m.e.r=l+e.length-1+i)}else l==-1&&(l=0,m.e.r=e.length-1+i);var v=n.header||[],y=0;e.forEach(function(E,S){Vr(E).forEach(function(D){(y=v.indexOf(D))==-1&&(v[y=v.length]=D);var U=E[D],k="z",W="",ee=ft({c:u+y,r:l+S+i});d=h0(s,ee),U&&typeof U=="object"&&!(U instanceof Date)?s[ee]=U:(typeof U=="number"?k="n":typeof U=="boolean"?k="b":typeof U=="string"?k="s":U instanceof Date?(k="d",n.cellDates||(k="n",U=un(U)),W=n.dateNF||ot[14]):U===null&&n.nullError&&(k="e",U=0),d?(d.t=k,d.v=U,delete d.w,delete d.R,W&&(d.z=W)):s[ee]=d={t:k,v:U},W&&(d.z=W))})}),m.e.c=Math.max(m.e.c,u+v.length-1);var T=Mr(l);if(i)for(y=0;y<v.length;++y)s[vr(y+u)+T]={t:"s",v:v[y]};return s["!ref"]=vt(m),s}function F7(r,e){return fC(null,r,e)}function h0(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=Cr(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?h0(r,ft(e)):h0(r,ft({r:e,c:t||0}))}function P7(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Xv(){return{SheetNames:[],Sheets:{}}}function Yv(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var l=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=l+i)!=-1;++i);}if(Uk(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function M7(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=P7(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function L7(r,e){return r.z=e,r}function hC(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function V7(r,e,t){return hC(r,"#"+e,t)}function B7(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function U7(r,e,t,n){for(var i=typeof e!="string"?e:Ft(e),s=typeof e=="string"?e:vt(e),l=i.s.r;l<=i.e.r;++l)for(var u=i.s.c;u<=i.e.c;++u){var f=h0(r,l,u);f.t="n",f.F=s,delete f.v,l==i.s.r&&u==i.s.c&&(f.f=t,n&&(f.D=!0))}return r}var gn={encode_col:vr,encode_row:Mr,encode_cell:ft,encode_range:vt,decode_col:Ev,decode_row:yv,split_cell:aO,decode_cell:Cr,decode_range:ii,format_cell:rs,sheet_add_aoa:DI,sheet_add_json:fC,sheet_add_dom:Jk,aoa_to_sheet:uf,json_to_sheet:F7,table_to_sheet:Zk,table_to_book:$B,sheet_to_csv:Wv,sheet_to_txt:uC,sheet_to_json:fp,sheet_to_html:Qk,sheet_to_formulae:O7,sheet_to_row_object_array:fp,sheet_get_cell:h0,book_new:Xv,book_append_sheet:Yv,book_set_sheet_visibility:M7,cell_set_number_format:L7,cell_set_hyperlink:hC,cell_set_internal_link:V7,cell_add_comment:B7,sheet_set_array_formula:U7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},$p;function z7(r){$p=r}function j7(r,e){var t=$p(),n=e??{};if(r==null||r["!ref"]==null)return t.push(null),t;var i=Ft(r["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",_=[];n.dense=Array.isArray(r);for(var v=n.skipHidden&&r["!cols"]||[],y=n.skipHidden&&r["!rows"]||[],T=i.s.c;T<=i.e.c;++T)(v[T]||{}).hidden||(_[T]=vr(T));var E=i.s.r,S=!1,D=0;return t._read=function(){if(!S)return S=!0,t.push("\uFEFF");for(;E<=i.e.r;)if(++E,!(y[E-1]||{}).hidden&&(m=cC(r,i,E-1,_,l,f,s,n),m!=null&&(n.strip&&(m=m.replace(d,"")),m||n.blankrows!==!1)))return t.push((D++?u:"")+m);return t.push(null)},t}function H7(r,e){var t=$p(),n=e||{},i=n.header!=null?n.header:Xk,s=n.footer!=null?n.footer:Yk;t.push(i);var l=ii(r["!ref"]);n.dense=Array.isArray(r),t.push($k(r,l,n));var u=l.s.r,f=!1;return t._read=function(){if(u>l.e.r)return f||(f=!0,t.push("</table>"+s)),t.push(null);for(;u<=l.e.r;){t.push(Wk(r,l,u,n)),++u;break}},t}function G7(r,e){var t=$p({objectMode:!0});if(r==null||r["!ref"]==null)return t.push(null),t;var n={t:"n",v:0},i=0,s=1,l=[],u=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},_=m.range!=null?m.range:r["!ref"];switch(m.header===1?i=1:m.header==="A"?i=2:Array.isArray(m.header)&&(i=3),typeof _){case"string":d=Ft(_);break;case"number":d=Ft(r["!ref"]),d.s.r=_;break;default:d=_}i>0&&(s=0);var v=Mr(d.s.r),y=[],T=0,E=Array.isArray(r),S=d.s.r,D=0,U={};E&&!r[S]&&(r[S]=[]);var k=m.skipHidden&&r["!cols"]||[],W=m.skipHidden&&r["!rows"]||[];for(D=d.s.c;D<=d.e.c;++D)if(!(k[D]||{}).hidden)switch(y[D]=vr(D),n=E?r[S][D]:r[y[D]+v],i){case 1:l[D]=D-d.s.c;break;case 2:l[D]=y[D];break;case 3:l[D]=m.header[D-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),f=u=rs(n,null,m),T=U[u]||0,!T)U[u]=1;else{do f=u+"_"+T++;while(U[f]);U[u]=T,U[f]=1}l[D]=f}return S=d.s.r+s,t._read=function(){for(;S<=d.e.r;)if(!(W[S-1]||{}).hidden){var ee=lC(r,d,S,y,i,l,E,m);if(++S,ee.isempty===!1||(i===1?m.blankrows!==!1:m.blankrows)){t.push(ee.row);return}}return t.push(null)},t}var q7={to_json:G7,to_html:H7,to_csv:j7,set_readable:z7};const K7=Zh.version,d0=Object.freeze(Object.defineProperty({__proto__:null,CFB:it,SSF:fI,parse_xlscfb:Uv,parse_zip:nC,read:Ku,readFile:jS,readFileSync:jS,set_cptable:$N,set_fs:A5,stream:q7,utils:gn,version:K7,write:Yp,writeFile:Yl,writeFileAsync:N7,writeFileSync:Yl,writeFileXLSX:D7,writeXLSX:qv},Symbol.toStringTag,{value:"Module"})),dC=We.createContext(null),L0=()=>{const r=We.useContext(dC);if(!r)throw new Error("useToast must be used within a ToastProvider");return r},W7=()=>{};var GS={};const mC=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},X7=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],l=r[t++],u=r[t++],f=((i&7)<<18|(s&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const s=r[t++],l=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|l&63)}}return e.join("")},pC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],l=i+1<r.length,u=l?r[i+1]:0,f=i+2<r.length,d=f?r[i+2]:0,m=s>>2,_=(s&3)<<4|u>>4;let v=(u&15)<<2|d>>6,y=d&63;f||(y=64,l||(v=64)),n.push(t[m],t[_],t[v],t[y])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(mC(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):X7(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],u=i<r.length?t[r.charAt(i)]:0;++i;const d=i<r.length?t[r.charAt(i)]:64;++i;const _=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||u==null||d==null||_==null)throw new Y7;const v=s<<2|u>>4;if(n.push(v),d!==64){const y=u<<4&240|d>>2;if(n.push(y),_!==64){const T=d<<6&192|_;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Y7 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $7=function(r){const e=mC(r);return pC.encodeByteArray(e,!0)},hp=function(r){return $7(r).replace(/\./g,"")},gC=function(r){try{return pC.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function _C(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Q7=()=>_C().__FIREBASE_DEFAULTS__,J7=()=>{if(typeof process>"u"||typeof GS>"u")return;const r=GS.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},Z7=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&gC(r[1]);return e&&JSON.parse(e)},Qp=()=>{try{return W7()||Q7()||J7()||Z7()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},xC=r=>Qp()?.emulatorHosts?.[r],eU=r=>{const e=xC(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},vC=()=>Qp()?.config,yC=r=>Qp()?.[`_${r}`];class tU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}function hf(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function EC(r){return(await fetch(r,{credentials:"include"})).ok}function rU(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...r};return[hp(JSON.stringify(t)),hp(JSON.stringify(l)),""].join(".")}const Uh={};function nU(){const r={prod:[],emulator:[]};for(const e of Object.keys(Uh))Uh[e]?r.emulator.push(e):r.prod.push(e);return r}function iU(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let qS=!1;function TC(r,e){if(typeof window>"u"||typeof document>"u"||!hf(window.location.host)||Uh[r]===e||Uh[r]||qS)return;Uh[r]=e;function t(v){return`__firebase__banner__${v}`}const n="__firebase__banner",s=nU().prod.length>0;function l(){const v=document.getElementById(n);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function f(v,y){v.setAttribute("width","24"),v.setAttribute("id",y),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{qS=!0,l()},v}function m(v,y){v.setAttribute("id",y),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function _(){const v=iU(n),y=t("text"),T=document.getElementById(y)||document.createElement("span"),E=t("learnmore"),S=document.getElementById(E)||document.createElement("a"),D=t("preprendIcon"),U=document.getElementById(D)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const k=v.element;u(k),m(S,E);const W=d();f(U,D),k.append(U,T,S,W),document.body.appendChild(k)}s?(T.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fn())}function wC(){const r=Qp()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function SC(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function oU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lU(){const r=fn();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function AC(){return!wC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bC(){return!wC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function $v(){try{return typeof indexedDB=="object"}catch{return!1}}function IC(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}function cU(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const uU="FirebaseError";class Na extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=uU,Object.setPrototypeOf(this,Na.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ic.prototype.create)}}class Ic{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],l=s?fU(s,n):"Error",u=`${this.serviceName}: ${l} (${i}).`;return new Na(i,u,n)}}function fU(r,e){return r.replace(hU,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const hU=/\{\$([^}]+)}/g;function dU(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Jo(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],l=e[i];if(KS(s)&&KS(l)){if(!Jo(s,l))return!1}else if(s!==l)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function KS(r){return r!==null&&typeof r=="object"}function df(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function mU(r,e){const t=new pU(r,e);return t.subscribe.bind(t)}class pU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");gU(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=U_),i.error===void 0&&(i.error=U_),i.complete===void 0&&(i.complete=U_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gU(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function U_(){}const _U=1e3,xU=2,vU=14400*1e3,yU=.5;function WS(r,e=_U,t=xU){const n=e*Math.pow(t,r),i=Math.round(yU*n*(Math.random()-.5)*2);return Math.min(vU,n+i)}function Rr(r){return r&&r._delegate?r._delegate:r}class Da{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Pl="[DEFAULT]";class EU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new tU;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wU(e))try{this.getOrInitializeService({instanceIdentifier:Pl})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Pl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pl){return this.instances.has(e)}getOptions(e=Pl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);n===u&&l.resolve(i)}return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:TU(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Pl){return this.component?this.component.multipleInstances?e:Pl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function TU(r){return r===Pl?void 0:r}function wU(r){return r.instantiationMode==="EAGER"}class SU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new EU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ot;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Ot||(Ot={}));const AU={debug:Ot.DEBUG,verbose:Ot.VERBOSE,info:Ot.INFO,warn:Ot.WARN,error:Ot.ERROR,silent:Ot.SILENT},bU=Ot.INFO,IU={[Ot.DEBUG]:"log",[Ot.VERBOSE]:"log",[Ot.INFO]:"info",[Ot.WARN]:"warn",[Ot.ERROR]:"error"},kU=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=IU[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Jp{constructor(e){this.name=e,this._logLevel=bU,this._logHandler=kU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ot))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ot.DEBUG,...e),this._logHandler(this,Ot.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ot.VERBOSE,...e),this._logHandler(this,Ot.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ot.INFO,...e),this._logHandler(this,Ot.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ot.WARN,...e),this._logHandler(this,Ot.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ot.ERROR,...e),this._logHandler(this,Ot.ERROR,...e)}}const CU=(r,e)=>e.some(t=>r instanceof t);let XS,YS;function RU(){return XS||(XS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DU(){return YS||(YS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kC=new WeakMap,Tx=new WeakMap,CC=new WeakMap,z_=new WeakMap,Qv=new WeakMap;function NU(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",l)},s=()=>{t(jo(r.result)),i()},l=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&kC.set(t,r)}).catch(()=>{}),Qv.set(e,r),e}function OU(r){if(Tx.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",l),r.removeEventListener("abort",l)},s=()=>{t(),i()},l=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",l),r.addEventListener("abort",l)});Tx.set(r,e)}let wx={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Tx.get(r);if(e==="objectStoreNames")return r.objectStoreNames||CC.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return jo(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function FU(r){wx=r(wx)}function PU(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(j_(this),e,...t);return CC.set(n,e.sort?e.sort():[e]),jo(n)}:DU().includes(r)?function(...e){return r.apply(j_(this),e),jo(kC.get(this))}:function(...e){return jo(r.apply(j_(this),e))}}function MU(r){return typeof r=="function"?PU(r):(r instanceof IDBTransaction&&OU(r),CU(r,RU())?new Proxy(r,wx):r)}function jo(r){if(r instanceof IDBRequest)return NU(r);if(z_.has(r))return z_.get(r);const e=MU(r);return e!==r&&(z_.set(r,e),Qv.set(e,r)),e}const j_=r=>Qv.get(r);function RC(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const l=indexedDB.open(r,e),u=jo(l);return n&&l.addEventListener("upgradeneeded",f=>{n(jo(l.result),f.oldVersion,f.newVersion,jo(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),u.then(f=>{s&&f.addEventListener("close",()=>s()),i&&f.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const LU=["get","getKey","getAll","getAllKeys","count"],VU=["put","add","delete","clear"],H_=new Map;function $S(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(H_.get(e))return H_.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=VU.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||LU.includes(t)))return;const s=async function(l,...u){const f=this.transaction(l,i?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),i&&f.done]))[0]};return H_.set(e,s),s}FU(r=>({...r,get:(e,t,n)=>$S(e,t)||r.get(e,t,n),has:(e,t)=>!!$S(e,t)||r.has(e,t)}));class BU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(UU(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function UU(r){return r.getComponent()?.type==="VERSION"}const Sx="@firebase/app",QS="0.14.6";const Ls=new Jp("@firebase/app"),zU="@firebase/app-compat",jU="@firebase/analytics-compat",HU="@firebase/analytics",GU="@firebase/app-check-compat",qU="@firebase/app-check",KU="@firebase/auth",WU="@firebase/auth-compat",XU="@firebase/database",YU="@firebase/data-connect",$U="@firebase/database-compat",QU="@firebase/functions",JU="@firebase/functions-compat",ZU="@firebase/installations",ez="@firebase/installations-compat",tz="@firebase/messaging",rz="@firebase/messaging-compat",nz="@firebase/performance",iz="@firebase/performance-compat",az="@firebase/remote-config",sz="@firebase/remote-config-compat",oz="@firebase/storage",lz="@firebase/storage-compat",cz="@firebase/firestore",uz="@firebase/ai",fz="@firebase/firestore-compat",hz="firebase",dz="12.6.0";const Ax="[DEFAULT]",mz={[Sx]:"fire-core",[zU]:"fire-core-compat",[HU]:"fire-analytics",[jU]:"fire-analytics-compat",[qU]:"fire-app-check",[GU]:"fire-app-check-compat",[KU]:"fire-auth",[WU]:"fire-auth-compat",[XU]:"fire-rtdb",[YU]:"fire-data-connect",[$U]:"fire-rtdb-compat",[QU]:"fire-fn",[JU]:"fire-fn-compat",[ZU]:"fire-iid",[ez]:"fire-iid-compat",[tz]:"fire-fcm",[rz]:"fire-fcm-compat",[nz]:"fire-perf",[iz]:"fire-perf-compat",[az]:"fire-rc",[sz]:"fire-rc-compat",[oz]:"fire-gcs",[lz]:"fire-gcs-compat",[cz]:"fire-fst",[fz]:"fire-fst-compat",[uz]:"fire-vertex","fire-js":"fire-js",[hz]:"fire-js-all"};const dp=new Map,pz=new Map,bx=new Map;function JS(r,e){try{r.container.addComponent(e)}catch(t){Ls.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ns(r){const e=r.name;if(bx.has(e))return Ls.debug(`There were multiple attempts to register component ${e}.`),!1;bx.set(e,r);for(const t of dp.values())JS(t,r);for(const t of pz.values())JS(t,r);return!0}function kc(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function ba(r){return r==null?!1:r.settings!==void 0}const gz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ho=new Ic("app","Firebase",gz);class _z{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Da("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ho.create("app-deleted",{appName:this._name})}}const mf=dz;function Jv(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:Ax,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Ho.create("bad-app-name",{appName:String(i)});if(t||(t=vC()),!t)throw Ho.create("no-options");const s=dp.get(i);if(s){if(Jo(t,s.options)&&Jo(n,s.config))return s;throw Ho.create("duplicate-app",{appName:i})}const l=new SU(i);for(const f of bx.values())l.addComponent(f);const u=new _z(t,n,l);return dp.set(i,u),u}function Zv(r=Ax){const e=dp.get(r);if(!e&&r===Ax&&vC())return Jv();if(!e)throw Ho.create("no-app",{appName:r});return e}function la(r,e,t){let n=mz[r]??r;t&&(n+=`-${t}`);const i=n.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const l=[`Unable to register library "${n}" with version "${e}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&l.push("and"),s&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ls.warn(l.join(" "));return}ns(new Da(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const xz="firebase-heartbeat-database",vz=1,m0="firebase-heartbeat-store";let G_=null;function DC(){return G_||(G_=RC(xz,vz,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(m0)}catch(t){console.warn(t)}}}}).catch(r=>{throw Ho.create("idb-open",{originalErrorMessage:r.message})})),G_}async function yz(r){try{const t=(await DC()).transaction(m0),n=await t.objectStore(m0).get(NC(r));return await t.done,n}catch(e){if(e instanceof Na)Ls.warn(e.message);else{const t=Ho.create("idb-get",{originalErrorMessage:e?.message});Ls.warn(t.message)}}}async function ZS(r,e){try{const n=(await DC()).transaction(m0,"readwrite");await n.objectStore(m0).put(e,NC(r)),await n.done}catch(t){if(t instanceof Na)Ls.warn(t.message);else{const n=Ho.create("idb-set",{originalErrorMessage:t?.message});Ls.warn(n.message)}}}function NC(r){return`${r.name}!${r.options.appId}`}const Ez=1024,Tz=30;class wz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Az(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=eA();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>Tz){const i=bz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ls.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=eA(),{heartbeatsToSend:t,unsentEntries:n}=Sz(this._heartbeatsCache.heartbeats),i=hp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ls.warn(e),""}}}function eA(){return new Date().toISOString().substring(0,10)}function Sz(r,e=Ez){const t=[];let n=r.slice();for(const i of r){const s=t.find(l=>l.agent===i.agent);if(s){if(s.dates.push(i.date),tA(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),tA(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class Az{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $v()?IC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yz(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ZS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ZS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function tA(r){return hp(JSON.stringify({version:2,heartbeats:r})).length}function bz(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}function Iz(r){ns(new Da("platform-logger",e=>new BU(e),"PRIVATE")),ns(new Da("heartbeat",e=>new wz(e),"PRIVATE")),la(Sx,QS,r),la(Sx,QS,"esm2020"),la("fire-js","")}Iz("");var kz="firebase",Cz="12.6.0";la(kz,Cz,"app");const OC="@firebase/installations",ey="0.6.19";const FC=1e4,PC=`w:${ey}`,MC="FIS_v2",Rz="https://firebaseinstallations.googleapis.com/v1",Dz=3600*1e3,Nz="installations",Oz="Installations";const Fz={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},cc=new Ic(Nz,Oz,Fz);function LC(r){return r instanceof Na&&r.code.includes("request-failed")}function VC({projectId:r}){return`${Rz}/projects/${r}/installations`}function BC(r){return{token:r.token,requestStatus:2,expiresIn:Mz(r.expiresIn),creationTime:Date.now()}}async function UC(r,e){const n=(await e.json()).error;return cc.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function zC({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Pz(r,{refreshToken:e}){const t=zC(r);return t.append("Authorization",Lz(e)),t}async function jC(r){const e=await r();return e.status>=500&&e.status<600?r():e}function Mz(r){return Number(r.replace("s","000"))}function Lz(r){return`${MC} ${r}`}async function Vz({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=VC(r),i=zC(r),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const l={fid:t,authVersion:MC,appId:r.appId,sdkVersion:PC},u={method:"POST",headers:i,body:JSON.stringify(l)},f=await jC(()=>fetch(n,u));if(f.ok){const d=await f.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:BC(d.authToken)}}else throw await UC("Create Installation",f)}function HC(r){return new Promise(e=>{setTimeout(e,r)})}function Bz(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}const Uz=/^[cdef][\w-]{21}$/,Ix="";function zz(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=jz(r);return Uz.test(t)?t:Ix}catch{return Ix}}function jz(r){return Bz(r).substr(0,22)}function Zp(r){return`${r.appName}!${r.appId}`}const GC=new Map;function qC(r,e){const t=Zp(r);KC(t,e),Hz(t,e)}function KC(r,e){const t=GC.get(r);if(t)for(const n of t)n(e)}function Hz(r,e){const t=Gz();t&&t.postMessage({key:r,fid:e}),qz()}let Hl=null;function Gz(){return!Hl&&"BroadcastChannel"in self&&(Hl=new BroadcastChannel("[Firebase] FID Change"),Hl.onmessage=r=>{KC(r.data.key,r.data.fid)}),Hl}function qz(){GC.size===0&&Hl&&(Hl.close(),Hl=null)}const Kz="firebase-installations-database",Wz=1,uc="firebase-installations-store";let q_=null;function ty(){return q_||(q_=RC(Kz,Wz,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(uc)}}})),q_}async function mp(r,e){const t=Zp(r),i=(await ty()).transaction(uc,"readwrite"),s=i.objectStore(uc),l=await s.get(t);return await s.put(e,t),await i.done,(!l||l.fid!==e.fid)&&qC(r,e.fid),e}async function WC(r){const e=Zp(r),n=(await ty()).transaction(uc,"readwrite");await n.objectStore(uc).delete(e),await n.done}async function eg(r,e){const t=Zp(r),i=(await ty()).transaction(uc,"readwrite"),s=i.objectStore(uc),l=await s.get(t),u=e(l);return u===void 0?await s.delete(t):await s.put(u,t),await i.done,u&&(!l||l.fid!==u.fid)&&qC(r,u.fid),u}async function ry(r){let e;const t=await eg(r.appConfig,n=>{const i=Xz(n),s=Yz(r,i);return e=s.registrationPromise,s.installationEntry});return t.fid===Ix?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Xz(r){const e=r||{fid:zz(),registrationStatus:0};return XC(e)}function Yz(r,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(cc.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=$z(r,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Qz(r)}:{installationEntry:e}}async function $z(r,e){try{const t=await Vz(r,e);return mp(r.appConfig,t)}catch(t){throw LC(t)&&t.customData.serverCode===409?await WC(r.appConfig):await mp(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Qz(r){let e=await rA(r.appConfig);for(;e.registrationStatus===1;)await HC(100),e=await rA(r.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await ry(r);return n||t}return e}function rA(r){return eg(r,e=>{if(!e)throw cc.create("installation-not-found");return XC(e)})}function XC(r){return Jz(r)?{fid:r.fid,registrationStatus:0}:r}function Jz(r){return r.registrationStatus===1&&r.registrationTime+FC<Date.now()}async function Zz({appConfig:r,heartbeatServiceProvider:e},t){const n=ej(r,t),i=Pz(r,t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const l={installation:{sdkVersion:PC,appId:r.appId}},u={method:"POST",headers:i,body:JSON.stringify(l)},f=await jC(()=>fetch(n,u));if(f.ok){const d=await f.json();return BC(d)}else throw await UC("Generate Auth Token",f)}function ej(r,{fid:e}){return`${VC(r)}/${e}/authTokens:generate`}async function ny(r,e=!1){let t;const n=await eg(r.appConfig,s=>{if(!YC(s))throw cc.create("not-registered");const l=s.authToken;if(!e&&nj(l))return s;if(l.requestStatus===1)return t=tj(r,e),s;{if(!navigator.onLine)throw cc.create("app-offline");const u=aj(s);return t=rj(r,u),u}});return t?await t:n.authToken}async function tj(r,e){let t=await nA(r.appConfig);for(;t.authToken.requestStatus===1;)await HC(100),t=await nA(r.appConfig);const n=t.authToken;return n.requestStatus===0?ny(r,e):n}function nA(r){return eg(r,e=>{if(!YC(e))throw cc.create("not-registered");const t=e.authToken;return sj(t)?{...e,authToken:{requestStatus:0}}:e})}async function rj(r,e){try{const t=await Zz(r,e),n={...e,authToken:t};return await mp(r.appConfig,n),t}catch(t){if(LC(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await WC(r.appConfig);else{const n={...e,authToken:{requestStatus:0}};await mp(r.appConfig,n)}throw t}}function YC(r){return r!==void 0&&r.registrationStatus===2}function nj(r){return r.requestStatus===2&&!ij(r)}function ij(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+Dz}function aj(r){const e={requestStatus:1,requestTime:Date.now()};return{...r,authToken:e}}function sj(r){return r.requestStatus===1&&r.requestTime+FC<Date.now()}async function oj(r){const e=r,{installationEntry:t,registrationPromise:n}=await ry(e);return n?n.catch(console.error):ny(e).catch(console.error),t.fid}async function lj(r,e=!1){const t=r;return await cj(t),(await ny(t,e)).token}async function cj(r){const{registrationPromise:e}=await ry(r);e&&await e}function uj(r){if(!r||!r.options)throw K_("App Configuration");if(!r.name)throw K_("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw K_(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function K_(r){return cc.create("missing-app-config-values",{valueName:r})}const $C="installations",fj="installations-internal",hj=r=>{const e=r.getProvider("app").getImmediate(),t=uj(e),n=kc(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},dj=r=>{const e=r.getProvider("app").getImmediate(),t=kc(e,$C).getImmediate();return{getId:()=>oj(t),getToken:i=>lj(t,i)}};function mj(){ns(new Da($C,hj,"PUBLIC")),ns(new Da(fj,dj,"PRIVATE"))}mj();la(OC,ey);la(OC,ey,"esm2020");const pp="analytics",pj="firebase_id",gj="origin",_j=60*1e3,xj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",iy="https://www.googletagmanager.com/gtag/js";const ri=new Jp("@firebase/analytics");const vj={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Oi=new Ic("analytics","Analytics",vj);function yj(r){if(!r.startsWith(iy)){const e=Oi.create("invalid-gtag-resource",{gtagURL:r});return ri.warn(e.message),""}return r}function QC(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function Ej(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}function Tj(r,e){const t=Ej("firebase-js-sdk-policy",{createScriptURL:yj}),n=document.createElement("script"),i=`${iy}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function wj(r){let e=[];return Array.isArray(window[r])?e=window[r]:window[r]=e,e}async function Sj(r,e,t,n,i,s){const l=n[i];try{if(l)await e[l];else{const f=(await QC(t)).find(d=>d.measurementId===i);f&&await e[f.appId]}}catch(u){ri.error(u)}r("config",i,s)}async function Aj(r,e,t,n,i){try{let s=[];if(i&&i.send_to){let l=i.send_to;Array.isArray(l)||(l=[l]);const u=await QC(t);for(const f of l){const d=u.find(_=>_.measurementId===f),m=d&&e[d.appId];if(m)s.push(m);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),r("event",n,i||{})}catch(s){ri.error(s)}}function bj(r,e,t,n){async function i(s,...l){try{if(s==="event"){const[u,f]=l;await Aj(r,e,t,u,f)}else if(s==="config"){const[u,f]=l;await Sj(r,e,t,n,u,f)}else if(s==="consent"){const[u,f]=l;r("consent",u,f)}else if(s==="get"){const[u,f,d]=l;r("get",u,f,d)}else if(s==="set"){const[u]=l;r("set",u)}else r(s,...l)}catch(u){ri.error(u)}}return i}function Ij(r,e,t,n,i){let s=function(...l){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=bj(s,r,e,t),{gtagCore:s,wrappedGtag:window[i]}}function kj(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(iy)&&t.src.includes(r))return t;return null}const Cj=30,Rj=1e3;class Dj{constructor(e={},t=Rj){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const JC=new Dj;function Nj(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function Oj(r){const{appId:e,apiKey:t}=r,n={method:"GET",headers:Nj(t)},i=xj.replace("{app-id}",e),s=await fetch(i,n);if(s.status!==200&&s.status!==304){let l="";try{const u=await s.json();u.error?.message&&(l=u.error.message)}catch{}throw Oi.create("config-fetch-failed",{httpStatus:s.status,responseMessage:l})}return s.json()}async function Fj(r,e=JC,t){const{appId:n,apiKey:i,measurementId:s}=r.options;if(!n)throw Oi.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw Oi.create("no-api-key")}const l=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new Lj;return setTimeout(async()=>{u.abort()},_j),ZC({appId:n,apiKey:i,measurementId:s},l,u,e)}async function ZC(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=JC){const{appId:s,measurementId:l}=r;try{await Pj(n,e)}catch(u){if(l)return ri.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u?.message}]`),{appId:s,measurementId:l};throw u}try{const u=await Oj(r);return i.deleteThrottleMetadata(s),u}catch(u){const f=u;if(!Mj(f)){if(i.deleteThrottleMetadata(s),l)return ri.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${f?.message}]`),{appId:s,measurementId:l};throw u}const d=Number(f?.customData?.httpStatus)===503?WS(t,i.intervalMillis,Cj):WS(t,i.intervalMillis),m={throttleEndTimeMillis:Date.now()+d,backoffCount:t+1};return i.setThrottleMetadata(s,m),ri.debug(`Calling attemptFetch again in ${d} millis`),ZC(r,m,n,i)}}function Pj(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(Oi.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Mj(r){if(!(r instanceof Na)||!r.customData)return!1;const e=Number(r.customData.httpStatus);return e===429||e===500||e===503||e===504}class Lj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Vj(r,e,t,n,i){if(i&&i.global){r("event",t,n);return}else{const s=await e,l={...n,send_to:s};r("event",t,l)}}async function Bj(r,e,t,n){if(n&&n.global){const i={};for(const s of Object.keys(t))i[`user_properties.${s}`]=t[s];return r("set",i),Promise.resolve()}else{const i=await e;r("config",i,{update:!0,user_properties:t})}}async function Uj(){if($v())try{await IC()}catch(r){return ri.warn(Oi.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}else return ri.warn(Oi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function zj(r,e,t,n,i,s,l){const u=Fj(r);u.then(v=>{t[v.measurementId]=v.appId,r.options.measurementId&&v.measurementId!==r.options.measurementId&&ri.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>ri.error(v)),e.push(u);const f=Uj().then(v=>{if(v)return n.getId()}),[d,m]=await Promise.all([u,f]);kj(s)||Tj(s,d.measurementId),i("js",new Date);const _=l?.config??{};return _[gj]="firebase",_.update=!0,m!=null&&(_[pj]=m),i("config",d.measurementId,_),d.measurementId}class jj{constructor(e){this.app=e}_delete(){return delete Vu[this.app.options.appId],Promise.resolve()}}let Vu={},iA=[];const aA={};let W_="dataLayer",Hj="gtag",sA,ay,oA=!1;function Gj(){const r=[];if(SC()&&r.push("This is a browser extension environment."),cU()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=Oi.create("invalid-analytics-context",{errorInfo:e});ri.warn(t.message)}}function qj(r,e,t){Gj();const n=r.options.appId;if(!n)throw Oi.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)ri.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Oi.create("no-api-key");if(Vu[n]!=null)throw Oi.create("already-exists",{id:n});if(!oA){wj(W_);const{wrappedGtag:s,gtagCore:l}=Ij(Vu,iA,aA,W_,Hj);ay=s,sA=l,oA=!0}return Vu[n]=zj(r,iA,aA,e,sA,W_,t),new jj(r)}function e4(r=Zv()){r=Rr(r);const e=kc(r,pp);return e.isInitialized()?e.getImmediate():Kj(r)}function Kj(r,e={}){const t=kc(r,pp);if(t.isInitialized()){const i=t.getImmediate();if(Jo(e,t.getOptions()))return i;throw Oi.create("already-initialized")}return t.initialize({options:e})}function Wj(r,e,t){r=Rr(r),Bj(ay,Vu[r.app.options.appId],e,t).catch(n=>ri.error(n))}function Xj(r,e,t,n){r=Rr(r),Vj(ay,Vu[r.app.options.appId],e,t,n).catch(i=>ri.error(i))}const lA="@firebase/analytics",cA="0.10.19";function Yj(){ns(new Da(pp,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return qj(n,i,t)},"PUBLIC")),ns(new Da("analytics-internal",r,"PRIVATE")),la(lA,cA),la(lA,cA,"esm2020");function r(e){try{const t=e.getProvider(pp).getImmediate();return{logEvent:(n,i,s)=>Xj(t,n,i,s),setUserProperties:(n,i)=>Wj(t,n,i)}}catch(t){throw Oi.create("interop-component-reg-failed",{reason:t})}}}Yj();function t4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $j=t4,r4=new Ic("auth","Firebase",t4());const gp=new Jp("@firebase/auth");function Qj(r,...e){gp.logLevel<=Ot.WARN&&gp.warn(`Auth (${mf}): ${r}`,...e)}function Lm(r,...e){gp.logLevel<=Ot.ERROR&&gp.error(`Auth (${mf}): ${r}`,...e)}function Vs(r,...e){throw sy(r,...e)}function Fi(r,...e){return sy(r,...e)}function n4(r,e,t){const n={...$j(),[e]:t};return new Ic("auth","Firebase",n).create(e,{appName:r.name})}function Go(r){return n4(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sy(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return r4.create(r,...e)}function Ye(r,e,...t){if(!r)throw sy(e,...t)}function Ds(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Lm(e),new Error(e)}function Bs(r,e){r||Ds(e)}function kx(){return typeof self<"u"&&self.location?.href||""}function i4(){return uA()==="http:"||uA()==="https:"}function uA(){return typeof self<"u"&&self.location?.protocol||null}function Jj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(i4()||SC()||"connection"in navigator)?navigator.onLine:!0}function Zj(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}class V0{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bs(t>e,"Short delay should be less than long delay!"),this.isMobile=aU()||oU()}get(){return Jj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function oy(r,e){Bs(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class a4{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ds("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ds("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ds("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const eH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const tH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rH=new V0(3e4,6e4);function os(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function Oa(r,e,t,n,i={}){return s4(r,i,async()=>{let s={},l={};n&&(e==="GET"?l=n:s={body:JSON.stringify(n)});const u=df({key:r.config.apiKey,...l}).slice(1),f=await r._getAdditionalHeaders();f["Content-Type"]="application/json",r.languageCode&&(f["X-Firebase-Locale"]=r.languageCode);const d={method:e,headers:f,...s};return sU()||(d.referrerPolicy="no-referrer"),r.emulatorConfig&&hf(r.emulatorConfig.host)&&(d.credentials="include"),a4.fetch()(await o4(r,r.config.apiHost,t,u),d)})}async function s4(r,e,t){r._canInitEmulator=!1;const n={...eH,...e};try{const i=new iH(r),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await s.json();if("needConfirmation"in l)throw bh(r,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{const u=s.ok?l.errorMessage:l.error.message,[f,d]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw bh(r,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw bh(r,"email-already-in-use",l);if(f==="USER_DISABLED")throw bh(r,"user-disabled",l);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw n4(r,m,d);Vs(r,m)}}catch(i){if(i instanceof Na)throw i;Vs(r,"network-request-failed",{message:String(i)})}}async function tg(r,e,t,n,i={}){const s=await Oa(r,e,t,n,i);return"mfaPendingCredential"in s&&Vs(r,"multi-factor-auth-required",{_serverResponse:s}),s}async function o4(r,e,t,n){const i=`${e}${t}?${n}`,s=r,l=s.config.emulator?oy(r.config,i):`${r.config.apiScheme}://${i}`;return tH.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(l).toString():l}function nH(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iH{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Fi(this.auth,"network-request-failed")),rH.get())})}}function bh(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=Fi(r,e,n);return i.customData._tokenResponse=t,i}function fA(r){return r!==void 0&&r.getResponse!==void 0}function hA(r){return r!==void 0&&r.enterprise!==void 0}class l4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return nH(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function aH(r){return(await Oa(r,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function c4(r,e){return Oa(r,"GET","/v2/recaptchaConfig",os(r,e))}async function sH(r,e){return Oa(r,"POST","/v1/accounts:delete",e)}async function _p(r,e){return Oa(r,"POST","/v1/accounts:lookup",e)}function zh(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oH(r,e=!1){const t=Rr(r),n=await t.getIdToken(e),i=ly(n);Ye(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,l=s?.sign_in_provider;return{claims:i,token:n,authTime:zh(X_(i.auth_time)),issuedAtTime:zh(X_(i.iat)),expirationTime:zh(X_(i.exp)),signInProvider:l||null,signInSecondFactor:s?.sign_in_second_factor||null}}function X_(r){return Number(r)*1e3}function ly(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return Lm("JWT malformed, contained fewer than 3 sections"),null;try{const i=gC(t);return i?JSON.parse(i):(Lm("Failed to decode base64 JWT payload"),null)}catch(i){return Lm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function dA(r){const e=ly(r);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function p0(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Na&&lH(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function lH({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}class cH{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Cx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zh(this.lastLoginAt),this.creationTime=zh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function xp(r){const e=r.auth,t=await r.getIdToken(),n=await p0(r,_p(e,{idToken:t}));Ye(n?.users.length,e,"internal-error");const i=n.users[0];r._notifyReloadListener(i);const s=i.providerUserInfo?.length?u4(i.providerUserInfo):[],l=fH(r.providerData,s),u=r.isAnonymous,f=!(r.email&&i.passwordHash)&&!l?.length,d=u?f:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Cx(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(r,m)}async function uH(r){const e=Rr(r);await xp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fH(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function u4(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function hH(r,e){const t=await s4(r,{},async()=>{const n=df({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,l=await o4(r,i,"/v1/token",`key=${s}`),u=await r._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return r.emulatorConfig&&hf(r.emulatorConfig.host)&&(f.credentials="include"),a4.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function dH(r,e){return Oa(r,"POST","/v2/accounts:revokeToken",os(r,e))}class Bu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):dA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const t=dA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await hH(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,l=new Bu;return n&&(Ye(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),i&&(Ye(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),s&&(Ye(typeof s=="number","internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bu,this.toJSON())}_performRefresh(){return Ds("not implemented")}}function ko(r,e){Ye(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class ka{constructor({uid:e,auth:t,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new cH(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Cx(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await p0(this,this.stsTokenManager.getToken(this.auth,e));return Ye(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return oH(this,e)}reload(){return uH(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ka({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await xp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ba(this.auth.app))return Promise.reject(Go(this.auth));const e=await this.getIdToken();return await p0(this,sH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,f=t._redirectEventId??void 0,d=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:_,emailVerified:v,isAnonymous:y,providerData:T,stsTokenManager:E}=t;Ye(_&&E,e,"internal-error");const S=Bu.fromJSON(this.name,E);Ye(typeof _=="string",e,"internal-error"),ko(n,e.name),ko(i,e.name),Ye(typeof v=="boolean",e,"internal-error"),Ye(typeof y=="boolean",e,"internal-error"),ko(s,e.name),ko(l,e.name),ko(u,e.name),ko(f,e.name),ko(d,e.name),ko(m,e.name);const D=new ka({uid:_,auth:e,email:i,emailVerified:v,displayName:n,isAnonymous:y,photoURL:l,phoneNumber:s,tenantId:u,stsTokenManager:S,createdAt:d,lastLoginAt:m});return T&&Array.isArray(T)&&(D.providerData=T.map(U=>({...U}))),f&&(D._redirectEventId=f),D}static async _fromIdTokenResponse(e,t,n=!1){const i=new Bu;i.updateFromServerResponse(t);const s=new ka({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await xp(s),s}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];Ye(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?u4(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!s?.length,u=new Bu;u.updateFromIdToken(n);const f=new ka({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Cx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(f,d),f}}const mA=new Map;function Ns(r){Bs(r instanceof Function,"Expected a class definition");let e=mA.get(r);return e?(Bs(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,mA.set(r,e),e)}class f4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}f4.type="NONE";const pA=f4;function Vm(r,e,t){return`firebase:${r}:${e}:${t}`}class Uu{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Vm(this.userKey,i.apiKey,s),this.fullPersistenceKey=Vm("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await _p(this.auth,{idToken:e}).catch(()=>{});return t?ka._fromGetAccountInfoResponse(this.auth,t,e):null}return ka._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Uu(Ns(pA),e,n);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Ns(pA);const l=Vm(n,e.config.apiKey,e.name);let u=null;for(const d of t)try{const m=await d._get(l);if(m){let _;if(typeof m=="string"){const v=await _p(e,{idToken:m}).catch(()=>{});if(!v)break;_=await ka._fromGetAccountInfoResponse(e,v,m)}else _=ka._fromJSON(e,m);d!==s&&(u=_),s=d;break}}catch{}const f=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!f.length?new Uu(s,e,n):(s=f[0],u&&await s._set(l,u.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(l)}catch{}})),new Uu(s,e,n))}}function gA(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(p4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(h4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_4(e))return"Blackberry";if(x4(e))return"Webos";if(d4(e))return"Safari";if((e.includes("chrome/")||m4(e))&&!e.includes("edge/"))return"Chrome";if(g4(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if(n?.length===2)return n[1]}return"Other"}function h4(r=fn()){return/firefox\//i.test(r)}function d4(r=fn()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function m4(r=fn()){return/crios\//i.test(r)}function p4(r=fn()){return/iemobile/i.test(r)}function g4(r=fn()){return/android/i.test(r)}function _4(r=fn()){return/blackberry/i.test(r)}function x4(r=fn()){return/webos/i.test(r)}function cy(r=fn()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function mH(r=fn()){return cy(r)&&!!window.navigator?.standalone}function pH(){return lU()&&document.documentMode===10}function v4(r=fn()){return cy(r)||g4(r)||x4(r)||_4(r)||/windows phone/i.test(r)||p4(r)}function y4(r,e=[]){let t;switch(r){case"Browser":t=gA(fn());break;case"Worker":t=`${gA(fn())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${mf}/${n}`}class gH{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((l,u)=>{try{const f=e(s);l(f)}catch(f){u(f)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function _H(r,e={}){return Oa(r,"GET","/v2/passwordPolicy",os(r,e))}const xH=6;class vH{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??xH,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class yH{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _A(this),this.idTokenSubscription=new _A(this),this.beforeStateQueue=new gH(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ns(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Uu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await _p(this,{idToken:e}),n=await ka._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ba(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,l=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!s||s===l)&&u?.user&&(n=u.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(s){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ba(this.app))return Promise.reject(Go(this));const t=e?Rr(e):null;return t&&Ye(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ba(this.app)?Promise.reject(Go(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ba(this.app)?Promise.reject(Go(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _H(this),t=new vH(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ic("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await dH(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ns(e)||this._popupRedirectResolver;Ye(t,this,"argument-error"),this.redirectPersistenceManager=await Uu.create(this,[Ns(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(u,this,"internal-error"),u.then(()=>{l||s(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,n,i);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(ba(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Qj(`Error while retrieving App Check token: ${e.error}`),e?.token}}function sl(r){return Rr(r)}class _A{constructor(e){this.auth=e,this.observer=null,this.addObserver=mU(t=>this.observer=t)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let B0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EH(r){B0=r}function uy(r){return B0.loadJS(r)}function TH(){return B0.recaptchaV2Script}function wH(){return B0.recaptchaEnterpriseScript}function SH(){return B0.gapiScript}function E4(r){return`__${r}${Math.floor(Math.random()*1e6)}`}const AH=500,bH=6e4,Im=1e12;class IH{constructor(e){this.auth=e,this.counter=Im,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new RH(e,this.auth.name,t||{})),this.counter++,n}reset(e){const t=e||Im;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Im;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Im;return this._widgets.get(t)?.execute(),""}}class kH{constructor(){this.enterprise=new CH}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CH{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class RH{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;Ye(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=DH(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},bH)},AH))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function DH(r){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<r;n++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const NH="recaptcha-enterprise",jh="NO_RECAPTCHA";class T4{constructor(e){this.type=NH,this.auth=sl(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(l,u)=>{c4(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new l4(f);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,l(d.siteKey)}}).catch(f=>{u(f)})})}function i(s,l,u){const f=window.grecaptcha;hA(f)?f.enterprise.ready(()=>{f.enterprise.execute(s,{action:e}).then(d=>{l(d)}).catch(()=>{l(jh)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new kH().execute("siteKey",{action:"verify"}):new Promise((s,l)=>{n(this.auth).then(u=>{if(!t&&hA(window.grecaptcha))i(u,s,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=wH();f.length!==0&&(f+=u),uy(f).then(()=>{i(u,s,l)}).catch(d=>{l(d)})}}).catch(u=>{l(u)})})}}async function Y_(r,e,t,n=!1,i=!1){const s=new T4(r);let l;if(i)l=jh;else try{l=await s.verify(t)}catch{l=await s.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const f=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const f=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function $_(r,e,t,n,i){if(r._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const s=await Y_(r,e,t);return n(r,s).catch(async l=>{if(r._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const u=await Y_(r,e,t,!1,!0);return n(r,u)}return Promise.reject(l)})}else{const s=await Y_(r,e,t,!1,!0);return n(r,s)}}async function OH(r){const e=sl(r),t=await c4(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new l4(t);e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.isAnyProviderEnabled()&&new T4(e).verify()}function FH(r,e){const t=kc(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Jo(s,e??{}))return i;Vs(i,"already-initialized")}return t.initialize({options:e})}function PH(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Ns);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}function MH(r,e,t){const n=sl(r);Ye(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=w4(e),{host:l,port:u}=LH(e),f=u===null?"":`:${u}`,d={url:`${s}//${l}${f}/`},m=Object.freeze({host:l,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Ye(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Ye(Jo(d,n.config.emulator)&&Jo(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,hf(l)?(EC(`${s}//${l}${f}`),TC("Auth",!0)):VH()}function w4(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function LH(r){const e=w4(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:xA(n.substr(s.length+1))}}else{const[s,l]=n.split(":");return{host:s,port:xA(l)}}}function xA(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function VH(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}class fy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ds("not implemented")}_getIdTokenResponse(e){return Ds("not implemented")}_linkToIdToken(e,t){return Ds("not implemented")}_getReauthenticationResolver(e){return Ds("not implemented")}}async function zu(r,e){return tg(r,"POST","/v1/accounts:signInWithIdp",os(r,e))}const BH="http://localhost";class fc extends fy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Vs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...s}=t;if(!n||!i)return null;const l=new fc(n,i);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return zu(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,zu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,zu(e,t)}buildRequest(){const e={requestUri:BH,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=df(t)}return e}}async function vA(r,e){return Oa(r,"POST","/v1/accounts:sendVerificationCode",os(r,e))}async function UH(r,e){return tg(r,"POST","/v1/accounts:signInWithPhoneNumber",os(r,e))}async function zH(r,e){const t=await tg(r,"POST","/v1/accounts:signInWithPhoneNumber",os(r,e));if(t.temporaryProof)throw bh(r,"account-exists-with-different-credential",t);return t}const jH={USER_NOT_FOUND:"user-not-found"};async function HH(r,e){const t={...e,operation:"REAUTH"};return tg(r,"POST","/v1/accounts:signInWithPhoneNumber",os(r,t),jH)}class Hh extends fy{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Hh({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Hh({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return UH(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return zH(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return HH(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s}=e;return!n&&!t&&!i&&!s?null:new Hh({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s})}}class S4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class U0 extends S4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class No extends U0{constructor(){super("facebook.com")}static credential(e){return fc._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return No.credential(e.oauthAccessToken)}catch{return null}}}No.FACEBOOK_SIGN_IN_METHOD="facebook.com";No.PROVIDER_ID="facebook.com";class Oo extends U0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fc._fromParams({providerId:Oo.PROVIDER_ID,signInMethod:Oo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Oo.credentialFromTaggedObject(e)}static credentialFromError(e){return Oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Oo.credential(t,n)}catch{return null}}}Oo.GOOGLE_SIGN_IN_METHOD="google.com";Oo.PROVIDER_ID="google.com";class Fo extends U0{constructor(){super("github.com")}static credential(e){return fc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fo.credential(e.oauthAccessToken)}catch{return null}}}Fo.GITHUB_SIGN_IN_METHOD="github.com";Fo.PROVIDER_ID="github.com";class Po extends U0{constructor(){super("twitter.com")}static credential(e,t){return fc._fromParams({providerId:Po.PROVIDER_ID,signInMethod:Po.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Po.credentialFromTaggedObject(e)}static credentialFromError(e){return Po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Po.credential(t,n)}catch{return null}}}Po.TWITTER_SIGN_IN_METHOD="twitter.com";Po.PROVIDER_ID="twitter.com";class Wu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await ka._fromIdTokenResponse(e,n,i),l=yA(n);return new Wu({user:s,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=yA(n);return new Wu({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function yA(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class vp extends Na{constructor(e,t,n,i){super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,vp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new vp(e,t,n,i)}}function A4(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?vp._fromErrorAndOperation(r,s,e,n):s})}async function GH(r,e,t=!1){const n=await p0(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Wu._forOperation(r,"link",n)}async function qH(r,e,t=!1){const{auth:n}=r;if(ba(n.app))return Promise.reject(Go(n));const i="reauthenticate";try{const s=await p0(r,A4(n,i,e,r),t);Ye(s.idToken,n,"internal-error");const l=ly(s.idToken);Ye(l,n,"internal-error");const{sub:u}=l;return Ye(r.uid===u,n,"user-mismatch"),Wu._forOperation(r,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Vs(n,"user-mismatch"),s}}async function b4(r,e,t=!1){if(ba(r.app))return Promise.reject(Go(r));const n="signIn",i=await A4(r,n,e),s=await Wu._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(s.user),s}async function KH(r,e){return b4(sl(r),e)}function WH(r,e,t,n){return Rr(r).onIdTokenChanged(e,t,n)}function XH(r,e,t){return Rr(r).beforeAuthStateChanged(e,t)}function YH(r,e,t,n){return Rr(r).onAuthStateChanged(e,t,n)}function $H(r){return Rr(r).signOut()}function EA(r,e){return Oa(r,"POST","/v2/accounts/mfaEnrollment:start",os(r,e))}const yp="__sak";class I4{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yp,"1"),this.storage.removeItem(yp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const QH=1e3,JH=10;class k4 extends I4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=v4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,f)=>{this.notifyListeners(l,f)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},s=this.storage.getItem(n);pH()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,JH):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},QH)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}k4.type="LOCAL";const ZH=k4;class C4 extends I4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}C4.type="SESSION";const R4=C4;function eG(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class rg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new rg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,l=this.handlersMap[i];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(l).map(async d=>d(t.origin,s)),f=await eG(u);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rg.receivers=[];function hy(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}class tG{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,l;return new Promise((u,f)=>{const d=hy("",20);i.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(_){const v=_;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(v.data.response);break;default:clearTimeout(m),clearTimeout(s),f(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function tn(){return window}function rG(r){tn().location.href=r}function dy(){return typeof tn().WorkerGlobalScope<"u"&&typeof tn().importScripts=="function"}async function nG(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function iG(){return navigator?.serviceWorker?.controller||null}function aG(){return dy()?self:null}const D4="firebaseLocalStorageDb",sG=1,Ep="firebaseLocalStorage",N4="fbase_key";class z0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ng(r,e){return r.transaction([Ep],e?"readwrite":"readonly").objectStore(Ep)}function oG(){const r=indexedDB.deleteDatabase(D4);return new z0(r).toPromise()}function Rx(){const r=indexedDB.open(D4,sG);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Ep,{keyPath:N4})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(Ep)?e(n):(n.close(),await oG(),e(await Rx()))})})}async function TA(r,e,t){const n=ng(r,!0).put({[N4]:e,value:t});return new z0(n).toPromise()}async function lG(r,e){const t=ng(r,!1).get(e),n=await new z0(t).toPromise();return n===void 0?null:n.value}function wA(r,e){const t=ng(r,!0).delete(e);return new z0(t).toPromise()}const cG=800,uG=3;class O4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Rx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>uG)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rg._getInstance(aG()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await nG(),!this.activeServiceWorker)return;this.sender=new tG(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||iG()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rx();return await TA(e,yp,"1"),await wA(e,yp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>TA(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>lG(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>wA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ng(i,!1).getAll();return new z0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),cG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}O4.type="LOCAL";const fG=O4;function SA(r,e){return Oa(r,"POST","/v2/accounts/mfaSignIn:start",os(r,e))}const Q_=E4("rcb"),hG=new V0(3e4,6e4);class dG{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!tn().grecaptcha?.render}load(e,t=""){return Ye(mG(t),e,"argument-error"),this.shouldResolveImmediately(t)&&fA(tn().grecaptcha)?Promise.resolve(tn().grecaptcha):new Promise((n,i)=>{const s=tn().setTimeout(()=>{i(Fi(e,"network-request-failed"))},hG.get());tn()[Q_]=()=>{tn().clearTimeout(s),delete tn()[Q_];const u=tn().grecaptcha;if(!u||!fA(u)){i(Fi(e,"internal-error"));return}const f=u.render;u.render=(d,m)=>{const _=f(d,m);return this.counter++,_},this.hostLanguage=t,n(u)};const l=`${TH()}?${df({onload:Q_,render:"explicit",hl:t})}`;uy(l).catch(()=>{clearTimeout(s),i(Fi(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!tn().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function mG(r){return r.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(r)}class pG{async load(e){return new IH(e)}clearedOneInstance(){}}const Gh="recaptcha",gG={theme:"light",type:"image"};class _G{constructor(e,t,n={...gG}){this.parameters=n,this.type=Gh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=sl(e),this.isInvisible=this.parameters.size==="invisible",Ye(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;Ye(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new pG:new dG,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(i=>{const s=l=>{l&&(this.tokenChangeListeners.delete(s),i(l))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Ye(!this.parameters.sitekey,this.auth,"argument-error"),Ye(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ye(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(n=>n(t)),typeof e=="function")e(t);else if(typeof e=="string"){const n=tn()[e];typeof n=="function"&&n(t)}}}assertNotDestroyed(){Ye(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Ye(i4()&&!dy(),this.auth,"internal-error"),await xG(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await aH(this.auth);Ye(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Ye(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function xG(){let r=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}r=()=>e(),window.addEventListener("load",r)}).catch(e=>{throw r&&window.removeEventListener("load",r),e})}class vG{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Hh._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function yG(r,e,t){if(ba(r.app))return Promise.reject(Go(r));const n=sl(r),i=await EG(n,e,Rr(t));return new vG(i,s=>KH(n,s))}async function EG(r,e,t){if(!r._getRecaptchaConfig())try{await OH(r)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let n;if(typeof e=="string"?n={phoneNumber:e}:n=e,"session"in n){const i=n.session;if("phoneNumber"in n){Ye(i.type==="enroll",r,"internal-error");const s={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await $_(r,s,"mfaSmsEnrollment",async(d,m)=>{if(m.phoneEnrollmentInfo.captchaResponse===jh){Ye(t?.type===Gh,d,"argument-error");const _=await J_(d,m,t);return EA(d,_)}return EA(d,m)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneSessionInfo.sessionInfo}else{Ye(i.type==="signin",r,"internal-error");const s=n.multiFactorHint?.uid||n.multiFactorUid;Ye(s,r,"missing-multi-factor-info");const l={mfaPendingCredential:i.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await $_(r,l,"mfaSmsSignIn",async(m,_)=>{if(_.phoneSignInInfo.captchaResponse===jh){Ye(t?.type===Gh,m,"argument-error");const v=await J_(m,_,t);return SA(m,v)}return SA(m,_)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await $_(r,i,"sendVerificationCode",async(f,d)=>{if(d.captchaResponse===jh){Ye(t?.type===Gh,f,"argument-error");const m=await J_(f,d,t);return vA(f,m)}return vA(f,d)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{t?._reset()}}async function J_(r,e,t){Ye(t.type===Gh,r,"argument-error");const n=await t.verify();Ye(typeof n=="string",r,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const s=i.phoneEnrollmentInfo.phoneNumber,l=i.phoneEnrollmentInfo.captchaResponse,u=i.phoneEnrollmentInfo.clientType,f=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:n,captchaResponse:l,clientType:u,recaptchaVersion:f}}),i}else if("phoneSignInInfo"in i){const s=i.phoneSignInInfo.captchaResponse,l=i.phoneSignInInfo.clientType,u=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:s,clientType:l,recaptchaVersion:u}}),i}else return Object.assign(i,{recaptchaToken:n}),i}function TG(r,e){return e?Ns(e):(Ye(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}class my extends fy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return zu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return zu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function wG(r){return b4(r.auth,new my(r),r.bypassAuthState)}function SG(r){const{auth:e,user:t}=r;return Ye(t,e,"internal-error"),qH(t,new my(r),r.bypassAuthState)}async function AG(r){const{auth:e,user:t}=r;return Ye(t,e,"internal-error"),GH(t,new my(r),r.bypassAuthState)}class F4{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:l,type:u}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wG;case"linkViaPopup":case"linkViaRedirect":return AG;case"reauthViaPopup":case"reauthViaRedirect":return SG;default:Vs(this.auth,"internal-error")}}resolve(e){Bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const bG=new V0(2e3,1e4);class Ou extends F4{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Ou.currentPopupAction&&Ou.currentPopupAction.cancel(),Ou.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){Bs(this.filter.length===1,"Popup operations only handle one event");const e=hy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Fi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Fi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ou.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bG.get())};e()}}Ou.currentPopupAction=null;const IG="pendingRedirect",Bm=new Map;class kG extends F4{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Bm.get(this.auth._key());if(!e){try{const n=await CG(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Bm.set(this.auth._key(),e)}return this.bypassAuthState||Bm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CG(r,e){const t=NG(e),n=DG(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function RG(r,e){Bm.set(r._key(),e)}function DG(r){return Ns(r._redirectPersistence)}function NG(r){return Vm(IG,r.config.apiKey,r.name)}async function OG(r,e,t=!1){if(ba(r.app))return Promise.reject(Go(r));const n=sl(r),i=TG(n,e),l=await new kG(n,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}const FG=600*1e3;class PG{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!MG(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!P4(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Fi(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FG&&this.cachedEventUids.clear(),this.cachedEventUids.has(AA(e))}saveEventToCache(e){this.cachedEventUids.add(AA(e)),this.lastProcessedEventTime=Date.now()}}function AA(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function P4({type:r,error:e}){return r==="unknown"&&e?.code==="auth/no-auth-event"}function MG(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return P4(r);default:return!1}}async function LG(r,e={}){return Oa(r,"GET","/v1/projects",e)}const VG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BG=/^https?/;async function UG(r){if(r.config.emulator)return;const{authorizedDomains:e}=await LG(r);for(const t of e)try{if(zG(t))return}catch{}Vs(r,"unauthorized-domain")}function zG(r){const e=kx(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const l=new URL(r);return l.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!BG.test(t))return!1;if(VG.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const jG=new V0(3e4,6e4);function bA(){const r=tn().___jsl;if(r?.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function HG(r){return new Promise((e,t)=>{function n(){bA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bA(),t(Fi(r,"network-request-failed"))},timeout:jG.get()})}if(tn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(tn().gapi?.load)n();else{const i=E4("iframefcb");return tn()[i]=()=>{gapi.load?n():t(Fi(r,"network-request-failed"))},uy(`${SH()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw Um=null,e})}let Um=null;function GG(r){return Um=Um||HG(r),Um}const qG=new V0(5e3,15e3),KG="__/auth/iframe",WG="emulator/auth/iframe",XG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},YG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $G(r){const e=r.config;Ye(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?oy(e,WG):`https://${r.config.authDomain}/${KG}`,n={apiKey:e.apiKey,appName:r.name,v:mf},i=YG.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${df(n).slice(1)}`}async function QG(r){const e=await GG(r),t=tn().gapi;return Ye(t,r,"internal-error"),e.open({where:document.body,url:$G(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:XG,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const l=Fi(r,"network-request-failed"),u=tn().setTimeout(()=>{s(l)},qG.get());function f(){tn().clearTimeout(u),i(n)}n.ping(f).then(f,()=>{s(l)})}))}const JG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ZG=500,eq=600,tq="_blank",rq="http://localhost";class IA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function nq(r,e,t,n=ZG,i=eq){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...JG,width:n.toString(),height:i.toString(),top:s,left:l},d=fn().toLowerCase();t&&(u=m4(d)?tq:t),h4(d)&&(e=e||rq,f.scrollbars="yes");const m=Object.entries(f).reduce((v,[y,T])=>`${v}${y}=${T},`,"");if(mH(d)&&u!=="_self")return iq(e||"",u),new IA(null);const _=window.open(e||"",u,m);Ye(_,r,"popup-blocked");try{_.focus()}catch{}return new IA(_)}function iq(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}const aq="__/auth/handler",sq="emulator/auth/handler",oq=encodeURIComponent("fac");async function kA(r,e,t,n,i,s){Ye(r.config.authDomain,r,"auth-domain-config-required"),Ye(r.config.apiKey,r,"invalid-api-key");const l={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:mf,eventId:i};if(e instanceof S4){e.setDefaultLanguage(r.languageCode),l.providerId=e.providerId||"",dU(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,_]of Object.entries({}))l[m]=_}if(e instanceof U0){const m=e.getScopes().filter(_=>_!=="");m.length>0&&(l.scopes=m.join(","))}r.tenantId&&(l.tid=r.tenantId);const u=l;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const f=await r._getAppCheckToken(),d=f?`#${oq}=${encodeURIComponent(f)}`:"";return`${lq(r)}?${df(u).slice(1)}${d}`}function lq({config:r}){return r.emulator?oy(r,sq):`https://${r.authDomain}/${aq}`}const Z_="webStorageSupport";class cq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=R4,this._completeRedirectFn=OG,this._overrideRedirectResult=RG}async _openPopup(e,t,n,i){Bs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await kA(e,t,n,kx(),i);return nq(e,s,hy())}async _openRedirect(e,t,n,i){await this._originValidation(e);const s=await kA(e,t,n,kx(),i);return rG(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Bs(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await QG(e),n=new PG(e);return t.register("authEvent",i=>(Ye(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Z_,{type:Z_},i=>{const s=i?.[0]?.[Z_];s!==void 0&&t(!!s),Vs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=UG(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return v4()||d4()||cy()}}const uq=cq;var CA="@firebase/auth",RA="1.11.1";class fq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function hq(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dq(r){ns(new Da("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;Ye(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:l,authDomain:u,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y4(r)},d=new yH(n,i,s,f);return PH(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ns(new Da("auth-internal",e=>{const t=sl(e.getProvider("auth").getImmediate());return(n=>new fq(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),la(CA,RA,hq(r)),la(CA,RA,"esm2020")}const mq=300,pq=yC("authIdTokenMaxAge")||mq;let DA=null;const gq=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>pq)return;const i=t?.token;DA!==i&&(DA=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function _q(r=Zv()){const e=kc(r,"auth");if(e.isInitialized())return e.getImmediate();const t=FH(r,{popupRedirectResolver:uq,persistence:[fG,ZH,R4]}),n=yC("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const l=gq(s.toString());XH(t,l,()=>l(t.currentUser)),WH(t,u=>l(u))}}const i=xC("auth");return i&&MH(t,`http://${i}`),t}function xq(){return document.getElementsByTagName("head")?.[0]??document}EH({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=Fi("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",xq().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dq("Browser");var NA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qo,M4;(function(){var r;function e(A,R){function C(){}C.prototype=R.prototype,A.F=R.prototype,A.prototype=new C,A.prototype.constructor=A,A.D=function(B,N,M){for(var V=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)V[xe-2]=arguments[xe];return R.prototype[N].apply(B,V)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,R,C){C||(C=0);const B=Array(16);if(typeof R=="string")for(var N=0;N<16;++N)B[N]=R.charCodeAt(C++)|R.charCodeAt(C++)<<8|R.charCodeAt(C++)<<16|R.charCodeAt(C++)<<24;else for(N=0;N<16;++N)B[N]=R[C++]|R[C++]<<8|R[C++]<<16|R[C++]<<24;R=A.g[0],C=A.g[1],N=A.g[2];let M=A.g[3],V;V=R+(M^C&(N^M))+B[0]+3614090360&4294967295,R=C+(V<<7&4294967295|V>>>25),V=M+(N^R&(C^N))+B[1]+3905402710&4294967295,M=R+(V<<12&4294967295|V>>>20),V=N+(C^M&(R^C))+B[2]+606105819&4294967295,N=M+(V<<17&4294967295|V>>>15),V=C+(R^N&(M^R))+B[3]+3250441966&4294967295,C=N+(V<<22&4294967295|V>>>10),V=R+(M^C&(N^M))+B[4]+4118548399&4294967295,R=C+(V<<7&4294967295|V>>>25),V=M+(N^R&(C^N))+B[5]+1200080426&4294967295,M=R+(V<<12&4294967295|V>>>20),V=N+(C^M&(R^C))+B[6]+2821735955&4294967295,N=M+(V<<17&4294967295|V>>>15),V=C+(R^N&(M^R))+B[7]+4249261313&4294967295,C=N+(V<<22&4294967295|V>>>10),V=R+(M^C&(N^M))+B[8]+1770035416&4294967295,R=C+(V<<7&4294967295|V>>>25),V=M+(N^R&(C^N))+B[9]+2336552879&4294967295,M=R+(V<<12&4294967295|V>>>20),V=N+(C^M&(R^C))+B[10]+4294925233&4294967295,N=M+(V<<17&4294967295|V>>>15),V=C+(R^N&(M^R))+B[11]+2304563134&4294967295,C=N+(V<<22&4294967295|V>>>10),V=R+(M^C&(N^M))+B[12]+1804603682&4294967295,R=C+(V<<7&4294967295|V>>>25),V=M+(N^R&(C^N))+B[13]+4254626195&4294967295,M=R+(V<<12&4294967295|V>>>20),V=N+(C^M&(R^C))+B[14]+2792965006&4294967295,N=M+(V<<17&4294967295|V>>>15),V=C+(R^N&(M^R))+B[15]+1236535329&4294967295,C=N+(V<<22&4294967295|V>>>10),V=R+(N^M&(C^N))+B[1]+4129170786&4294967295,R=C+(V<<5&4294967295|V>>>27),V=M+(C^N&(R^C))+B[6]+3225465664&4294967295,M=R+(V<<9&4294967295|V>>>23),V=N+(R^C&(M^R))+B[11]+643717713&4294967295,N=M+(V<<14&4294967295|V>>>18),V=C+(M^R&(N^M))+B[0]+3921069994&4294967295,C=N+(V<<20&4294967295|V>>>12),V=R+(N^M&(C^N))+B[5]+3593408605&4294967295,R=C+(V<<5&4294967295|V>>>27),V=M+(C^N&(R^C))+B[10]+38016083&4294967295,M=R+(V<<9&4294967295|V>>>23),V=N+(R^C&(M^R))+B[15]+3634488961&4294967295,N=M+(V<<14&4294967295|V>>>18),V=C+(M^R&(N^M))+B[4]+3889429448&4294967295,C=N+(V<<20&4294967295|V>>>12),V=R+(N^M&(C^N))+B[9]+568446438&4294967295,R=C+(V<<5&4294967295|V>>>27),V=M+(C^N&(R^C))+B[14]+3275163606&4294967295,M=R+(V<<9&4294967295|V>>>23),V=N+(R^C&(M^R))+B[3]+4107603335&4294967295,N=M+(V<<14&4294967295|V>>>18),V=C+(M^R&(N^M))+B[8]+1163531501&4294967295,C=N+(V<<20&4294967295|V>>>12),V=R+(N^M&(C^N))+B[13]+2850285829&4294967295,R=C+(V<<5&4294967295|V>>>27),V=M+(C^N&(R^C))+B[2]+4243563512&4294967295,M=R+(V<<9&4294967295|V>>>23),V=N+(R^C&(M^R))+B[7]+1735328473&4294967295,N=M+(V<<14&4294967295|V>>>18),V=C+(M^R&(N^M))+B[12]+2368359562&4294967295,C=N+(V<<20&4294967295|V>>>12),V=R+(C^N^M)+B[5]+4294588738&4294967295,R=C+(V<<4&4294967295|V>>>28),V=M+(R^C^N)+B[8]+2272392833&4294967295,M=R+(V<<11&4294967295|V>>>21),V=N+(M^R^C)+B[11]+1839030562&4294967295,N=M+(V<<16&4294967295|V>>>16),V=C+(N^M^R)+B[14]+4259657740&4294967295,C=N+(V<<23&4294967295|V>>>9),V=R+(C^N^M)+B[1]+2763975236&4294967295,R=C+(V<<4&4294967295|V>>>28),V=M+(R^C^N)+B[4]+1272893353&4294967295,M=R+(V<<11&4294967295|V>>>21),V=N+(M^R^C)+B[7]+4139469664&4294967295,N=M+(V<<16&4294967295|V>>>16),V=C+(N^M^R)+B[10]+3200236656&4294967295,C=N+(V<<23&4294967295|V>>>9),V=R+(C^N^M)+B[13]+681279174&4294967295,R=C+(V<<4&4294967295|V>>>28),V=M+(R^C^N)+B[0]+3936430074&4294967295,M=R+(V<<11&4294967295|V>>>21),V=N+(M^R^C)+B[3]+3572445317&4294967295,N=M+(V<<16&4294967295|V>>>16),V=C+(N^M^R)+B[6]+76029189&4294967295,C=N+(V<<23&4294967295|V>>>9),V=R+(C^N^M)+B[9]+3654602809&4294967295,R=C+(V<<4&4294967295|V>>>28),V=M+(R^C^N)+B[12]+3873151461&4294967295,M=R+(V<<11&4294967295|V>>>21),V=N+(M^R^C)+B[15]+530742520&4294967295,N=M+(V<<16&4294967295|V>>>16),V=C+(N^M^R)+B[2]+3299628645&4294967295,C=N+(V<<23&4294967295|V>>>9),V=R+(N^(C|~M))+B[0]+4096336452&4294967295,R=C+(V<<6&4294967295|V>>>26),V=M+(C^(R|~N))+B[7]+1126891415&4294967295,M=R+(V<<10&4294967295|V>>>22),V=N+(R^(M|~C))+B[14]+2878612391&4294967295,N=M+(V<<15&4294967295|V>>>17),V=C+(M^(N|~R))+B[5]+4237533241&4294967295,C=N+(V<<21&4294967295|V>>>11),V=R+(N^(C|~M))+B[12]+1700485571&4294967295,R=C+(V<<6&4294967295|V>>>26),V=M+(C^(R|~N))+B[3]+2399980690&4294967295,M=R+(V<<10&4294967295|V>>>22),V=N+(R^(M|~C))+B[10]+4293915773&4294967295,N=M+(V<<15&4294967295|V>>>17),V=C+(M^(N|~R))+B[1]+2240044497&4294967295,C=N+(V<<21&4294967295|V>>>11),V=R+(N^(C|~M))+B[8]+1873313359&4294967295,R=C+(V<<6&4294967295|V>>>26),V=M+(C^(R|~N))+B[15]+4264355552&4294967295,M=R+(V<<10&4294967295|V>>>22),V=N+(R^(M|~C))+B[6]+2734768916&4294967295,N=M+(V<<15&4294967295|V>>>17),V=C+(M^(N|~R))+B[13]+1309151649&4294967295,C=N+(V<<21&4294967295|V>>>11),V=R+(N^(C|~M))+B[4]+4149444226&4294967295,R=C+(V<<6&4294967295|V>>>26),V=M+(C^(R|~N))+B[11]+3174756917&4294967295,M=R+(V<<10&4294967295|V>>>22),V=N+(R^(M|~C))+B[2]+718787259&4294967295,N=M+(V<<15&4294967295|V>>>17),V=C+(M^(N|~R))+B[9]+3951481745&4294967295,A.g[0]=A.g[0]+R&4294967295,A.g[1]=A.g[1]+(N+(V<<21&4294967295|V>>>11))&4294967295,A.g[2]=A.g[2]+N&4294967295,A.g[3]=A.g[3]+M&4294967295}n.prototype.v=function(A,R){R===void 0&&(R=A.length);const C=R-this.blockSize,B=this.C;let N=this.h,M=0;for(;M<R;){if(N==0)for(;M<=C;)i(this,A,M),M+=this.blockSize;if(typeof A=="string"){for(;M<R;)if(B[N++]=A.charCodeAt(M++),N==this.blockSize){i(this,B),N=0;break}}else for(;M<R;)if(B[N++]=A[M++],N==this.blockSize){i(this,B),N=0;break}}this.h=N,this.o+=R},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var R=1;R<A.length-8;++R)A[R]=0;R=this.o*8;for(var C=A.length-8;C<A.length;++C)A[C]=R&255,R/=256;for(this.v(A),A=Array(16),R=0,C=0;C<4;++C)for(let B=0;B<32;B+=8)A[R++]=this.g[C]>>>B&255;return A};function s(A,R){var C=u;return Object.prototype.hasOwnProperty.call(C,A)?C[A]:C[A]=R(A)}function l(A,R){this.h=R;const C=[];let B=!0;for(let N=A.length-1;N>=0;N--){const M=A[N]|0;B&&M==R||(C[N]=M,B=!1)}this.g=C}var u={};function f(A){return-128<=A&&A<128?s(A,function(R){return new l([R|0],R<0?-1:0)}):new l([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return _;if(A<0)return S(d(-A));const R=[];let C=1;for(let B=0;A>=C;B++)R[B]=A/C|0,C*=4294967296;return new l(R,0)}function m(A,R){if(A.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(A.charAt(0)=="-")return S(m(A.substring(1),R));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=d(Math.pow(R,8));let B=_;for(let M=0;M<A.length;M+=8){var N=Math.min(8,A.length-M);const V=parseInt(A.substring(M,M+N),R);N<8?(N=d(Math.pow(R,N)),B=B.j(N).add(d(V))):(B=B.j(C),B=B.add(d(V)))}return B}var _=f(0),v=f(1),y=f(16777216);r=l.prototype,r.m=function(){if(E(this))return-S(this).m();let A=0,R=1;for(let C=0;C<this.g.length;C++){const B=this.i(C);A+=(B>=0?B:4294967296+B)*R,R*=4294967296}return A},r.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(T(this))return"0";if(E(this))return"-"+S(this).toString(A);const R=d(Math.pow(A,6));var C=this;let B="";for(;;){const N=W(C,R).g;C=D(C,N.j(R));let M=((C.g.length>0?C.g[0]:C.h)>>>0).toString(A);if(C=N,T(C))return M+B;for(;M.length<6;)M="0"+M;B=M+B}},r.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function T(A){if(A.h!=0)return!1;for(let R=0;R<A.g.length;R++)if(A.g[R]!=0)return!1;return!0}function E(A){return A.h==-1}r.l=function(A){return A=D(this,A),E(A)?-1:T(A)?0:1};function S(A){const R=A.g.length,C=[];for(let B=0;B<R;B++)C[B]=~A.g[B];return new l(C,~A.h).add(v)}r.abs=function(){return E(this)?S(this):this},r.add=function(A){const R=Math.max(this.g.length,A.g.length),C=[];let B=0;for(let N=0;N<=R;N++){let M=B+(this.i(N)&65535)+(A.i(N)&65535),V=(M>>>16)+(this.i(N)>>>16)+(A.i(N)>>>16);B=V>>>16,M&=65535,V&=65535,C[N]=V<<16|M}return new l(C,C[C.length-1]&-2147483648?-1:0)};function D(A,R){return A.add(S(R))}r.j=function(A){if(T(this)||T(A))return _;if(E(this))return E(A)?S(this).j(S(A)):S(S(this).j(A));if(E(A))return S(this.j(S(A)));if(this.l(y)<0&&A.l(y)<0)return d(this.m()*A.m());const R=this.g.length+A.g.length,C=[];for(var B=0;B<2*R;B++)C[B]=0;for(B=0;B<this.g.length;B++)for(let N=0;N<A.g.length;N++){const M=this.i(B)>>>16,V=this.i(B)&65535,xe=A.i(N)>>>16,ve=A.i(N)&65535;C[2*B+2*N]+=V*ve,U(C,2*B+2*N),C[2*B+2*N+1]+=M*ve,U(C,2*B+2*N+1),C[2*B+2*N+1]+=V*xe,U(C,2*B+2*N+1),C[2*B+2*N+2]+=M*xe,U(C,2*B+2*N+2)}for(A=0;A<R;A++)C[A]=C[2*A+1]<<16|C[2*A];for(A=R;A<2*R;A++)C[A]=0;return new l(C,0)};function U(A,R){for(;(A[R]&65535)!=A[R];)A[R+1]+=A[R]>>>16,A[R]&=65535,R++}function k(A,R){this.g=A,this.h=R}function W(A,R){if(T(R))throw Error("division by zero");if(T(A))return new k(_,_);if(E(A))return R=W(S(A),R),new k(S(R.g),S(R.h));if(E(R))return R=W(A,S(R)),new k(S(R.g),R.h);if(A.g.length>30){if(E(A)||E(R))throw Error("slowDivide_ only works with positive integers.");for(var C=v,B=R;B.l(A)<=0;)C=ee(C),B=ee(B);var N=X(C,1),M=X(B,1);for(B=X(B,2),C=X(C,2);!T(B);){var V=M.add(B);V.l(A)<=0&&(N=N.add(C),M=V),B=X(B,1),C=X(C,1)}return R=D(A,N.j(R)),new k(N,R)}for(N=_;A.l(R)>=0;){for(C=Math.max(1,Math.floor(A.m()/R.m())),B=Math.ceil(Math.log(C)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),M=d(C),V=M.j(R);E(V)||V.l(A)>0;)C-=B,M=d(C),V=M.j(R);T(M)&&(M=v),N=N.add(M),A=D(A,V)}return new k(N,A)}r.B=function(A){return W(this,A).h},r.and=function(A){const R=Math.max(this.g.length,A.g.length),C=[];for(let B=0;B<R;B++)C[B]=this.i(B)&A.i(B);return new l(C,this.h&A.h)},r.or=function(A){const R=Math.max(this.g.length,A.g.length),C=[];for(let B=0;B<R;B++)C[B]=this.i(B)|A.i(B);return new l(C,this.h|A.h)},r.xor=function(A){const R=Math.max(this.g.length,A.g.length),C=[];for(let B=0;B<R;B++)C[B]=this.i(B)^A.i(B);return new l(C,this.h^A.h)};function ee(A){const R=A.g.length+1,C=[];for(let B=0;B<R;B++)C[B]=A.i(B)<<1|A.i(B-1)>>>31;return new l(C,A.h)}function X(A,R){const C=R>>5;R%=32;const B=A.g.length-C,N=[];for(let M=0;M<B;M++)N[M]=R>0?A.i(M+C)>>>R|A.i(M+C+1)<<32-R:A.i(M+C);return new l(N,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,M4=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=m,qo=l}).apply(typeof NA<"u"?NA:typeof self<"u"?self:typeof window<"u"?window:{});var km=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var L4,Ih,V4,zm,Dx,B4,U4,z4;(function(){var r,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof km=="object"&&km];for(var w=0;w<p.length;++w){var I=p[w];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=t(this);function i(p,w){if(w)e:{var I=n;p=p.split(".");for(var j=0;j<p.length-1;j++){var ue=p[j];if(!(ue in I))break e;I=I[ue]}p=p[p.length-1],j=I[p],w=w(j),w!=j&&w!=null&&e(I,p,{configurable:!0,writable:!0,value:w})}}i("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(p){return p||function(w){var I=[],j;for(j in w)Object.prototype.hasOwnProperty.call(w,j)&&I.push([j,w[j]]);return I}});var s=s||{},l=this||self;function u(p){var w=typeof p;return w=="object"&&p!=null||w=="function"}function f(p,w,I){return p.call.apply(p.bind,arguments)}function d(p,w,I){return d=f,d.apply(null,arguments)}function m(p,w){var I=Array.prototype.slice.call(arguments,1);return function(){var j=I.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function _(p,w){function I(){}I.prototype=w.prototype,p.Z=w.prototype,p.prototype=new I,p.prototype.constructor=p,p.Ob=function(j,ue,ye){for(var je=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)je[_t-2]=arguments[_t];return w.prototype[ue].apply(j,je)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function y(p){const w=p.length;if(w>0){const I=Array(w);for(let j=0;j<w;j++)I[j]=p[j];return I}return[]}function T(p,w){for(let j=1;j<arguments.length;j++){const ue=arguments[j];var I=typeof ue;if(I=I!="object"?I:ue?Array.isArray(ue)?"array":I:"null",I=="array"||I=="object"&&typeof ue.length=="number"){I=p.length||0;const ye=ue.length||0;p.length=I+ye;for(let je=0;je<ye;je++)p[I+je]=ue[je]}else p.push(ue)}}class E{constructor(w,I){this.i=w,this.j=I,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function S(p){l.setTimeout(()=>{throw p},0)}function D(){var p=A;let w=null;return p.g&&(w=p.g,p.g=p.g.next,p.g||(p.h=null),w.next=null),w}class U{constructor(){this.h=this.g=null}add(w,I){const j=k.get();j.set(w,I),this.h?this.h.next=j:this.g=j,this.h=j}}var k=new E(()=>new W,p=>p.reset());class W{constructor(){this.next=this.g=this.h=null}set(w,I){this.h=w,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,X=!1,A=new U,R=()=>{const p=Promise.resolve(void 0);ee=()=>{p.then(C)}};function C(){for(var p;p=D();){try{p.h.call(p.g)}catch(I){S(I)}var w=k;w.j(p),w.h<100&&(w.h++,p.next=w.g,w.g=p)}X=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(p,w){this.type=p,this.g=this.target=w,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,w=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};l.addEventListener("test",I,w),l.removeEventListener("test",I,w)}catch{}return p})();function V(p){return/^[\s\xa0]*$/.test(p)}function xe(p,w){N.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,w)}_(xe,N),xe.prototype.init=function(p,w){const I=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=w,w=p.relatedTarget,w||(I=="mouseover"?w=p.fromElement:I=="mouseout"&&(w=p.toElement)),this.relatedTarget=w,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&xe.Z.h.call(this)},xe.prototype.h=function(){xe.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var ve="closure_listenable_"+(Math.random()*1e6|0),ne=0;function le(p,w,I,j,ue){this.listener=p,this.proxy=null,this.src=w,this.type=I,this.capture=!!j,this.ha=ue,this.key=++ne,this.da=this.fa=!1}function Pe(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ae(p,w,I){for(const j in p)w.call(I,p[j],j,p)}function Me(p,w){for(const I in p)w.call(void 0,p[I],I,p)}function J(p){const w={};for(const I in p)w[I]=p[I];return w}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(p,w){let I,j;for(let ue=1;ue<arguments.length;ue++){j=arguments[ue];for(I in j)p[I]=j[I];for(let ye=0;ye<O.length;ye++)I=O[ye],Object.prototype.hasOwnProperty.call(j,I)&&(p[I]=j[I])}}function q(p){this.src=p,this.g={},this.h=0}q.prototype.add=function(p,w,I,j,ue){const ye=p.toString();p=this.g[ye],p||(p=this.g[ye]=[],this.h++);const je=oe(p,w,j,ue);return je>-1?(w=p[je],I||(w.fa=!1)):(w=new le(w,this.src,ye,!!j,ue),w.fa=I,p.push(w)),w};function te(p,w){const I=w.type;if(I in p.g){var j=p.g[I],ue=Array.prototype.indexOf.call(j,w,void 0),ye;(ye=ue>=0)&&Array.prototype.splice.call(j,ue,1),ye&&(Pe(w),p.g[I].length==0&&(delete p.g[I],p.h--))}}function oe(p,w,I,j){for(let ue=0;ue<p.length;++ue){const ye=p[ue];if(!ye.da&&ye.listener==w&&ye.capture==!!I&&ye.ha==j)return ue}return-1}var Te="closure_lm_"+(Math.random()*1e6|0),ke={};function be(p,w,I,j,ue){if(Array.isArray(w)){for(let ye=0;ye<w.length;ye++)be(p,w[ye],I,j,ue);return null}return I=nt(I),p&&p[ve]?p.J(w,I,u(j)?!!j.capture:!1,ue):De(p,w,I,!1,j,ue)}function De(p,w,I,j,ue,ye){if(!w)throw Error("Invalid event type");const je=u(ue)?!!ue.capture:!!ue;let _t=qe(p);if(_t||(p[Te]=_t=new q(p)),I=_t.add(w,I,j,je,ye),I.proxy)return I;if(j=lt(),I.proxy=j,j.src=p,j.listener=I,p.addEventListener)M||(ue=je),ue===void 0&&(ue=!1),p.addEventListener(w.toString(),j,ue);else if(p.attachEvent)p.attachEvent(ut(w.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return I}function lt(){function p(I){return w.call(p.src,p.listener,I)}const w=It;return p}function Z(p,w,I,j,ue){if(Array.isArray(w))for(var ye=0;ye<w.length;ye++)Z(p,w[ye],I,j,ue);else j=u(j)?!!j.capture:!!j,I=nt(I),p&&p[ve]?(p=p.i,ye=String(w).toString(),ye in p.g&&(w=p.g[ye],I=oe(w,I,j,ue),I>-1&&(Pe(w[I]),Array.prototype.splice.call(w,I,1),w.length==0&&(delete p.g[ye],p.h--)))):p&&(p=qe(p))&&(w=p.g[w.toString()],p=-1,w&&(p=oe(w,I,j,ue)),(I=p>-1?w[p]:null)&&wt(I))}function wt(p){if(typeof p!="number"&&p&&!p.da){var w=p.src;if(w&&w[ve])te(w.i,p);else{var I=p.type,j=p.proxy;w.removeEventListener?w.removeEventListener(I,j,p.capture):w.detachEvent?w.detachEvent(ut(I),j):w.addListener&&w.removeListener&&w.removeListener(j),(I=qe(w))?(te(I,p),I.h==0&&(I.src=null,w[Te]=null)):Pe(p)}}}function ut(p){return p in ke?ke[p]:ke[p]="on"+p}function It(p,w){if(p.da)p=!0;else{w=new xe(w,this);const I=p.listener,j=p.ha||p.src;p.fa&&wt(p),p=I.call(j,w)}return p}function qe(p){return p=p[Te],p instanceof q?p:null}var Oe="__closure_events_fn_"+(Math.random()*1e9>>>0);function nt(p){return typeof p=="function"?p:(p[Oe]||(p[Oe]=function(w){return p.handleEvent(w)}),p[Oe])}function gt(){B.call(this),this.i=new q(this),this.M=this,this.G=null}_(gt,B),gt.prototype[ve]=!0,gt.prototype.removeEventListener=function(p,w,I,j){Z(this,p,w,I,j)};function Lt(p,w){var I,j=p.G;if(j)for(I=[];j;j=j.G)I.push(j);if(p=p.M,j=w.type||w,typeof w=="string")w=new N(w,p);else if(w instanceof N)w.target=w.target||p;else{var ue=w;w=new N(j,p),Q(w,ue)}ue=!0;let ye,je;if(I)for(je=I.length-1;je>=0;je--)ye=w.g=I[je],ue=Gr(ye,j,!0,w)&&ue;if(ye=w.g=p,ue=Gr(ye,j,!0,w)&&ue,ue=Gr(ye,j,!1,w)&&ue,I)for(je=0;je<I.length;je++)ye=w.g=I[je],ue=Gr(ye,j,!1,w)&&ue}gt.prototype.N=function(){if(gt.Z.N.call(this),this.i){var p=this.i;for(const w in p.g){const I=p.g[w];for(let j=0;j<I.length;j++)Pe(I[j]);delete p.g[w],p.h--}}this.G=null},gt.prototype.J=function(p,w,I,j){return this.i.add(String(p),w,!1,I,j)},gt.prototype.K=function(p,w,I,j){return this.i.add(String(p),w,!0,I,j)};function Gr(p,w,I,j){if(w=p.i.g[String(w)],!w)return!0;w=w.concat();let ue=!0;for(let ye=0;ye<w.length;++ye){const je=w[ye];if(je&&!je.da&&je.capture==I){const _t=je.listener,Br=je.ha||je.src;je.fa&&te(p.i,je),ue=_t.call(Br,j)!==!1&&ue}}return ue&&!j.defaultPrevented}function fa(p,w){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=d(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:l.setTimeout(p,w||0)}function Yn(p){p.g=fa(()=>{p.g=null,p.i&&(p.i=!1,Yn(p))},p.l);const w=p.h;p.h=null,p.m.apply(null,w)}class qt extends B{constructor(w,I){super(),this.m=w,this.l=I,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Yn(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function sn(p){B.call(this),this.h=p,this.g={}}_(sn,B);var Nn=[];function gi(p){ae(p.g,function(w,I){this.g.hasOwnProperty(I)&&wt(w)},p),p.g={}}sn.prototype.N=function(){sn.Z.N.call(this),gi(this)},sn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var et=l.JSON.stringify,yt=l.JSON.parse,rt=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function Kt(){}function Ir(){}var kt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Vt(){N.call(this,"d")}_(Vt,N);function on(){N.call(this,"c")}_(on,N);var $t={},Fa=null;function ai(){return Fa=Fa||new gt}$t.Ia="serverreachability";function ha(p){N.call(this,$t.Ia,p)}_(ha,N);function Er(p){const w=ai();Lt(w,new ha(w))}$t.STAT_EVENT="statevent";function qr(p,w){N.call(this,$t.STAT_EVENT,p),this.stat=w}_(qr,N);function Tr(p){const w=ai();Lt(w,new qr(w,p))}$t.Ja="timingevent";function $n(p,w){N.call(this,$t.Ja,p),this.size=w}_($n,N);function Bi(p,w){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},w)}function _i(){this.g=!0}_i.prototype.ua=function(){this.g=!1};function xf(p,w,I,j,ue,ye){p.info(function(){if(p.g)if(ye){var je="",_t=ye.split("&");for(let Wt=0;Wt<_t.length;Wt++){var Br=_t[Wt].split("=");if(Br.length>1){const wr=Br[0];Br=Br[1];const Hi=wr.split("_");je=Hi.length>=2&&Hi[1]=="type"?je+(wr+"="+Br+"&"):je+(wr+"=redacted&")}}}else je=null;else je=ye;return"XMLHTTP REQ ("+j+") [attempt "+ue+"]: "+w+`
`+I+`
`+je})}function Dc(p,w,I,j,ue,ye,je){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ue+"]: "+w+`
`+I+`
`+ye+" "+je})}function Ui(p,w,I,j){p.info(function(){return"XMLHTTP TEXT ("+w+"): "+vf(p,I)+(j?" "+j:"")})}function ls(p,w){p.info(function(){return"TIMEOUT: "+w})}_i.prototype.info=function(){};function vf(p,w){if(!p.g)return w;if(!w)return null;try{const ye=JSON.parse(w);if(ye){for(p=0;p<ye.length;p++)if(Array.isArray(ye[p])){var I=ye[p];if(!(I.length<2)){var j=I[1];if(Array.isArray(j)&&!(j.length<1)){var ue=j[0];if(ue!="noop"&&ue!="stop"&&ue!="close")for(let je=1;je<j.length;je++)j[je]=""}}}}return et(ye)}catch{return w}}var cs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},us={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},cl;function fs(){}_(fs,Kt),fs.prototype.g=function(){return new XMLHttpRequest},cl=new fs;function da(p){return encodeURIComponent(String(p))}function F(p){var w=1;p=p.split(":");const I=[];for(;w>0&&p.length;)I.push(p.shift()),w--;return p.length&&I.push(p.join(":")),I}function K(p,w,I,j){this.j=p,this.i=w,this.l=I,this.S=j||1,this.V=new sn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new z}function z(){this.i=null,this.g="",this.h=!1}var H={},G={};function Y(p,w,I){p.M=1,p.A=ul(Kr(w)),p.u=I,p.R=!0,he(p,null)}function he(p,w){p.F=Date.now(),pe(p),p.B=Kr(p.A);var I=p.B,j=p.S;Array.isArray(j)||(j=[String(j)]),Oc(I.i,"t",j),p.C=0,I=p.j.L,p.h=new z,p.g=ud(p.j,I?w:null,!p.u),p.P>0&&(p.O=new qt(d(p.Y,p,p.g),p.P)),w=p.V,I=p.g,j=p.ba;var ue="readystatechange";Array.isArray(ue)||(ue&&(Nn[0]=ue.toString()),ue=Nn);for(let ye=0;ye<ue.length;ye++){const je=be(I,ue[ye],j||w.handleEvent,!1,w.h||w);if(!je)break;w.g[je.key]=je}w=p.J?J(p.J):{},p.u?(p.v||(p.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,w)):(p.v="GET",p.g.ea(p.B,p.v,null,w)),Er(),xf(p.i,p.v,p.B,p.l,p.S,p.u)}K.prototype.ba=function(p){p=p.target;const w=this.O;w&&xa(p)==3?w.j():this.Y(p)},K.prototype.Y=function(p){try{if(p==this.g)e:{const _t=xa(this.g),Br=this.g.ya(),Wt=this.g.ca();if(!(_t<3)&&(_t!=3||this.g&&(this.h.h||this.g.la()||Tn(this.g)))){this.K||_t!=4||Br==7||(Br==8||Wt<=0?Er(3):Er(2)),Be(this);var w=this.g.ca();this.X=w;var I=Se(this);if(this.o=w==200,Dc(this.i,this.v,this.B,this.l,this.S,_t,w),this.o){if(this.U&&!this.L){t:{if(this.g){var j,ue=this.g;if((j=ue.g?ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(j)){var ye=j;break t}}ye=null}if(p=ye)Ui(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,He(this,p);else{this.o=!1,this.m=3,Tr(12),Fe(this),Ge(this);break e}}if(this.R){p=!0;let wr;for(;!this.K&&this.C<I.length;)if(wr=ge(this,I),wr==G){_t==4&&(this.m=4,Tr(14),p=!1),Ui(this.i,this.l,null,"[Incomplete Response]");break}else if(wr==H){this.m=4,Tr(15),Ui(this.i,this.l,I,"[Invalid Chunk]"),p=!1;break}else Ui(this.i,this.l,wr,null),He(this,wr);if(de(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_t!=4||I.length!=0||this.h.h||(this.m=1,Tr(16),p=!1),this.o=this.o&&p,!p)Ui(this.i,this.l,I,"[Invalid Chunked Response]"),Fe(this),Ge(this);else if(I.length>0&&!this.W){this.W=!0;var je=this.j;je.g==this&&je.aa&&!je.P&&(je.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),Cf(je),je.P=!0,Tr(11))}}else Ui(this.i,this.l,I,null),He(this,I);_t==4&&Fe(this),this.o&&!this.K&&(_t==4?sd(this.j,this):(this.o=!1,pe(this)))}else ds(this.g),w==400&&I.indexOf("Unknown SID")>0?(this.m=3,Tr(12)):(this.m=0,Tr(13)),Fe(this),Ge(this)}}}catch{}finally{}};function Se(p){if(!de(p))return p.g.la();const w=Tn(p.g);if(w==="")return"";let I="";const j=w.length,ue=xa(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Fe(p),Ge(p),"";p.h.i=new l.TextDecoder}for(let ye=0;ye<j;ye++)p.h.h=!0,I+=p.h.i.decode(w[ye],{stream:!(ue&&ye==j-1)});return w.length=0,p.h.g+=I,p.C=0,p.h.g}function de(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function ge(p,w){var I=p.C,j=w.indexOf(`
`,I);return j==-1?G:(I=Number(w.substring(I,j)),isNaN(I)?H:(j+=1,j+I>w.length?G:(w=w.slice(j,j+I),p.C=j+I,w)))}K.prototype.cancel=function(){this.K=!0,Fe(this)};function pe(p){p.T=Date.now()+p.H,Le(p,p.H)}function Le(p,w){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Bi(d(p.aa,p),w)}function Be(p){p.D&&(l.clearTimeout(p.D),p.D=null)}K.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(ls(this.i,this.B),this.M!=2&&(Er(),Tr(17)),Fe(this),this.m=2,Ge(this)):Le(this,this.T-p)};function Ge(p){p.j.I==0||p.K||sd(p.j,p)}function Fe(p){Be(p);var w=p.O;w&&typeof w.dispose=="function"&&w.dispose(),p.O=null,gi(p.V),p.g&&(w=p.g,p.g=null,w.abort(),w.dispose())}function He(p,w){try{var I=p.j;if(I.I!=0&&(I.g==p||On(I.h,p))){if(!p.L&&On(I.h,p)&&I.I==3){try{var j=I.Ba.g.parse(w)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ue=j;if(ue[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<p.F)Vc(I),ro(I);else break e;_l(I),Tr(18)}}else I.xa=ue[1],0<I.xa-I.K&&ue[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Bi(d(I.Va,I),6e3));dr(I.h)<=1&&I.ta&&(I.ta=void 0)}else Ua(I,11)}else if((p.L||I.g==p)&&Vc(I),!V(w))for(ue=I.Ba.g.parse(w),w=0;w<ue.length;w++){let Wt=ue[w];const wr=Wt[0];if(!(wr<=I.K))if(I.K=wr,Wt=Wt[1],I.I==2)if(Wt[0]=="c"){I.M=Wt[1],I.ba=Wt[2];const Hi=Wt[3];Hi!=null&&(I.ka=Hi,I.j.info("VER="+I.ka));const za=Wt[4];za!=null&&(I.za=za,I.j.info("SVER="+I.za));const va=Wt[5];va!=null&&typeof va=="number"&&va>0&&(j=1.5*va,I.O=j,I.j.info("backChannelRequestTimeoutMs_="+j)),j=I;const ya=p.g;if(ya){const xl=ya.g?ya.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xl){var ye=j.h;ye.g||xl.indexOf("spdy")==-1&&xl.indexOf("quic")==-1&&xl.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(ma(ye,ye.h),ye.h=null))}if(j.G){const Bc=ya.g?ya.g.getResponseHeader("X-HTTP-Session-Id"):null;Bc&&(j.wa=Bc,Zt(j.J,j.G,Bc))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-p.F,I.j.info("Handshake RTT: "+I.T+"ms")),j=I;var je=p;if(j.na=cd(j,j.L?j.ba:null,j.W),je.L){pa(j.h,je);var _t=je,Br=j.O;Br&&(_t.H=Br),_t.D&&(Be(_t),pe(_t)),j.g=je}else id(j);I.i.length>0&&Ba(I)}else Wt[0]!="stop"&&Wt[0]!="close"||Ua(I,7);else I.I==3&&(Wt[0]=="stop"||Wt[0]=="close"?Wt[0]=="stop"?Ua(I,7):If(I):Wt[0]!="noop"&&I.l&&I.l.qa(Wt),I.A=0)}}Er(4)}catch{}}var Qe=class{constructor(p,w){this.g=p,this.map=w}};function Qt(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Jt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function dr(p){return p.h?1:p.g?p.g.size:0}function On(p,w){return p.h?p.h==w:p.g?p.g.has(w):!1}function ma(p,w){p.g?p.g.add(w):p.h=w}function pa(p,w){p.h&&p.h==w?p.h=null:p.g&&p.g.has(w)&&p.g.delete(w)}Qt.prototype.cancel=function(){if(this.i=xi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function xi(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let w=p.i;for(const I of p.g.values())w=w.concat(I.G);return w}return y(p.i)}var Xs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fn(p,w){if(p){p=p.split("&");for(let I=0;I<p.length;I++){const j=p[I].indexOf("=");let ue,ye=null;j>=0?(ue=p[I].substring(0,j),ye=p[I].substring(j+1)):ue=p[I],w(ue,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function vi(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;p instanceof vi?(this.l=p.l,dn(this,p.j),this.o=p.o,this.g=p.g,Ys(this,p.u),this.h=p.h,yf(this,rd(p.i)),this.m=p.m):p&&(w=String(p).match(Xs))?(this.l=!1,dn(this,w[1]||"",!0),this.o=Pa(w[2]||""),this.g=Pa(w[3]||"",!0),Ys(this,w[4]),this.h=Pa(w[5]||"",!0),yf(this,w[6]||"",!0),this.m=Pa(w[7]||"")):(this.l=!1,this.i=new Qs(null,this.l))}vi.prototype.toString=function(){const p=[];var w=this.j;w&&p.push(fl(w,Nc,!0),":");var I=this.g;return(I||w=="file")&&(p.push("//"),(w=this.o)&&p.push(fl(w,Nc,!0),"@"),p.push(da(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&p.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(fl(I,I.charAt(0)=="/"?Ef:Z0,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",fl(I,ed)),p.join("")},vi.prototype.resolve=function(p){const w=Kr(this);let I=!!p.j;I?dn(w,p.j):I=!!p.o,I?w.o=p.o:I=!!p.g,I?w.g=p.g:I=p.u!=null;var j=p.h;if(I)Ys(w,p.u);else if(I=!!p.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var ue=w.h.lastIndexOf("/");ue!=-1&&(j=w.h.slice(0,ue+1)+j)}if(ue=j,ue==".."||ue==".")j="";else if(ue.indexOf("./")!=-1||ue.indexOf("/.")!=-1){j=ue.lastIndexOf("/",0)==0,ue=ue.split("/");const ye=[];for(let je=0;je<ue.length;){const _t=ue[je++];_t=="."?j&&je==ue.length&&ye.push(""):_t==".."?((ye.length>1||ye.length==1&&ye[0]!="")&&ye.pop(),j&&je==ue.length&&ye.push("")):(ye.push(_t),j=!0)}j=ye.join("/")}else j=ue}return I?w.h=j:I=p.i.toString()!=="",I?yf(w,rd(p.i)):I=!!p.m,I&&(w.m=p.m),w};function Kr(p){return new vi(p)}function dn(p,w,I){p.j=I?Pa(w,!0):w,p.j&&(p.j=p.j.replace(/:$/,""))}function Ys(p,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);p.u=w}else p.u=null}function yf(p,w,I){w instanceof Qs?(p.i=w,Fc(p.i,p.l)):(I||(w=fl(w,$s)),p.i=new Qs(w,p.l))}function Zt(p,w,I){p.i.set(w,I)}function ul(p){return Zt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Pa(p,w){return p?w?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function fl(p,w,I){return typeof p=="string"?(p=encodeURI(p).replace(w,si),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function si(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Nc=/[#\/\?@]/g,Z0=/[#\?:]/g,Ef=/[#\?]/g,$s=/[#\?@]/g,ed=/#/g;function Qs(p,w){this.h=this.g=null,this.i=p||null,this.j=!!w}function oi(p){p.g||(p.g=new Map,p.h=0,p.i&&Fn(p.i,function(w,I){p.add(decodeURIComponent(w.replace(/\+/g," ")),I)}))}r=Qs.prototype,r.add=function(p,w){oi(this),this.i=null,p=Js(this,p);let I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(w),this.h+=1,this};function td(p,w){oi(p),w=Js(p,w),p.g.has(w)&&(p.i=null,p.h-=p.g.get(w).length,p.g.delete(w))}function Tf(p,w){return oi(p),w=Js(p,w),p.g.has(w)}r.forEach=function(p,w){oi(this),this.g.forEach(function(I,j){I.forEach(function(ue){p.call(w,ue,j,this)},this)},this)};function wf(p,w){oi(p);let I=[];if(typeof w=="string")Tf(p,w)&&(I=I.concat(p.g.get(Js(p,w))));else for(p=Array.from(p.g.values()),w=0;w<p.length;w++)I=I.concat(p[w]);return I}r.set=function(p,w){return oi(this),this.i=null,p=Js(this,p),Tf(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[w]),this.h+=1,this},r.get=function(p,w){return p?(p=wf(this,p),p.length>0?String(p[0]):w):w};function Oc(p,w,I){td(p,w),I.length>0&&(p.i=null,p.g.set(Js(p,w),y(I)),p.h+=I.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],w=Array.from(this.g.keys());for(let j=0;j<w.length;j++){var I=w[j];const ue=da(I);I=wf(this,I);for(let ye=0;ye<I.length;ye++){let je=ue;I[ye]!==""&&(je+="="+da(I[ye])),p.push(je)}}return this.i=p.join("&")};function rd(p){const w=new Qs;return w.i=p.i,p.g&&(w.g=new Map(p.g),w.h=p.h),w}function Js(p,w){return w=String(w),p.j&&(w=w.toLowerCase()),w}function Fc(p,w){w&&!p.j&&(oi(p),p.i=null,p.g.forEach(function(I,j){const ue=j.toLowerCase();j!=ue&&(td(this,j),Oc(this,ue,I))},p)),p.j=w}function ga(p,w){const I=new _i;if(l.Image){const j=new Image;j.onload=m(zi,I,"TestLoadImage: loaded",!0,w,j),j.onerror=m(zi,I,"TestLoadImage: error",!1,w,j),j.onabort=m(zi,I,"TestLoadImage: abort",!1,w,j),j.ontimeout=m(zi,I,"TestLoadImage: timeout",!1,w,j),l.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else w(!1)}function Sf(p,w){const I=new _i,j=new AbortController,ue=setTimeout(()=>{j.abort(),zi(I,"TestPingServer: timeout",!1,w)},1e4);fetch(p,{signal:j.signal}).then(ye=>{clearTimeout(ue),ye.ok?zi(I,"TestPingServer: ok",!0,w):zi(I,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(ue),zi(I,"TestPingServer: error",!1,w)})}function zi(p,w,I,j,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),j(I)}catch{}}function Zs(){this.g=new rt}function Ma(p){this.i=p.Sb||null,this.h=p.ab||!1}_(Ma,Kt),Ma.prototype.g=function(){return new hl(this.i,this.h)};function hl(p,w){gt.call(this),this.H=p,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(hl,gt),r=hl.prototype,r.open=function(p,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=w,this.readyState=1,_a(this)},r.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(w.body=p),(this.H||l).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,eo(this)),this.readyState=0},r.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,_a(this)),this.g&&(this.readyState=3,_a(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Pc(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Pc(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}r.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var w=p.value?p.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!p.done}))&&(this.response=this.responseText+=w)}p.done?eo(this):_a(this),this.readyState==3&&Pc(this)}},r.Oa=function(p){this.g&&(this.response=this.responseText=p,eo(this))},r.Na=function(p){this.g&&(this.response=p,eo(this))},r.ga=function(){this.g&&eo(this)};function eo(p){p.readyState=4,p.l=null,p.j=null,p.B=null,_a(p)}r.setRequestHeader=function(p,w){this.A.append(p,w)},r.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],w=this.h.entries();for(var I=w.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=w.next();return p.join(`\r
`)};function _a(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function ji(p){let w="";return ae(p,function(I,j){w+=j,w+=":",w+=I,w+=`\r
`}),w}function dl(p,w,I){e:{for(j in I){var j=!1;break e}j=!0}j||(I=ji(I),typeof p=="string"?I!=null&&da(I):Zt(p,w,I))}function or(p){gt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(or,gt);var La=/^https?$/i,Af=["POST","PUT"];r=or.prototype,r.Fa=function(p){this.H=p},r.ea=function(p,w,I,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);w=w?w.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():cl.g(),this.g.onreadystatechange=v(d(this.Ca,this));try{this.B=!0,this.g.open(w,String(p),!0),this.B=!1}catch(ye){ml(this,ye);return}if(p=I||"",I=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ue in j)I.set(ue,j[ue]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ye of j.keys())I.set(ye,j.get(ye));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(I.keys()).find(ye=>ye.toLowerCase()=="content-type"),ue=l.FormData&&p instanceof l.FormData,!(Array.prototype.indexOf.call(Af,w,void 0)>=0)||j||ue||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,je]of I)this.g.setRequestHeader(ye,je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ye){ml(this,ye)}};function ml(p,w){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=w,p.o=5,bf(p),hs(p)}function bf(p){p.A||(p.A=!0,Lt(p,"complete"),Lt(p,"error"))}r.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Lt(this,"complete"),Lt(this,"abort"),hs(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hs(this,!0)),or.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?pl(this):this.Xa())},r.Xa=function(){pl(this)};function pl(p){if(p.h&&typeof s<"u"){if(p.v&&xa(p)==4)setTimeout(p.Ca.bind(p),0);else if(Lt(p,"readystatechange"),xa(p)==4){p.h=!1;try{const ye=p.ca();e:switch(ye){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var I;if(!(I=w)){var j;if(j=ye===0){let je=String(p.D).match(Xs)[1]||null;!je&&l.self&&l.self.location&&(je=l.self.location.protocol.slice(0,-1)),j=!La.test(je?je.toLowerCase():"")}I=j}if(I)Lt(p,"complete"),Lt(p,"success");else{p.o=6;try{var ue=xa(p)>2?p.g.statusText:""}catch{ue=""}p.l=ue+" ["+p.ca()+"]",bf(p)}}finally{hs(p)}}}}function hs(p,w){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const I=p.g;p.g=null,w||Lt(p,"ready");try{I.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function xa(p){return p.g?p.g.readyState:0}r.ca=function(){try{return xa(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(p){if(this.g){var w=this.g.responseText;return p&&w.indexOf(p)==0&&(w=w.substring(p.length)),yt(w)}};function Tn(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ds(p){const w={};p=(p.g&&xa(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(V(p[j]))continue;var I=F(p[j]);const ue=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const ye=w[ue]||[];w[ue]=ye,ye.push(I)}Me(w,function(j){return j.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Va(p,w,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||w}function to(p){this.za=0,this.i=[],this.j=new _i,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Va("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Va("baseRetryDelayMs",5e3,p),this.Za=Va("retryDelaySeedMs",1e4,p),this.Ta=Va("forwardChannelMaxRetries",2,p),this.va=Va("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Qt(p&&p.concurrentRequestLimit),this.Ba=new Zs,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=to.prototype,r.ka=8,r.I=1,r.connect=function(p,w,I,j){Tr(0),this.W=p,this.H=w||{},I&&j!==void 0&&(this.H.OSID=I,this.H.OAID=j),this.F=this.X,this.J=cd(this,null,this.W),Ba(this)};function If(p){if(Mc(p),p.I==3){var w=p.V++,I=Kr(p.J);if(Zt(I,"SID",p.M),Zt(I,"RID",w),Zt(I,"TYPE","terminate"),gl(p,I),w=new K(p,p.j,w),w.M=2,w.A=ul(Kr(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(w.A.toString(),"")}catch{}!I&&l.Image&&(new Image().src=w.A,I=!0),I||(w.g=ud(w.j,null),w.g.ea(w.A)),w.F=Date.now(),pe(w)}ld(p)}function ro(p){p.g&&(Cf(p),p.g.cancel(),p.g=null)}function Mc(p){ro(p),p.v&&(l.clearTimeout(p.v),p.v=null),Vc(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&l.clearTimeout(p.m),p.m=null)}function Ba(p){if(!Jt(p.h)&&!p.m){p.m=!0;var w=p.Ea;ee||R(),X||(ee(),X=!0),A.add(w,p),p.D=0}}function Lc(p,w){return dr(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=w.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Bi(d(p.Ea,p,w),od(p,p.D)),p.D++,!0)}r.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ue=new K(this,this.j,p);let ye=this.o;if(this.U&&(ye?(ye=J(ye),Q(ye,this.U)):ye=this.U),this.u!==null||this.R||(ue.J=ye,ye=null),this.S)e:{for(var w=0,I=0;I<this.i.length;I++){t:{var j=this.i[I];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(w+=j,w>4096){w=I;break e}if(w===4096||I===this.i.length-1){w=I+1;break e}}w=1e3}else w=1e3;w=nd(this,ue,w),I=Kr(this.J),Zt(I,"RID",p),Zt(I,"CVER",22),this.G&&Zt(I,"X-HTTP-Session-Id",this.G),gl(this,I),ye&&(this.R?w="headers="+da(ji(ye))+"&"+w:this.u&&dl(I,this.u,ye)),ma(this.h,ue),this.Ra&&Zt(I,"TYPE","init"),this.S?(Zt(I,"$req",w),Zt(I,"SID","null"),ue.U=!0,Y(ue,I,null)):Y(ue,I,w),this.I=2}}else this.I==3&&(p?kf(this,p):this.i.length==0||Jt(this.h)||kf(this))};function kf(p,w){var I;w?I=w.l:I=p.V++;const j=Kr(p.J);Zt(j,"SID",p.M),Zt(j,"RID",I),Zt(j,"AID",p.K),gl(p,j),p.u&&p.o&&dl(j,p.u,p.o),I=new K(p,p.j,I,p.D+1),p.u===null&&(I.J=p.o),w&&(p.i=w.G.concat(p.i)),w=nd(p,I,1e3),I.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ma(p.h,I),Y(I,j,w)}function gl(p,w){p.H&&ae(p.H,function(I,j){Zt(w,j,I)}),p.l&&ae({},function(I,j){Zt(w,j,I)})}function nd(p,w,I){I=Math.min(p.i.length,I);const j=p.l?d(p.l.Ka,p.l,p):null;e:{var ue=p.i;let _t=-1;for(;;){const Br=["count="+I];_t==-1?I>0?(_t=ue[0].g,Br.push("ofs="+_t)):_t=0:Br.push("ofs="+_t);let Wt=!0;for(let wr=0;wr<I;wr++){var ye=ue[wr].g;const Hi=ue[wr].map;if(ye-=_t,ye<0)_t=Math.max(0,ue[wr].g-100),Wt=!1;else try{ye="req"+ye+"_"||"";try{var je=Hi instanceof Map?Hi:Object.entries(Hi);for(const[za,va]of je){let ya=va;u(va)&&(ya=et(va)),Br.push(ye+za+"="+encodeURIComponent(ya))}}catch(za){throw Br.push(ye+"type="+encodeURIComponent("_badmap")),za}}catch{j&&j(Hi)}}if(Wt){je=Br.join("&");break e}}je=void 0}return p=p.i.splice(0,I),w.G=p,je}function id(p){if(!p.g&&!p.v){p.Y=1;var w=p.Da;ee||R(),X||(ee(),X=!0),A.add(w,p),p.A=0}}function _l(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Bi(d(p.Da,p),od(p,p.A)),p.A++,!0)}r.Da=function(){if(this.v=null,ad(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Bi(d(this.Wa,this),p)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Tr(10),ro(this),ad(this))};function Cf(p){p.B!=null&&(l.clearTimeout(p.B),p.B=null)}function ad(p){p.g=new K(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var w=Kr(p.na);Zt(w,"RID","rpc"),Zt(w,"SID",p.M),Zt(w,"AID",p.K),Zt(w,"CI",p.F?"0":"1"),!p.F&&p.ia&&Zt(w,"TO",p.ia),Zt(w,"TYPE","xmlhttp"),gl(p,w),p.u&&p.o&&dl(w,p.u,p.o),p.O&&(p.g.H=p.O);var I=p.g;p=p.ba,I.M=1,I.A=ul(Kr(w)),I.u=null,I.R=!0,he(I,p)}r.Va=function(){this.C!=null&&(this.C=null,ro(this),_l(this),Tr(19))};function Vc(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function sd(p,w){var I=null;if(p.g==w){Vc(p),Cf(p),p.g=null;var j=2}else if(On(p.h,w))I=w.G,pa(p.h,w),j=1;else return;if(p.I!=0){if(w.o)if(j==1){I=w.u?w.u.length:0,w=Date.now()-w.F;var ue=p.D;j=ai(),Lt(j,new $n(j,I)),Ba(p)}else id(p);else if(ue=w.m,ue==3||ue==0&&w.X>0||!(j==1&&Lc(p,w)||j==2&&_l(p)))switch(I&&I.length>0&&(w=p.h,w.i=w.i.concat(I)),ue){case 1:Ua(p,5);break;case 4:Ua(p,10);break;case 3:Ua(p,6);break;default:Ua(p,2)}}}function od(p,w){let I=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(I*=2),I*w}function Ua(p,w){if(p.j.info("Error code "+w),w==2){var I=d(p.bb,p),j=p.Ua;const ue=!j;j=new vi(j||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||dn(j,"https"),ul(j),ue?ga(j.toString(),I):Sf(j.toString(),I)}else Tr(2);p.I=0,p.l&&p.l.pa(w),ld(p),Mc(p)}r.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Tr(2)):(this.j.info("Failed to ping google.com"),Tr(1))};function ld(p){if(p.I=0,p.ja=[],p.l){const w=xi(p.h);(w.length!=0||p.i.length!=0)&&(T(p.ja,w),T(p.ja,p.i),p.h.i.length=0,y(p.i),p.i.length=0),p.l.oa()}}function cd(p,w,I){var j=I instanceof vi?Kr(I):new vi(I);if(j.g!="")w&&(j.g=w+"."+j.g),Ys(j,j.u);else{var ue=l.location;j=ue.protocol,w=w?w+"."+ue.hostname:ue.hostname,ue=+ue.port;const ye=new vi(null);j&&dn(ye,j),w&&(ye.g=w),ue&&Ys(ye,ue),I&&(ye.h=I),j=ye}return I=p.G,w=p.wa,I&&w&&Zt(j,I,w),Zt(j,"VER",p.ka),gl(p,j),j}function ud(p,w,I){if(w&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=p.Aa&&!p.ma?new or(new Ma({ab:I})):new or(p.ma),w.Fa(p.L),w}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function fd(){}r=fd.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function no(){}no.prototype.g=function(p,w){return new Qn(p,w)};function Qn(p,w){gt.call(this),this.g=new to(w),this.l=p,this.h=w&&w.messageUrlParams||null,p=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(p?p["X-WebChannel-Content-Type"]=w.messageContentType:p={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(p?p["X-WebChannel-Client-Profile"]=w.sa:p={"X-WebChannel-Client-Profile":w.sa}),this.g.U=p,(p=w&&w.Qb)&&!V(p)&&(this.g.u=p),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!V(w)&&(this.g.G=w,p=this.h,p!==null&&w in p&&(p=this.h,w in p&&delete p[w])),this.j=new ms(this)}_(Qn,gt),Qn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qn.prototype.close=function(){If(this.g)},Qn.prototype.o=function(p){var w=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.v&&(I={},I.__data__=et(p),p=I);w.i.push(new Qe(w.Ya++,p)),w.I==3&&Ba(w)},Qn.prototype.N=function(){this.g.l=null,delete this.j,If(this.g),delete this.g,Qn.Z.N.call(this)};function hd(p){Vt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var w=p.__sm__;if(w){e:{for(const I in w){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,w=w!==null&&p in w?w[p]:void 0),this.data=w}else this.data=p}_(hd,Vt);function dd(){on.call(this),this.status=1}_(dd,on);function ms(p){this.g=p}_(ms,fd),ms.prototype.ra=function(){Lt(this.g,"a")},ms.prototype.qa=function(p){Lt(this.g,new hd(p))},ms.prototype.pa=function(p){Lt(this.g,new dd)},ms.prototype.oa=function(){Lt(this.g,"b")},no.prototype.createWebChannel=no.prototype.g,Qn.prototype.send=Qn.prototype.o,Qn.prototype.open=Qn.prototype.m,Qn.prototype.close=Qn.prototype.close,z4=function(){return new no},U4=function(){return ai()},B4=$t,Dx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},cs.NO_ERROR=0,cs.TIMEOUT=8,cs.HTTP_ERROR=6,zm=cs,us.COMPLETE="complete",V4=us,Ir.EventType=kt,kt.OPEN="a",kt.CLOSE="b",kt.ERROR="c",kt.MESSAGE="d",gt.prototype.listen=gt.prototype.J,Ih=Ir,or.prototype.listenOnce=or.prototype.K,or.prototype.getLastError=or.prototype.Ha,or.prototype.getLastErrorCode=or.prototype.ya,or.prototype.getStatus=or.prototype.ca,or.prototype.getResponseJson=or.prototype.La,or.prototype.getResponseText=or.prototype.la,or.prototype.send=or.prototype.ea,or.prototype.setWithCredentials=or.prototype.Fa,L4=or}).apply(typeof km<"u"?km:typeof self<"u"?self:typeof window<"u"?window:{});const OA="@firebase/firestore",FA="4.9.2";class kn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}kn.UNAUTHENTICATED=new kn(null),kn.GOOGLE_CREDENTIALS=new kn("google-credentials-uid"),kn.FIRST_PARTY=new kn("first-party-uid"),kn.MOCK_USER=new kn("mock-user");let pf="12.3.0";const hc=new Jp("@firebase/firestore");function Au(){return hc.logLevel}function Ve(r,...e){if(hc.logLevel<=Ot.DEBUG){const t=e.map(py);hc.debug(`Firestore (${pf}): ${r}`,...t)}}function ti(r,...e){if(hc.logLevel<=Ot.ERROR){const t=e.map(py);hc.error(`Firestore (${pf}): ${r}`,...t)}}function dc(r,...e){if(hc.logLevel<=Ot.WARN){const t=e.map(py);hc.warn(`Firestore (${pf}): ${r}`,...t)}}function py(r){if(typeof r=="string")return r;try{return(function(t){return JSON.stringify(t)})(r)}catch{return r}}function Je(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,j4(r,n,t)}function j4(r,e,t){let n=`FIRESTORE (${pf}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw ti(n),new Error(n)}function tt(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||j4(e,i,n)}function mt(r,e){return r}const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xe extends Na{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ms{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class H4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vq{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(kn.UNAUTHENTICATED)))}shutdown(){}}class yq{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Eq{constructor(e){this.t=e,this.currentUser=kn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){tt(this.o===void 0,42304);let n=this.i;const i=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let s=new Ms;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ms,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const f=s;e.enqueueRetryable((async()=>{await f.promise,await i(this.currentUser)}))},u=f=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ms)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(tt(typeof n.accessToken=="string",31837,{l:n}),new H4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return tt(e===null||typeof e=="string",2055,{h:e}),new kn(e)}}class Tq{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=kn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class wq{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Tq(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(kn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class PA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Sq{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ba(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){tt(this.o===void 0,3512);const n=s=>{s.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const l=s.token!==this.m;return this.m=s.token,Ve("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>n(s)))};const i=s=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new PA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(tt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new PA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Aq(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class gy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=Aq(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function dt(r,e){return r<e?-1:r>e?1:0}function Nx(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const i=r.charAt(n),s=e.charAt(n);if(i!==s)return ex(i)===ex(s)?dt(i,s):ex(i)?1:-1}return dt(r.length,e.length)}const bq=55296,Iq=57343;function ex(r){const e=r.charCodeAt(0);return e>=bq&&e<=Iq}function Xu(r,e,t){return r.length===e.length&&r.every(((n,i)=>t(n,e[i])))}function G4(r){return r+"\0"}const MA="__name__";class Ya{constructor(e,t,n){t===void 0?t=0:t>e.length&&Je(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Je(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Ya.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ya?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=Ya.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return dt(e.length,t.length)}static compareSegments(e,t){const n=Ya.isNumericId(e),i=Ya.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Ya.extractNumericId(e).compare(Ya.extractNumericId(t)):Nx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return qo.fromString(e.substring(4,e.length-2))}}class Yt extends Ya{construct(e,t,n){return new Yt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Xe(Ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((i=>i.length>0)))}return new Yt(t)}static emptyPath(){return new Yt([])}}const kq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kr extends Ya{construct(e,t,n){return new kr(e,t,n)}static isValidIdentifier(e){return kq.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===MA}static keyField(){return new kr([MA])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Xe(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new Xe(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Xe(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,i+=2}else u==="`"?(l=!l,i++):u!=="."||l?(n+=u,i++):(s(),i++)}if(s(),l)throw new Xe(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kr(t)}static emptyPath(){return new kr([])}}class Ke{constructor(e){this.path=e}static fromPath(e){return new Ke(Yt.fromString(e))}static fromName(e){return new Ke(Yt.fromString(e).popFirst(5))}static empty(){return new Ke(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Yt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ke(new Yt(e.slice()))}}function q4(r,e,t){if(!t)throw new Xe(Ce.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function Cq(r,e,t,n){if(e===!0&&n===!0)throw new Xe(Ce.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function LA(r){if(!Ke.isDocumentKey(r))throw new Xe(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function VA(r){if(Ke.isDocumentKey(r))throw new Xe(Ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function K4(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function _y(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Je(12329,{type:typeof r})}function Pi(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Xe(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=_y(r);throw new Xe(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function rn(r,e){const t={typeString:r};return e&&(t.value=e),t}function j0(r,e){if(!K4(r))throw new Xe(Ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const l=r[n];if(i&&typeof l!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(s!==void 0&&l!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new Xe(Ce.INVALID_ARGUMENT,t);return!0}const BA=-62135596800,UA=1e6;class ir{static now(){return ir.fromMillis(Date.now())}static fromDate(e){return ir.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*UA);return new ir(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Xe(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Xe(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<BA)throw new Xe(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xe(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/UA}_compareTo(e){return this.seconds===e.seconds?dt(this.nanoseconds,e.nanoseconds):dt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ir._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(j0(e,ir._jsonSchema))return new ir(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-BA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ir._jsonSchemaVersion="firestore/timestamp/1.0",ir._jsonSchema={type:rn("string",ir._jsonSchemaVersion),seconds:rn("number"),nanoseconds:rn("number")};class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new ir(0,0))}static max(){return new st(new ir(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const g0=-1;class Tp{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function Ox(r){return r.fields.find((e=>e.kind===2))}function Ml(r){return r.fields.filter((e=>e.kind!==2))}Tp.UNKNOWN_ID=-1;class jm{constructor(e,t){this.fieldPath=e,this.kind=t}}class _0{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new _0(0,Vi.min())}}function Rq(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=st.fromTimestamp(n===1e9?new ir(t+1,0):new ir(t,n));return new Vi(i,Ke.empty(),e)}function W4(r){return new Vi(r.readTime,r.key,g0)}class Vi{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Vi(st.min(),Ke.empty(),g0)}static max(){return new Vi(st.max(),Ke.empty(),g0)}}function xy(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=Ke.comparator(r.documentKey,e.documentKey),t!==0?t:dt(r.largestBatchId,e.largestBatchId))}const X4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Y4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Cc(r){if(r.code!==Ce.FAILED_PRECONDITION||r.message!==X4)throw r;Ve("LocalStore","Unexpectedly lost primary lease")}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Je(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce(((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.reject(t)}static resolve(e){return new ce(((t,n)=>{t(e)}))}static reject(e){return new ce(((t,n)=>{n(e)}))}static waitFor(e){return new ce(((t,n)=>{let i=0,s=0,l=!1;e.forEach((u=>{++i,u.next((()=>{++s,l&&s===i&&t()}),(f=>n(f)))})),l=!0,s===i&&t()}))}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next((i=>i?ce.resolve(i):n()));return t}static forEach(e,t){const n=[];return e.forEach(((i,s)=>{n.push(t.call(this,i,s))})),this.waitFor(n)}static mapArray(e,t){return new ce(((n,i)=>{const s=e.length,l=new Array(s);let u=0;for(let f=0;f<s;f++){const d=f;t(e[d]).next((m=>{l[d]=m,++u,u===s&&n(l)}),(m=>i(m)))}}))}static doWhile(e,t){return new ce(((n,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):n()};s()}))}}const Ii="SimpleDb";class ig{static open(e,t,n,i){try{return new ig(t,e.transaction(i,n))}catch(s){throw new qh(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ms,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new qh(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=vy(n.target.error);this.S.reject(new qh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ve(Ii,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Nq(t)}}class Ko{static delete(e){return Ve(Ii,"Removing database:",e),Bl(_C().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!$v())return!1;if(Ko.F())return!0;const e=fn(),t=Ko.M(e),n=0<t&&t<10,i=$4(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,Ko.M(fn())===12.2&&ti("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ve(Ii,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const l=s.target.result;t(l)},i.onblocked=()=>{n(new qh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const l=s.target.error;l.name==="VersionError"?n(new Xe(Ce.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?n(new Xe(Ce.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):n(new qh(e,l))},i.onupgradeneeded=s=>{Ve(Ii,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const l=s.target.result;this.N.k(l,i.transaction,s.oldVersion,this.version).next((()=>{Ve(Ii,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const s=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const u=ig.open(this.db,e,s?"readonly":"readwrite",n),f=i(u).next((d=>(u.C(),d))).catch((d=>(u.abort(d),ce.reject(d)))).toPromise();return f.catch((()=>{})),await u.D,f}catch(u){const f=u,d=f.name!=="FirebaseError"&&l<3;if(Ve(Ii,"Transaction failed with error:",f.message,"Retrying:",d),this.close(),!d)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function $4(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Dq{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Bl(this.U.delete())}}class qh extends Xe{constructor(e,t){super(Ce.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ol(r){return r.name==="IndexedDbTransactionError"}class Nq{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(Ve(Ii,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Ve(Ii,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Bl(n)}add(e){return Ve(Ii,"ADD",this.store.name,e,e),Bl(this.store.add(e))}get(e){return Bl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ve(Ii,"GET",this.store.name,e,t),t)))}delete(e){return Ve(Ii,"DELETE",this.store.name,e),Bl(this.store.delete(e))}count(){return Ve(Ii,"COUNT",this.store.name),Bl(this.store.count())}J(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(n.range);return new ce(((l,u)=>{s.onerror=f=>{u(f.target.error)},s.onsuccess=f=>{l(f.target.result)}}))}{const s=this.cursor(n),l=[];return this.H(s,((u,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new ce(((i,s)=>{n.onerror=l=>{s(l.target.error)},n.onsuccess=l=>{i(l.target.result)}}))}Z(e,t){Ve(Ii,"DELETE ALL",this.store.name);const n=this.options(e,t);n.X=!1;const i=this.cursor(n);return this.H(i,((s,l,u)=>u.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.H(i,t)}te(e){const t=this.cursor({});return new ce(((n,i)=>{t.onerror=s=>{const l=vy(s.target.error);i(l)},t.onsuccess=s=>{const l=s.target.result;l?e(l.primaryKey,l.value).next((u=>{u?l.continue():n()})):n()}}))}H(e,t){const n=[];return new ce(((i,s)=>{e.onerror=l=>{s(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void i();const f=new Dq(u),d=t(u.primaryKey,u.value,f);if(d instanceof ce){const m=d.catch((_=>(f.done(),ce.reject(_))));n.push(m)}f.isDone?i():f.G===null?u.continue():u.continue(f.G)}})).next((()=>ce.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Bl(r){return new ce(((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=vy(n.target.error);t(i)}}))}let zA=!1;function vy(r){const e=Ko.M(fn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Xe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zA||(zA=!0,setTimeout((()=>{throw n}),0)),n}}return r}const Kh="IndexBackfiller";class Oq{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ve(Kh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ve(Kh,`Documents written: ${t}`)}catch(t){ol(t)?Ve(Kh,"Ignoring IndexedDB error during index backfill: ",t):await Cc(t)}await this.re(6e4)}))}}class Fq{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let i=t,s=!0;return ce.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!n.has(l))return Ve(Kh,`Processing collection: ${l}`),this.oe(e,l,i).next((u=>{i-=u,n.add(l)}));s=!1})))).next((()=>t-i))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next((s=>{const l=s.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(i,s))).next((u=>(Ve(Kh,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>l.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((i,s)=>{const l=W4(s);xy(l,n)>0&&(n=l)})),new Vi(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class sa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}sa.ce=-1;const $l=-1;function ag(r){return r==null}function x0(r){return r===0&&1/r==-1/0}function Pq(r){return typeof r=="number"&&Number.isInteger(r)&&!x0(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}const wp="";function Kn(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=jA(e)),e=Mq(r.get(t),e);return jA(e)}function Mq(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case wp:t+="";break;default:t+=s}}return t}function jA(r){return r+wp+""}function Qa(r){const e=r.length;if(tt(e>=2,64408,{path:r}),e===2)return tt(r.charAt(0)===wp&&r.charAt(1)==="",56145,{path:r}),Yt.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const l=r.indexOf(wp,s);switch((l<0||l>t)&&Je(50515,{path:r}),r.charAt(l+1)){case"":const u=r.substring(s,l);let f;i.length===0?f=u:(i+=u,f=i,i=""),n.push(f);break;case"":i+=r.substring(s,l),i+="\0";break;case"":i+=r.substring(s,l+1);break;default:Je(61167,{path:r})}s=l+2}return new Yt(n)}const Ll="remoteDocuments",H0="owner",xu="owner",v0="mutationQueues",Lq="userId",Aa="mutations",HA="batchId",Gl="userMutationsIndex",GA=["userId","batchId"];function Hm(r,e){return[r,Kn(e)]}function Q4(r,e,t){return[r,Kn(e),t]}const Vq={},Yu="documentMutations",Sp="remoteDocumentsV14",Bq=["prefixPath","collectionGroup","readTime","documentId"],Gm="documentKeyIndex",Uq=["prefixPath","collectionGroup","documentId"],J4="collectionGroupIndex",zq=["collectionGroup","readTime","prefixPath","documentId"],y0="remoteDocumentGlobal",Fx="remoteDocumentGlobalKey",$u="targets",Z4="queryTargetsIndex",jq=["canonicalId","targetId"],Qu="targetDocuments",Hq=["targetId","path"],yy="documentTargetsIndex",Gq=["path","targetId"],Ap="targetGlobalKey",Ql="targetGlobal",E0="collectionParents",qq=["collectionId","parent"],Ju="clientMetadata",Kq="clientId",sg="bundles",Wq="bundleId",og="namedQueries",Xq="name",Ey="indexConfiguration",Yq="indexId",Px="collectionGroupIndex",$q="collectionGroup",Wh="indexState",Qq=["indexId","uid"],eR="sequenceNumberIndex",Jq=["uid","sequenceNumber"],Xh="indexEntries",Zq=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tR="documentKeyIndex",eK=["indexId","uid","orderedDocumentKey"],lg="documentOverlays",tK=["userId","collectionPath","documentId"],Mx="collectionPathOverlayIndex",rK=["userId","collectionPath","largestBatchId"],rR="collectionGroupOverlayIndex",nK=["userId","collectionGroup","largestBatchId"],Ty="globals",iK="name",nR=[v0,Aa,Yu,Ll,$u,H0,Ql,Qu,Ju,y0,E0,sg,og],aK=[...nR,lg],iR=[v0,Aa,Yu,Sp,$u,H0,Ql,Qu,Ju,y0,E0,sg,og,lg],aR=iR,wy=[...aR,Ey,Wh,Xh],sK=wy,sR=[...wy,Ty],oK=sR;class Lx extends Y4{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function hn(r,e){const t=mt(r);return Ko.O(t.le,e)}function qA(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ll(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function oR(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class br{constructor(e,t){this.comparator=e,this.root=t||Cn.EMPTY}insert(e,t){return new br(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Cn.BLACK,null,null))}remove(e){return new br(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cm(this.root,e,this.comparator,!0)}}class Cm{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cn{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Cn.RED,this.left=i??Cn.EMPTY,this.right=s??Cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Cn(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Cn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Je(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Je(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Je(27949);return e+(this.isRed()?0:1)}}Cn.EMPTY=null,Cn.RED=!0,Cn.BLACK=!1;Cn.EMPTY=new class{constructor(){this.size=0}get key(){throw Je(57766)}get value(){throw Je(16141)}get color(){throw Je(16727)}get left(){throw Je(29726)}get right(){throw Je(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new Cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sr{constructor(e){this.comparator=e,this.data=new br(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new KA(this.data.getIterator())}getIteratorFrom(e){return new KA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof sr)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new sr(this.comparator);return t.data=e,t}}class KA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function vu(r){return r.hasNext()?r.getNext():void 0}class mi{constructor(e){this.fields=e,e.sort(kr.comparator)}static empty(){return new mi([])}unionWith(e){let t=new sr(kr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new mi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xu(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}class lR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class an{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lR("Invalid base64 string: "+s):s}})(e);return new an(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let l=0;l<i.length;++l)s+=String.fromCharCode(i[l]);return s})(e);return new an(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return dt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}an.EMPTY_BYTE_STRING=new an("");const lK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Us(r){if(tt(!!r,39018),typeof r=="string"){let e=0;const t=lK.exec(r);if(tt(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ar(r.seconds),nanos:Ar(r.nanos)}}function Ar(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function zs(r){return typeof r=="string"?an.fromBase64String(r):an.fromUint8Array(r)}const cR="server_timestamp",uR="__type__",fR="__previous_value__",hR="__local_write_time__";function Sy(r){return(r?.mapValue?.fields||{})[uR]?.stringValue===cR}function cg(r){const e=r.mapValue.fields[fR];return Sy(e)?cg(e):e}function T0(r){const e=Us(r.mapValue.fields[hR].timestampValue);return new ir(e.seconds,e.nanos)}class cK{constructor(e,t,n,i,s,l,u,f,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=m}}const bp="(default)";class mc{constructor(e,t){this.projectId=e,this.database=t||bp}static empty(){return new mc("","")}get isDefaultDatabase(){return this.database===bp}isEqual(e){return e instanceof mc&&e.projectId===this.projectId&&e.database===this.database}}const Ay="__type__",dR="__max__",zo={mapValue:{fields:{__type__:{stringValue:dR}}}},by="__vector__",Zu="value",qm={nullValue:"NULL_VALUE"};function Zo(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Sy(r)?4:mR(r)?9007199254740991:ug(r)?10:11:Je(28295,{value:r})}function is(r,e){if(r===e)return!0;const t=Zo(r);if(t!==Zo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return T0(r).isEqual(T0(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const l=Us(i.timestampValue),u=Us(s.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(i,s){return zs(i.bytesValue).isEqual(zs(s.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(i,s){return Ar(i.geoPointValue.latitude)===Ar(s.geoPointValue.latitude)&&Ar(i.geoPointValue.longitude)===Ar(s.geoPointValue.longitude)})(r,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Ar(i.integerValue)===Ar(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const l=Ar(i.doubleValue),u=Ar(s.doubleValue);return l===u?x0(l)===x0(u):isNaN(l)&&isNaN(u)}return!1})(r,e);case 9:return Xu(r.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return(function(i,s){const l=i.mapValue.fields||{},u=s.mapValue.fields||{};if(qA(l)!==qA(u))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(u[f]===void 0||!is(l[f],u[f])))return!1;return!0})(r,e);default:return Je(52216,{left:r})}}function w0(r,e){return(r.values||[]).find((t=>is(t,e)))!==void 0}function el(r,e){if(r===e)return 0;const t=Zo(r),n=Zo(e);if(t!==n)return dt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return dt(r.booleanValue,e.booleanValue);case 2:return(function(s,l){const u=Ar(s.integerValue||s.doubleValue),f=Ar(l.integerValue||l.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(r,e);case 3:return WA(r.timestampValue,e.timestampValue);case 4:return WA(T0(r),T0(e));case 5:return Nx(r.stringValue,e.stringValue);case 6:return(function(s,l){const u=zs(s),f=zs(l);return u.compareTo(f)})(r.bytesValue,e.bytesValue);case 7:return(function(s,l){const u=s.split("/"),f=l.split("/");for(let d=0;d<u.length&&d<f.length;d++){const m=dt(u[d],f[d]);if(m!==0)return m}return dt(u.length,f.length)})(r.referenceValue,e.referenceValue);case 8:return(function(s,l){const u=dt(Ar(s.latitude),Ar(l.latitude));return u!==0?u:dt(Ar(s.longitude),Ar(l.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return XA(r.arrayValue,e.arrayValue);case 10:return(function(s,l){const u=s.fields||{},f=l.fields||{},d=u[Zu]?.arrayValue,m=f[Zu]?.arrayValue,_=dt(d?.values?.length||0,m?.values?.length||0);return _!==0?_:XA(d,m)})(r.mapValue,e.mapValue);case 11:return(function(s,l){if(s===zo.mapValue&&l===zo.mapValue)return 0;if(s===zo.mapValue)return 1;if(l===zo.mapValue)return-1;const u=s.fields||{},f=Object.keys(u),d=l.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let _=0;_<f.length&&_<m.length;++_){const v=Nx(f[_],m[_]);if(v!==0)return v;const y=el(u[f[_]],d[m[_]]);if(y!==0)return y}return dt(f.length,m.length)})(r.mapValue,e.mapValue);default:throw Je(23264,{he:t})}}function WA(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return dt(r,e);const t=Us(r),n=Us(e),i=dt(t.seconds,n.seconds);return i!==0?i:dt(t.nanos,n.nanos)}function XA(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=el(t[i],n[i]);if(s)return s}return dt(t.length,n.length)}function ef(r){return Vx(r)}function Vx(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=Us(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return zs(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return Ke.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=Vx(s);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const l of n)s?s=!1:i+=",",i+=`${l}:${Vx(t.fields[l])}`;return i+"}"})(r.mapValue):Je(61005,{value:r})}function Km(r){switch(Zo(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cg(r);return e?16+Km(e):16;case 5:return 2*r.stringValue.length;case 6:return zs(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,s)=>i+Km(s)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return ll(n.fields,((s,l)=>{i+=s.length+Km(l)})),i})(r.mapValue);default:throw Je(13486,{value:r})}}function Iy(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Bx(r){return!!r&&"integerValue"in r}function S0(r){return!!r&&"arrayValue"in r}function YA(r){return!!r&&"nullValue"in r}function $A(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Wm(r){return!!r&&"mapValue"in r}function ug(r){return(r?.mapValue?.fields||{})[Ay]?.stringValue===by}function Yh(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return ll(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Yh(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Yh(r.arrayValue.values[t]);return e}return{...r}}function mR(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===dR}const pR={mapValue:{fields:{[Ay]:{stringValue:by},[Zu]:{arrayValue:{}}}}};function uK(r){return"nullValue"in r?qm:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Iy(mc.empty(),Ke.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?ug(r)?pR:{mapValue:{}}:Je(35942,{value:r})}function fK(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Iy(mc.empty(),Ke.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?pR:"mapValue"in r?ug(r)?{mapValue:{}}:zo:Je(61959,{value:r})}function QA(r,e){const t=el(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function JA(r,e){const t=el(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}class Hn{constructor(e){this.value=e}static empty(){return new Hn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Wm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yh(t)}setAll(e){let t=kr.emptyPath(),n={},i=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const f=this.getFieldsMap(t);this.applyChanges(f,n,i),n={},i=[],t=u.popLast()}l?n[u.lastSegment()]=Yh(l):i.push(u.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());Wm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Wm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ll(t,((i,s)=>e[i]=s));for(const i of n)delete e[i]}clone(){return new Hn(Yh(this.value))}}function gR(r){const e=[];return ll(r.fields,((t,n)=>{const i=new kr([t]);if(Wm(n)){const s=gR(n.mapValue).fields;if(s.length===0)e.push(i);else for(const l of s)e.push(i.child(l))}else e.push(i)})),new mi(e)}class Fr{constructor(e,t,n,i,s,l,u){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Fr(e,0,st.min(),st.min(),st.min(),Hn.empty(),0)}static newFoundDocument(e,t,n,i){return new Fr(e,1,t,st.min(),n,i,0)}static newNoDocument(e,t){return new Fr(e,2,t,st.min(),st.min(),Hn.empty(),0)}static newUnknownDocument(e,t){return new Fr(e,3,t,st.min(),st.min(),Hn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class tf{constructor(e,t){this.position=e,this.inclusive=t}}function ZA(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],l=r.position[i];if(s.field.isKeyField()?n=Ke.comparator(Ke.fromName(l.referenceValue),t.key):n=el(l,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function eb(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!is(r.position[t],e.position[t]))return!1;return!0}class Ip{constructor(e,t="asc"){this.field=e,this.dir=t}}function hK(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class _R{}class Mt extends _R{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new dK(e,t,n):t==="array-contains"?new gK(e,n):t==="in"?new wR(e,n):t==="not-in"?new _K(e,n):t==="array-contains-any"?new xK(e,n):new Mt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new mK(e,n):new pK(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(el(t,this.value)):t!==null&&Zo(this.value)===Zo(t)&&this.matchesComparison(el(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Je(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class hr extends _R{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new hr(e,t)}matches(e){return rf(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function rf(r){return r.op==="and"}function Ux(r){return r.op==="or"}function ky(r){return xR(r)&&rf(r)}function xR(r){for(const e of r.filters)if(e instanceof hr)return!1;return!0}function zx(r){if(r instanceof Mt)return r.field.canonicalString()+r.op.toString()+ef(r.value);if(ky(r))return r.filters.map((e=>zx(e))).join(",");{const e=r.filters.map((t=>zx(t))).join(",");return`${r.op}(${e})`}}function vR(r,e){return r instanceof Mt?(function(n,i){return i instanceof Mt&&n.op===i.op&&n.field.isEqual(i.field)&&is(n.value,i.value)})(r,e):r instanceof hr?(function(n,i){return i instanceof hr&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((s,l,u)=>s&&vR(l,i.filters[u])),!0):!1})(r,e):void Je(19439)}function yR(r,e){const t=r.filters.concat(e);return hr.create(t,r.op)}function ER(r){return r instanceof Mt?(function(t){return`${t.field.canonicalString()} ${t.op} ${ef(t.value)}`})(r):r instanceof hr?(function(t){return t.op.toString()+" {"+t.getFilters().map(ER).join(" ,")+"}"})(r):"Filter"}class dK extends Mt{constructor(e,t,n){super(e,t,n),this.key=Ke.fromName(n.referenceValue)}matches(e){const t=Ke.comparator(e.key,this.key);return this.matchesComparison(t)}}class mK extends Mt{constructor(e,t){super(e,"in",t),this.keys=TR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class pK extends Mt{constructor(e,t){super(e,"not-in",t),this.keys=TR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function TR(r,e){return(e.arrayValue?.values||[]).map((t=>Ke.fromName(t.referenceValue)))}class gK extends Mt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return S0(t)&&w0(t.arrayValue,this.value)}}class wR extends Mt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&w0(this.value.arrayValue,t)}}class _K extends Mt{constructor(e,t){super(e,"not-in",t)}matches(e){if(w0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!w0(this.value.arrayValue,t)}}class xK extends Mt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!S0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>w0(this.value.arrayValue,n)))}}class vK{constructor(e,t=null,n=[],i=[],s=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=l,this.endAt=u,this.Te=null}}function jx(r,e=null,t=[],n=[],i=null,s=null,l=null){return new vK(r,e,t,n,i,s,l)}function pc(r){const e=mt(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>zx(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(s){return s.field.canonicalString()+s.dir})(n))).join(","),ag(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>ef(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>ef(n))).join(",")),e.Te=t}return e.Te}function G0(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!hK(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!vR(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!eb(r.startAt,e.startAt)&&eb(r.endAt,e.endAt)}function kp(r){return Ke.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Cp(r,e){return r.filters.filter((t=>t instanceof Mt&&t.field.isEqual(e)))}function tb(r,e,t){let n=qm,i=!0;for(const s of Cp(r,e)){let l=qm,u=!0;switch(s.op){case"<":case"<=":l=uK(s.value);break;case"==":case"in":case">=":l=s.value;break;case">":l=s.value,u=!1;break;case"!=":case"not-in":l=qm}QA({value:n,inclusive:i},{value:l,inclusive:u})<0&&(n=l,i=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const l=t.position[s];QA({value:n,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(n=l,i=t.inclusive);break}}return{value:n,inclusive:i}}function rb(r,e,t){let n=zo,i=!0;for(const s of Cp(r,e)){let l=zo,u=!0;switch(s.op){case">=":case">":l=fK(s.value),u=!1;break;case"==":case"in":case"<=":l=s.value;break;case"<":l=s.value,u=!1;break;case"!=":case"not-in":l=zo}JA({value:n,inclusive:i},{value:l,inclusive:u})>0&&(n=l,i=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const l=t.position[s];JA({value:n,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(n=l,i=t.inclusive);break}}return{value:n,inclusive:i}}class fg{constructor(e,t=null,n=[],i=[],s=null,l="F",u=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=l,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function yK(r,e,t,n,i,s,l,u){return new fg(r,e,t,n,i,s,l,u)}function hg(r){return new fg(r)}function nb(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function EK(r){return r.collectionGroup!==null}function $h(r){const e=mt(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new sr(kr.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Ip(s,n))})),t.has(kr.keyField().canonicalString())||e.Ie.push(new Ip(kr.keyField(),n))}return e.Ie}function ca(r){const e=mt(r);return e.Ee||(e.Ee=TK(e,$h(r))),e.Ee}function TK(r,e){if(r.limitType==="F")return jx(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Ip(i.field,s)}));const t=r.endAt?new tf(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new tf(r.startAt.position,r.startAt.inclusive):null;return jx(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Hx(r,e,t){return new fg(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function dg(r,e){return G0(ca(r),ca(e))&&r.limitType===e.limitType}function SR(r){return`${pc(ca(r))}|lt:${r.limitType}`}function bu(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((i=>ER(i))).join(", ")}]`),ag(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((i=>ef(i))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((i=>ef(i))).join(",")),`Target(${n})`})(ca(r))}; limitType=${r.limitType})`}function q0(r,e){return e.isFoundDocument()&&(function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Ke.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)})(r,e)&&(function(n,i){for(const s of $h(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(r,e)&&(function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0})(r,e)&&(function(n,i){return!(n.startAt&&!(function(l,u,f){const d=ZA(l,u,f);return l.inclusive?d<=0:d<0})(n.startAt,$h(n),i)||n.endAt&&!(function(l,u,f){const d=ZA(l,u,f);return l.inclusive?d>=0:d>0})(n.endAt,$h(n),i))})(r,e)}function wK(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function AR(r){return(e,t)=>{let n=!1;for(const i of $h(r)){const s=SK(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function SK(r,e,t){const n=r.field.isKeyField()?Ke.comparator(e.key,t.key):(function(s,l,u){const f=l.data.field(s),d=u.data.field(s);return f!==null&&d!==null?el(f,d):Je(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Je(19790,{direction:r.dir})}}class Ks{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ll(this.inner,((t,n)=>{for(const[i,s]of n)e(i,s)}))}isEmpty(){return oR(this.inner)}size(){return this.innerSize}}const AK=new br(Ke.comparator);function Di(){return AK}const bR=new br(Ke.comparator);function kh(...r){let e=bR;for(const t of r)e=e.insert(t.key,t);return e}function IR(r){let e=bR;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Ja(){return Qh()}function kR(){return Qh()}function Qh(){return new Ks((r=>r.toString()),((r,e)=>r.isEqual(e)))}const bK=new br(Ke.comparator),IK=new sr(Ke.comparator);function At(...r){let e=IK;for(const t of r)e=e.add(t);return e}const kK=new sr(dt);function CK(){return kK}function Cy(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:x0(e)?"-0":e}}function CR(r){return{integerValue:""+r}}function RK(r,e){return Pq(e)?CR(e):Cy(r,e)}class mg{constructor(){this._=void 0}}function DK(r,e,t){return r instanceof A0?(function(i,s){const l={fields:{[uR]:{stringValue:cR},[hR]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Sy(s)&&(s=cg(s)),s&&(l.fields[fR]=s),{mapValue:l}})(t,e):r instanceof nf?DR(r,e):r instanceof af?NR(r,e):(function(i,s){const l=RR(i,s),u=ib(l)+ib(i.Ae);return Bx(l)&&Bx(i.Ae)?CR(u):Cy(i.serializer,u)})(r,e)}function NK(r,e,t){return r instanceof nf?DR(r,e):r instanceof af?NR(r,e):t}function RR(r,e){return r instanceof b0?(function(n){return Bx(n)||(function(s){return!!s&&"doubleValue"in s})(n)})(e)?e:{integerValue:0}:null}class A0 extends mg{}class nf extends mg{constructor(e){super(),this.elements=e}}function DR(r,e){const t=OR(e);for(const n of r.elements)t.some((i=>is(i,n)))||t.push(n);return{arrayValue:{values:t}}}class af extends mg{constructor(e){super(),this.elements=e}}function NR(r,e){let t=OR(e);for(const n of r.elements)t=t.filter((i=>!is(i,n)));return{arrayValue:{values:t}}}class b0 extends mg{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ib(r){return Ar(r.integerValue||r.doubleValue)}function OR(r){return S0(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class OK{constructor(e,t){this.field=e,this.transform=t}}function FK(r,e){return r.field.isEqual(e.field)&&(function(n,i){return n instanceof nf&&i instanceof nf||n instanceof af&&i instanceof af?Xu(n.elements,i.elements,is):n instanceof b0&&i instanceof b0?is(n.Ae,i.Ae):n instanceof A0&&i instanceof A0})(r.transform,e.transform)}class PK{constructor(e,t){this.version=e,this.transformResults=t}}class En{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new En}static exists(e){return new En(void 0,e)}static updateTime(e){return new En(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xm(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class pg{}function FR(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new K0(r.key,En.none()):new gf(r.key,r.data,En.none());{const t=r.data,n=Hn.empty();let i=new sr(kr.comparator);for(let s of e.fields)if(!i.has(s)){let l=t.field(s);l===null&&s.length>1&&(s=s.popLast(),l=t.field(s)),l===null?n.delete(s):n.set(s,l),i=i.add(s)}return new Ws(r.key,n,new mi(i.toArray()),En.none())}}function MK(r,e,t){r instanceof gf?(function(i,s,l){const u=i.value.clone(),f=sb(i.fieldTransforms,s,l.transformResults);u.setAll(f),s.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(r,e,t):r instanceof Ws?(function(i,s,l){if(!Xm(i.precondition,s))return void s.convertToUnknownDocument(l.version);const u=sb(i.fieldTransforms,s,l.transformResults),f=s.data;f.setAll(PR(i)),f.setAll(u),s.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(r,e,t):(function(i,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Jh(r,e,t,n){return r instanceof gf?(function(s,l,u,f){if(!Xm(s.precondition,l))return u;const d=s.value.clone(),m=ob(s.fieldTransforms,f,l);return d.setAll(m),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(r,e,t,n):r instanceof Ws?(function(s,l,u,f){if(!Xm(s.precondition,l))return u;const d=ob(s.fieldTransforms,f,l),m=l.data;return m.setAll(PR(s)),m.setAll(d),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((_=>_.field)))})(r,e,t,n):(function(s,l,u){return Xm(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(r,e,t)}function LK(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=RR(n.transform,i||null);s!=null&&(t===null&&(t=Hn.empty()),t.set(n.field,s))}return t||null}function ab(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Xu(n,i,((s,l)=>FK(s,l)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class gf extends pg{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ws extends pg{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function PR(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function sb(r,e,t){const n=new Map;tt(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let i=0;i<t.length;i++){const s=r[i],l=s.transform,u=e.data.field(s.field);n.set(s.field,NK(l,u,t[i]))}return n}function ob(r,e,t){const n=new Map;for(const i of r){const s=i.transform,l=t.data.field(i.field);n.set(i.field,DK(s,l,e))}return n}class K0 extends pg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class MR extends pg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ry{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&MK(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Jh(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Jh(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=kR();return this.mutations.forEach((i=>{const s=e.get(i.key),l=s.overlayedDocument;let u=this.applyToLocalView(l,s.mutatedFields);u=t.has(i.key)?null:u;const f=FR(l,u);f!==null&&n.set(i.key,f),l.isValidDocument()||l.convertToNoDocument(st.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),At())}isEqual(e){return this.batchId===e.batchId&&Xu(this.mutations,e.mutations,((t,n)=>ab(t,n)))&&Xu(this.baseMutations,e.baseMutations,((t,n)=>ab(t,n)))}}class Dy{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){tt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=(function(){return bK})();const s=e.mutations;for(let l=0;l<s.length;l++)i=i.insert(s[l].key,n[l].version);return new Dy(e,t,n,i)}}class Ny{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class VK{constructor(e,t){this.count=e,this.unchangedNames=t}}var Jr,Bt;function BK(r){switch(r){case Ce.OK:return Je(64938);case Ce.CANCELLED:case Ce.UNKNOWN:case Ce.DEADLINE_EXCEEDED:case Ce.RESOURCE_EXHAUSTED:case Ce.INTERNAL:case Ce.UNAVAILABLE:case Ce.UNAUTHENTICATED:return!1;case Ce.INVALID_ARGUMENT:case Ce.NOT_FOUND:case Ce.ALREADY_EXISTS:case Ce.PERMISSION_DENIED:case Ce.FAILED_PRECONDITION:case Ce.ABORTED:case Ce.OUT_OF_RANGE:case Ce.UNIMPLEMENTED:case Ce.DATA_LOSS:return!0;default:return Je(15467,{code:r})}}function LR(r){if(r===void 0)return ti("GRPC error has no .code"),Ce.UNKNOWN;switch(r){case Jr.OK:return Ce.OK;case Jr.CANCELLED:return Ce.CANCELLED;case Jr.UNKNOWN:return Ce.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return Ce.INTERNAL;case Jr.UNAVAILABLE:return Ce.UNAVAILABLE;case Jr.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case Jr.NOT_FOUND:return Ce.NOT_FOUND;case Jr.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case Jr.ABORTED:return Ce.ABORTED;case Jr.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case Jr.DATA_LOSS:return Ce.DATA_LOSS;default:return Je(39323,{code:r})}}(Bt=Jr||(Jr={}))[Bt.OK=0]="OK",Bt[Bt.CANCELLED=1]="CANCELLED",Bt[Bt.UNKNOWN=2]="UNKNOWN",Bt[Bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Bt[Bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Bt[Bt.NOT_FOUND=5]="NOT_FOUND",Bt[Bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Bt[Bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Bt[Bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Bt[Bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Bt[Bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Bt[Bt.ABORTED=10]="ABORTED",Bt[Bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Bt[Bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Bt[Bt.INTERNAL=13]="INTERNAL",Bt[Bt.UNAVAILABLE=14]="UNAVAILABLE",Bt[Bt.DATA_LOSS=15]="DATA_LOSS";function UK(){return new TextEncoder}const zK=new qo([4294967295,4294967295],0);function lb(r){const e=UK().encode(r),t=new M4;return t.update(e),new Uint8Array(t.digest())}function cb(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new qo([t,n],0),new qo([i,s],0)]}class Oy{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ch(`Invalid padding: ${t}`);if(n<0)throw new Ch(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ch(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ch(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=qo.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply(qo.fromNumber(n)));return i.compare(zK)===1&&(i=new qo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=lb(e),[n,i]=cb(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,i,s);if(!this.we(l))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new Oy(s,i,t);return n.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=lb(e),[n,i]=cb(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,i,s);this.Se(l)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ch extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gg{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,W0.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new gg(st.min(),i,new br(dt),Di(),At())}}class W0{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new W0(n,t,At(),At(),At())}}class Ym{constructor(e,t,n,i){this.be=e,this.removedTargetIds=t,this.key=n,this.De=i}}class VR{constructor(e,t){this.targetId=e,this.Ce=t}}class BR{constructor(e,t,n=an.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class ub{constructor(){this.ve=0,this.Fe=fb(),this.Me=an.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=At(),t=At(),n=At();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Je(38017,{changeType:s})}})),new W0(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=fb()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,tt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class jK{constructor(e){this.Ge=e,this.ze=new Map,this.je=Di(),this.Je=Rm(),this.He=Rm(),this.Ye=new br(dt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Je(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,n=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(kp(s))if(n===0){const l=new Ke(s.path);this.et(t,l,Fr.newNoDocument(l,st.min()))}else tt(n===1,20013,{expectedCount:n});else{const l=this._t(t);if(l!==n){const u=this.ut(e),f=u?this.ct(u,e,l):1;if(f!==0){this.it(t);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let l,u;try{l=zs(n).toUint8Array()}catch(f){if(f instanceof lR)return dc("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new Oy(l,i,s)}catch(f){return dc(f instanceof Ch?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let i=0;return n.forEach((s=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,l)=>{const u=this.ot(l);if(u){if(s.current&&kp(u.target)){const f=new Ke(u.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,Fr.newNoDocument(f,e))}s.Be&&(t.set(l,s.ke()),s.qe())}}));let n=At();this.He.forEach(((s,l)=>{let u=!0;l.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(s))})),this.je.forEach(((s,l)=>l.setReadTime(e)));const i=new gg(e,t,this.Ye,this.je,n);return this.je=Di(),this.Je=Rm(),this.He=Rm(),this.Ye=new br(dt),i}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ub,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new sr(dt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new sr(dt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ub),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Rm(){return new br(Ke.comparator)}function fb(){return new br(Ke.comparator)}const HK={asc:"ASCENDING",desc:"DESCENDING"},GK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qK={and:"AND",or:"OR"};class KK{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gx(r,e){return r.useProto3Json||ag(e)?e:{value:e}}function sf(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function UR(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function WK(r,e){return sf(r,e.toTimestamp())}function ni(r){return tt(!!r,49232),st.fromTimestamp((function(t){const n=Us(t);return new ir(n.seconds,n.nanos)})(r))}function Fy(r,e){return qx(r,e).canonicalString()}function qx(r,e){const t=(function(i){return new Yt(["projects",i.projectId,"databases",i.database])})(r).child("documents");return e===void 0?t:t.child(e)}function zR(r){const e=Yt.fromString(r);return tt($R(e),10190,{key:e.toString()}),e}function Rp(r,e){return Fy(r.databaseId,e.path)}function Jl(r,e){const t=zR(e);if(t.get(1)!==r.databaseId.projectId)throw new Xe(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Xe(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ke(GR(t))}function jR(r,e){return Fy(r.databaseId,e)}function HR(r){const e=zR(r);return e.length===4?Yt.emptyPath():GR(e)}function Kx(r){return new Yt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function GR(r){return tt(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function hb(r,e,t){return{name:Rp(r,e),fields:t.value.mapValue.fields}}function XK(r,e,t){const n=Jl(r,e.name),i=ni(e.updateTime),s=e.createTime?ni(e.createTime):st.min(),l=new Hn({mapValue:{fields:e.fields}}),u=Fr.newFoundDocument(n,i,s,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function YK(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Je(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,m){return d.useProto3Json?(tt(m===void 0||typeof m=="string",58123),an.fromBase64String(m||"")):(tt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),an.fromUint8Array(m||new Uint8Array))})(r,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(d){const m=d.code===void 0?Ce.UNKNOWN:LR(d.code);return new Xe(m,d.message||"")})(l);t=new BR(n,i,s,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Jl(r,n.document.name),s=ni(n.document.updateTime),l=n.document.createTime?ni(n.document.createTime):st.min(),u=new Hn({mapValue:{fields:n.document.fields}}),f=Fr.newFoundDocument(i,s,l,u),d=n.targetIds||[],m=n.removedTargetIds||[];t=new Ym(d,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Jl(r,n.document),s=n.readTime?ni(n.readTime):st.min(),l=Fr.newNoDocument(i,s),u=n.removedTargetIds||[];t=new Ym([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Jl(r,n.document),s=n.removedTargetIds||[];t=new Ym([],s,i,null)}else{if(!("filter"in e))return Je(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,l=new VK(i,s),u=n.targetId;t=new VR(u,l)}}return t}function Dp(r,e){let t;if(e instanceof gf)t={update:hb(r,e.key,e.value)};else if(e instanceof K0)t={delete:Rp(r,e.key)};else if(e instanceof Ws)t={update:hb(r,e.key,e.data),updateMask:tW(e.fieldMask)};else{if(!(e instanceof MR))return Je(16599,{Vt:e.type});t={verify:Rp(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(s,l){const u=l.transform;if(u instanceof A0)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof nf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof af)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof b0)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw Je(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:WK(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Je(27497)})(r,e.precondition)),t}function Wx(r,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?En.updateTime(ni(s.updateTime)):s.exists!==void 0?En.exists(s.exists):En.none()})(e.currentDocument):En.none(),n=e.updateTransforms?e.updateTransforms.map((i=>(function(l,u){let f=null;if("setToServerValue"in u)tt(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),f=new A0;else if("appendMissingElements"in u){const m=u.appendMissingElements.values||[];f=new nf(m)}else if("removeAllFromArray"in u){const m=u.removeAllFromArray.values||[];f=new af(m)}else"increment"in u?f=new b0(l,u.increment):Je(16584,{proto:u});const d=kr.fromServerFormat(u.fieldPath);return new OK(d,f)})(r,i))):[];if(e.update){e.update.name;const i=Jl(r,e.update.name),s=new Hn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const d=f.fieldPaths||[];return new mi(d.map((m=>kr.fromServerFormat(m))))})(e.updateMask);return new Ws(i,s,l,t,n)}return new gf(i,s,t,n)}if(e.delete){const i=Jl(r,e.delete);return new K0(i,t)}if(e.verify){const i=Jl(r,e.verify);return new MR(i,t)}return Je(1463,{proto:e})}function $K(r,e){return r&&r.length>0?(tt(e!==void 0,14353),r.map((t=>(function(i,s){let l=i.updateTime?ni(i.updateTime):ni(s);return l.isEqual(st.min())&&(l=ni(s)),new PK(l,i.transformResults||[])})(t,e)))):[]}function qR(r,e){return{documents:[jR(r,e.path)]}}function KR(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=jR(r,i);const s=(function(d){if(d.length!==0)return YR(hr.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const l=(function(d){if(d.length!==0)return d.map((m=>(function(v){return{field:Iu(v.field),direction:JK(v.dir)}})(m)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=Gx(r,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function WR(r){let e=HR(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){tt(n===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=(function(_){const v=XR(_);return v instanceof hr&&ky(v)?v.getFilters():[v]})(t.where));let l=[];t.orderBy&&(l=(function(_){return _.map((v=>(function(T){return new Ip(ku(T.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(v)))})(t.orderBy));let u=null;t.limit&&(u=(function(_){let v;return v=typeof _=="object"?_.value:_,ag(v)?null:v})(t.limit));let f=null;t.startAt&&(f=(function(_){const v=!!_.before,y=_.values||[];return new tf(y,v)})(t.startAt));let d=null;return t.endAt&&(d=(function(_){const v=!_.before,y=_.values||[];return new tf(y,v)})(t.endAt)),yK(e,i,l,s,u,"F",f,d)}function QK(r,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Je(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function XR(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ku(t.unaryFilter.field);return Mt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ku(t.unaryFilter.field);return Mt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ku(t.unaryFilter.field);return Mt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=ku(t.unaryFilter.field);return Mt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Je(61313);default:return Je(60726)}})(r):r.fieldFilter!==void 0?(function(t){return Mt.create(ku(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Je(58110);default:return Je(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return hr.create(t.compositeFilter.filters.map((n=>XR(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Je(1026)}})(t.compositeFilter.op))})(r):Je(30097,{filter:r})}function JK(r){return HK[r]}function ZK(r){return GK[r]}function eW(r){return qK[r]}function Iu(r){return{fieldPath:r.canonicalString()}}function ku(r){return kr.fromServerFormat(r.fieldPath)}function YR(r){return r instanceof Mt?(function(t){if(t.op==="=="){if($A(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NAN"}};if(YA(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if($A(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NOT_NAN"}};if(YA(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Iu(t.field),op:ZK(t.op),value:t.value}}})(r):r instanceof hr?(function(t){const n=t.getFilters().map((i=>YR(i)));return n.length===1?n[0]:{compositeFilter:{op:eW(t.op),filters:n}}})(r):Je(54877,{filter:r})}function tW(r){const e=[];return r.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function $R(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}class Os{constructor(e,t,n,i,s=st.min(),l=st.min(),u=an.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new Os(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class QR{constructor(e){this.yt=e}}function rW(r,e){let t;if(e.document)t=XK(r.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Ke.fromSegments(e.noDocument.path),i=_c(e.noDocument.readTime);t=Fr.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Je(56709);{const n=Ke.fromSegments(e.unknownDocument.path),i=_c(e.unknownDocument.version);t=Fr.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime((function(i){const s=new ir(i[0],i[1]);return st.fromTimestamp(s)})(e.readTime)),t}function db(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Np(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(s,l){return{name:Rp(s,l.key),fields:l.data.value.mapValue.fields,updateTime:sf(s,l.version.toTimestamp()),createTime:sf(s,l.createTime.toTimestamp())}})(r.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:gc(e.version)};else{if(!e.isUnknownDocument())return Je(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:gc(e.version)}}return n}function Np(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function gc(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _c(r){const e=new ir(r.seconds,r.nanoseconds);return st.fromTimestamp(e)}function Ul(r,e){const t=(e.baseMutations||[]).map((s=>Wx(r.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const l=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const u=e.mutations[s+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map((s=>Wx(r.yt,s))),i=ir.fromMillis(e.localWriteTimeMs);return new Ry(e.batchId,i,t,n)}function Rh(r){const e=_c(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?_c(r.lastLimboFreeSnapshotVersion):st.min();let n;return n=(function(s){return s.documents!==void 0})(r.query)?(function(s){const l=s.documents.length;return tt(l===1,1966,{count:l}),ca(hg(HR(s.documents[0])))})(r.query):(function(s){return ca(WR(s))})(r.query),new Os(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,an.fromBase64String(r.resumeToken))}function JR(r,e){const t=gc(e.snapshotVersion),n=gc(e.lastLimboFreeSnapshotVersion);let i;i=kp(e.target)?qR(r.yt,e.target):KR(r.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function ZR(r){const e=WR({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Hx(e,e.limit,"L"):e}function tx(r,e){return new Ny(e.largestBatchId,Wx(r.yt,e.overlayMutation))}function mb(r,e){const t=e.path.lastSegment();return[r,Kn(e.path.popLast()),t]}function pb(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:gc(n.readTime),documentKey:Kn(n.documentKey.path),largestBatchId:n.largestBatchId}}class nW{getBundleMetadata(e,t){return gb(e).get(t).next((n=>{if(n)return(function(s){return{id:s.bundleId,createTime:_c(s.createTime),version:s.version}})(n)}))}saveBundleMetadata(e,t){return gb(e).put((function(i){return{bundleId:i.id,createTime:gc(ni(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return _b(e).get(t).next((n=>{if(n)return(function(s){return{name:s.name,query:ZR(s.bundledQuery),readTime:_c(s.readTime)}})(n)}))}saveNamedQuery(e,t){return _b(e).put((function(i){return{name:i.name,readTime:gc(ni(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function gb(r){return hn(r,sg)}function _b(r){return hn(r,og)}class _g{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new _g(e,n)}getOverlay(e,t){return ph(e).get(mb(this.userId,t)).next((n=>n?tx(this.serializer,n):null))}getOverlays(e,t){const n=Ja();return ce.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&n.set(i,s)})))).next((()=>n))}saveOverlays(e,t,n){const i=[];return n.forEach(((s,l)=>{const u=new Ny(t,l);i.push(this.St(e,u))})),ce.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach((l=>i.add(Kn(l.getCollectionPath()))));const s=[];return i.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,n+1],!1,!0);s.push(ph(e).Z(Mx,u))})),ce.waitFor(s)}getOverlaysForCollection(e,t,n){const i=Ja(),s=Kn(t),l=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ph(e).J(Mx,l).next((u=>{for(const f of u){const d=tx(this.serializer,f);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,n,i){const s=Ja();let l;const u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ph(e).ee({index:rR,range:u},((f,d,m)=>{const _=tx(this.serializer,d);s.size()<i||_.largestBatchId===l?(s.set(_.getKey(),_),l=_.largestBatchId):m.done()})).next((()=>s))}St(e,t){return ph(e).put((function(i,s,l){const[u,f,d]=mb(s,l.mutation.key);return{userId:s,collectionPath:f,documentId:d,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Dp(i.yt,l.mutation)}})(this.serializer,this.userId,t))}}function ph(r){return hn(r,lg)}class iW{bt(e){return hn(e,Ty)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const n=t?.value;return n?an.fromUint8Array(n):an.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class zl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ar(e.integerValue));else if("doubleValue"in e){const n=Ar(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),x0(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=Us(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(zs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?mR(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ug(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Je(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const i of Object.keys(n))this.Ot(i,t),this.Ct(n[i],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const i=Zu,s=n[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ar(s)),this.Ot(i,t),this.Ct(n[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const i of n)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Ke.fromName(e).path.forEach((n=>{this.Ft(t,60),this.Ut(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}zl.Kt=new zl;const yu=255;function aW(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function xb(r){const e=64-(function(n){let i=0;for(let s=0;s<8;++s){const l=aW(255&n[s]);if(i+=l,l!==8)break}return i})(r);return Math.ceil(e/8)}class sW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),n=xb(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),n=xb(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(yu),this.sn(255)}_n(){this.an(yu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,s,!1),new Uint8Array(l.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===yu?(this.sn(yu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===yu?(this.an(yu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class oW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class lW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class gh{constructor(){this.cn=new sW,this.ln=new oW(this.cn),this.hn=new lW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class jl{constructor(e,t,n,i){this.Tn=e,this.In=t,this.En=n,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new jl(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:$m(this.En),directionalValue:$m(this.dn),orderedDocumentKey:$m(t),documentKey:n.path.toArray()}}Vn(e,t,n){const i=this.Rn(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Co(r,e){let t=r.Tn-e.Tn;return t!==0?t:(t=vb(r.En,e.En),t!==0?t:(t=vb(r.dn,e.dn),t!==0?t:Ke.comparator(r.In,e.In)))}function vb(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function $m(r){return bC()?(function(t){let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return n})(r):r}function yb(r){return typeof r!="string"?r:(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(r)}class Eb{constructor(e){this.mn=new sr(((t,n)=>kr.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const n=t;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(tt(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Ox(e);if(t!==void 0&&!this.wn(t))return!1;const n=Ml(e);let i=new Set,s=0,l=0;for(;s<n.length&&this.wn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!i.has(u.field.canonicalString())){const f=n[s];if(!this.Sn(u,f)||!this.bn(this.fn[l++],f))return!1}++s}for(;s<n.length;++s){const u=n[s];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let e=new sr(kr.comparator);const t=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new jm(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new jm(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new jm(n.field,n.dir==="asc"?0:1)));return new Tp(Tp.UNKNOWN_ID,this.collectionId,t,_0.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function eD(r){if(tt(r instanceof Mt||r instanceof hr,20012),r instanceof Mt){if(r instanceof wR){const t=r.value.arrayValue?.values?.map((n=>Mt.create(r.field,"==",n)))||[];return hr.create(t,"or")}return r}const e=r.filters.map((t=>eD(t)));return hr.create(e,r.op)}function cW(r){if(r.getFilters().length===0)return[];const e=$x(eD(r));return tt(tD(e),7391),Xx(e)||Yx(e)?[e]:e.getFilters()}function Xx(r){return r instanceof Mt}function Yx(r){return r instanceof hr&&ky(r)}function tD(r){return Xx(r)||Yx(r)||(function(t){if(t instanceof hr&&Ux(t)){for(const n of t.getFilters())if(!Xx(n)&&!Yx(n))return!1;return!0}return!1})(r)}function $x(r){if(tt(r instanceof Mt||r instanceof hr,34018),r instanceof Mt)return r;if(r.filters.length===1)return $x(r.filters[0]);const e=r.filters.map((n=>$x(n)));let t=hr.create(e,r.op);return t=Op(t),tD(t)?t:(tt(t instanceof hr,64498),tt(rf(t),40251),tt(t.filters.length>1,57927),t.filters.reduce(((n,i)=>Py(n,i))))}function Py(r,e){let t;return tt(r instanceof Mt||r instanceof hr,38388),tt(e instanceof Mt||e instanceof hr,25473),t=r instanceof Mt?e instanceof Mt?(function(i,s){return hr.create([i,s],"and")})(r,e):Tb(r,e):e instanceof Mt?Tb(e,r):(function(i,s){if(tt(i.filters.length>0&&s.filters.length>0,48005),rf(i)&&rf(s))return yR(i,s.getFilters());const l=Ux(i)?i:s,u=Ux(i)?s:i,f=l.filters.map((d=>Py(d,u)));return hr.create(f,"or")})(r,e),Op(t)}function Tb(r,e){if(rf(e))return yR(e,r.getFilters());{const t=e.filters.map((n=>Py(r,n)));return hr.create(t,"or")}}function Op(r){if(tt(r instanceof Mt||r instanceof hr,11850),r instanceof Mt)return r;const e=r.getFilters();if(e.length===1)return Op(e[0]);if(xR(r))return r;const t=e.map((i=>Op(i))),n=[];return t.forEach((i=>{i instanceof Mt?n.push(i):i instanceof hr&&(i.op===r.op?n.push(...i.filters):n.push(i))})),n.length===1?n[0]:hr.create(n,r.op)}class uW{constructor(){this.Cn=new My}addToCollectionParentIndex(e,t){return this.Cn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(Vi.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(Vi.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class My{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new sr(Yt.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new sr(Yt.comparator)).toArray()}}const wb="IndexedDbIndexManager",Dm=new Uint8Array(0);class fW{constructor(e,t){this.databaseId=t,this.vn=new My,this.Fn=new Ks((n=>pc(n)),((n,i)=>G0(n,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:n,parent:Kn(i)};return Sb(e).put(s)}return ce.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[G4(t),""],!1,!0);return Sb(e).J(i).next((s=>{for(const l of s){if(l.collectionId!==t)break;n.push(Qa(l.parent))}return n}))}addFieldIndex(e,t){const n=_h(e),i=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete i.indexId;const s=n.add(i);if(t.indexState){const l=Tu(e);return s.next((u=>{l.put(pb(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const n=_h(e),i=Tu(e),s=Eu(e);return n.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=_h(e),n=Eu(e),i=Tu(e);return t.Z().next((()=>n.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return ce.forEach(this.Mn(t),(n=>this.getIndexType(e,n).next((i=>{if(i===0||i===1){const s=new Eb(n).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const n=Eu(e);let i=!0;const s=new Map;return ce.forEach(this.Mn(t),(l=>this.xn(e,l).next((u=>{i&&(i=!!u),s.set(l,u)})))).next((()=>{if(i){let l=At();const u=[];return ce.forEach(s,((f,d)=>{Ve(wb,`Using index ${(function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map((W=>`${W.fieldPath}:${W.kind}`)).join(",")}`})(f)} to execute ${pc(t)}`);const m=(function(k,W){const ee=Ox(W);if(ee===void 0)return null;for(const X of Cp(k,ee.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null})(d,f),_=(function(k,W){const ee=new Map;for(const X of Ml(W))for(const A of Cp(k,X.fieldPath))switch(A.op){case"==":case"in":ee.set(X.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return ee.set(X.fieldPath.canonicalString(),A.value),Array.from(ee.values())}return null})(d,f),v=(function(k,W){const ee=[];let X=!0;for(const A of Ml(W)){const R=A.kind===0?tb(k,A.fieldPath,k.startAt):rb(k,A.fieldPath,k.startAt);ee.push(R.value),X&&(X=R.inclusive)}return new tf(ee,X)})(d,f),y=(function(k,W){const ee=[];let X=!0;for(const A of Ml(W)){const R=A.kind===0?rb(k,A.fieldPath,k.endAt):tb(k,A.fieldPath,k.endAt);ee.push(R.value),X&&(X=R.inclusive)}return new tf(ee,X)})(d,f),T=this.On(f,d,v),E=this.On(f,d,y),S=this.Nn(f,d,_),D=this.Bn(f.indexId,m,T,v.inclusive,E,y.inclusive,S);return ce.forEach(D,(U=>n.Y(U,t.limit).next((k=>{k.forEach((W=>{const ee=Ke.fromSegments(W.documentKey);l.has(ee)||(l=l.add(ee),u.push(ee))}))}))))})).next((()=>u))}return ce.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=cW(hr.create(e.filters,"and")).map((n=>jx(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,n,i,s,l,u){const f=(t!=null?t.length:1)*Math.max(n.length,s.length),d=f/(t!=null?t.length:1),m=[];for(let _=0;_<f;++_){const v=t?this.Ln(t[_/d]):Dm,y=this.kn(e,v,n[_%d],i),T=this.qn(e,v,s[_%d],l),E=u.map((S=>this.kn(e,v,S,!0)));m.push(...this.createRange(y,T,E))}return m}kn(e,t,n,i){const s=new jl(e,Ke.empty(),t,n);return i?s:s.An()}qn(e,t,n,i){const s=new jl(e,Ke.empty(),t,n);return i?s.An():s}xn(e,t){const n=new Eb(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let l=null;for(const u of s)n.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(e,t){let n=2;const i=this.Mn(t);return ce.forEach(i,(s=>this.xn(e,s).next((l=>{l?n!==0&&l.fields.length<(function(f){let d=new sr(kr.comparator),m=!1;for(const _ of f.filters)for(const v of _.getFlattenedFilters())v.field.isKeyField()||(v.op==="array-contains"||v.op==="array-contains-any"?m=!0:d=d.add(v.field));for(const _ of f.orderBy)_.field.isKeyField()||(d=d.add(_.field));return d.size+(m?1:0)})(s)&&(n=1):n=0})))).next((()=>(function(l){return l.limit!==null})(t)&&i.length>1&&n===2?1:n))}Qn(e,t){const n=new gh;for(const i of Ml(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const l=n.Pn(i.kind);zl.Kt.Dt(s,l)}return n.un()}Ln(e){const t=new gh;return zl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const n=new gh;return zl.Kt.Dt(Iy(this.databaseId,t),n.Pn((function(s){const l=Ml(s);return l.length===0?0:l[l.length-1].kind})(e))),n.un()}Nn(e,t,n){if(n===null)return[];let i=[];i.push(new gh);let s=0;for(const l of Ml(e)){const u=n[s++];for(const f of i)if(this.Un(t,l.fieldPath)&&S0(u))i=this.Kn(i,l,u);else{const d=f.Pn(l.kind);zl.Kt.Dt(u,d)}}return this.Wn(i)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){const i=[...e],s=[];for(const l of n.arrayValue.values||[])for(const u of i){const f=new gh;f.seed(u.un()),zl.Kt.Dt(l,f.Pn(t.kind)),s.push(f)}return s}Un(e,t){return!!e.filters.find((n=>n instanceof Mt&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=_h(e),i=Tu(e);return(t?n.J(Px,IDBKeyRange.bound(t,t)):n.J()).next((s=>{const l=[];return ce.forEach(s,(u=>i.get([u.indexId,this.uid]).next((f=>{l.push((function(m,_){const v=_?new _0(_.sequenceNumber,new Vi(_c(_.readTime),new Ke(Qa(_.documentKey)),_.largestBatchId)):_0.empty(),y=m.fields.map((([T,E])=>new jm(kr.fromServerFormat(T),E)));return new Tp(m.indexId,m.collectionGroup,y,v)})(u,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:dt(n.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const i=_h(e),s=Tu(e);return this.Gn(e).next((l=>i.J(Px,IDBKeyRange.bound(t,t)).next((u=>ce.forEach(u,(f=>s.put(pb(f.indexId,this.uid,l,n))))))))}updateIndexEntries(e,t){const n=new Map;return ce.forEach(t,((i,s)=>{const l=n.get(i.collectionGroup);return(l?ce.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next((u=>(n.set(i.collectionGroup,u),ce.forEach(u,(f=>this.zn(e,i,f).next((d=>{const m=this.jn(s,f);return d.isEqual(m)?ce.resolve():this.Jn(e,s,f,d,m)})))))))}))}Hn(e,t,n,i){return Eu(e).put(i.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,i){return Eu(e).delete(i.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){const i=Eu(e);let s=new sr(Co);return i.ee({index:tR,range:IDBKeyRange.only([n.indexId,this.uid,$m(this.$n(n,t))])},((l,u)=>{s=s.add(new jl(n.indexId,t,yb(u.arrayValue),yb(u.directionalValue)))})).next((()=>s))}jn(e,t){let n=new sr(Co);const i=this.Qn(t,e);if(i==null)return n;const s=Ox(t);if(s!=null){const l=e.data.field(s.fieldPath);if(S0(l))for(const u of l.arrayValue.values||[])n=n.add(new jl(t.indexId,e.key,this.Ln(u),i))}else n=n.add(new jl(t.indexId,e.key,Dm,i));return n}Jn(e,t,n,i,s){Ve(wb,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,d,m,_,v){const y=f.getIterator(),T=d.getIterator();let E=vu(y),S=vu(T);for(;E||S;){let D=!1,U=!1;if(E&&S){const k=m(E,S);k<0?U=!0:k>0&&(D=!0)}else E!=null?U=!0:D=!0;D?(_(S),S=vu(T)):U?(v(E),E=vu(y)):(E=vu(y),S=vu(T))}})(i,s,Co,(u=>{l.push(this.Hn(e,t,n,u))}),(u=>{l.push(this.Yn(e,t,n,u))})),ce.waitFor(l)}Gn(e){let t=1;return Tu(e).ee({index:eR,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((l,u)=>Co(l,u))).filter(((l,u,f)=>!u||Co(l,f[u-1])!==0));const i=[];i.push(e);for(const l of n){const u=Co(l,e),f=Co(l,t);if(u===0)i[0]=e.An();else if(u>0&&f<0)i.push(l),i.push(l.An());else if(f>0)break}i.push(t);const s=[];for(let l=0;l<i.length;l+=2){if(this.Zn(i[l],i[l+1]))return[];const u=i[l].Vn(this.uid,Dm,Ke.empty()),f=i[l+1].Vn(this.uid,Dm,Ke.empty());s.push(IDBKeyRange.bound(u,f))}return s}Zn(e,t){return Co(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ab)}getMinOffset(e,t){return ce.mapArray(this.Mn(t),(n=>this.xn(e,n).next((i=>i||Je(44426))))).next(Ab)}}function Sb(r){return hn(r,E0)}function Eu(r){return hn(r,Xh)}function _h(r){return hn(r,Ey)}function Tu(r){return hn(r,Wh)}function Ab(r){tt(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;xy(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Vi(e.readTime,e.documentKey,t)}const bb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rD=41943040;class Bn{static withCacheSize(e){return new Bn(e,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function nD(r,e,t){const n=r.store(Aa),i=r.store(Yu),s=[],l=IDBKeyRange.only(t.batchId);let u=0;const f=n.ee({range:l},((m,_,v)=>(u++,v.delete())));s.push(f.next((()=>{tt(u===1,47070,{batchId:t.batchId})})));const d=[];for(const m of t.mutations){const _=Q4(e,m.key.path,t.batchId);s.push(i.delete(_)),d.push(m.key)}return ce.waitFor(s).next((()=>d))}function Fp(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Je(14731);e=r.noDocument}return JSON.stringify(e).length}Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(rD,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);class xg{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Xn={}}static wt(e,t,n,i){tt(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new xg(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ro(e).ee({index:Gl,range:n},((i,s,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,n,i){const s=Cu(e),l=Ro(e);return l.add({}).next((u=>{tt(typeof u=="number",49019);const f=new Ry(u,t,n,i),d=(function(y,T,E){const S=E.baseMutations.map((U=>Dp(y.yt,U))),D=E.mutations.map((U=>Dp(y.yt,U)));return{userId:T,batchId:E.batchId,localWriteTimeMs:E.localWriteTime.toMillis(),baseMutations:S,mutations:D}})(this.serializer,this.userId,f),m=[];let _=new sr(((v,y)=>dt(v.canonicalString(),y.canonicalString())));for(const v of i){const y=Q4(this.userId,v.key.path,u);_=_.add(v.key.path.popLast()),m.push(l.put(d)),m.push(s.put(y,Vq))}return _.forEach((v=>{m.push(this.indexManager.addToCollectionParentIndex(e,v))})),e.addOnCommittedListener((()=>{this.Xn[u]=f.keys()})),ce.waitFor(m).next((()=>f))}))}lookupMutationBatch(e,t){return Ro(e).get(t).next((n=>n?(tt(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Ul(this.serializer,n)):null))}er(e,t){return this.Xn[t]?ce.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const i=n.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Ro(e).ee({index:Gl,range:i},((l,u,f)=>{u.userId===this.userId&&(tt(u.batchId>=n,47524,{tr:n}),s=Ul(this.serializer,u)),f.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=$l;return Ro(e).ee({index:Gl,range:t,reverse:!0},((i,s,l)=>{n=s.batchId,l.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,$l],[this.userId,Number.POSITIVE_INFINITY]);return Ro(e).J(Gl,t).next((n=>n.map((i=>Ul(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Hm(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return Cu(e).ee({range:i},((l,u,f)=>{const[d,m,_]=l,v=Qa(m);if(d===this.userId&&t.path.isEqual(v))return Ro(e).get(_).next((y=>{if(!y)throw Je(61480,{nr:l,batchId:_});tt(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:_}),s.push(Ul(this.serializer,y))}));f.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new sr(dt);const i=[];return t.forEach((s=>{const l=Hm(this.userId,s.path),u=IDBKeyRange.lowerBound(l),f=Cu(e).ee({range:u},((d,m,_)=>{const[v,y,T]=d,E=Qa(y);v===this.userId&&s.path.isEqual(E)?n=n.add(T):_.done()}));i.push(f)})),ce.waitFor(i).next((()=>this.rr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=Hm(this.userId,n),l=IDBKeyRange.lowerBound(s);let u=new sr(dt);return Cu(e).ee({range:l},((f,d,m)=>{const[_,v,y]=f,T=Qa(v);_===this.userId&&n.isPrefixOf(T)?T.length===i&&(u=u.add(y)):m.done()})).next((()=>this.rr(e,u)))}rr(e,t){const n=[],i=[];return t.forEach((s=>{i.push(Ro(e).get(s).next((l=>{if(l===null)throw Je(35274,{batchId:s});tt(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:s}),n.push(Ul(this.serializer,l))})))})),ce.waitFor(i).next((()=>n))}removeMutationBatch(e,t){return nD(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ce.forEach(n,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ce.resolve();const n=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),i=[];return Cu(e).ee({range:n},((s,l,u)=>{if(s[0]===this.userId){const f=Qa(s[1]);i.push(f)}else u.done()})).next((()=>{tt(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return iD(e,this.userId,t)}_r(e){return aD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:$l,lastStreamToken:""}))}}function iD(r,e,t){const n=Hm(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let l=!1;return Cu(r).ee({range:s,X:!0},((u,f,d)=>{const[m,_,v]=u;m===e&&_===i&&(l=!0),d.done()})).next((()=>l))}function Ro(r){return hn(r,Aa)}function Cu(r){return hn(r,Yu)}function aD(r){return hn(r,v0)}class xc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xc(0)}static cr(){return new xc(-1)}}class hW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const n=new xc(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>st.fromTimestamp(new ir(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>wu(e).delete(t.targetId))).next((()=>this.lr(e))).next((n=>(tt(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n))))}removeTargets(e,t,n){let i=0;const s=[];return wu(e).ee(((l,u)=>{const f=Rh(u);f.sequenceNumber<=t&&n.get(f.targetId)===null&&(i++,s.push(this.removeTargetData(e,f)))})).next((()=>ce.waitFor(s))).next((()=>i))}forEachTarget(e,t){return wu(e).ee(((n,i)=>{const s=Rh(i);t(s)}))}lr(e){return Ib(e).get(Ap).next((t=>(tt(t!==null,2888),t)))}hr(e,t){return Ib(e).put(Ap,t)}Pr(e,t){return wu(e).put(JR(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const n=pc(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return wu(e).ee({range:i,index:Z4},((l,u,f)=>{const d=Rh(u);G0(t,d.target)&&(s=d,f.done())})).next((()=>s))}addMatchingKeys(e,t,n){const i=[],s=Mo(e);return t.forEach((l=>{const u=Kn(l.path);i.push(s.put({targetId:n,path:u})),i.push(this.referenceDelegate.addReference(e,n,l))})),ce.waitFor(i)}removeMatchingKeys(e,t,n){const i=Mo(e);return ce.forEach(t,(s=>{const l=Kn(s.path);return ce.waitFor([i.delete([n,l]),this.referenceDelegate.removeReference(e,n,s)])}))}removeMatchingKeysForTargetId(e,t){const n=Mo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Mo(e);let s=At();return i.ee({range:n,X:!0},((l,u,f)=>{const d=Qa(l[1]),m=new Ke(d);s=s.add(m)})).next((()=>s))}containsKey(e,t){const n=Kn(t.path),i=IDBKeyRange.bound([n],[G4(n)],!1,!0);let s=0;return Mo(e).ee({index:yy,X:!0,range:i},(([l,u],f,d)=>{l!==0&&(s++,d.done())})).next((()=>s>0))}At(e,t){return wu(e).get(t).next((n=>n?Rh(n):null))}}function wu(r){return hn(r,$u)}function Ib(r){return hn(r,Ql)}function Mo(r){return hn(r,Qu)}const kb="LruGarbageCollector",dW=1048576;function Cb([r,e],[t,n]){const i=dt(r,t);return i===0?dt(e,n):i}class mW{constructor(e){this.Ir=e,this.buffer=new sr(Cb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Cb(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sD{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ve(kb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ol(t)?Ve(kb,"Ignoring IndexedDB error during garbage collection: ",t):await Cc(t)}await this.Vr(3e5)}))}}class pW{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(sa.ce);const n=new mW(t);return this.mr.forEachTarget(e,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ve("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(bb)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bb):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,i,s,l,u,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(Ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,l=Date.now(),this.nthSequenceNumber(e,i)))).next((_=>(n=_,u=Date.now(),this.removeTargets(e,n,t)))).next((_=>(s=_,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((_=>(d=Date.now(),Au()<=Ot.DEBUG&&Ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${i} in `+(u-l)+`ms
	Removed ${s} targets in `+(f-u)+`ms
	Removed ${_} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:_}))))}}function oD(r,e){return new pW(r,e)}class gW{constructor(e,t){this.db=e,this.garbageCollector=oD(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((n,i)=>t(i)))}addReference(e,t,n){return Nm(e,n)}removeReference(e,t,n){return Nm(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Nm(e,t)}br(e,t){return(function(i,s){let l=!1;return aD(i).te((u=>iD(i,u,s).next((f=>(f&&(l=!0),ce.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((l,u)=>{if(u<=t){const f=this.br(e,l).next((d=>{if(!d)return s++,n.getEntry(e,l).next((()=>(n.removeEntry(l,st.min()),Mo(e).delete((function(_){return[0,Kn(_.path)]})(l)))))}));i.push(f)}})).next((()=>ce.waitFor(i))).next((()=>n.apply(e))).next((()=>s))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Nm(e,t)}Sr(e,t){const n=Mo(e);let i,s=sa.ce;return n.ee({index:yy},(([l,u],{path:f,sequenceNumber:d})=>{l===0?(s!==sa.ce&&t(new Ke(Qa(i)),s),s=d,i=f):s=sa.ce})).next((()=>{s!==sa.ce&&t(new Ke(Qa(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Nm(r,e){return Mo(r).put((function(n,i){return{targetId:0,path:Kn(n.path),sequenceNumber:i}})(e,r.currentSequenceNumber))}class lD{constructor(){this.changes=new Ks((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class _W{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Fl(e).put(n)}removeEntry(e,t,n){return Fl(e).delete((function(s,l){const u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Np(l),u[u.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Dr(e,n))))}getEntry(e,t){let n=Fr.newInvalidDocument(t);return Fl(e).ee({index:Gm,range:IDBKeyRange.only(xh(t))},((i,s)=>{n=this.Cr(t,s)})).next((()=>n))}vr(e,t){let n={size:0,document:Fr.newInvalidDocument(t)};return Fl(e).ee({index:Gm,range:IDBKeyRange.only(xh(t))},((i,s)=>{n={document:this.Cr(t,s),size:Fp(s)}})).next((()=>n))}getEntries(e,t){let n=Di();return this.Fr(e,t,((i,s)=>{const l=this.Cr(i,s);n=n.insert(i,l)})).next((()=>n))}Mr(e,t){let n=Di(),i=new br(Ke.comparator);return this.Fr(e,t,((s,l)=>{const u=this.Cr(s,l);n=n.insert(s,u),i=i.insert(s,Fp(l))})).next((()=>({documents:n,Or:i})))}Fr(e,t,n){if(t.isEmpty())return ce.resolve();let i=new sr(Nb);t.forEach((f=>i=i.add(f)));const s=IDBKeyRange.bound(xh(i.first()),xh(i.last())),l=i.getIterator();let u=l.getNext();return Fl(e).ee({index:Gm,range:s},((f,d,m)=>{const _=Ke.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;u&&Nb(u,_)<0;)n(u,null),u=l.getNext();u&&u.isEqual(_)&&(n(u,d),u=l.hasNext()?l.getNext():null),u?m.j(xh(u)):m.done()})).next((()=>{for(;u;)n(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,n,i,s){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),Np(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fl(e).J(IDBKeyRange.bound(u,f,!0)).next((d=>{s?.incrementDocumentReadCount(d.length);let m=Di();for(const _ of d){const v=this.Cr(Ke.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);v.isFoundDocument()&&(q0(t,v)||i.has(v.key))&&(m=m.insert(v.key,v))}return m}))}getAllFromCollectionGroup(e,t,n,i){let s=Di();const l=Db(t,n),u=Db(t,Vi.max());return Fl(e).ee({index:J4,range:IDBKeyRange.bound(l,u,!0)},((f,d,m)=>{const _=this.Cr(Ke.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(_.key,_),s.size===i&&m.done()})).next((()=>s))}newChangeBuffer(e){return new xW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Rb(e).get(Fx).next((t=>(tt(!!t,20021),t)))}Dr(e,t){return Rb(e).put(Fx,t)}Cr(e,t){if(t){const n=rW(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(st.min())))return n}return Fr.newInvalidDocument(e)}}function cD(r){return new _W(r)}class xW extends lD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ks((n=>n.toString()),((n,i)=>n.isEqual(i)))}applyChanges(e){const t=[];let n=0,i=new sr(((s,l)=>dt(s.canonicalString(),l.canonicalString())));return this.changes.forEach(((s,l)=>{const u=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,u.readTime)),l.isValidDocument()){const f=db(this.Nr.serializer,l);i=i.add(s.path.popLast());const d=Fp(f);n+=d-u.size,t.push(this.Nr.addEntry(e,s,f))}else if(n-=u.size,this.trackRemovals){const f=db(this.Nr.serializer,l.convertToNoDocument(st.min()));t.push(this.Nr.addEntry(e,s,f))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,n)),ce.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((n=>(this.Br.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:n,Or:i})=>(i.forEach(((s,l)=>{this.Br.set(s,{size:l,readTime:n.get(s).readTime})})),n)))}}function Rb(r){return hn(r,y0)}function Fl(r){return hn(r,Sp)}function xh(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Db(r,e){const t=e.documentKey.path.toArray();return[r,Np(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Nb(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=dt(t[s],n[s]),i)return i;return i=dt(t.length,n.length),i||(i=dt(t[t.length-2],n[n.length-2]),i||dt(t[t.length-1],n[n.length-1]))}class vW{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class uD{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(n!==null&&Jh(n.mutation,i,mi.empty(),ir.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,At()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=At()){const i=Ja();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((s=>{let l=kh();return s.forEach(((u,f)=>{l=l.insert(u,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const n=Ja();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,At())))}populateOverlays(e,t,n){const i=[];return n.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,n,i){let s=Di();const l=Qh(),u=(function(){return Qh()})();return t.forEach(((f,d)=>{const m=n.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof Ws)?s=s.insert(d.key,d):m!==void 0?(l.set(d.key,m.mutation.getFieldMask()),Jh(m.mutation,d,m.mutation.getFieldMask(),ir.now())):l.set(d.key,mi.empty())})),this.recalculateAndSaveOverlays(e,s).next((f=>(f.forEach(((d,m)=>l.set(d,m))),t.forEach(((d,m)=>u.set(d,new vW(m,l.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,t){const n=Qh();let i=new br(((l,u)=>l-u)),s=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((f=>{const d=t.get(f);if(d===null)return;let m=n.get(f)||mi.empty();m=u.applyToLocalView(d,m),n.set(f,m);const _=(i.get(u.batchId)||At()).add(f);i=i.insert(u.batchId,_)}))})).next((()=>{const l=[],u=i.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,m=f.value,_=kR();m.forEach((v=>{if(!s.has(v)){const y=FR(t.get(v),n.get(v));y!==null&&_.set(v,y),s=s.add(v)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,_))}return ce.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,i){return(function(l){return Ke.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):EK(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((s=>{const l=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ce.resolve(Ja());let u=g0,f=s;return l.next((d=>ce.forEach(d,((m,_)=>(u<_.largestBatchId&&(u=_.largestBatchId),s.get(m)?ce.resolve():this.remoteDocumentCache.getEntry(e,m).next((v=>{f=f.insert(m,v)}))))).next((()=>this.populateOverlays(e,d,s))).next((()=>this.computeViews(e,f,d,At()))).next((m=>({batchId:u,changes:IR(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ke(t)).next((n=>{let i=kh();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let l=kh();return this.indexManager.getCollectionParents(e,s).next((u=>ce.forEach(u,(f=>{const d=(function(_,v){return new fg(v,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next((m=>{m.forEach(((_,v)=>{l=l.insert(_,v)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i)))).next((l=>{s.forEach(((f,d)=>{const m=d.getKey();l.get(m)===null&&(l=l.insert(m,Fr.newInvalidDocument(m)))}));let u=kh();return l.forEach(((f,d)=>{const m=s.get(f);m!==void 0&&Jh(m.mutation,d,mi.empty(),ir.now()),q0(t,d)&&(u=u.insert(f,d))})),u}))}}class yW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ce.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:ni(i.createTime)}})(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:ZR(i.bundledQuery),readTime:ni(i.readTime)}})(t)),ce.resolve()}}class EW{constructor(){this.overlays=new br(Ke.comparator),this.qr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ja();return ce.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&n.set(i,s)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((i,s)=>{this.St(e,t,s)})),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=Ja(),s=t.length+1,l=new Ke(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&f.largestBatchId>n&&i.set(f.getKey(),f)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new br(((d,m)=>d-m));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let m=s.get(d.largestBatchId);m===null&&(m=Ja(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=Ja(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,m)=>u.set(d,m))),!(u.size()>=i)););return ce.resolve(u)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new Ny(t,n));let s=this.qr.get(t);s===void 0&&(s=At(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class TW{constructor(){this.sessionToken=an.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}class Ly{constructor(){this.Qr=new sr(_n.$r),this.Ur=new sr(_n.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new _n(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new _n(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new Ke(new Yt([])),n=new _n(t,e),i=new _n(t,e+1),s=[];return this.Ur.forEachInRange([n,i],(l=>{this.Gr(l),s.push(l.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ke(new Yt([])),n=new _n(t,e),i=new _n(t,e+1);let s=At();return this.Ur.forEachInRange([n,i],(l=>{s=s.add(l.key)})),s}containsKey(e){const t=new _n(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class _n{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ke.comparator(e.key,t.key)||dt(e.Yr,t.Yr)}static Kr(e,t){return dt(e.Yr,t.Yr)||Ke.comparator(e.key,t.key)}}class wW{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new sr(_n.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Ry(s,t,n,i);this.mutationQueue.push(l);for(const u of i)this.Zr=this.Zr.add(new _n(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ce.resolve(l)}lookupMutationBatch(e,t){return ce.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ei(n),s=i<0?0:i;return ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?$l:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new _n(t,0),i=new _n(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,i],(l=>{const u=this.Xr(l.Yr);s.push(u)})),ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new sr(dt);return t.forEach((i=>{const s=new _n(i,0),l=new _n(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,l],(u=>{n=n.add(u.Yr)}))})),ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;Ke.isDocumentKey(s)||(s=s.child(""));const l=new _n(new Ke(s),0);let u=new sr(dt);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(u=u.add(f.Yr)),!0)}),l),ce.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((n=>{const i=this.Xr(n);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){tt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ce.forEach(t.mutations,(i=>{const s=new _n(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new _n(t,0),i=this.Zr.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class SW{constructor(e){this.ri=e,this.docs=(function(){return new br(Ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():Fr.newInvalidDocument(t))}getEntries(e,t){let n=Di();return t.forEach((i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Fr.newInvalidDocument(i))})),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Di();const l=t.path,u=new Ke(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||xy(W4(m),n)<=0||(i.has(m.key)||q0(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return ce.resolve(s)}getAllFromCollectionGroup(e,t,n,i){Je(9500)}ii(e,t){return ce.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new AW(this)}getSize(e){return ce.resolve(this.size)}}class AW extends lD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)})),ce.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class bW{constructor(e){this.persistence=e,this.si=new Ks((t=>pc(t)),G0),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.oi=0,this._i=new Ly,this.targetCount=0,this.ai=xc.ur()}forEachTarget(e,t){return this.si.forEach(((n,i)=>t(i))),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ce.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new xc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Pr(t),ce.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.si.delete(l),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),ce.waitFor(s).next((()=>i))}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((l=>{s.push(i.markPotentiallyOrphaned(e,l))})),ce.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this._i.containsKey(t))}}class Vy{constructor(e,t){this.ui={},this.overlays={},this.ci=new sa(0),this.li=!1,this.li=!0,this.hi=new TW,this.referenceDelegate=e(this),this.Pi=new bW(this),this.indexManager=new uW,this.remoteDocumentCache=(function(i){return new SW(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new QR(t),this.Ii=new yW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new EW,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new wW(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Ve("MemoryPersistence","Starting transaction:",e);const i=new IW(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return ce.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class IW extends Y4{constructor(e){super(),this.currentSequenceNumber=e}}class vg{constructor(e){this.persistence=e,this.Ri=new Ly,this.Vi=null}static mi(e){return new vg(e)}get fi(){if(this.Vi)return this.Vi;throw Je(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,(n=>{const i=Ke.fromPath(n);return this.gi(e,i).next((s=>{s||t.removeEntry(i,st.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ce.or([()=>ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Pp{constructor(e,t){this.persistence=e,this.pi=new Ks((n=>Kn(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=oD(this,t)}static mi(e,t){return new Pp(e,t)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return ce.forEach(this.pi,((n,i)=>this.br(e,n,i).next((s=>s?ce.resolve():t(i)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(l=>this.br(e,l,t).next((u=>{u||(n++,s.removeEntry(l,st.min()))})))).next((()=>s.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Km(e.data.value)),t}br(e,t,n){return ce.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return ce.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class kW{constructor(e){this.serializer=e}k(e,t,n,i){const s=new ig("createOrUpgrade",t);n<1&&i>=1&&((function(f){f.createObjectStore(H0)})(e),(function(f){f.createObjectStore(v0,{keyPath:Lq}),f.createObjectStore(Aa,{keyPath:HA,autoIncrement:!0}).createIndex(Gl,GA,{unique:!0}),f.createObjectStore(Yu)})(e),Ob(e),(function(f){f.createObjectStore(Ll)})(e));let l=ce.resolve();return n<3&&i>=3&&(n!==0&&((function(f){f.deleteObjectStore(Qu),f.deleteObjectStore($u),f.deleteObjectStore(Ql)})(e),Ob(e)),l=l.next((()=>(function(f){const d=f.store(Ql),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:st.min().toTimestamp(),targetCount:0};return d.put(Ap,m)})(s)))),n<4&&i>=4&&(n!==0&&(l=l.next((()=>(function(f,d){return d.store(Aa).J().next((_=>{f.deleteObjectStore(Aa),f.createObjectStore(Aa,{keyPath:HA,autoIncrement:!0}).createIndex(Gl,GA,{unique:!0});const v=d.store(Aa),y=_.map((T=>v.put(T)));return ce.waitFor(y)}))})(e,s)))),l=l.next((()=>{(function(f){f.createObjectStore(Ju,{keyPath:Kq})})(e)}))),n<5&&i>=5&&(l=l.next((()=>this.yi(s)))),n<6&&i>=6&&(l=l.next((()=>((function(f){f.createObjectStore(y0)})(e),this.wi(s))))),n<7&&i>=7&&(l=l.next((()=>this.Si(s)))),n<8&&i>=8&&(l=l.next((()=>this.bi(e,s)))),n<9&&i>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&i>=10&&(l=l.next((()=>this.Di(s)))),n<11&&i>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(sg,{keyPath:Wq})})(e),(function(f){f.createObjectStore(og,{keyPath:Xq})})(e)}))),n<12&&i>=12&&(l=l.next((()=>{(function(f){const d=f.createObjectStore(lg,{keyPath:tK});d.createIndex(Mx,rK,{unique:!1}),d.createIndex(rR,nK,{unique:!1})})(e)}))),n<13&&i>=13&&(l=l.next((()=>(function(f){const d=f.createObjectStore(Sp,{keyPath:Bq});d.createIndex(Gm,Uq),d.createIndex(J4,zq)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ll)))),n<14&&i>=14&&(l=l.next((()=>this.Fi(e,s)))),n<15&&i>=15&&(l=l.next((()=>(function(f){f.createObjectStore(Ey,{keyPath:Yq,autoIncrement:!0}).createIndex(Px,$q,{unique:!1}),f.createObjectStore(Wh,{keyPath:Qq}).createIndex(eR,Jq,{unique:!1}),f.createObjectStore(Xh,{keyPath:Zq}).createIndex(tR,eK,{unique:!1})})(e)))),n<16&&i>=16&&(l=l.next((()=>{t.objectStore(Wh).clear()})).next((()=>{t.objectStore(Xh).clear()}))),n<17&&i>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(Ty,{keyPath:iK})})(e)}))),n<18&&i>=18&&bC()&&(l=l.next((()=>{t.objectStore(Wh).clear()})).next((()=>{t.objectStore(Xh).clear()}))),l}wi(e){let t=0;return e.store(Ll).ee(((n,i)=>{t+=Fp(i)})).next((()=>{const n={byteSize:t};return e.store(y0).put(Fx,n)}))}yi(e){const t=e.store(v0),n=e.store(Aa);return t.J().next((i=>ce.forEach(i,(s=>{const l=IDBKeyRange.bound([s.userId,$l],[s.userId,s.lastAcknowledgedBatchId]);return n.J(Gl,l).next((u=>ce.forEach(u,(f=>{tt(f.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const d=Ul(this.serializer,f);return nD(e,s.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(Qu),n=e.store(Ll);return e.store(Ql).get(Ap).next((i=>{const s=[];return n.ee(((l,u)=>{const f=new Yt(l),d=(function(_){return[0,Kn(_)]})(f);s.push(t.get(d).next((m=>m?ce.resolve():(_=>t.put({targetId:0,path:Kn(_),sequenceNumber:i.highestListenSequenceNumber}))(f))))})).next((()=>ce.waitFor(s)))}))}bi(e,t){e.createObjectStore(E0,{keyPath:qq});const n=t.store(E0),i=new My,s=l=>{if(i.add(l)){const u=l.lastSegment(),f=l.popLast();return n.put({collectionId:u,parent:Kn(f)})}};return t.store(Ll).ee({X:!0},((l,u)=>{const f=new Yt(l);return s(f.popLast())})).next((()=>t.store(Yu).ee({X:!0},(([l,u,f],d)=>{const m=Qa(u);return s(m.popLast())}))))}Di(e){const t=e.store($u);return t.ee(((n,i)=>{const s=Rh(i),l=JR(this.serializer,s);return t.put(l)}))}Ci(e,t){const n=t.store(Ll),i=[];return n.ee(((s,l)=>{const u=t.store(Sp),f=(function(_){return _.document?new Ke(Yt.fromString(_.document.name).popFirst(5)):_.noDocument?Ke.fromSegments(_.noDocument.path):_.unknownDocument?Ke.fromSegments(_.unknownDocument.path):Je(36783)})(l).path.toArray(),d={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(u.put(d))})).next((()=>ce.waitFor(i)))}Fi(e,t){const n=t.store(Aa),i=cD(this.serializer),s=new Vy(vg.mi,this.serializer.yt);return n.J().next((l=>{const u=new Map;return l.forEach((f=>{let d=u.get(f.userId)??At();Ul(this.serializer,f).keys().forEach((m=>d=d.add(m))),u.set(f.userId,d)})),ce.forEach(u,((f,d)=>{const m=new kn(d),_=_g.wt(this.serializer,m),v=s.getIndexManager(m),y=xg.wt(m,this.serializer,v,s.referenceDelegate);return new uD(i,y,_,v).recalculateAndSaveOverlaysForDocumentKeys(new Lx(t,sa.ce),f).next()}))}))}}function Ob(r){r.createObjectStore(Qu,{keyPath:Hq}).createIndex(yy,Gq,{unique:!0}),r.createObjectStore($u,{keyPath:"targetId"}).createIndex(Z4,jq,{unique:!0}),r.createObjectStore(Ql)}const Do="IndexedDbPersistence",rx=18e5,nx=5e3,ix="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",CW="main";class By{constructor(e,t,n,i,s,l,u,f,d,m,_=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=s,this.window=l,this.document=u,this.xi=d,this.Oi=m,this.Ni=_,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=v=>Promise.resolve(),!By.v())throw new Xe(Ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gW(this,i),this.$i=t+CW,this.serializer=new QR(f),this.Ui=new Ko(this.$i,this.Ni,new kW(this.serializer)),this.hi=new iW,this.Pi=new hW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cD(this.serializer),this.Ii=new nW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,m===!1&&ti(Do,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Xe(Ce.FAILED_PRECONDITION,ix);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new sa(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Om(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(ol(e))return Ve(Do,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ve(Do,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return vh(e).get(xu).next((t=>ce.resolve(this.es(t))))}ts(e){return Om(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,rx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=hn(t,Ju);return n.J().next((i=>{const s=this.ss(i,rx),l=i.filter((u=>s.indexOf(u)===-1));return ce.forEach(l,(u=>n.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ce.resolve(!0):vh(e).get(xu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,nx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Xe(Ce.FAILED_PRECONDITION,ix);return!1}}return!(!this.networkEnabled||!this.inForeground)||Om(e).J().next((n=>this.ss(n,nx).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(s||l&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ve(Do,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[H0,Ju],(e=>{const t=new Lx(e,sa.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((n=>this.rs(n.updateTimeMs,t)&&!this.us(n.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Om(e).J().next((t=>this.ss(t,rx).map((n=>n.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return xg.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return _g.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){Ve(Do,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(f){return f===18?oK:f===17?sR:f===16?sK:f===15?wy:f===14?aR:f===13?iR:f===12?aK:f===11?nR:void Je(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,i,s,(u=>(l=new Lx(u,this.ci?this.ci.next():sa.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw ti(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Xe(Ce.FAILED_PRECONDITION,X4);return n(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>n(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(e){return vh(e).get(xu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,nx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Xe(Ce.FAILED_PRECONDITION,ix)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vh(e).put(xu,t)}static v(){return Ko.v()}Zi(e){const t=vh(e);return t.get(xu).next((n=>this.es(n)?(Ve(Do,"Releasing primary lease."),t.delete(xu)):ce.resolve()))}rs(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(ti(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;AC()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ve(Do,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ti(Do,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ti("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vh(r){return hn(r,H0)}function Om(r){return hn(r,Ju)}function RW(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}class Uy{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=i}static As(e,t){let n=At(),i=At();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Uy(e,t.fromCache,n,i)}}class DW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class fD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return AC()?8:$4(fn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ys(e,t).next((l=>{s.result=l})).next((()=>{if(!s.result)return this.ws(e,t,i,n).next((l=>{s.result=l}))})).next((()=>{if(s.result)return;const l=new DW;return this.Ss(e,t,l).next((u=>{if(s.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>s.result))}bs(e,t,n,i){return n.documentReadCount<this.fs?(Au()<=Ot.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",bu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Au()<=Ot.DEBUG&&Ve("QueryEngine","Query:",bu(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Au()<=Ot.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",bu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ca(t))):ce.resolve())}ys(e,t){if(nb(t))return ce.resolve(null);let n=ca(t);return this.indexManager.getIndexType(e,n).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Hx(t,null,"F"),n=ca(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((s=>{const l=At(...s);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const d=this.Ds(t,u);return this.Cs(t,d,l,f.readTime)?this.ys(e,Hx(t,null,"F")):this.vs(e,d,t,f)}))))})))))}ws(e,t,n,i){return nb(t)||i.isEqual(st.min())?ce.resolve(null):this.ps.getDocuments(e,n).next((s=>{const l=this.Ds(t,s);return this.Cs(t,l,n,i)?ce.resolve(null):(Au()<=Ot.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bu(t)),this.vs(e,l,t,Rq(i,g0)).next((u=>u)))}))}Ds(e,t){let n=new sr(AR(e));return t.forEach(((i,s)=>{q0(e,s)&&(n=n.add(s))})),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,n){return Au()<=Ot.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",bu(t)),this.ps.getDocumentsMatchingQuery(e,t,Vi.min(),n)}vs(e,t,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next((s=>(t.forEach((l=>{s=s.insert(l.key,l)})),s)))}}const zy="LocalStore",NW=3e8;class OW{constructor(e,t,n,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new br(dt),this.xs=new Ks((s=>pc(s)),G0),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function hD(r,e,t,n){return new OW(r,e,t,n)}async function dD(r,e){const t=mt(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((s=>{const l=[],u=[];let f=At();for(const d of i){l.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of s){u.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return t.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:u})))}))}))}function FW(r,e){const t=mt(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,d,m){const _=d.batch,v=_.keys();let y=ce.resolve();return v.forEach((T=>{y=y.next((()=>m.getEntry(f,T))).next((E=>{const S=d.docVersions.get(T);tt(S!==null,48541),E.version.compareTo(S)<0&&(_.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),m.addEntry(E)))}))})),y.next((()=>u.mutationQueue.removeMutationBatch(f,_)))})(t,n,e,s).next((()=>s.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=At();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(n,i)))}))}function mD(r){const e=mt(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function PW(r,e){const t=mt(r),n=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const u=[];e.targetChanges.forEach(((m,_)=>{const v=i.get(_);if(!v)return;u.push(t.Pi.removeMatchingKeys(s,m.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(s,m.addedDocuments,_))));let y=v.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(_)!==null?y=y.withResumeToken(an.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):m.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(m.resumeToken,n)),i=i.insert(_,y),(function(E,S,D){return E.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=NW?!0:D.addedDocuments.size+D.modifiedDocuments.size+D.removedDocuments.size>0})(v,y,m)&&u.push(t.Pi.updateTargetData(s,y))}));let f=Di(),d=At();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))})),u.push(MW(s,l,e.documentUpdates).next((m=>{f=m.ks,d=m.qs}))),!n.isEqual(st.min())){const m=t.Pi.getLastRemoteSnapshotVersion(s).next((_=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n)));u.push(m)}return ce.waitFor(u).next((()=>l.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,f,d))).next((()=>f))})).then((s=>(t.Ms=i,s)))}function MW(r,e,t){let n=At(),i=At();return t.forEach((s=>n=n.add(s))),e.getEntries(r,n).next((s=>{let l=Di();return t.forEach(((u,f)=>{const d=s.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),f.isNoDocument()&&f.version.isEqual(st.min())?(e.removeEntry(u,f.readTime),l=l.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),l=l.insert(u,f)):Ve(zy,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)})),{ks:l,qs:i}}))}function LW(r,e){const t=mt(r);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=$l),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function VW(r,e){const t=mt(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return t.Pi.getTargetData(n,e).next((s=>s?(i=s,ce.resolve(i)):t.Pi.allocateTargetId(n).next((l=>(i=new Os(e,l,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=t.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function Qx(r,e,t){const n=mt(r),i=n.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,(l=>n.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!ol(l))throw l;Ve(zy,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Fb(r,e,t){const n=mt(r);let i=st.min(),s=At();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,d,m){const _=mt(f),v=_.xs.get(m);return v!==void 0?ce.resolve(_.Ms.get(v)):_.Pi.getTargetData(d,m)})(n,l,ca(e)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((f=>{s=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,t?i:st.min(),t?s:At()))).next((u=>(BW(n,wK(e),u),{documents:u,Qs:s})))))}function BW(r,e,t){let n=r.Os.get(e)||st.min();t.forEach(((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)})),r.Os.set(e,n)}class Pb{constructor(){this.activeTargetIds=CK()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pD{constructor(){this.Mo=new Pb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Pb,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class UW{Oo(e){}shutdown(){}}const Mb="ConnectivityMonitor";class Lb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ve(Mb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ve(Mb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Fm=null;function Jx(){return Fm===null?Fm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fm++,"0x"+Fm.toString(16)}const ax="RestConnection",zW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class jW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===bp?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,t,n,i,s){const l=Jx(),u=this.zo(e,t.toUriEncodedString());Ve(ax,`Sending RPC '${e}' ${l}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,i,s);const{host:d}=new URL(u),m=hf(d);return this.Jo(e,u,f,n,m).then((_=>(Ve(ax,`Received RPC '${e}' ${l}: `,_),_)),(_=>{throw dc(ax,`RPC '${e}' ${l} failed with error: `,_,"url: ",u,"request:",n),_}))}Ho(e,t,n,i,s,l){return this.Go(e,t,n,i,s)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+pf})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),n&&n.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const n=zW[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class HW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ln="WebChannelConnection";class GW extends jW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,s){const l=Jx();return new Promise(((u,f)=>{const d=new L4;d.setWithCredentials(!0),d.listenOnce(V4.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case zm.NO_ERROR:const _=d.getResponseJson();Ve(Ln,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(_)),u(_);break;case zm.TIMEOUT:Ve(Ln,`RPC '${e}' ${l} timed out`),f(new Xe(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case zm.HTTP_ERROR:const v=d.getStatus();if(Ve(Ln,`RPC '${e}' ${l} failed with status:`,v,"response text:",d.getResponseText()),v>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const T=y?.error;if(T&&T.status&&T.message){const E=(function(D){const U=D.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(U)>=0?U:Ce.UNKNOWN})(T.status);f(new Xe(E,T.message))}else f(new Xe(Ce.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new Xe(Ce.UNAVAILABLE,"Connection failed."));break;default:Je(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ve(Ln,`RPC '${e}' ${l} completed.`)}}));const m=JSON.stringify(i);Ve(Ln,`RPC '${e}' ${l} sending request:`,i),d.send(t,"POST",m,n,15)}))}T_(e,t,n){const i=Jx(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=z4(),u=U4(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,n),f.encodeInitMessageHeaders=!0;const m=s.join("");Ve(Ln,`Creating RPC '${e}' stream ${i}: ${m}`,f);const _=l.createWebChannel(m,f);this.I_(_);let v=!1,y=!1;const T=new HW({Yo:S=>{y?Ve(Ln,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(v||(Ve(Ln,`Opening RPC '${e}' stream ${i} transport.`),_.open(),v=!0),Ve(Ln,`RPC '${e}' stream ${i} sending:`,S),_.send(S))},Zo:()=>_.close()}),E=(S,D,U)=>{S.listen(D,(k=>{try{U(k)}catch(W){setTimeout((()=>{throw W}),0)}}))};return E(_,Ih.EventType.OPEN,(()=>{y||(Ve(Ln,`RPC '${e}' stream ${i} transport opened.`),T.o_())})),E(_,Ih.EventType.CLOSE,(()=>{y||(y=!0,Ve(Ln,`RPC '${e}' stream ${i} transport closed`),T.a_(),this.E_(_))})),E(_,Ih.EventType.ERROR,(S=>{y||(y=!0,dc(Ln,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),T.a_(new Xe(Ce.UNAVAILABLE,"The operation could not be completed")))})),E(_,Ih.EventType.MESSAGE,(S=>{if(!y){const D=S.data[0];tt(!!D,16349);const U=D,k=U?.error||U[0]?.error;if(k){Ve(Ln,`RPC '${e}' stream ${i} received error:`,k);const W=k.status;let ee=(function(R){const C=Jr[R];if(C!==void 0)return LR(C)})(W),X=k.message;ee===void 0&&(ee=Ce.INTERNAL,X="Unknown error status: "+W+" with message "+k.message),y=!0,T.a_(new Xe(ee,X)),_.close()}else Ve(Ln,`RPC '${e}' stream ${i} received:`,D),T.u_(D)}})),E(u,B4.STAT_EVENT,(S=>{S.stat===Dx.PROXY?Ve(Ln,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Dx.NOPROXY&&Ve(Ln,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function qW(){return typeof window<"u"?window:null}function Qm(){return typeof document<"u"?document:null}function yg(r){return new KK(r,!0)}class gD{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&Ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Vb="PersistentStream";class _D{constructor(e,t,n,i,s,l,u,f){this.Mi=e,this.S_=n,this.b_=i,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new gD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ce.RESOURCE_EXHAUSTED?(ti(t.toString()),ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===t&&this.G_(n,i)}),(n=>{e((()=>{const i=new Xe(Ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ve(Vb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ve(Vb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class KW extends _D{constructor(e,t,n,i,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,l),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=YK(this.serializer,e),n=(function(s){if(!("targetChange"in s))return st.min();const l=s.targetChange;return l.targetIds&&l.targetIds.length?st.min():l.readTime?ni(l.readTime):st.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Kx(this.serializer),t.addTarget=(function(s,l){let u;const f=l.target;if(u=kp(f)?{documents:qR(s,f)}:{query:KR(s,f).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=UR(s,l.resumeToken);const d=Gx(s,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(st.min())>0){u.readTime=sf(s,l.snapshotVersion.toTimestamp());const d=Gx(s,l.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=QK(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Kx(this.serializer),t.removeTarget=e,this.q_(t)}}class WW extends _D{constructor(e,t,n,i,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,l),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=$K(e.writeResults,e.commitTime),n=ni(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Kx(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>Dp(this.serializer,n)))};this.q_(t)}}class XW{}class YW extends XW{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Xe(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,l])=>this.connection.Go(e,qx(t,n),i,s,l))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Xe(Ce.UNKNOWN,s.toString())}))}Ho(e,t,n,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,qx(t,n),i,l,u,s))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Xe(Ce.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class $W{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ti(t),this.aa=!1):Ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const vc="RemoteStore";class QW{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{Rc(this)&&(Ve(vc,"Restarting streams for network reachability change."),await(async function(f){const d=mt(f);d.Ea.add(4),await X0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Eg(d)})(this))}))})),this.Ra=new $W(n,i)}}async function Eg(r){if(Rc(r))for(const e of r.da)await e(!0)}async function X0(r){for(const e of r.da)await e(!1)}function xD(r,e){const t=mt(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),qy(t)?Gy(t):_f(t).O_()&&Hy(t,e))}function jy(r,e){const t=mt(r),n=_f(t);t.Ia.delete(e),n.O_()&&vD(t,e),t.Ia.size===0&&(n.O_()?n.L_():Rc(t)&&t.Ra.set("Unknown"))}function Hy(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}_f(r).Y_(e)}function vD(r,e){r.Va.Ue(e),_f(r).Z_(e)}function Gy(r){r.Va=new jK({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),_f(r).start(),r.Ra.ua()}function qy(r){return Rc(r)&&!_f(r).x_()&&r.Ia.size>0}function Rc(r){return mt(r).Ea.size===0}function yD(r){r.Va=void 0}async function JW(r){r.Ra.set("Online")}async function ZW(r){r.Ia.forEach(((e,t)=>{Hy(r,e)}))}async function eX(r,e){yD(r),qy(r)?(r.Ra.ha(e),Gy(r)):r.Ra.set("Unknown")}async function tX(r,e,t){if(r.Ra.set("Online"),e instanceof BR&&e.state===2&&e.cause)try{await(async function(i,s){const l=s.cause;for(const u of s.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,l),i.Ia.delete(u),i.Va.removeTarget(u))})(r,e)}catch(n){Ve(vc,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Mp(r,n)}else if(e instanceof Ym?r.Va.Ze(e):e instanceof VR?r.Va.st(e):r.Va.tt(e),!t.isEqual(st.min()))try{const n=await mD(r.localStore);t.compareTo(n)>=0&&await(function(s,l){const u=s.Va.Tt(l);return u.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const m=s.Ia.get(d);m&&s.Ia.set(d,m.withResumeToken(f.resumeToken,l))}})),u.targetMismatches.forEach(((f,d)=>{const m=s.Ia.get(f);if(!m)return;s.Ia.set(f,m.withResumeToken(an.EMPTY_BYTE_STRING,m.snapshotVersion)),vD(s,f);const _=new Os(m.target,f,d,m.sequenceNumber);Hy(s,_)})),s.remoteSyncer.applyRemoteEvent(u)})(r,t)}catch(n){Ve(vc,"Failed to raise snapshot:",n),await Mp(r,n)}}async function Mp(r,e,t){if(!ol(e))throw e;r.Ea.add(1),await X0(r),r.Ra.set("Offline"),t||(t=()=>mD(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{Ve(vc,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await Eg(r)}))}function ED(r,e){return e().catch((t=>Mp(r,t,e)))}async function Y0(r){const e=mt(r),t=tl(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:$l;for(;rX(e);)try{const i=await LW(e.localStore,n);if(i===null){e.Ta.length===0&&t.L_();break}n=i.batchId,nX(e,i)}catch(i){await Mp(e,i)}TD(e)&&wD(e)}function rX(r){return Rc(r)&&r.Ta.length<10}function nX(r,e){r.Ta.push(e);const t=tl(r);t.O_()&&t.X_&&t.ea(e.mutations)}function TD(r){return Rc(r)&&!tl(r).x_()&&r.Ta.length>0}function wD(r){tl(r).start()}async function iX(r){tl(r).ra()}async function aX(r){const e=tl(r);for(const t of r.Ta)e.ea(t.mutations)}async function sX(r,e,t){const n=r.Ta.shift(),i=Dy.from(n,e,t);await ED(r,(()=>r.remoteSyncer.applySuccessfulWrite(i))),await Y0(r)}async function oX(r,e){e&&tl(r).X_&&await(async function(n,i){if((function(l){return BK(l)&&l!==Ce.ABORTED})(i.code)){const s=n.Ta.shift();tl(n).B_(),await ED(n,(()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i))),await Y0(n)}})(r,e),TD(r)&&wD(r)}async function Bb(r,e){const t=mt(r);t.asyncQueue.verifyOperationInProgress(),Ve(vc,"RemoteStore received new credentials");const n=Rc(t);t.Ea.add(3),await X0(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Eg(t)}async function lX(r,e){const t=mt(r);e?(t.Ea.delete(2),await Eg(t)):e||(t.Ea.add(2),await X0(t),t.Ra.set("Unknown"))}function _f(r){return r.ma||(r.ma=(function(t,n,i){const s=mt(t);return s.sa(),new KW(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(r.datastore,r.asyncQueue,{Xo:JW.bind(null,r),t_:ZW.bind(null,r),r_:eX.bind(null,r),H_:tX.bind(null,r)}),r.da.push((async e=>{e?(r.ma.B_(),qy(r)?Gy(r):r.Ra.set("Unknown")):(await r.ma.stop(),yD(r))}))),r.ma}function tl(r){return r.fa||(r.fa=(function(t,n,i){const s=mt(t);return s.sa(),new WW(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:iX.bind(null,r),r_:oX.bind(null,r),ta:aX.bind(null,r),na:sX.bind(null,r)}),r.da.push((async e=>{e?(r.fa.B_(),await Y0(r)):(await r.fa.stop(),r.Ta.length>0&&(Ve(vc,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}class Ky{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ms,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const l=Date.now()+n,u=new Ky(e,t,l,i,s);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Xe(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wy(r,e){if(ti("AsyncQueue",`${e}: ${r}`),ol(r))return new Xe(Ce.UNAVAILABLE,`${e}: ${r}`);throw r}class ju{static emptySet(e){return new ju(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ke.comparator(t.key,n.key):(t,n)=>Ke.comparator(t.key,n.key),this.keyedMap=kh(),this.sortedSet=new br(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ju)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new ju;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ub{constructor(){this.ga=new br(Ke.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Je(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class of{constructor(e,t,n,i,s,l,u,f,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,t,n,i,s){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new of(e,t,ju.emptySet(t),l,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class cX{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class uX{constructor(){this.queries=zb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=mt(t),s=i.queries;i.queries=zb(),s.forEach(((l,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new Xe(Ce.ABORTED,"Firestore shutting down"))}}function zb(){return new Ks((r=>SR(r)),dg)}async function SD(r,e){const t=mt(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(n=2):(s=new cX,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const u=Wy(l,`Initialization of query '${bu(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Xy(t)}async function AD(r,e){const t=mt(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const l=s.Sa.indexOf(e);l>=0&&(s.Sa.splice(l,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function fX(r,e){const t=mt(r);let n=!1;for(const i of e){const s=i.query,l=t.queries.get(s);if(l){for(const u of l.Sa)u.Fa(i)&&(n=!0);l.wa=i}}n&&Xy(t)}function hX(r,e,t){const n=mt(r),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);n.queries.delete(e)}function Xy(r){r.Ca.forEach((e=>{e.next()}))}var Zx,jb;(jb=Zx||(Zx={})).Ma="default",jb.Cache="cache";class bD{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new of(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=of.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zx.Cache}}class ID{constructor(e){this.key=e}}class kD{constructor(e){this.key=e}}class dX{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=At(),this.mutatedKeys=At(),this.eu=AR(e),this.tu=new ju(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Ub,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,l=i,u=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((m,_)=>{const v=i.get(m),y=q0(this.query,_)?_:null,T=!!v&&this.mutatedKeys.has(v.key),E=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let S=!1;v&&y?v.data.isEqual(y.data)?T!==E&&(n.track({type:3,doc:y}),S=!0):this.su(v,y)||(n.track({type:2,doc:y}),S=!0,(f&&this.eu(y,f)>0||d&&this.eu(y,d)<0)&&(u=!0)):!v&&y?(n.track({type:0,doc:y}),S=!0):v&&!y&&(n.track({type:1,doc:v}),S=!0,(f||d)&&(u=!0)),S&&(y?(l=l.add(y),s=E?s.add(m):s.delete(m)):(l=l.delete(m),s=s.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{tu:l,iu:n,Cs:u,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((m,_)=>(function(y,T){const E=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Je(20277,{Rt:S})}};return E(y)-E(T)})(m.type,_.type)||this.eu(m.doc,_.doc))),this.ou(n),i=i??!1;const u=t&&!i?this._u():[],f=this.Xa.size===0&&this.current&&!i?1:0,d=f!==this.Za;return this.Za=f,l.length!==0||d?{snapshot:new of(this.query,e.tu,s,l,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ub,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=At(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new kD(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new ID(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=At();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return of.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Yy="SyncEngine";class mX{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class pX{constructor(e){this.key=e,this.hu=!1}}class gX{constructor(e,t,n,i,s,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Ks((u=>SR(u)),dg),this.Iu=new Map,this.Eu=new Set,this.du=new br(Ke.comparator),this.Au=new Map,this.Ru=new Ly,this.Vu={},this.mu=new Map,this.fu=xc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function _X(r,e,t=!0){const n=FD(r);let i;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await CD(n,e,t,!0),i}async function xX(r,e){const t=FD(r);await CD(t,e,!0,!1)}async function CD(r,e,t,n){const i=await VW(r.localStore,ca(e)),s=i.targetId,l=r.sharedClientState.addLocalQueryTarget(s,t);let u;return n&&(u=await vX(r,e,s,l==="current",i.resumeToken)),r.isPrimaryClient&&t&&xD(r.remoteStore,i),u}async function vX(r,e,t,n,i){r.pu=(_,v,y)=>(async function(E,S,D,U){let k=S.view.ru(D);k.Cs&&(k=await Fb(E.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,k))));const W=U&&U.targetChanges.get(S.targetId),ee=U&&U.targetMismatches.get(S.targetId)!=null,X=S.view.applyChanges(k,E.isPrimaryClient,W,ee);return Gb(E,S.targetId,X.au),X.snapshot})(r,_,v,y);const s=await Fb(r.localStore,e,!0),l=new dX(e,s.Qs),u=l.ru(s.documents),f=W0.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),d=l.applyChanges(u,r.isPrimaryClient,f);Gb(r,t,d.au);const m=new mX(e,t,l);return r.Tu.set(e,m),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),d.snapshot}async function yX(r,e,t){const n=mt(r),i=n.Tu.get(e),s=n.Iu.get(i.targetId);if(s.length>1)return n.Iu.set(i.targetId,s.filter((l=>!dg(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Qx(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),t&&jy(n.remoteStore,i.targetId),ev(n,i.targetId)})).catch(Cc)):(ev(n,i.targetId),await Qx(n.localStore,i.targetId,!0))}async function EX(r,e){const t=mt(r),n=t.Tu.get(e),i=t.Iu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),jy(t.remoteStore,n.targetId))}async function TX(r,e,t){const n=PD(r);try{const i=await(function(l,u){const f=mt(l),d=ir.now(),m=u.reduce(((y,T)=>y.add(T.key)),At());let _,v;return f.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let T=Di(),E=At();return f.Ns.getEntries(y,m).next((S=>{T=S,T.forEach(((D,U)=>{U.isValidDocument()||(E=E.add(D))}))})).next((()=>f.localDocuments.getOverlayedDocuments(y,T))).next((S=>{_=S;const D=[];for(const U of u){const k=LK(U,_.get(U.key).overlayedDocument);k!=null&&D.push(new Ws(U.key,k,gR(k.value.mapValue),En.exists(!0)))}return f.mutationQueue.addMutationBatch(y,d,D,u)})).next((S=>{v=S;const D=S.applyToLocalDocumentSet(_,E);return f.documentOverlayCache.saveOverlays(y,S.batchId,D)}))})).then((()=>({batchId:v.batchId,changes:IR(_)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),(function(l,u,f){let d=l.Vu[l.currentUser.toKey()];d||(d=new br(dt)),d=d.insert(u,f),l.Vu[l.currentUser.toKey()]=d})(n,i.batchId,t),await $0(n,i.changes),await Y0(n.remoteStore)}catch(i){const s=Wy(i,"Failed to persist write");t.reject(s)}}async function RD(r,e){const t=mt(r);try{const n=await PW(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const l=t.Au.get(s);l&&(tt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?tt(l.hu,14607):i.removedDocuments.size>0&&(tt(l.hu,42227),l.hu=!1))})),await $0(t,n,e)}catch(n){await Cc(n)}}function Hb(r,e,t){const n=mt(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Tu.forEach(((s,l)=>{const u=l.view.va(e);u.snapshot&&i.push(u.snapshot)})),(function(l,u){const f=mt(l);f.onlineState=u;let d=!1;f.queries.forEach(((m,_)=>{for(const v of _.Sa)v.va(u)&&(d=!0)})),d&&Xy(f)})(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function wX(r,e,t){const n=mt(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Au.get(e),s=i&&i.key;if(s){let l=new br(Ke.comparator);l=l.insert(s,Fr.newNoDocument(s,st.min()));const u=At().add(s),f=new gg(st.min(),new Map,new br(dt),l,u);await RD(n,f),n.du=n.du.remove(s),n.Au.delete(e),$y(n)}else await Qx(n.localStore,e,!1).then((()=>ev(n,e,t))).catch(Cc)}async function SX(r,e){const t=mt(r),n=e.batch.batchId;try{const i=await FW(t.localStore,e);ND(t,n,null),DD(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await $0(t,i)}catch(i){await Cc(i)}}async function AX(r,e,t){const n=mt(r);try{const i=await(function(l,u){const f=mt(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return f.mutationQueue.lookupMutationBatch(d,u).next((_=>(tt(_!==null,37113),m=_.keys(),f.mutationQueue.removeMutationBatch(d,_)))).next((()=>f.mutationQueue.performConsistencyCheck(d))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>f.localDocuments.getDocuments(d,m)))}))})(n.localStore,e);ND(n,e,t),DD(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await $0(n,i)}catch(i){await Cc(i)}}function DD(r,e){(r.mu.get(e)||[]).forEach((t=>{t.resolve()})),r.mu.delete(e)}function ND(r,e,t){const n=mt(r);let i=n.Vu[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function ev(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach((n=>{r.Ru.containsKey(n)||OD(r,n)}))}function OD(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(jy(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),$y(r))}function Gb(r,e,t){for(const n of t)n instanceof ID?(r.Ru.addReference(n.key,e),bX(r,n)):n instanceof kD?(Ve(Yy,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||OD(r,n.key)):Je(19791,{wu:n})}function bX(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(Ve(Yy,"New document in limbo: "+t),r.Eu.add(n),$y(r))}function $y(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new Ke(Yt.fromString(e)),n=r.fu.next();r.Au.set(n,new pX(t)),r.du=r.du.insert(t,n),xD(r.remoteStore,new Os(ca(hg(t.path)),n,"TargetPurposeLimboResolution",sa.ce))}}async function $0(r,e,t){const n=mt(r),i=[],s=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{l.push(n.pu(f,e,t).then((d=>{if((d||t)&&n.isPrimaryClient){const m=d?!d.fromCache:t?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,m?"current":"not-current")}if(d){i.push(d);const m=Uy.As(f.targetId,d);s.push(m)}})))})),await Promise.all(l),n.Pu.H_(i),await(async function(f,d){const m=mt(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>ce.forEach(d,(v=>ce.forEach(v.Es,(y=>m.persistence.referenceDelegate.addReference(_,v.targetId,y))).next((()=>ce.forEach(v.ds,(y=>m.persistence.referenceDelegate.removeReference(_,v.targetId,y)))))))))}catch(_){if(!ol(_))throw _;Ve(zy,"Failed to update sequence numbers: "+_)}for(const _ of d){const v=_.targetId;if(!_.fromCache){const y=m.Ms.get(v),T=y.snapshotVersion,E=y.withLastLimboFreeSnapshotVersion(T);m.Ms=m.Ms.insert(v,E)}}})(n.localStore,s))}async function IX(r,e){const t=mt(r);if(!t.currentUser.isEqual(e)){Ve(Yy,"User change. New user:",e.toKey());const n=await dD(t.localStore,e);t.currentUser=e,(function(s,l){s.mu.forEach((u=>{u.forEach((f=>{f.reject(new Xe(Ce.CANCELLED,l))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await $0(t,n.Ls)}}function kX(r,e){const t=mt(r),n=t.Au.get(e);if(n&&n.hu)return At().add(n.key);{let i=At();const s=t.Iu.get(e);if(!s)return i;for(const l of s){const u=t.Tu.get(l);i=i.unionWith(u.view.nu)}return i}}function FD(r){const e=mt(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=RD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kX.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wX.bind(null,e),e.Pu.H_=fX.bind(null,e.eventManager),e.Pu.yu=hX.bind(null,e.eventManager),e}function PD(r){const e=mt(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SX.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AX.bind(null,e),e}class I0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yg(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return hD(this.persistence,new fD,e.initialUser,this.serializer)}Cu(e){return new Vy(vg.mi,this.serializer)}Du(e){return new pD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}I0.provider={build:()=>new I0};class CX extends I0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){tt(this.persistence.referenceDelegate instanceof Pp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new sD(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new Vy((n=>Pp.mi(n,t)),this.serializer)}}class RX extends I0{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await PD(this.xu.syncEngine),await Y0(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return hD(this.persistence,new fD,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new sD(n,e.asyncQueue,t)}Mu(e,t){const n=new Fq(t,this.persistence);return new Oq(e.asyncQueue,n)}Cu(e){const t=RW(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new By(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,qW(),Qm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new pD}}class Lp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Hb(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=IX.bind(null,this.syncEngine),await lX(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new uX})()}createDatastore(e){const t=yg(e.databaseInfo.databaseId),n=(function(s){return new GW(s)})(e.databaseInfo);return(function(s,l,u,f){return new YW(s,l,u,f)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,i,s,l,u){return new QW(n,i,s,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>Hb(this.syncEngine,t,0)),(function(){return Lb.v()?new Lb:new UW})())}createSyncEngine(e,t){return(function(i,s,l,u,f,d,m){const _=new gX(i,s,l,u,f,d);return m&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=mt(t);Ve(vc,"RemoteStore shutting down."),n.Ea.add(5),await X0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Lp.provider={build:()=>new Lp};class MD{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ti("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const rl="FirestoreClient";class DX{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=kn.UNAUTHENTICATED,this.clientId=gy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async l=>{Ve(rl,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(Ve(rl,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ms;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Wy(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function sx(r,e){r.asyncQueue.verifyOperationInProgress(),Ve(rl,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await dD(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function qb(r,e){r.asyncQueue.verifyOperationInProgress();const t=await NX(r);Ve(rl,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>Bb(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>Bb(e.remoteStore,i))),r._onlineComponents=e}async function NX(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Ve(rl,"Using user provided OfflineComponentProvider");try{await sx(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Ce.FAILED_PRECONDITION||i.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;dc("Error using user provided cache. Falling back to memory cache: "+t),await sx(r,new I0)}}else Ve(rl,"Using default OfflineComponentProvider"),await sx(r,new CX(void 0));return r._offlineComponents}async function LD(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Ve(rl,"Using user provided OnlineComponentProvider"),await qb(r,r._uninitializedComponentsProvider._online)):(Ve(rl,"Using default OnlineComponentProvider"),await qb(r,new Lp))),r._onlineComponents}function OX(r){return LD(r).then((e=>e.syncEngine))}async function tv(r){const e=await LD(r),t=e.eventManager;return t.onListen=_X.bind(null,e.syncEngine),t.onUnlisten=yX.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xX.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=EX.bind(null,e.syncEngine),t}function FX(r,e,t={}){const n=new Ms;return r.asyncQueue.enqueueAndForget((async()=>(function(s,l,u,f,d){const m=new MD({next:v=>{m.Nu(),l.enqueueAndForget((()=>AD(s,_))),v.fromCache&&f.source==="server"?d.reject(new Xe(Ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),_=new bD(u,m,{includeMetadataChanges:!0,qa:!0});return SD(s,_)})(await tv(r),r.asyncQueue,e,t,n))),n.promise}function VD(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}const Kb=new Map;const BD="firestore.googleapis.com",Wb=!0;class Xb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Xe(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=BD,this.ssl=Wb}else this.host=e.host,this.ssl=e.ssl??Wb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<dW)throw new Xe(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Cq("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VD(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Xe(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Xe(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Xe(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Tg{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xe(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Xe(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new vq;switch(n.type){case"firstParty":return new wq(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Xe(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=Kb.get(t);n&&(Ve("ComponentProvider","Removing Datastore"),Kb.delete(t),n.terminate())})(this),Promise.resolve()}}function PX(r,e,t,n={}){r=Pi(r,Tg);const i=hf(e),s=r._getSettings(),l={...s,emulatorOptions:r._getEmulatorOptions()},u=`${e}:${t}`;i&&(EC(`https://${u}`),TC("Firestore",!0)),s.host!==BD&&s.host!==u&&dc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...s,host:u,ssl:i,emulatorOptions:n};if(!Jo(f,l)&&(r._setSettings(f),n.mockUserToken)){let d,m;if(typeof n.mockUserToken=="string")d=n.mockUserToken,m=kn.MOCK_USER;else{d=rU(n.mockUserToken,r._app?.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new Xe(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new kn(_)}r._authCredentials=new yq(new H4(d,m))}}class Q0{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Q0(this.firestore,e,this._query)}}class nn{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nn(this.firestore,e,this._key)}toJSON(){return{type:nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(j0(t,nn._jsonSchema))return new nn(e,n||null,new Ke(Yt.fromString(t.referencePath)))}}nn._jsonSchemaVersion="firestore/documentReference/1.0",nn._jsonSchema={type:rn("string",nn._jsonSchemaVersion),referencePath:rn("string")};class Wo extends Q0{constructor(e,t,n){super(e,t,hg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nn(this.firestore,null,new Ke(e))}withConverter(e){return new Wo(this.firestore,e,this._path)}}function ox(r,e,...t){if(r=Rr(r),q4("collection","path",e),r instanceof Tg){const n=Yt.fromString(e,...t);return VA(n),new Wo(r,null,n)}{if(!(r instanceof nn||r instanceof Wo))throw new Xe(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Yt.fromString(e,...t));return VA(n),new Wo(r.firestore,null,n)}}function lx(r,e,...t){if(r=Rr(r),arguments.length===1&&(e=gy.newId()),q4("doc","path",e),r instanceof Tg){const n=Yt.fromString(e,...t);return LA(n),new nn(r,null,new Ke(n))}{if(!(r instanceof nn||r instanceof Wo))throw new Xe(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Yt.fromString(e,...t));return LA(n),new nn(r.firestore,r instanceof Wo?r.converter:null,new Ke(n))}}const Yb="AsyncQueue";class $b{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new gD(this,"async_queue_retry"),this._c=()=>{const n=Qm();n&&Ve(Yb,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Qm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Qm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ms;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ol(e))throw e;Ve(Yb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ti("INTERNAL UNHANDLED ERROR: ",Qb(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Ky.createAndSchedule(this,e,t,n,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Je(47125,{Pc:Qb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Qb(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}function Jb(r){return(function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1})(r,["next","error","complete"])}class js extends Tg{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new $b,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $b(e),this._firestoreClient=void 0,await e}}}function UD(r,e){const t=typeof r=="object"?r:Zv(),n=typeof r=="string"?r:bp,i=kc(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=eU("firestore");s&&PX(i,...s)}return i}function wg(r){if(r._terminated)throw new Xe(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||zD(r),r._firestoreClient}function zD(r){const e=r._freezeSettings(),t=(function(i,s,l,u){return new cK(i,s,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,VD(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(r._databaseId,r._app?.options.appId||"",r._persistenceKey,e);r._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new DX(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(r._componentsProvider))}function jD(r,e){dc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=r._freezeSettings();return MX(r,Lp.provider,{build:n=>new RX(n,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function MX(r,e,t){if((r=Pi(r,js))._firestoreClient||r._terminated)throw new Xe(Ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new Xe(Ce.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},zD(r)}class ia{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ia(an.fromBase64String(e))}catch(t){throw new Xe(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ia(an.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ia._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(j0(e,ia._jsonSchema))return ia.fromBase64String(e.bytes)}}ia._jsonSchemaVersion="firestore/bytes/1.0",ia._jsonSchema={type:rn("string",ia._jsonSchemaVersion),bytes:rn("string")};class J0{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Xe(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Qy{constructor(e){this._methodName=e}}class es{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Xe(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Xe(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return dt(this._lat,e._lat)||dt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:es._jsonSchemaVersion}}static fromJSON(e){if(j0(e,es._jsonSchema))return new es(e.latitude,e.longitude)}}es._jsonSchemaVersion="firestore/geoPoint/1.0",es._jsonSchema={type:rn("string",es._jsonSchemaVersion),latitude:rn("number"),longitude:rn("number")};class ts{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ts._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(j0(e,ts._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ts(e.vectorValues);throw new Xe(Ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ts._jsonSchemaVersion="firestore/vectorValue/1.0",ts._jsonSchema={type:rn("string",ts._jsonSchemaVersion),vectorValues:rn("object")};const LX=/^__.*__$/;class VX{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ws(e,this.data,this.fieldMask,t,this.fieldTransforms):new gf(e,this.data,t,this.fieldTransforms)}}class HD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ws(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function GD(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Je(40011,{Ac:r})}}class Jy{constructor(e,t,n,i,s,l){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Jy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Vp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(GD(this.Ac)&&LX.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class BX{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||yg(e)}Cc(e,t,n,i=!1){return new Jy({Ac:e,methodName:t,Dc:n,path:kr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Zy(r){const e=r._freezeSettings(),t=yg(r._databaseId);return new BX(r._databaseId,!!e.ignoreUndefinedProperties,t)}function qD(r,e,t,n,i,s={}){const l=r.Cc(s.merge||s.mergeFields?2:0,e,t,i);eE("Data must be an object, but it was:",l,n);const u=XD(n,l);let f,d;if(s.merge)f=new mi(l.fieldMask),d=l.fieldTransforms;else if(s.mergeFields){const m=[];for(const _ of s.mergeFields){const v=rv(e,_,t);if(!l.contains(v))throw new Xe(Ce.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);$D(m,v)||m.push(v)}f=new mi(m),d=l.fieldTransforms.filter((_=>f.covers(_.field)))}else f=null,d=l.fieldTransforms;return new VX(new Hn(u),f,d)}class Sg extends Qy{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sg}}function KD(r,e,t,n){const i=r.Cc(1,e,t);eE("Data must be an object, but it was:",i,n);const s=[],l=Hn.empty();ll(n,((f,d)=>{const m=tE(e,f,t);d=Rr(d);const _=i.yc(m);if(d instanceof Sg)s.push(m);else{const v=Ag(d,_);v!=null&&(s.push(m),l.set(m,v))}}));const u=new mi(s);return new HD(l,u,i.fieldTransforms)}function WD(r,e,t,n,i,s){const l=r.Cc(1,e,t),u=[rv(e,n,t)],f=[i];if(s.length%2!=0)throw new Xe(Ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<s.length;v+=2)u.push(rv(e,s[v])),f.push(s[v+1]);const d=[],m=Hn.empty();for(let v=u.length-1;v>=0;--v)if(!$D(d,u[v])){const y=u[v];let T=f[v];T=Rr(T);const E=l.yc(y);if(T instanceof Sg)d.push(y);else{const S=Ag(T,E);S!=null&&(d.push(y),m.set(y,S))}}const _=new mi(d);return new HD(m,_,l.fieldTransforms)}function Ag(r,e){if(YD(r=Rr(r)))return eE("Unsupported field value:",e,r),XD(r,e);if(r instanceof Qy)return(function(n,i){if(!GD(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,i){const s=[];let l=0;for(const u of n){let f=Ag(u,i.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),l++}return{arrayValue:{values:s}}})(r,e)}return(function(n,i){if((n=Rr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return RK(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ir.fromDate(n);return{timestampValue:sf(i.serializer,s)}}if(n instanceof ir){const s=new ir(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:sf(i.serializer,s)}}if(n instanceof es)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ia)return{bytesValue:UR(i.serializer,n._byteString)};if(n instanceof nn){const s=i.databaseId,l=n.firestore._databaseId;if(!l.isEqual(s))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Fy(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ts)return(function(l,u){return{mapValue:{fields:{[Ay]:{stringValue:by},[Zu]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Cy(u.serializer,d)}))}}}}}})(n,i);throw i.Sc(`Unsupported field value: ${_y(n)}`)})(r,e)}function XD(r,e){const t={};return oR(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ll(r,((n,i)=>{const s=Ag(i,e.mc(n));s!=null&&(t[n]=s)})),{mapValue:{fields:t}}}function YD(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof ir||r instanceof es||r instanceof ia||r instanceof nn||r instanceof Qy||r instanceof ts)}function eE(r,e,t){if(!YD(t)||!K4(t)){const n=_y(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function rv(r,e,t){if((e=Rr(e))instanceof J0)return e._internalPath;if(typeof e=="string")return tE(r,e);throw Vp("Field path arguments must be of type string or ",r,!1,void 0,t)}const UX=new RegExp("[~\\*/\\[\\]]");function tE(r,e,t){if(e.search(UX)>=0)throw Vp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new J0(...e.split("."))._internalPath}catch{throw Vp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Vp(r,e,t,n,i){const s=n&&!n.isEmpty(),l=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(s||l)&&(f+=" (found",s&&(f+=` in field ${n}`),l&&(f+=` in document ${i}`),f+=")"),new Xe(Ce.INVALID_ARGUMENT,u+r+f)}function $D(r,e){return r.some((t=>t.isEqual(e)))}class QD{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(JD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class zX extends QD{data(){return super.data()}}function JD(r,e){return typeof e=="string"?tE(r,e):e instanceof J0?e._internalPath:e._delegate._internalPath}function ZD(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Xe(Ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jX{convertValue(e,t="none"){switch(Zo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ar(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Je(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ll(e,((i,s)=>{n[i]=this.convertValue(s,t)})),n}convertVectorValue(e){const t=e.fields?.[Zu].arrayValue?.values?.map((n=>Ar(n.doubleValue)));return new ts(t)}convertGeoPoint(e){return new es(Ar(e.latitude),Ar(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=cg(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(T0(e));default:return null}}convertTimestamp(e){const t=Us(e);return new ir(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Yt.fromString(e);tt($R(n),9688,{name:e});const i=new mc(n.get(1),n.get(3)),s=new Ke(n.popFirst(5));return i.isEqual(t)||ti(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function e3(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class Dh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zl extends QD{constructor(e,t,n,i,s,l){super(e,t,n,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Jm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(JD("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(Ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Zl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Zl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zl._jsonSchema={type:rn("string",Zl._jsonSchemaVersion),bundleSource:rn("string","DocumentSnapshot"),bundleName:rn("string"),bundle:rn("string")};class Jm extends Zl{data(e={}){return super.data(e)}}class ec{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Dh(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Jm(this._firestore,this._userDataWriter,n.key,n,new Dh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Xe(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((u=>{const f=new Jm(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dh(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>s||u.type!==3)).map((u=>{const f=new Jm(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dh(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),m=l.indexOf(u.doc.key)),{type:HX(u.type),doc:f,oldIndex:d,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(Ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ec._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function HX(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Je(61501,{type:r})}}ec._jsonSchemaVersion="firestore/querySnapshot/1.0",ec._jsonSchema={type:rn("string",ec._jsonSchemaVersion),bundleSource:rn("string","QuerySnapshot"),bundleName:rn("string"),bundle:rn("string")};class rE extends jX{constructor(e){super(),this.firestore=e}convertBytes(e){return new ia(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new nn(this.firestore,null,t)}}function GX(r){r=Pi(r,Q0);const e=Pi(r.firestore,js),t=wg(e),n=new rE(e);return ZD(r._query),FX(t,r._query).then((i=>new ec(e,n,r,i)))}function qX(r,e,t){r=Pi(r,nn);const n=Pi(r.firestore,js),i=e3(r.converter,e,t);return bg(n,[qD(Zy(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,En.none())])}function KX(r,e,t,...n){r=Pi(r,nn);const i=Pi(r.firestore,js),s=Zy(i);let l;return l=typeof(e=Rr(e))=="string"||e instanceof J0?WD(s,"updateDoc",r._key,e,t,n):KD(s,"updateDoc",r._key,e),bg(i,[l.toMutation(r._key,En.exists(!0))])}function WX(r){return bg(Pi(r.firestore,js),[new K0(r._key,En.none())])}function XX(r,...e){r=Rr(r);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Jb(e[n])||(t=e[n++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Jb(e[n])){const f=e[n];e[n]=f.next?.bind(f),e[n+1]=f.error?.bind(f),e[n+2]=f.complete?.bind(f)}let s,l,u;if(r instanceof nn)l=Pi(r.firestore,js),u=hg(r._key.path),s={next:f=>{e[n]&&e[n](YX(l,r,f))},error:e[n+1],complete:e[n+2]};else{const f=Pi(r,Q0);l=Pi(f.firestore,js),u=f._query;const d=new rE(l);s={next:m=>{e[n]&&e[n](new ec(l,d,f,m))},error:e[n+1],complete:e[n+2]},ZD(r._query)}return(function(d,m,_,v){const y=new MD(v),T=new bD(m,y,_);return d.asyncQueue.enqueueAndForget((async()=>SD(await tv(d),T))),()=>{y.Nu(),d.asyncQueue.enqueueAndForget((async()=>AD(await tv(d),T)))}})(wg(l),u,i,s)}function bg(r,e){return(function(n,i){const s=new Ms;return n.asyncQueue.enqueueAndForget((async()=>TX(await OX(n),i,s))),s.promise})(wg(r),e)}function YX(r,e,t){const n=t.docs.get(e._key),i=new rE(r);return new Zl(r,i,e._key,n,new Dh(t.hasPendingWrites,t.fromCache),e.converter)}class $X{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Zy(e)}set(e,t,n){this._verifyNotCommitted();const i=cx(e,this._firestore),s=e3(i.converter,t,n),l=qD(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(l.toMutation(i._key,En.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=cx(e,this._firestore);let l;return l=typeof(t=Rr(t))=="string"||t instanceof J0?WD(this._dataReader,"WriteBatch.update",s._key,t,n,i):KD(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(l.toMutation(s._key,En.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=cx(e,this._firestore);return this._mutations=this._mutations.concat(new K0(t._key,En.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Xe(Ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function cx(r,e){if((r=Rr(r)).firestore!==e)throw new Xe(Ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function kY(r){return wg(r=Pi(r,js)),new $X(r,(e=>bg(r,e)))}(function(e,t=!0){(function(i){pf=i})(mf),ns(new Da("firestore",((n,{instanceIdentifier:i,options:s})=>{const l=n.getProvider("app").getImmediate(),u=new js(new Eq(n.getProvider("auth-internal")),new Sq(l,n.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Xe(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new mc(d.options.projectId,m)})(l,i),l);return s={useFetchStreams:t,...s},u._setSettings(s),u}),"PUBLIC").setMultipleInstances(!0)),la(OA,FA,e),la(OA,FA,"esm2020")})();const QX={apiKey:"AIzaSyBs73Bei23kJZ1enZNVfMJhCqwUfPrxI8c",authDomain:"imis-id-manager.firebaseapp.com",projectId:"imis-id-manager",storageBucket:"imis-id-manager.firebasestorage.app",messagingSenderId:"6647190912",appId:"1:6647190912:web:85abc4585b1fa8b9281d65",measurementId:"G-925Q6R67S2"},nE=Jv(QX);e4(nE);const Pm=_q(nE),JX=UD(nE);jD(JX).catch(r=>{r.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open."):r.code=="unimplemented"&&console.warn("Firestore persistence not supported in this environment.")});const yh="imis_auth",Eh={getItem:r=>{try{return sessionStorage.getItem(r)}catch(e){return console.warn("SessionStorage access denied",e),null}},setItem:(r,e)=>{try{sessionStorage.setItem(r,e)}catch(t){console.warn("SessionStorage access denied",t)}},removeItem:r=>{try{sessionStorage.removeItem(r)}catch(e){console.warn("SessionStorage access denied",e)}}};class ZX{constructor(){this.isAuthenticated=!1,this.user=null,this.confirmationResult=null,this.initAuth()}initAuth(){YH(Pm,e=>{e?(this.isAuthenticated=!0,this.user=e,Eh.setItem(yh,"true")):(this.isAuthenticated=!1,this.user=null,Eh.removeItem(yh))})}initRecaptcha(e){window.recaptchaVerifier||(window.recaptchaVerifier=new _G(Pm,e,{size:"invisible",callback:()=>{}}))}async sendOtp(e){try{const t=window.recaptchaVerifier;return this.confirmationResult=await yG(Pm,e,t),!0}catch(t){throw console.error("SMS Error:",t),window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null),t}}async verifyOtp(e){if(!this.confirmationResult)throw new Error("No OTP request found.");try{const t=await this.confirmationResult.confirm(e);return this.user=t.user,this.isAuthenticated=!0,Eh.setItem(yh,"true"),!0}catch(t){return console.error("OTP Verification Error:",t),!1}}async logout(){try{await $H(Pm),this.isAuthenticated=!1,this.user=null,Eh.removeItem(yh),window.location.reload()}catch(e){console.error("Logout Error:",e)}}isLoggedIn(){return this.isAuthenticated||Eh.getItem(yh)==="true"}}const tc=new ZX,eY=()=>{const[r,e]=We.useState(new Date),[t,n]=We.useState(null);We.useEffect(()=>{const s=setInterval(()=>{const l=new Date;e(l);const u=tc.getExpiryTime();if(u){const f=u-l.getTime();f<=0?tc.logout():n(f)}},1e3);return()=>clearInterval(s)},[]);const i=s=>{if(s===null)return"--:--";const l=Math.floor(s/1e3),u=Math.floor(l/60),f=l%60;return`${u}:${f.toString().padStart(2,"0")}`};return t===null?null:P.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",textAlign:"right",color:"rgba(255,255,255,0.8)",fontSize:"0.9rem",background:"rgba(0,0,0,0.2)",padding:"8px 15px",borderRadius:"20px",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.1)"},children:[P.jsx("div",{style:{fontWeight:"bold",fontSize:"1.1rem",color:"#fff"},children:r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),P.jsxs("div",{style:{fontSize:"0.8rem",opacity:.8,marginTop:"2px"},children:["Logout in: ",P.jsx("span",{style:{color:t<6e4?"#ff6b6b":"#4dabf5",fontWeight:"bold"},children:i(t)})]})]})},tY=({onDataEntryClick:r,onViewDataClick:e,onBulkUploadClick:t})=>P.jsxs("header",{style:{marginBottom:"2rem",position:"relative"},children:[tc.isLoggedIn()&&P.jsx(eY,{}),P.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"700",textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:"IMIS Data & ID Manager"}),P.jsx("p",{style:{opacity:.8},children:"Upload any Excel file with the required format to generate missing IDs."}),P.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"1rem",justifyContent:"center"},children:[P.jsx("button",{onClick:r,className:"glass-button",style:{background:"rgba(33, 150, 243, 0.3)"},children:" Data Entry"}),P.jsx("button",{onClick:t,className:"glass-button",style:{background:"rgba(255, 152, 0, 0.3)"},children:" Bulk Upload"}),P.jsx("button",{onClick:e,className:"glass-button",style:{background:"rgba(156, 39, 176, 0.3)"},children:" View Data Entry"})]})]}),rY=["District","Mandal","Grampanchayat","Benificiary Name","IMIS Id","Beneficiary Category","Beneficiary Type","Beneficiary Mobile Number","Ration Card Number","Ticket Number","Stage Level","FTR Status","FTR Number"],nY=[{label:"CFMS Bill Status",url:"https://prdcfms.apcfss.in:44300/sap/bc/ui5_ui5/sap/zexp_billstatus/index.html?sap-client=%27%27"},{label:"Create Multiple Beneficiary Requests",url:"https://prdcfms.apcfss.in:44300/sap/bc/ui5_ui5/sap/zexp_bf_mul_req/index.html"},{label:"SBM IMIS",url:"https://sbm.gov.in/SBMPhase2/Secure/Entry/UserMenu.aspx"},{label:"SAC",url:"https://sac.ap.gov.in/internal"},{label:"New Added Data Finder",url:"#"},{label:"Match CFMS with SAC",url:"#"},{label:"Show the commitments",url:"#"},{label:"IMIS id Generator",url:"#"}],CY={TICKET:{MIN:2e9,MAX:2999999999},FTR:{MIN:2e9,MAX:2999999999},REG:{MIN:1e9,MAX:1999999999}},iY=({onAadharClick:r,onTallyClick:e,onImisClick:t,onMatchClick:n,onCommitmentsClick:i})=>P.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",background:"rgba(255,255,255,0.05)",borderRadius:"8px"},children:[P.jsx("h3",{style:{marginBottom:"1rem",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"0.5rem"},children:"Quick Links"}),P.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[nY.map((s,l)=>s.label==="New Added Data Finder"?P.jsxs("button",{onClick:e,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):s.label==="Match CFMS with SAC"?P.jsxs("button",{onClick:n,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):s.label==="Show the commitments"?P.jsxs("button",{onClick:i,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):s.label==="IMIS id Generator"?P.jsxs("button",{onClick:t,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):P.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l)),P.jsx("button",{onClick:r,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer",background:"rgba(255, 100, 100, 0.2)",border:"1px solid rgba(255, 100, 100, 0.4)"},children:" Aadhar Generator"})]})]}),aY=({isOpen:r,onClose:e,validCount:t,setValidCount:n,invalidCount:i,setInvalidCount:s,onGenerate:l})=>r?P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"500px",position:"relative"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"2rem",marginTop:0},children:"Aadhar Generator"}),P.jsxs("div",{style:{display:"flex",gap:"2rem",justifyContent:"space-between"},children:[P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"1rem"},children:[P.jsx("h3",{style:{borderBottom:"2px solid #4caf50",paddingBottom:"0.5rem"},children:"Valid Aadhar"}),P.jsx("label",{style:{fontSize:"0.9rem",textAlign:"left"},children:"How many?"}),P.jsx("input",{type:"number",className:"glass-input",placeholder:"Count...",value:t,onChange:u=>n(u.target.value)}),P.jsx("button",{className:"glass-button",style:{background:"rgba(76, 175, 80, 0.4)"},onClick:()=>l("valid"),children:"Download .xlsx"})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"1rem"},children:[P.jsx("h3",{style:{borderBottom:"2px solid #f44336",paddingBottom:"0.5rem"},children:"Invalid Aadhar"}),P.jsx("label",{style:{fontSize:"0.9rem",textAlign:"left"},children:"How many?"}),P.jsx("input",{type:"number",className:"glass-input",placeholder:"Count...",value:i,onChange:u=>s(u.target.value)}),P.jsx("button",{className:"glass-button",style:{background:"rgba(244, 67, 54, 0.4)"},onClick:()=>l("invalid"),children:"Download .xlsx"})]})]})]})}):null,sY=({data:r,headers:e,isVerifying:t,investigationReport:n,progress:i,synthesisCount:s,setSynthesisCount:l,onClear:u,onAnalyze:f,onGenerate:d,onExport:m})=>P.jsxs("div",{className:"glass-panel",children:[P.jsxs("div",{className:"preview-header",children:[P.jsxs("h2",{children:["Preview: ",r.length," Rows"]}),P.jsx("div",{style:{gap:"1rem",display:"flex"},children:P.jsx("button",{className:"glass-button",style:{background:"rgba(255,0,0,0.2)"},onClick:u,children:"Clear"})})]}),P.jsxs("div",{className:"action-area",children:[!n&&!t&&P.jsxs("div",{children:[P.jsx("p",{style:{marginBottom:"1rem",color:"#ccc"},children:"Step 1: Analyze file for missing data and consistency."}),P.jsx("button",{className:"glass-button",onClick:f,style:{fontSize:"1.1rem",padding:"12px 24px"},children:" Analyze & Verify Data"})]}),t&&P.jsxs("div",{style:{width:"100%"},children:[P.jsx("p",{style:{marginBottom:"0.5rem"},children:"Investigating Data Integrity..."}),P.jsx("div",{style:{width:"100%",height:"8px",background:"#333",borderRadius:"4px",overflow:"hidden"},children:P.jsx("div",{style:{width:`${i}%`,height:"100%",background:"#007bff",transition:"width 0.2s"}})})]}),n&&P.jsxs("div",{className:"fade-in",children:[P.jsx("h3",{style:{color:"#4caf50",marginBottom:"1rem"},children:" Data Verified"}),P.jsxs("div",{className:"stats-grid",children:[P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Valid Rows"}),P.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:n.validCount})]}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Missing IDs"}),P.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:n.missingStats.ticket+n.missingStats.ftr+n.missingStats.reg})]}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Action Needed"}),P.jsx("div",{style:{fontSize:"1.2rem",color:"#ffc107"},children:"Generate New IDs"})]})]}),P.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"rgba(0,123,255,0.1)",borderRadius:"8px",border:"1px solid rgba(0,123,255,0.2)"},children:[P.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem"},children:"Generate New Records (Append to file)"}),P.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",alignItems:"center",flexWrap:"wrap"},children:[P.jsx("input",{type:"number",min:"0",max:"1000",value:s,onChange:_=>l(_.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #555",background:"#222",color:"white",width:"100px",textAlign:"center"}}),P.jsx("span",{style:{fontSize:"0.9rem",opacity:.7},children:"rows"})]})]}),P.jsxs("div",{className:"action-buttons",children:[P.jsx("button",{className:"glass-button",onClick:d,style:{background:"#28a745",fontSize:"1.1rem",padding:"12px 24px",border:"none"},children:" Generate Smart IDs"}),P.jsx("button",{className:"glass-button",onClick:m,children:" Export Excel"})]})]})]}),P.jsx("div",{className:"table-container",children:P.jsxs("table",{className:"data-table",children:[P.jsx("thead",{children:P.jsx("tr",{children:e.map((_,v)=>P.jsx("th",{children:_},v))})}),P.jsx("tbody",{children:r.map((_,v)=>P.jsx("tr",{children:e.map((y,T)=>P.jsx("td",{children:_[T]||""},T))},v))})]})})]}),oY=({onLogin:r})=>{const[e,t]=We.useState(""),[n,i]=We.useState(""),[s,l]=We.useState("PHONE"),[u,f]=We.useState(""),[d,m]=We.useState(!1);We.useEffect(()=>{try{tc.initRecaptcha("recaptcha-container")}catch(y){console.error("Recaptcha Init Error",y)}},[]);const _=async y=>{y.preventDefault(),f(""),m(!0);const T=e.replace(/\D/g,"");if(T.length!==10){f("Please enter a valid 10-digit mobile number"),m(!1);return}try{const E="+91"+T;await tc.sendOtp(E)&&(l("OTP"),m(!1))}catch(E){console.error(E),f(E.message||"Failed to send OTP. Check console."),m(!1)}},v=async y=>{if(y.preventDefault(),f(""),m(!0),!n||n.length!==6){f("Please enter a valid 6-digit OTP"),m(!1);return}try{await tc.verifyOtp(n)?r():(f("Invalid OTP"),m(!1))}catch(T){console.error(T),f("Verification Failed"),m(!1)}};return P.jsx("div",{className:"login-overlay",style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"#0f0f0f",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,backdropFilter:"blur(10px)"},children:P.jsxs("div",{className:"glass-panel login-container",style:{padding:"3rem",width:"100%",maxWidth:"400px",textAlign:"center"},children:[P.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem"},children:s==="PHONE"?"Admin Login":"Verify OTP"}),P.jsx("div",{id:"recaptcha-container"}),s==="PHONE"&&P.jsxs("form",{onSubmit:_,children:[P.jsx("p",{style:{marginBottom:"1.5rem",opacity:.7},children:"Enter Mobile Number"}),P.jsxs("div",{className:"input-group",style:{display:"flex",alignItems:"center",marginBottom:"1rem",background:"rgba(255,255,255,0.05)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)"},children:[P.jsx("span",{style:{padding:"0 1rem",fontSize:"1.2rem",color:"#888",borderRight:"1px solid rgba(255,255,255,0.1)"},children:"+91"}),P.jsx("input",{type:"tel",value:e,onChange:y=>{const T=y.target.value.replace(/\D/g,"");T.length<=10&&t(T)},placeholder:"98765 43210",className:"glass-input-clean",style:{flex:1,border:"none",background:"transparent",padding:"1rem",fontSize:"1.2rem",color:"white",outline:"none"},autoFocus:!0})]}),P.jsx("button",{type:"submit",disabled:d,className:"glass-button",style:{width:"100%",justifyContent:"center",fontSize:"1rem",padding:"1rem"},children:d?"Sending OTP...":"Send OTP"})]}),s==="OTP"&&P.jsxs("form",{onSubmit:v,children:[P.jsx("p",{style:{marginBottom:"1.5rem",opacity:.7},children:"Enter the 6-digit code sent to your phone"}),P.jsx("input",{type:"text",value:n,onChange:y=>i(y.target.value),placeholder:"123456",className:"glass-input",style:{width:"100%",marginBottom:"1rem",fontSize:"1.2rem",textAlign:"center",letterSpacing:"0.5rem"},maxLength:6,autoFocus:!0}),P.jsx("button",{type:"submit",disabled:d,className:"glass-button",style:{width:"100%",justifyContent:"center",fontSize:"1rem",padding:"1rem"},children:d?"Verifying...":"Verify & Login"}),P.jsx("button",{type:"button",onClick:()=>{l("PHONE"),m(!1),f("")},style:{marginTop:"1rem",background:"none",border:"none",color:"#aaa",cursor:"pointer"},children:"Change Number"})]}),u&&P.jsx("p",{style:{color:"#ff4444",marginTop:"1rem",fontSize:"0.9rem"},children:u}),P.jsxs("div",{style:{marginTop:"2rem",fontSize:"0.7rem",opacity:.4},children:["This site is protected by reCAPTCHA and the Google",P.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noreferrer",style:{color:"inherit",textDecoration:"underline",margin:"0 4px"},children:"Privacy Policy"})," and",P.jsx("a",{href:"https://policies.google.com/terms",target:"_blank",rel:"noreferrer",style:{color:"inherit",textDecoration:"underline",margin:"0 4px"},children:"Terms of Service"})," apply."]})]})})},Zb=r=>new Promise((e,t)=>{const n=new FileReader;n.onload=i=>{try{const s=new Uint8Array(i.target.result),l=Ku(s,{type:"array"}),u=l.SheetNames[0],f=l.Sheets[u],d=gn.sheet_to_json(f,{header:1});e(d)}catch(s){t(s)}},n.onerror=i=>t(i),n.readAsArrayBuffer(r)}),lY=async(r,e)=>{try{const[t,n]=await Promise.all([Zb(r),Zb(e)]);if(!t||t.length===0)throw new Error("Old file is empty");if(!n||n.length===0)throw new Error("New file is empty");const i=n[0],s=i.findIndex(f=>f&&f.toString().trim()==="Ticket Number");if(s===-1)throw new Error("Column 'Ticket Number' not found in the latest file. Please ensure both files have this column.");const l=new Set;t.slice(1).forEach(f=>{const d=f[s];d&&l.add(String(d).trim())});const u=[];return n.slice(1).forEach(f=>{const d=f[s];d&&!l.has(String(d).trim())&&u.push(f)}),{headers:i,newRows:u,count:u.length}}catch(t){return console.error("Comparison Error:",t),{error:t.message}}},cY=(r,e)=>{const t=gn.aoa_to_sheet([r,...e]),n=gn.book_new();gn.book_append_sheet(n,t,"NewEntries");const i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19);Yl(n,`tally_differences_${i}.xlsx`,{bookType:"xlsx",type:"array"})},uY=({isOpen:r,onClose:e})=>{const t=L0(),[n,i]=We.useState(null),[s,l]=We.useState(null),[u,f]=We.useState(!1),[d,m]=We.useState(null);if(!r)return null;const _=async()=>{if(!n||!s){t.error("Please upload both files.");return}f(!0),m(null);try{const{headers:y,newRows:T,count:E,error:S}=await lY(n,s);S?m({error:S}):(m({count:E}),E>0&&cY(y,T))}catch(y){m({error:y.message})}finally{f(!1)}},v=()=>{i(null),l(null),m(null)};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"600px",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:()=>{v(),e()},style:{position:"absolute",top:"15px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"0.5rem",marginTop:0},children:"Tally Analysis"}),P.jsx("p",{style:{marginBottom:"2rem",opacity:.7,fontSize:"0.9rem"},children:"Compare two Excel files to extract newly added rows."}),P.jsxs("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem"},children:[P.jsxs("div",{style:{flex:1},children:[P.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"1. Old File"}),P.jsx("div",{style:{border:"1px dashed rgba(255,255,255,0.3)",padding:"1.5rem",borderRadius:"8px",textAlign:"center",background:n?"rgba(76, 175, 80, 0.1)":"transparent"},children:n?P.jsxs("div",{children:[P.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),P.jsx("div",{style:{wordBreak:"break-all",fontSize:"0.8rem"},children:n.name}),P.jsx("button",{onClick:()=>i(null),style:{marginTop:"0.5rem",background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",fontSize:"0.8rem"},children:"Remove"})]}):P.jsxs(P.Fragment,{children:[P.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:y=>i(y.target.files[0]),style:{display:"none"},id:"old-file-upload"}),P.jsx("label",{htmlFor:"old-file-upload",className:"glass-button",style:{fontSize:"0.8rem"},children:"Browse Old"})]})})]}),P.jsxs("div",{style:{flex:1},children:[P.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"2. Latest File"}),P.jsx("div",{style:{border:"1px dashed rgba(255,255,255,0.3)",padding:"1.5rem",borderRadius:"8px",textAlign:"center",background:s?"rgba(76, 175, 80, 0.1)":"transparent"},children:s?P.jsxs("div",{children:[P.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),P.jsx("div",{style:{wordBreak:"break-all",fontSize:"0.8rem"},children:s.name}),P.jsx("button",{onClick:()=>l(null),style:{marginTop:"0.5rem",background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",fontSize:"0.8rem"},children:"Remove"})]}):P.jsxs(P.Fragment,{children:[P.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:y=>l(y.target.files[0]),style:{display:"none"},id:"new-file-upload"}),P.jsx("label",{htmlFor:"new-file-upload",className:"glass-button",style:{fontSize:"0.8rem"},children:"Browse Latest"})]})})]})]}),u&&P.jsxs("div",{style:{textAlign:"center",marginBottom:"1rem"},children:[P.jsx("div",{className:"spinner",style:{display:"inline-block",width:"20px",height:"20px",border:"2px solid rgba(255,255,255,0.3)",borderTop:"2px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",marginRight:"0.5rem"}}),P.jsx("span",{children:"Processing files..."})]}),d&&P.jsx("div",{style:{marginBottom:"1.5rem",padding:"1rem",borderRadius:"8px",background:d.error?"rgba(244, 67, 54, 0.1)":"rgba(76, 175, 80, 0.1)",border:`1px solid ${d.error?"#f44336":"#4caf50"}`},children:d.error?P.jsxs("div",{style:{color:"#ff6b6b"},children:[" ",d.error]}):P.jsxs("div",{style:{color:"#81c784"},children:[" Success! Found ",P.jsx("strong",{children:d.count})," new newly added rows.",d.count>0&&P.jsx("div",{children:"File downloaded automatically."})]})}),P.jsx("button",{onClick:_,disabled:!n||!s||u,className:"glass-button",style:{width:"100%",background:!n||!s?"rgba(255,255,255,0.1)":"rgba(0, 123, 255, 0.5)",cursor:!n||!s?"not-allowed":"pointer",padding:"1rem",fontSize:"1.1rem"},children:"Compare & Download Differences"})]})})},fY=({isOpen:r,onClose:e,count:t,setCount:n,onGenerate:i})=>r?P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"400px",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"1.5rem",marginTop:0,textAlign:"center"},children:"IMIS ID Generator"}),P.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[P.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.9rem",textAlign:"left",opacity:.9},children:"Number of IDs to Generate:"}),P.jsx("input",{type:"number",className:"glass-input",placeholder:"Enter quantity...",value:t,onChange:s=>n(s.target.value),style:{padding:"0.8rem"}})]}),P.jsx("button",{className:"glass-button",style:{marginTop:"0.5rem",justifyContent:"center",background:"rgba(33, 150, 243, 0.3)"},onClick:i,children:"Generte & Download .xlsx"})]})]})}):null,hY=({isOpen:r,onClose:e})=>{const[t,n]=We.useState(null),[i,s]=We.useState(null),[l,u]=We.useState(!1);if(!r)return null;const f=(m,_)=>{const v=m.target.files[0];_==="cfms"&&n(v),_==="sac"&&s(v)},d=async()=>{if(!t||!i){alert("Please upload both files.");return}u(!0);try{const{readExcelFile:m}=await Pr(async()=>{const{readExcelFile:ee}=await import("./excelUtils-LQ7RWABM.js");return{readExcelFile:ee}},[],import.meta.url),{matchAndMerge:_}=await Pr(async()=>{const{matchAndMerge:ee}=await import("./dataMatcher-DT7jLePl.js");return{matchAndMerge:ee}},[],import.meta.url),v=await Pr(()=>Promise.resolve().then(()=>d0),void 0,import.meta.url);console.log("Reading CFMS Excel...");const y=await m(t);if(console.log("CFMS Data:",y),!y||y.length===0){alert("No data found in CFMS Excel."),u(!1);return}console.log("Reading SAC Excel...");const T=await m(i);console.log("SAC Data:",T),console.log("Matching...");const E=_(T,y);console.log("Merged Data:",E);const S=v.utils.json_to_sheet(E),D=v.utils.book_new();v.utils.book_append_sheet(D,S,"Matched Data");const U=new Date,W=`matched_result_${`${String(U.getDate()).padStart(2,"0")}_${String(U.getMonth()+1).padStart(2,"0")}_${U.getFullYear()}`}.xlsx`;v.writeFile(D,W),alert("Matching Complete! File downloaded."),e()}catch(m){console.error("Match Error:",m),alert("Error matching files: "+m.message)}finally{u(!1)}};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"600px",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:e,disabled:l,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:l?"not-allowed":"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"1.5rem",marginTop:0,textAlign:"center"},children:"Match CFMS with SAC"}),P.jsxs("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem"},children:[P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.9rem",opacity:.9},children:"Upload CFMS Excel file"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:t?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:m=>f(m,"cfms"),style:{display:"none"},id:"cfms-upload",disabled:l}),P.jsx("label",{htmlFor:"cfms-upload",style:{cursor:l?"wait":"pointer",width:"100%",display:"block"},children:t?P.jsx("span",{style:{color:"#4caf50"},children:t.name}):P.jsx("span",{style:{opacity:.7},children:"Click to Browse"})})]})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.9rem",opacity:.9},children:"Upload SAC Excel file"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:i?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:m=>f(m,"sac"),style:{display:"none"},id:"sac-upload",disabled:l}),P.jsx("label",{htmlFor:"sac-upload",style:{cursor:l?"wait":"pointer",width:"100%",display:"block"},children:i?P.jsx("span",{style:{color:"#4caf50"},children:i.name}):P.jsx("span",{style:{opacity:.7},children:"Click to Browse"})})]})]})]}),P.jsxs("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",gap:"1rem"},children:[l&&P.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",color:"#ffeb3b",fontWeight:"bold"},children:[P.jsx("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"#ffeb3b",animation:"spin 1s ease-in-out infinite"}}),P.jsx("span",{children:"Processing... This may take a moment."}),P.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]}),P.jsx("button",{className:"glass-button",style:{padding:"0.8rem 2rem",background:l?"grey":"rgba(33, 150, 243, 0.3)",cursor:l?"not-allowed":"pointer"},onClick:d,disabled:l,children:l?"Matching...":"Match Data"})]})]})})},t3=We.createContext(null),iE=()=>{const r=We.useContext(t3);if(!r)throw new Error("useDataEntry must be used within a DataEntryProvider");return r},dY=({isOpen:r,onClose:e})=>{const{entries:t}=iE(),[n,i]=We.useState(null),[s,l]=We.useState("upload"),[u,f]=We.useState(null),[d,m]=We.useState(null),[_,v]=We.useState(!1),[y,T]=We.useState(null),[E,S]=We.useState("upload"),[D,U]=We.useState("All"),[k,W]=We.useState([]);if(!r)return null;const ee=(xe,ve)=>{const ne=xe.target.files[0];ve==="commitment"&&i(ne),ve==="cfms"&&f(ne),ve==="sac"&&m(ne)},X=async()=>{if(s==="upload"&&!n){alert("Upload Commitment File is mandatory.");return}if(s==="server"&&(!t||t.length===0)){alert("No data found in server database. Please add entries in 'Data Entry' first.");return}if(!u&&!d){alert("Please upload at least one secondary file (CFMS or SAC) to process.");return}v(!0),setTimeout(async()=>{try{const xe=await Pr(()=>Promise.resolve().then(()=>d0),void 0,import.meta.url),{processCommitments:ve}=await Pr(async()=>{const{processCommitments:O}=await import("./commitmentsProcessor-COCoH_jg.js");return{processCommitments:O}},[],import.meta.url),ne=O=>new Promise((Q,q)=>{if(!O)return Q([]);const te=new FileReader;te.onload=oe=>{try{const Te=new Uint8Array(oe.target.result),ke=xe.read(Te,{type:"array"}),be=ke.Sheets[ke.SheetNames[0]];Q(xe.utils.sheet_to_json(be))}catch(Te){q(Te)}},te.onerror=q,te.readAsArrayBuffer(O)});let le=[];s==="server"?le=t.map(O=>({"NAME OF THE VENDOR":O.vendorName,"Beneficiary Name":O.beneficiaryName,"ACCOUNT NUMBER":O.accountNumber,"IFSC Code":O.ifscCode,AADHAR:O.aadharNumber,PAN:O.panCard,"CFMS ID":O.cfmsId,"Account Number":O.accountNumber})):le=await ne(n);const Pe=await ne(u),ae=await ne(d);if(!le.length)throw new Error("Commitment data is empty.");if(!Pe.length&&!ae.length)throw new Error("Secondary files are empty.");console.log("Processing...");const Me=ve(le,Pe,ae),J=[...new Set(Me.map(O=>O["NAME OF THE VENDOR"]||"Unknown"))].sort();T(Me),W(["All",...J]),U("All"),S("results"),alert(`Analysis Complete! Found ${Me.length} matches.`)}catch(xe){console.error(xe),alert("Error: "+xe.message)}finally{v(!1)}},100)},A=async()=>{if(!y)return;let xe=D==="All"?y:y.filter(ve=>ve["NAME OF THE VENDOR"]===D);if(xe=xe.map((ve,ne)=>({"S.No":ne+1,...ve})),D!=="All")try{let ve="both";d&&!u?ve="sac":!d&&u&&(ve="cfms");const{generateVendorPdf:ne}=await Pr(async()=>{const{generateVendorPdf:le}=await import("./pdfGenerator-CzqP8X1l.js");return{generateVendorPdf:le}},__vite__mapDeps([0,1,2]),import.meta.url);ne(xe,D,ve)}catch(ve){console.error(ve),alert("Error generating PDF: "+ve.message)}else try{const ve=M(xe),ne={"S.No":"","NAME OF THE VENDOR":"GRAND TOTAL","Proposed Payment Individual":B(ve.proposed),"Credited Payment Individual":B(ve.credited),"My Share":B(ve.share)};xe.push(ne);const le=await Pr(()=>Promise.resolve().then(()=>d0),void 0,import.meta.url),Pe=le.utils.json_to_sheet(xe),ae=le.utils.book_new();le.utils.book_append_sheet(ae,Pe,"Commitments");const Me=new Date().toISOString().slice(0,10);le.writeFile(ae,`commitments_${Me}.xlsx`)}catch(ve){console.error(ve),alert("Error generating Excel")}},R=()=>{S("upload"),T(null),i(null),f(null),m(null),U("All")},C=xe=>{if(!xe)return 0;const ve=String(xe).replace(/[^0-9.-]+/g,"");return parseFloat(ve)||0},B=xe=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(xe),N=y?D==="All"?y:y.filter(xe=>xe["NAME OF THE VENDOR"]===D):[],M=xe=>{let ve=0,ne=0,le=0;return xe.forEach(Pe=>{ve+=C(Pe["Proposed Payment Individual"]),ne+=C(Pe["Credited Payment Individual"]),le+=C(Pe["My Share"])}),{proposed:ve,credited:ne,share:le}},V=M(N);return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(8px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:E==="results"?"90%":"800px",height:E==="results"?"90%":"auto",position:"relative",padding:"2rem",display:"flex",flexDirection:"column"},children:[P.jsx("button",{onClick:()=>{e(),R()},style:{position:"absolute",top:10,right:15,background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{textAlign:"center",marginTop:0},children:E==="results"?"Analysis Results":"Show the Commitments"}),E==="upload"?P.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[P.jsxs("div",{style:{display:"flex",gap:"1.5rem",justifyContent:"space-between"},children:[P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.8rem",opacity:.9},children:"Commitment File"}),P.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:P.jsxs("select",{style:{flex:1,padding:"0.5rem",borderRadius:"4px",background:"rgba(255,255,255,0.1)",color:"white",border:"1px solid rgba(255,255,255,0.2)"},value:s,onChange:xe=>l(xe.target.value),children:[P.jsx("option",{value:"server",style:{color:"black"},children:"From Server"}),P.jsx("option",{value:"upload",style:{color:"black"},children:"Upload Device"})]})}),s==="server"?P.jsx("select",{style:{width:"100%",padding:"1rem",borderRadius:"8px",background:"rgba(255,255,255,0.05)",color:"white",border:"2px dashed rgba(255,255,255,0.2)"},disabled:!0,children:P.jsxs("option",{children:["Using ",t.length," Live Entries from Database"]})}):P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:n?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:xe=>ee(xe,"commitment"),style:{display:"none"},id:"comm-upload"}),P.jsx("label",{htmlFor:"comm-upload",style:{cursor:"pointer",width:"100%",display:"block",fontSize:"0.8rem"},children:n?P.jsx("span",{style:{color:"#4caf50"},children:n.name}):P.jsx("span",{children:"Click to Browse"})})]})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.8rem",opacity:.9},children:"CFMS Excel"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:u?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:xe=>ee(xe,"cfms"),style:{display:"none"},id:"cfms-upload"}),P.jsx("label",{htmlFor:"cfms-upload",style:{cursor:"pointer",width:"100%",display:"block",fontSize:"0.8rem"},children:u?P.jsx("span",{style:{color:"#4caf50"},children:u.name}):P.jsx("span",{children:"Click to Browse"})})]})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.8rem",opacity:.9},children:"SAC Excel"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:d?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:xe=>ee(xe,"sac"),style:{display:"none"},id:"sac-upload"}),P.jsx("label",{htmlFor:"sac-upload",style:{cursor:"pointer",width:"100%",display:"block",fontSize:"0.8rem"},children:d?P.jsx("span",{style:{color:"#4caf50"},children:d.name}):P.jsx("span",{children:"Click to Browse"})})]})]})]}),P.jsx("div",{style:{display:"flex",justifyContent:"center"},children:P.jsx("button",{className:"glass-button",style:{padding:"0.8rem 2rem",background:_?"grey":"rgba(33, 150, 243, 0.3)"},onClick:X,disabled:_,children:_?"Processing 3 Files...":"Process All Files"})})]}):P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[P.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem",alignItems:"center"},children:[P.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[P.jsx("label",{children:"Filter by Vendor:"}),P.jsx("select",{value:D,onChange:xe=>U(xe.target.value),style:{padding:"5px",borderRadius:"4px",background:"rgba(0,0,0,0.3)",color:"white",border:"1px solid rgba(255,255,255,0.2)"},children:k.map(xe=>P.jsx("option",{value:xe,children:xe},xe))})]}),P.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[P.jsx("button",{className:"glass-button",onClick:R,children:"Back to Upload"}),P.jsx("button",{className:"glass-button",onClick:A,style:{background:"rgba(76, 175, 80, 0.3)"},children:D==="All"?"Download Excel":"Download PDF"})]})]}),P.jsx("div",{style:{flex:1,overflow:"auto",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px"},children:P.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[P.jsx("thead",{style:{position:"sticky",top:0,background:"#2c3e50",zIndex:1},children:P.jsxs("tr",{children:[P.jsx("th",{style:{padding:"10px",textAlign:"center",borderBottom:"1px solid #ddd"},children:"S.No"}),y&&y.length>0&&Object.keys(y[0]).map(xe=>{let ve="left";return(xe.includes("Payment")||xe.includes("Amount")||xe.includes("Share")||xe.includes("count"))&&(ve="right"),P.jsx("th",{style:{padding:"10px",textAlign:ve,borderBottom:"1px solid #ddd"},children:xe},xe)})]})}),P.jsx("tbody",{children:N.map((xe,ve)=>P.jsxs("tr",{style:{background:ve%2===0?"rgba(255,255,255,0.02)":"transparent"},children:[P.jsx("td",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:ve+1}),Object.keys(xe).map((ne,le)=>{const Pe=xe[ne];let ae="left";return(ne.includes("Payment")||ne.includes("Amount")||ne.includes("Share")||ne.includes("count"))&&(ae="right"),P.jsx("td",{style:{padding:"8px",textAlign:ae,borderBottom:"1px solid rgba(255,255,255,0.05)"},children:Pe},le)})]},ve))}),P.jsx("tfoot",{style:{position:"sticky",bottom:0,background:"#34495e",fontWeight:"bold"},children:P.jsxs("tr",{children:[P.jsx("td",{style:{padding:"10px"}}),y&&y.length>0&&Object.keys(y[0]).map((xe,ve)=>xe==="Proposed Payment Individual"?P.jsx("td",{style:{padding:"10px"},children:B(V.proposed)},ve):xe==="Credited Payment Individual"?P.jsx("td",{style:{padding:"10px"},children:B(V.credited)},ve):xe==="My Share"?P.jsx("td",{style:{padding:"10px"},children:B(V.share)},ve):xe==="NAME OF THE VENDOR"?P.jsx("td",{style:{padding:"10px"},children:"GRAND TOTAL"},ve):P.jsx("td",{},ve))]})})]})})]})]})})},mY=({isOpen:r,onClose:e,initialData:t,onSave:n})=>{const i=L0(),[s,l]=We.useState({vendorName:"",beneficiaryName:"",cfmsId:"",aadharNumber:"",panCard:"",ifscCode:"",accountNumber:""});We.useEffect(()=>{l(t||{vendorName:"",beneficiaryName:"",cfmsId:"",aadharNumber:"",panCard:"",ifscCode:"",accountNumber:""})},[t,r]);const u=S=>{const{name:D,value:U}=S.target;if(D==="accountNumber"){/^\d*$/.test(U)&&l(k=>({...k,[D]:U}));return}if(D==="aadharNumber"){/^\d{0,12}$/.test(U)&&l(k=>({...k,[D]:U}));return}if(["ifscCode","vendorName","beneficiaryName","cfmsId","panCard"].includes(D)){l(k=>({...k,[D]:U.toUpperCase()}));return}l(k=>({...k,[D]:U}))},[f,d]=We.useState(null),[m,_]=We.useState(!1);We.useEffect(()=>{const S=s.ifscCode;S.length===11?v(S):d(null)},[s.ifscCode]);const v=async S=>{_(!0);try{const D=await fetch(`https://ifsc.razorpay.com/${S}`);if(D.ok){const U=await D.json();d(U)}else d(null)}catch(D){console.error("Error fetching IFSC:",D),d(null)}finally{_(!1)}},y=S=>{S.preventDefault();const D=/^[A-Z]{4}0[A-Z0-9]{6}$/,U=/^[0-9]{9,18}$/;if(!s.vendorName.trim()||!s.beneficiaryName.trim()||!s.ifscCode.trim()||!s.accountNumber.trim()){i.error("Please fill all mandatory fields: Vendor, Beneficiary, IFSC, Account");return}if(s.aadharNumber&&s.aadharNumber.length!==12){i.error("Aadhar Number must be exactly 12 digits.");return}if(!D.test(s.ifscCode)){i.error("Invalid IFSC Code Format. (e.g., SBIN0001234)");return}if(!U.test(s.accountNumber)){i.error("Invalid Account Number. Must be 9-18 digits.");return}n(s),t?e():(l({vendorName:"",beneficiaryName:"",cfmsId:"",aadharNumber:"",panCard:"",ifscCode:"",accountNumber:""}),d(null))},T={display:"block",width:"100%",padding:"0.8rem",marginBottom:"1rem",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"4px",color:"white",fontSize:"1rem"},E={display:"block",marginBottom:"0.5rem",textAlign:"left",fontSize:"0.9rem",opacity:.9};return r?P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1050,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"600px",maxHeight:"90vh",overflowY:"auto",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"1.5rem",marginTop:0},children:t?"Edit Entry":"Data Entry"}),P.jsxs("form",{onSubmit:y,children:[P.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Vendor Name *"}),P.jsx("input",{type:"text",name:"vendorName",value:s.vendorName,onChange:u,style:T,placeholder:"Enter Vendor Name"})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Beneficiary Name *"}),P.jsx("input",{type:"text",name:"beneficiaryName",value:s.beneficiaryName,onChange:u,style:T,placeholder:"Enter Beneficiary Name"})]})]}),P.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[P.jsxs("div",{children:[P.jsx("label",{style:E,children:"CFMS ID"}),P.jsx("input",{type:"text",name:"cfmsId",value:s.cfmsId,onChange:u,style:T,placeholder:"Enter CFMS ID"})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Aadhar Number"}),P.jsx("input",{type:"text",name:"aadharNumber",value:s.aadharNumber,onChange:u,style:T,placeholder:"Enter Aadhar"})]})]}),P.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Pan Card"}),P.jsx("input",{type:"text",name:"panCard",value:s.panCard,onChange:u,style:T,placeholder:"Enter PAN"})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"IFSC Code *"}),P.jsx("input",{type:"text",name:"ifscCode",value:s.ifscCode,onChange:u,maxLength:11,style:{...T,textTransform:"uppercase"},placeholder:"Enter IFSC"}),m&&P.jsx("div",{style:{fontSize:"0.8rem",color:"#ccc"},children:"Fetching Bank Details..."}),f&&P.jsxs("div",{style:{fontSize:"0.85rem",color:"#4caf50",marginTop:"-0.5rem",marginBottom:"1rem",background:"rgba(76, 175, 80, 0.1)",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(76, 175, 80, 0.3)"},children:[" ",f.BANK," - ",f.BRANCH,", ",f.CITY]})]})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Account Number *"}),P.jsx("input",{type:"text",name:"accountNumber",value:s.accountNumber,onChange:u,style:T,placeholder:"Enter Account Number"})]}),P.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[P.jsx("button",{type:"button",onClick:e,className:"glass-button",style:{background:"rgba(255, 255, 255, 0.1)"},children:"Cancel"}),P.jsx("button",{type:"submit",className:"glass-button",style:{background:"rgba(76, 175, 80, 0.5)"},children:t?"Update":"Submit"})]})]})]})}):null},pY=({isOpen:r,onClose:e})=>{const[t,n]=We.useState(!1),{addEntry:i}=iE(),s=L0();if(!r)return null;const l=async()=>{try{const f=await Pr(()=>Promise.resolve().then(()=>d0),void 0,import.meta.url),d=[["Vendor Name","Beneficiary Name","CFMS ID","Aadhar Number","Pan Card","IFSC Code","Account Number"],["Example Vendor","Example Beneficiary","123456","123412341234","ABCDE1234F","SBIN0000300","12345678901"]],m=f.utils.aoa_to_sheet(d),_=f.utils.book_new();f.utils.book_append_sheet(_,m,"Template"),f.writeFile(_,"DataEntry_Template.xlsx"),s.success("Template downloaded successfully!")}catch(f){console.error("Template download failed:",f),s.error("Failed to download template.")}},u=async f=>{const d=f.target.files[0];if(d){n(!0);try{const{readExcelFile:m}=await Pr(async()=>{const{readExcelFile:E}=await import("./excelUtils-LQ7RWABM.js");return{readExcelFile:E}},[],import.meta.url),_=await m(d);if(!_||_.length===0){s.error("File is empty or invalid format."),n(!1);return}let v=0,y=0;const T=_.map(async E=>{const S={vendorName:(E["Vendor Name"]||"").toString().trim().toUpperCase(),beneficiaryName:(E["Beneficiary Name"]||"").toString().trim().toUpperCase(),cfmsId:(E["CFMS ID"]||"").toString().trim().toUpperCase(),aadharNumber:(E["Aadhar Number"]||"").toString().trim(),panCard:(E["Pan Card"]||"").toString().trim().toUpperCase(),ifscCode:(E["IFSC Code"]||"").toString().trim().toUpperCase(),accountNumber:(E["Account Number"]||"").toString().trim()};if(!S.vendorName||!S.beneficiaryName||!S.ifscCode||!S.accountNumber){y++;return}if(S.aadharNumber&&!/^\d{12}$/.test(S.aadharNumber)){y++;return}if(!/^[A-Z]{4}0[A-Z0-9]{6}$/.test(S.ifscCode)){y++;return}if(!/^\d{9,18}$/.test(S.accountNumber)){y++;return}await i(S)?v++:y++});await Promise.all(T),s.success(`Bulk Upload Complete: ${v} Added, ${y} Skipped.`),f.target.value="",v>0&&e()}catch(m){console.error("Bulk upload error:",m),s.error("Failed to process file.")}finally{n(!1)}}};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1050,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"500px",padding:"2rem",display:"flex",flexDirection:"column",gap:"1.5rem",position:"relative"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginTop:0},children:"Bulk Data Entry"}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("p",{style:{margin:"0 0 1rem 0"},children:"Step 1: Download the template."}),P.jsx("button",{onClick:l,className:"glass-button",style:{width:"100%"},children:" Download Excel Template"})]}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("p",{style:{margin:"0 0 1rem 0"},children:"Step 2: Upload filled Excel file."}),t?P.jsx("div",{style:{textAlign:"center",padding:"1rem"},children:"Processing..."}):P.jsxs(P.Fragment,{children:[P.jsx("input",{type:"file",id:"bulk-upload-input",accept:".xlsx, .xls",onChange:u,style:{display:"none"}}),P.jsx("label",{htmlFor:"bulk-upload-input",className:"glass-button",style:{display:"block",textAlign:"center",cursor:"pointer",background:"rgba(76, 175, 80, 0.4)"},children:" Upload & Process"})]})]})]})})},gY=({isOpen:r,onClose:e,entries:t=[],onEdit:n,onDelete:i})=>{const[s,l]=We.useState(""),[u,f]=We.useState(""),[d,m]=We.useState({key:"vendorName",direction:"asc"}),_=We.useMemo(()=>[...new Set(t.map(W=>W.vendorName))].sort(),[t]);if(!r)return null;const v=k=>{let W="asc";d.key===k&&d.direction==="asc"&&(W="desc"),m({key:k,direction:W})},T=[...t].sort((k,W)=>k[d.key]<W[d.key]?d.direction==="asc"?-1:1:k[d.key]>W[d.key]?d.direction==="asc"?1:-1:0).filter(k=>{const W=s===""||k.vendorName===s,ee=k.ifscCode.toLowerCase().includes(u.toLowerCase());return W&&ee}),E=k=>d.key===k?d.direction==="asc"?" ":" ":"",S=async()=>{try{const k=await Pr(()=>Promise.resolve().then(()=>d0),void 0,import.meta.url),W=T.map((A,R)=>({"S.No":R+1,"Vendor Name":A.vendorName,"Beneficiary Name":A.beneficiaryName,"CFMS ID":A.cfmsId||"-","Aadhar Number":A.aadharNumber||"-","PAN Card":A.panCard||"-","IFSC Code":A.ifscCode,"Account Number":A.accountNumber})),ee=k.utils.json_to_sheet(W),X=k.utils.book_new();k.utils.book_append_sheet(X,ee,"Data Entries"),k.writeFile(X,`Data_Entries_${new Date().toLocaleDateString().replace(/\//g,"-")}.xlsx`)}catch(k){console.error("Export failed:",k),alert("Failed to export Excel")}},D=async()=>{try{const{default:k}=await Pr(async()=>{const{default:R}=await import("./jspdf.es.min-DFico01g.js").then(C=>C.j);return{default:R}},[],import.meta.url),{default:W}=await Pr(async()=>{const{default:R}=await import("./jspdf.plugin.autotable-DZlIrCiz.js");return{default:R}},[],import.meta.url),ee=new k,X=["S.No","Vendor Name","Beneficiary Name","IFSC Code","Account Number"],A=T.map((R,C)=>[C+1,R.vendorName,R.beneficiaryName,R.ifscCode,R.accountNumber]);ee.text("Data Entries List",14,15),W(ee,{head:[X],body:A,startY:20,theme:"grid",styles:{overflow:"linebreak",fontSize:10,cellPadding:2},columnStyles:{0:{cellWidth:15},1:{cellWidth:"auto"},2:{cellWidth:"auto"},3:{cellWidth:30},4:{cellWidth:40}}}),ee.save(`Data_Entries_${new Date().toLocaleDateString().replace(/\//g,"-")}.pdf`)}catch(k){console.error("PDF Export failed:",k),alert(`Failed to export PDF: ${k.message}`)}},U={padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.1)",color:"white",width:"200px"};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"90%",maxWidth:"1200px",height:"90vh",display:"flex",flexDirection:"column",position:"relative"},children:[P.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[P.jsxs("h2",{style:{margin:0},children:["View Data Entries (",T.length,")"]}),P.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""})]}),P.jsxs("div",{style:{padding:"1rem 1.5rem",display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[P.jsxs("select",{value:s,onChange:k=>l(k.target.value),style:U,children:[P.jsx("option",{value:"",style:{color:"black"},children:"All Vendors"}),_.map(k=>P.jsx("option",{value:k,style:{color:"black"},children:k},k))]}),P.jsx("input",{type:"text",placeholder:"Filter by IFSC...",value:u,onChange:k=>f(k.target.value),style:U}),P.jsx("div",{style:{flex:1}}),P.jsx("button",{className:"glass-button",onClick:S,style:{background:"rgba(76, 175, 80, 0.3)"},children:"Export Excel"}),P.jsx("button",{className:"glass-button",onClick:D,style:{background:"rgba(255, 152, 0, 0.3)"},children:"Export PDF"})]}),P.jsx("div",{style:{flex:1,overflow:"auto",padding:"1.5rem"},children:T.length===0?P.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"rgba(255,255,255,0.5)"},children:t.length===0?"No entries found. Please add some data.":"No matches found."}):P.jsxs("table",{className:"data-table",style:{width:"100%",borderCollapse:"collapse"},children:[P.jsx("thead",{children:P.jsxs("tr",{children:[P.jsx("th",{style:{textAlign:"left",padding:"0.75rem"},children:"S.No"}),P.jsxs("th",{onClick:()=>v("vendorName"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Vendor Name ",E("vendorName")]}),P.jsxs("th",{onClick:()=>v("beneficiaryName"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Beneficiary Name ",E("beneficiaryName")]}),P.jsxs("th",{onClick:()=>v("cfmsId"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["CFMS ID ",E("cfmsId")]}),P.jsxs("th",{onClick:()=>v("aadharNumber"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Aadhar Number ",E("aadharNumber")]}),P.jsxs("th",{onClick:()=>v("panCard"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Pan Card ",E("panCard")]}),P.jsxs("th",{onClick:()=>v("ifscCode"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["IFSC Code ",E("ifscCode")]}),P.jsxs("th",{onClick:()=>v("accountNumber"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Account Number ",E("accountNumber")]}),P.jsx("th",{style:{textAlign:"center",padding:"0.75rem"},children:"Actions"})]})}),P.jsx("tbody",{children:T.map((k,W)=>P.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:W+1}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.vendorName}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.beneficiaryName}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.cfmsId||"-"}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.aadharNumber||"-"}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.panCard||"-"}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.ifscCode}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.accountNumber}),P.jsx("td",{style:{textAlign:"center",padding:"0.75rem"},children:P.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[P.jsx("button",{onClick:()=>n(k),className:"glass-button",style:{padding:"5px 10px",fontSize:"0.8rem",background:"rgba(33, 150, 243, 0.3)"},children:"Edit"}),P.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this entry?")&&i(k.id)},className:"glass-button",style:{padding:"5px 10px",fontSize:"0.8rem",background:"rgba(244, 67, 54, 0.3)"},children:"Delete"})]})})]},k.id))})]})})]})})};class _Y extends LN.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught Error:",e,t),this.setState({errorInfo:t})}handleReload=()=>{window.location.reload()};handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?P.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:"#ff6b6b"},children:P.jsxs("div",{className:"glass-panel",style:{padding:"3rem",maxWidth:"600px"},children:[P.jsx("h2",{style:{fontSize:"2rem",marginBottom:"1rem"},children:" Application Error"}),P.jsx("p",{style:{color:"white",marginBottom:"1rem",opacity:.9},children:"Something went wrong in the application specific logic."}),P.jsx("div",{style:{background:"rgba(0,0,0,0.3)",padding:"1rem",borderRadius:"8px",fontFamily:"monospace",marginBottom:"2rem",textAlign:"left",overflow:"auto",maxHeight:"200px",fontSize:"0.9rem",color:"#ffcccc"},children:this.state.error&&this.state.error.toString()}),P.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[P.jsx("button",{onClick:this.handleReset,className:"glass-button",children:"Try Again"}),P.jsx("button",{onClick:this.handleReload,className:"glass-button",style:{background:"rgba(255,255,255,0.1)"},children:"Reload Page"})]})]})}):this.props.children}}const xY=()=>{const[r,e]=We.useState([]),[t,n]=We.useState([]),[i,s]=We.useState(""),[l,u]=We.useState(!1),[f,d]=We.useState(null),m=We.useCallback(v=>{v&&(u(!0),s(v.name),d(null),e([]),setTimeout(()=>{const y=new FileReader;y.onload=T=>{try{const E=T.target.result,S=Ku(E,{type:"binary"}),D=S.SheetNames[0],U=S.Sheets[D];let k=gn.sheet_to_json(U,{header:1});if(!k||k.length===0)throw new Error("File is empty");let W=k[0];const ee=W.indexOf("Benificiary Registration Id");ee!==-1&&(W[ee]="IMIS Id");let X=[...W];X=X.filter(N=>N!=="CFMS Id"&&N!=="Aadhar Number"&&N!=="Amount");const A=X.findIndex(N=>N&&N.trim()==="Bank Account Number"),R=["CFMS Id","Aadhar Number"];A!==-1?X.splice(A,0,...R):X.push(...R),X.includes("Amount")||X.push("Amount");const C={};W.forEach((N,M)=>C[N]=M);const B=k.slice(1).map(N=>X.map(M=>{const V=C[M];return V!==void 0&&N[V]!==void 0?N[V]:""}));n(X),e(B)}catch(E){console.error(E),d(E.message||"Error reading file")}finally{u(!1)}},y.onerror=()=>{d("Failed to read file"),u(!1)},y.readAsBinaryString(v)},100))},[]),_=We.useCallback(()=>{e([]),n([]),s(""),d(null)},[]);return{data:r,setData:e,headers:t,setHeaders:n,fileName:i,isUploading:l,error:f,processFile:m,clearData:_}},vY=()=>{const[r,e]=We.useState(!1),[t,n]=We.useState(null),[i,s]=We.useState(null),[l,u]=We.useState(0),[f,d]=We.useState(0);return{isVerifying:r,investigationReport:t,generationContext:i,synthesisCount:l,setSynthesisCount:u,progress:f,analyzeAndVerify:async(v,y)=>{try{e(!0),d(0),n(null);const{validateRow:T}=await Pr(async()=>{const{validateRow:N}=await import("./idGenerator-Dp6YtTpY.js");return{validateRow:N}},[],import.meta.url),{analyzeContext:E}=await Pr(async()=>{const{analyzeContext:N}=await import("./dataAnalyzer-CEU6KrsT.js");return{analyzeContext:N}},[],import.meta.url),S=new Set(y.map(N=>N&&N.trim())),D=[];if(rY.forEach(N=>{S.has(N)||D.push(N)}),D.length>0)throw new Error(`CRITICAL ERROR: Missing required columns: ${D.join(", ")}`);const U=E(v,y);s(U);let k=0,W=0;const ee={ticket:0,ftr:0,reg:0,name:0},X=y.indexOf("Ticket Number"),A=y.indexOf("FTR Number"),R=y.indexOf("IMIS Id"),C=y.indexOf("Benificiary Name"),B=v.length;for(let N=0;N<B;N++){const M=v[N];T(M).valid?(k++,X!==-1&&!M[X]&&ee.ticket++,A!==-1&&!M[A]&&ee.ftr++,R!==-1&&!M[R]&&ee.reg++,C!==-1&&!M[C]&&ee.name++):W++,B>100&&N%Math.ceil(B/10)===0&&d(Math.round(N/B*100))}return d(100),n({total:B,validCount:k,invalidCount:W,missingStats:ee,context:U}),{success:!0}}catch(T){return console.error("Analysis failed:",T),{success:!1,error:T.message}}finally{e(!1)}},generateIds:async(v,y,T,E)=>{try{const{generateTicketNumber:S,generateFTRNumber:D,generateBeneficiaryRegId:U,generateName:k,validateRow:W}=await Pr(async()=>{const{generateTicketNumber:qe,generateFTRNumber:Oe,generateBeneficiaryRegId:nt,generateName:gt,validateRow:Lt}=await import("./idGenerator-Dp6YtTpY.js");return{generateTicketNumber:qe,generateFTRNumber:Oe,generateBeneficiaryRegId:nt,generateName:gt,validateRow:Lt}},[],import.meta.url),{synthesizeRows:ee}=await Pr(async()=>{const{synthesizeRows:qe}=await import("./dataSynthesizer-nKH26hCw.js");return{synthesizeRows:qe}},__vite__mapDeps([3,4]),import.meta.url),{IdService:X}=await Pr(async()=>{const{IdService:qe}=await import("./IdService-B1BhGqQl.js");return{IdService:qe}},[],import.meta.url);let A;try{A=await X.getAllIds()}catch{return{success:!1,error:`CRITICAL: Cannot connect to Online Storage. 

Check your internet connection or configuration. 
ID Generation aborted to prevent duplicates.`}}const R=y.indexOf("Ticket Number"),C=y.indexOf("FTR Number"),B=y.indexOf("IMIS Id"),N=y.indexOf("Benificiary Name"),M=y.indexOf("District"),V=y.indexOf("Mandal"),xe=y.indexOf("Stage Level"),ve=y.indexOf("Amount"),ne=y.indexOf("Bank Account Number"),le=y.indexOf("Bank Branch"),Pe=y.indexOf("IFSC Code"),ae=y.indexOf("Nank Account Number"),Me={ticket:new Set(A.ticket),ftr:new Set(A.ftr),reg:new Set(A.reg)},J={ticket:new Set,ftr:new Set,reg:new Set};v.forEach(qe=>{R!==-1&&qe[R]&&Me.ticket.add(String(qe[R])),C!==-1&&qe[C]&&Me.ftr.add(String(qe[C])),B!==-1&&qe[B]&&Me.reg.add(String(qe[B]))});let O=i?.maxIds?.ticket||0,Q=i?.maxIds?.ftr||0,q=i?.maxIds?.reg||0,te=v.map(qe=>{if(!W(qe).valid)return qe;let Oe=[...qe];if(M!==-1&&!Oe[M]&&i?.districtMode&&(Oe[M]=i.districtMode),V!==-1&&!Oe[V]&&i?.mandalMode&&(Oe[V]=i.mandalMode),N!==-1&&!Oe[N]&&i?.namePool&&(Oe[N]=k(i.namePool)),R!==-1&&!Oe[R]){const nt=S(Me.ticket,O);Oe[R]=nt,Me.ticket.add(String(nt)),J.ticket.add(String(nt)),O=nt}if(C!==-1&&!Oe[C]){const nt=D(Me.ftr,Q);Oe[C]=nt,Me.ftr.add(String(nt)),J.ftr.add(String(nt)),Q=nt}if(B!==-1&&!Oe[B]){const nt=U(Me.reg,q);Oe[B]=nt,Me.reg.add(String(nt)),J.reg.add(String(nt)),q=nt}return Oe});const oe=parseInt(l,10)||0;let Te=[],ke=0;if(oe>0){const qe=ee(oe,i,y,Me,{ticket:O,ftr:Q,reg:q});ke=qe.length,Te=[...te,...qe],qe.forEach(Oe=>{R!==-1&&J.ticket.add(String(Oe[R])),C!==-1&&J.ftr.add(String(Oe[C])),B!==-1&&J.reg.add(String(Oe[B]))})}else Te=te;await X.saveBatch(J);const be=y.findIndex(qe=>{const Oe=String(qe).toLowerCase().replace(".","").replace(/\s/g,"");return["sno","slno","serialno","serialnumber"].includes(Oe)});Te=Te.map((qe,Oe)=>{if(qe.length<y.length)for(;qe.length<y.length;)qe.push("");let nt=[...qe];if(be!==-1&&(nt[be]=Oe+1),ne!==-1&&(nt[ne]=""),ae!==-1&&(nt[ae]=""),le!==-1&&(nt[le]=""),Pe!==-1&&(nt[Pe]=""),xe!==-1&&ve!==-1){const gt=String(nt[xe]||"").toLowerCase();gt.includes("after basement")||gt.includes("afterbasement")?nt[ve]=6e3:(gt.includes("final completion")||gt.includes("finalcompletion"))&&(nt[ve]=9e3)}return nt});const De=new Date,lt=`${String(De.getDate()).padStart(2,"0")}.${String(De.getMonth()+1).padStart(2,"0")}.${De.getFullYear()}`,Z=gn.aoa_to_sheet([y,...Te]),wt=gn.book_new();gn.book_append_sheet(wt,Z,"Sheet1");const ut=`${lt}_${E||"data.xlsx"}`;Yl(wt,ut);const It=await X.getAllIds();return{success:!0,finalData:Te,newHistory:It,message:oe>0?`SUCCESS!

Generated ${ke} NEW rows.
IDs saved to Firebase.`:`SUCCESS!

Processed ${Te.length} rows.
IDs saved to Firebase.`}}catch(S){return console.error(S),{success:!1,error:S.message}}},reset:()=>{n(null),s(null),u(0),d(0),e(!1)}}},yY=()=>{document.addEventListener("contextmenu",r=>{r.preventDefault()}),document.addEventListener("keydown",r=>{r.key==="F12"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.shiftKey&&r.key==="I"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.shiftKey&&r.key==="J"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.shiftKey&&r.key==="C"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.key==="u"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.key==="c"&&(r.preventDefault(),r.stopPropagation())}),setInterval(()=>{(function(){}).constructor("debugger")()},1e3),console.log=function(){},console.warn=function(){},console.error=function(){}},EY=()=>P.jsx("footer",{style:{marginTop:"auto",padding:"2rem 0 1rem 0",textAlign:"center",color:"rgba(255, 255, 255, 0.5)",fontSize:"0.85rem",letterSpacing:"0.5px"},children:P.jsxs("p",{style:{margin:0},children:["Powered by ",P.jsx("span",{style:{color:"#4fc3f7",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px"},children:"HRHKILLO"})]})});function TY(){const r=L0(),{data:e,setData:t,headers:n,isUploading:i,error:s,processFile:l,clearData:u,fileName:f}=xY(),{isVerifying:d,investigationReport:m,synthesisCount:_,setSynthesisCount:v,progress:y,analyzeAndVerify:T,generateIds:E,reset:S}=vY(),[D,U]=We.useState(!1),[k,W]=We.useState(""),[ee,X]=We.useState(""),[A,R]=We.useState(!1),[C,B]=We.useState(!1),[N,M]=We.useState(""),[V,xe]=We.useState(!1),[ve,ne]=We.useState(!1),[le,Pe]=We.useState({ticket:new Set,ftr:new Set,reg:new Set}),[ae,Me]=We.useState(!1),[J,O]=We.useState(!0),{entries:Q,addEntry:q,updateEntry:te,deleteEntry:oe}=iE(),[Te,ke]=We.useState(!1),[be,De]=We.useState(!1),[lt,Z]=We.useState(!1),[wt,ut]=We.useState(null),It=()=>{ut(null),ke(!0)},qe=()=>{De(!0)},Oe=()=>{Z(!0)},nt=async et=>{let yt=!1;wt?(yt=await te(wt.id,et),yt&&r.success("Entry updated successfully!")):(yt=await q(et),yt&&r.success("Entry added successfully!"))},gt=et=>{ut(et),ke(!0)},Lt=et=>{oe(et),r.success("Entry deleted successfully!")};We.useEffect(()=>{yY(),(()=>{tc.isLoggedIn()&&Me(!0),O(!1)})(),Pr(async()=>{const{IdService:yt}=await import("./IdService-B1BhGqQl.js");return{IdService:yt}},[],import.meta.url).then(({IdService:yt})=>{yt.getAllIds().then(rt=>{rt&&Pe(rt)}).catch(rt=>{console.error("Initial ID load failed (Offline?):",rt)})})},[]);const Gr=()=>{Me(!0)};if(J)return P.jsx("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",background:"#242424",color:"white"},children:P.jsx("div",{className:"spinner",style:{width:"40px",height:"40px",border:"4px solid rgba(255,255,255,0.3)",borderTop:"4px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}})});const fa=et=>{const yt=et.target.files[0];yt&&(S(),l(yt))},Yn=async()=>{const et=await T(e,n);!et.success&&et.error.includes("CRITICAL")?r.error(et.error):et.success||r.error("Analysis failed. Please check file.")},qt=async()=>{const et=await E(e,n,le,f);et.success?(t(et.finalData),Pe(et.newHistory),r.success(et.message)):r.error("Generation failed: "+et.error)},sn=async et=>{const yt=Number(et==="valid"?k:ee);if(!yt||yt<=0){r.error("Please enter a valid quantity.");return}try{const{generateValidAadhar:rt,generateInvalidAadhar:Kt}=await Pr(async()=>{const{generateValidAadhar:qr,generateInvalidAadhar:Tr}=await import("./aadharGenerator-Cn99XK-H.js");return{generateValidAadhar:qr,generateInvalidAadhar:Tr}},[],import.meta.url),{IdService:Ir}=await Pr(async()=>{const{IdService:qr}=await import("./IdService-B1BhGqQl.js");return{IdService:qr}},[],import.meta.url);let kt=new Set;et==="valid"&&(kt=(await Ir.getAllIds()).aadhar);let Vt=[];et==="valid"?Vt=rt(yt,kt):Vt=Kt(yt),et==="valid"&&Vt.length>0?(await Ir.saveBatch({ticket:new Set,ftr:new Set,reg:new Set,aadhar:new Set(Vt)}),r.success(`Generated ${yt} unique Aadhar IDs and saved to Database!`)):r.success(`Generated ${yt} Invalid Aadhar numbers (Not saved to DB).`);const on=[["Aadhar Number"],...Vt.map(qr=>[qr])],$t=new Date,Fa=`${String($t.getDate()).padStart(2,"0")}.${String($t.getMonth()+1).padStart(2,"0")}.${$t.getFullYear()}`,ai=gn.aoa_to_sheet(on),ha=gn.book_new();gn.book_append_sheet(ha,ai,"Aadhar");const Er=`${et}_aadhar_${Fa}.xlsx`;Yl(ha,Er)}catch(rt){console.error(rt),r.error("Error: "+rt.message)}},Nn=async()=>{const et=Number(N);if(!et||et<=0){r.error("Please enter a valid quantity.");return}try{const{generateBeneficiaryRegId:yt}=await Pr(async()=>{const{generateBeneficiaryRegId:Er}=await import("./idGenerator-Dp6YtTpY.js");return{generateBeneficiaryRegId:Er}},[],import.meta.url),{IdService:rt}=await Pr(async()=>{const{IdService:Er}=await import("./IdService-B1BhGqQl.js");return{IdService:Er}},[],import.meta.url);let Kt;try{Kt=await rt.getAllIds()}catch{r.error("Generation Aborted: Cannot connect to online storage.");return}const Ir=new Set(Kt.reg),kt=new Set,Vt=[];for(let Er=0;Er<et;Er++){const qr=yt(Ir);Ir.add(String(qr)),kt.add(String(qr)),Vt.push(qr)}await rt.saveBatch({ticket:new Set,ftr:new Set,reg:kt});const on=await rt.getAllIds();Pe(on);const $t=[["IMIS Id"],...Vt.map(Er=>[Er])],Fa=gn.aoa_to_sheet($t),ai=gn.book_new();gn.book_append_sheet(ai,Fa,"IMIS IDs"),Yl(ai,"imis_ids_generated.xlsx"),r.success(`Generated ${et} unique IMIS IDs and saved to history!`),M(""),B(!1)}catch(yt){console.error(yt),r.error("Error: "+yt.message)}},gi=()=>{const et=gn.aoa_to_sheet([n,...e]),yt=gn.book_new();gn.book_append_sheet(yt,et,"Sheet1"),Yl(yt,`processed_${f||"data.xlsx"}`)};return ae?(s&&console.error(s),P.jsx(_Y,{children:P.jsxs("div",{className:"App",children:[P.jsx(aY,{isOpen:D,onClose:()=>U(!1),validCount:k,setValidCount:W,invalidCount:ee,setInvalidCount:X,onGenerate:sn}),P.jsx(uY,{isOpen:A,onClose:()=>R(!1)}),P.jsx(fY,{isOpen:C,onClose:()=>B(!1),count:N,setCount:M,onGenerate:Nn}),P.jsx(hY,{isOpen:V,onClose:()=>xe(!1)}),P.jsx(dY,{isOpen:ve,onClose:()=>ne(!1)}),P.jsx(mY,{isOpen:Te,onClose:()=>ke(!1),initialData:wt,onSave:nt}),P.jsx(pY,{isOpen:be,onClose:()=>De(!1)}),P.jsx(gY,{isOpen:lt,onClose:()=>Z(!1),entries:Q,onEdit:gt,onDelete:Lt}),P.jsx(tY,{onDataEntryClick:It,onBulkUploadClick:qe,onViewDataClick:Oe}),e.length?P.jsx(sY,{data:e,headers:n,isVerifying:d,investigationReport:m,progress:y,synthesisCount:_,setSynthesisCount:v,onClear:u,onAnalyze:Yn,onGenerate:qt,onExport:gi}):P.jsx("div",{className:"glass-panel",style:{padding:"4rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderStyle:"dashed"},children:i?P.jsxs("div",{style:{textAlign:"center"},children:[P.jsx("div",{className:"spinner",style:{width:"40px",height:"40px",border:"4px solid rgba(255,255,255,0.3)",borderTop:"4px solid #fff",borderRadius:"50%",marginBottom:"1rem",animation:"spin 1s linear infinite"}}),P.jsx("p",{style:{fontSize:"1.2rem"},children:"Processing File... Please wait"})]}):P.jsxs(P.Fragment,{children:[P.jsx("p",{style:{fontSize:"1.2rem",marginBottom:"1rem"},children:"Drag & Drop Excel File Here"}),P.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:fa,style:{display:"none"},id:"file-upload"}),P.jsx("label",{htmlFor:"file-upload",className:"glass-button",children:"Browse Files"}),s&&P.jsx("p",{style:{color:"#ff6b6b",marginTop:"1rem"},children:s})]})}),P.jsx(iY,{onAadharClick:()=>U(!0),onTallyClick:()=>R(!0),onImisClick:()=>B(!0),onMatchClick:()=>xe(!0),onCommitmentsClick:()=>ne(!0)}),P.jsx(EY,{})]})})):P.jsx(oY,{onLogin:Gr})}const wY=({children:r})=>{const[e,t]=We.useState([]),n=We.useCallback((f,d="info")=>{const m=Date.now();t(_=>[..._,{id:m,message:f,type:d}]),setTimeout(()=>{t(_=>_.filter(v=>v.id!==m))},3e3)},[]),i=f=>n(f,"success"),s=f=>n(f,"error"),l=f=>n(f,"info"),u=f=>{t(d=>d.filter(m=>m.id!==f))};return P.jsxs(dC.Provider,{value:{success:i,error:s,info:l},children:[r,P.jsx("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:9999,display:"flex",flexDirection:"column",gap:"10px"},children:e.map(f=>P.jsxs("div",{className:`glass-panel toast-${f.type}`,style:{padding:"12px 20px",borderRadius:"8px",backdropFilter:"blur(10px)",background:f.type==="error"?"rgba(255, 68, 68, 0.9)":f.type==="success"?"rgba(0, 200, 81, 0.9)":"rgba(51, 181, 229, 0.9)",color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",minWidth:"250px",animation:"slideIn 0.3s ease-out",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[P.jsx("span",{children:f.message}),P.jsx("button",{onClick:()=>u(f.id),style:{background:"none",border:"none",color:"white",marginLeft:"10px",cursor:"pointer",fontSize:"1.2rem"},children:""})]},f.id))})]})},SY={apiKey:"AIzaSyBs73Bei23kJZ1enZNVfMJhCqwUfPrxI8c",authDomain:"imis-id-manager.firebaseapp.com",projectId:"imis-id-manager",storageBucket:"imis-id-manager.firebasestorage.app",messagingSenderId:"6647190912",appId:"1:6647190912:web:85abc4585b1fa8b9281d65",measurementId:"G-925Q6R67S2"},r3=Jv(SY);e4(r3);const Ru=UD(r3);jD(Ru).catch(r=>{r.code=="failed-precondition"?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):r.code=="unimplemented"&&console.warn("The current browser does not support all of the features required to enable persistence")});const Th="imis_data_entries",Mm={subscribeToEntries:r=>{const e=ox(Ru,Th);return XX(e,t=>{const n=[];t.forEach(i=>{n.push({id:i.id,...i.data()})}),r(n)},t=>{console.error("Error in real-time sync:",t)})},getAllEntries:async()=>{try{const r=await GX(ox(Ru,Th)),e=[];return r.forEach(t=>{e.push({id:t.id,...t.data()})}),e}catch(r){throw console.error("Error fetching entries:",r),r}},addEntry:async r=>{try{const e=lx(ox(Ru,Th)),t={...r,id:e.id,createdAt:new Date().toISOString()};return await qX(e,t),t}catch(e){throw console.error("Error adding entry:",e),e}},updateEntry:async(r,e)=>{try{const t=lx(Ru,Th,r);return await KX(t,{...e,updatedAt:new Date().toISOString()}),{id:r,...e}}catch(t){throw console.error("Error updating entry:",t),t}},deleteEntry:async r=>{try{return await WX(lx(Ru,Th,r)),r}catch(e){throw console.error("Error deleting entry:",e),e}}},AY=({children:r})=>{const[e,t]=We.useState([]),[n,i]=We.useState(!0),s=L0();We.useEffect(()=>{const d=Mm.subscribeToEntries(m=>{t(m),i(!1)});return()=>d()},[]);const l=async d=>{try{return await Mm.addEntry(d),!0}catch(m){return console.error("Failed to add entry:",m),s.error(`Failed to save: ${m.message}`),!1}},u=async(d,m)=>{try{return await Mm.updateEntry(d,m),!0}catch(_){return console.error("Failed to update entry:",_),s.error("Failed to update entry."),!1}},f=async d=>{try{return await Mm.deleteEntry(d),!0}catch(m){return console.error("Failed to delete entry:",m),s.error("Failed to delete entry."),!1}};return P.jsx(t3.Provider,{value:{entries:e,addEntry:l,updateEntry:u,deleteEntry:f,loading:n},children:r})};GN.createRoot(document.getElementById("root")).render(P.jsx(We.StrictMode,{children:P.jsx(wY,{children:P.jsx(AY,{children:P.jsx(TY,{})})})}));export{CY as I,Pr as _,lx as a,bY as b,ox as c,Ru as d,ON as e,GX as g,Ku as r,gn as u,kY as w};
