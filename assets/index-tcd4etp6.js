const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pdfGenerator-CIDG78H4.js","./jspdf.es.min-DQ__GkXo.js","./jspdf.plugin.autotable-DZlIrCiz.js","./dataSynthesizer-BPWho-Jj.js","./idGenerator-CFu3fATh.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var NY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function DN(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var S_={exports:{}},gh={};var Nw;function NN(){if(Nw)return gh;Nw=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,s){var l=null;if(s!==void 0&&(l=""+s),i.key!==void 0&&(l=""+i.key),"key"in i){s={};for(var c in i)c!=="key"&&(s[c]=i[c])}else s=i;return i=s.ref,{$$typeof:r,type:n,key:l,ref:i!==void 0?i:null,props:s}}return gh.Fragment=e,gh.jsx=t,gh.jsxs=t,gh}var Ow;function ON(){return Ow||(Ow=1,S_.exports=NN()),S_.exports}var P=ON(),A_={exports:{}},pt={};var Fw;function FN(){if(Fw)return pt;Fw=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),x=Symbol.iterator;function y(J){return J===null||typeof J!="object"?null:(J=x&&J[x]||J["@@iterator"],typeof J=="function"?J:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function D(J,O,Q){this.props=J,this.context=O,this.refs=S,this.updater=Q||T}D.prototype.isReactComponent={},D.prototype.setState=function(J,O){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,O,"setState")},D.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function U(){}U.prototype=D.prototype;function k(J,O,Q){this.props=J,this.context=O,this.refs=S,this.updater=Q||T}var W=k.prototype=new U;W.constructor=k,E(W,D.prototype),W.isPureReactComponent=!0;var Z=Array.isArray;function X(){}var A={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function C(J,O,Q){var q=Q.ref;return{$$typeof:r,type:J,key:O,ref:q!==void 0?q:null,props:Q}}function V(J,O){return C(J.type,O,J.props)}function N(J){return typeof J=="object"&&J!==null&&J.$$typeof===r}function M(J){var O={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(Q){return O[Q]})}var B=/\/+/g;function ve(J,O){return typeof J=="object"&&J!==null&&J.key!=null?M(""+J.key):O.toString(36)}function xe(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(X,X):(J.status="pending",J.then(function(O){J.status==="pending"&&(J.status="fulfilled",J.value=O)},function(O){J.status==="pending"&&(J.status="rejected",J.reason=O)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function ne(J,O,Q,q,ee){var oe=typeof J;(oe==="undefined"||oe==="boolean")&&(J=null);var Te=!1;if(J===null)Te=!0;else switch(oe){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(J.$$typeof){case r:case e:Te=!0;break;case m:return Te=J._init,ne(Te(J._payload),O,Q,q,ee)}}if(Te)return ee=ee(J),Te=q===""?"."+ve(J,0):q,Z(ee)?(Q="",Te!=null&&(Q=Te.replace(B,"$&/")+"/"),ne(ee,O,Q,"",function(De){return De})):ee!=null&&(N(ee)&&(ee=V(ee,Q+(ee.key==null||J&&J.key===ee.key?"":(""+ee.key).replace(B,"$&/")+"/")+Te)),O.push(ee)),1;Te=0;var Re=q===""?".":q+":";if(Z(J))for(var Se=0;Se<J.length;Se++)q=J[Se],oe=Re+ve(q,Se),Te+=ne(q,O,Q,oe,ee);else if(Se=y(J),typeof Se=="function")for(J=Se.call(J),Se=0;!(q=J.next()).done;)q=q.value,oe=Re+ve(q,Se++),Te+=ne(q,O,Q,oe,ee);else if(oe==="object"){if(typeof J.then=="function")return ne(xe(J),O,Q,q,ee);throw O=String(J),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return Te}function le(J,O,Q){if(J==null)return J;var q=[],ee=0;return ne(J,q,"","",function(oe){return O.call(Q,oe,ee++)}),q}function Le(J){if(J._status===-1){var O=J._result;O=O(),O.then(function(Q){(J._status===0||J._status===-1)&&(J._status=1,J._result=Q)},function(Q){(J._status===0||J._status===-1)&&(J._status=2,J._result=Q)}),J._status===-1&&(J._status=0,J._result=O)}if(J._status===1)return J._result.default;throw J._result}var ae=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},Pe={map:le,forEach:function(J,O,Q){le(J,function(){O.apply(this,arguments)},Q)},count:function(J){var O=0;return le(J,function(){O++}),O},toArray:function(J){return le(J,function(O){return O})||[]},only:function(J){if(!N(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return pt.Activity=_,pt.Children=Pe,pt.Component=D,pt.Fragment=t,pt.Profiler=i,pt.PureComponent=k,pt.StrictMode=n,pt.Suspense=f,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,pt.__COMPILER_RUNTIME={__proto__:null,c:function(J){return A.H.useMemoCache(J)}},pt.cache=function(J){return function(){return J.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(J,O,Q){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var q=E({},J.props),ee=J.key;if(O!=null)for(oe in O.key!==void 0&&(ee=""+O.key),O)!R.call(O,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&O.ref===void 0||(q[oe]=O[oe]);var oe=arguments.length-2;if(oe===1)q.children=Q;else if(1<oe){for(var Te=Array(oe),Re=0;Re<oe;Re++)Te[Re]=arguments[Re+2];q.children=Te}return C(J.type,ee,q)},pt.createContext=function(J){return J={$$typeof:l,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:s,_context:J},J},pt.createElement=function(J,O,Q){var q,ee={},oe=null;if(O!=null)for(q in O.key!==void 0&&(oe=""+O.key),O)R.call(O,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(ee[q]=O[q]);var Te=arguments.length-2;if(Te===1)ee.children=Q;else if(1<Te){for(var Re=Array(Te),Se=0;Se<Te;Se++)Re[Se]=arguments[Se+2];ee.children=Re}if(J&&J.defaultProps)for(q in Te=J.defaultProps,Te)ee[q]===void 0&&(ee[q]=Te[q]);return C(J,oe,ee)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(J){return{$$typeof:c,render:J}},pt.isValidElement=N,pt.lazy=function(J){return{$$typeof:m,_payload:{_status:-1,_result:J},_init:Le}},pt.memo=function(J,O){return{$$typeof:d,type:J,compare:O===void 0?null:O}},pt.startTransition=function(J){var O=A.T,Q={};A.T=Q;try{var q=J(),ee=A.S;ee!==null&&ee(Q,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(X,ae)}catch(oe){ae(oe)}finally{O!==null&&Q.types!==null&&(O.types=Q.types),A.T=O}},pt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},pt.use=function(J){return A.H.use(J)},pt.useActionState=function(J,O,Q){return A.H.useActionState(J,O,Q)},pt.useCallback=function(J,O){return A.H.useCallback(J,O)},pt.useContext=function(J){return A.H.useContext(J)},pt.useDebugValue=function(){},pt.useDeferredValue=function(J,O){return A.H.useDeferredValue(J,O)},pt.useEffect=function(J,O){return A.H.useEffect(J,O)},pt.useEffectEvent=function(J){return A.H.useEffectEvent(J)},pt.useId=function(){return A.H.useId()},pt.useImperativeHandle=function(J,O,Q){return A.H.useImperativeHandle(J,O,Q)},pt.useInsertionEffect=function(J,O){return A.H.useInsertionEffect(J,O)},pt.useLayoutEffect=function(J,O){return A.H.useLayoutEffect(J,O)},pt.useMemo=function(J,O){return A.H.useMemo(J,O)},pt.useOptimistic=function(J,O){return A.H.useOptimistic(J,O)},pt.useReducer=function(J,O,Q){return A.H.useReducer(J,O,Q)},pt.useRef=function(J){return A.H.useRef(J)},pt.useState=function(J){return A.H.useState(J)},pt.useSyncExternalStore=function(J,O,Q){return A.H.useSyncExternalStore(J,O,Q)},pt.useTransition=function(){return A.H.useTransition()},pt.version="19.2.1",pt}var Pw;function sx(){return Pw||(Pw=1,A_.exports=FN()),A_.exports}var qe=sx();const PN=DN(qe);var b_={exports:{}},_h={},I_={exports:{}},k_={};var Mw;function MN(){return Mw||(Mw=1,(function(r){function e(ne,le){var Le=ne.length;ne.push(le);e:for(;0<Le;){var ae=Le-1>>>1,Pe=ne[ae];if(0<i(Pe,le))ne[ae]=le,ne[Le]=Pe,Le=ae;else break e}}function t(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var le=ne[0],Le=ne.pop();if(Le!==le){ne[0]=Le;e:for(var ae=0,Pe=ne.length,J=Pe>>>1;ae<J;){var O=2*(ae+1)-1,Q=ne[O],q=O+1,ee=ne[q];if(0>i(Q,Le))q<Pe&&0>i(ee,Q)?(ne[ae]=ee,ne[q]=Le,ae=q):(ne[ae]=Q,ne[O]=Le,ae=O);else if(q<Pe&&0>i(ee,Le))ne[ae]=ee,ne[q]=Le,ae=q;else break e}}return le}function i(ne,le){var Le=ne.sortIndex-le.sortIndex;return Le!==0?Le:ne.id-le.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();r.unstable_now=function(){return l.now()-c}}var f=[],d=[],m=1,_=null,x=3,y=!1,T=!1,E=!1,S=!1,D=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function W(ne){for(var le=t(d);le!==null;){if(le.callback===null)n(d);else if(le.startTime<=ne)n(d),le.sortIndex=le.expirationTime,e(f,le);else break;le=t(d)}}function Z(ne){if(E=!1,W(ne),!T)if(t(f)!==null)T=!0,X||(X=!0,M());else{var le=t(d);le!==null&&xe(Z,le.startTime-ne)}}var X=!1,A=-1,R=5,C=-1;function V(){return S?!0:!(r.unstable_now()-C<R)}function N(){if(S=!1,X){var ne=r.unstable_now();C=ne;var le=!0;try{e:{T=!1,E&&(E=!1,U(A),A=-1),y=!0;var Le=x;try{t:{for(W(ne),_=t(f);_!==null&&!(_.expirationTime>ne&&V());){var ae=_.callback;if(typeof ae=="function"){_.callback=null,x=_.priorityLevel;var Pe=ae(_.expirationTime<=ne);if(ne=r.unstable_now(),typeof Pe=="function"){_.callback=Pe,W(ne),le=!0;break t}_===t(f)&&n(f),W(ne)}else n(f);_=t(f)}if(_!==null)le=!0;else{var J=t(d);J!==null&&xe(Z,J.startTime-ne),le=!1}}break e}finally{_=null,x=Le,y=!1}le=void 0}}finally{le?M():X=!1}}}var M;if(typeof k=="function")M=function(){k(N)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,ve=B.port2;B.port1.onmessage=N,M=function(){ve.postMessage(null)}}else M=function(){D(N,0)};function xe(ne,le){A=D(function(){ne(r.unstable_now())},le)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ne){ne.callback=null},r.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ne?Math.floor(1e3/ne):5},r.unstable_getCurrentPriorityLevel=function(){return x},r.unstable_next=function(ne){switch(x){case 1:case 2:case 3:var le=3;break;default:le=x}var Le=x;x=le;try{return ne()}finally{x=Le}},r.unstable_requestPaint=function(){S=!0},r.unstable_runWithPriority=function(ne,le){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Le=x;x=ne;try{return le()}finally{x=Le}},r.unstable_scheduleCallback=function(ne,le,Le){var ae=r.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?ae+Le:ae):Le=ae,ne){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=Le+Pe,ne={id:m++,callback:le,priorityLevel:ne,startTime:Le,expirationTime:Pe,sortIndex:-1},Le>ae?(ne.sortIndex=Le,e(d,ne),t(f)===null&&ne===t(d)&&(E?(U(A),A=-1):E=!0,xe(Z,Le-ae))):(ne.sortIndex=Pe,e(f,ne),T||y||(T=!0,X||(X=!0,M()))),ne},r.unstable_shouldYield=V,r.unstable_wrapCallback=function(ne){var le=x;return function(){var Le=x;x=le;try{return ne.apply(this,arguments)}finally{x=Le}}}})(k_)),k_}var Lw;function LN(){return Lw||(Lw=1,I_.exports=MN()),I_.exports}var C_={exports:{}},Vn={};var Vw;function VN(){if(Vw)return Vn;Vw=1;var r=sx();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(f,d,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:f,containerInfo:d,implementation:m}}var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Vn.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,m)},Vn.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},Vn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Vn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Vn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,_=c(m,d.crossOrigin),x=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:x,fetchPriority:y}):m==="script"&&n.d.X(f,{crossOrigin:_,integrity:x,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Vn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Vn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,_=c(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Vn.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=c(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Vn.requestFormReset=function(f){n.d.r(f)},Vn.unstable_batchedUpdates=function(f,d){return f(d)},Vn.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Vn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Vn.version="19.2.1",Vn}var Bw;function BN(){if(Bw)return C_.exports;Bw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),C_.exports=VN(),C_.exports}var Uw;function UN(){if(Uw)return _h;Uw=1;var r=LN(),e=sx(),t=BN();function n(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var o=a,u=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(u=o.return),a=o.return;while(a)}return o.tag===3?u:null}function l(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function c(a){if(a.tag===31){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function f(a){if(s(a)!==a)throw Error(n(188))}function d(a){var o=a.alternate;if(!o){if(o=s(a),o===null)throw Error(n(188));return o!==a?null:a}for(var u=a,h=o;;){var g=u.return;if(g===null)break;var v=g.alternate;if(v===null){if(h=g.return,h!==null){u=h;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===u)return f(g),a;if(v===h)return f(g),o;v=v.sibling}throw Error(n(188))}if(u.return!==h.return)u=g,h=v;else{for(var b=!1,L=g.child;L;){if(L===u){b=!0,u=g,h=v;break}if(L===h){b=!0,h=g,u=v;break}L=L.sibling}if(!b){for(L=v.child;L;){if(L===u){b=!0,u=v,h=g;break}if(L===h){b=!0,h=v,u=g;break}L=L.sibling}if(!b)throw Error(n(189))}}if(u.alternate!==h)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?a:o}function m(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=m(a),o!==null)return o;a=a.sibling}return null}var _=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),k=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),N=Symbol.iterator;function M(a){return a===null||typeof a!="object"?null:(a=N&&a[N]||a["@@iterator"],typeof a=="function"?a:null)}var B=Symbol.for("react.client.reference");function ve(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===B?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case E:return"Fragment";case D:return"Profiler";case S:return"StrictMode";case Z:return"Suspense";case X:return"SuspenseList";case C:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case T:return"Portal";case k:return a.displayName||"Context";case U:return(a._context.displayName||"Context")+".Consumer";case W:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case A:return o=a.displayName||null,o!==null?o:ve(a.type)||"Memo";case R:o=a._payload,a=a._init;try{return ve(a(o))}catch{}}return null}var xe=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Le={pending:!1,data:null,method:null,action:null},ae=[],Pe=-1;function J(a){return{current:a}}function O(a){0>Pe||(a.current=ae[Pe],ae[Pe]=null,Pe--)}function Q(a,o){Pe++,ae[Pe]=a.current,a.current=o}var q=J(null),ee=J(null),oe=J(null),Te=J(null);function Re(a,o){switch(Q(oe,o),Q(ee,a),Q(q,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?tw(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=tw(o),a=rw(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}O(q),Q(q,a)}function Se(){O(q),O(ee),O(oe)}function De(a){a.memoizedState!==null&&Q(Te,a);var o=q.current,u=rw(o,a.type);o!==u&&(Q(ee,a),Q(q,u))}function st(a){ee.current===a&&(O(q),O(ee)),Te.current===a&&(O(Te),hh._currentValue=Le)}var te,St;function lt(a){if(te===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);te=o&&o[1]||"",St=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+te+a+St}var At=!1;function Xe(a,o){if(!a||At)return"";At=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(Ee){var _e=Ee}Reflect.construct(a,[],Ce)}else{try{Ce.call()}catch(Ee){_e=Ee}a.call(Ce.prototype)}}else{try{throw Error()}catch(Ee){_e=Ee}(Ce=a())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(Ee){if(Ee&&_e&&typeof Ee.stack=="string")return[Ee.stack,_e.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=h.DetermineComponentFrameRoot(),b=v[0],L=v[1];if(b&&L){var re=b.split(`
`),me=L.split(`
`);for(g=h=0;h<re.length&&!re[h].includes("DetermineComponentFrameRoot");)h++;for(;g<me.length&&!me[g].includes("DetermineComponentFrameRoot");)g++;if(h===re.length||g===me.length)for(h=re.length-1,g=me.length-1;1<=h&&0<=g&&re[h]!==me[g];)g--;for(;1<=h&&0<=g;h--,g--)if(re[h]!==me[g]){if(h!==1||g!==1)do if(h--,g--,0>g||re[h]!==me[g]){var be=`
`+re[h].replace(" at new "," at ");return a.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",a.displayName)),be}while(1<=h&&0<=g);break}}}finally{At=!1,Error.prepareStackTrace=u}return(u=a?a.displayName||a.name:"")?lt(u):""}function Oe(a,o){switch(a.tag){case 26:case 27:case 5:return lt(a.type);case 16:return lt("Lazy");case 13:return a.child!==o&&o!==null?lt("Suspense Fallback"):lt("Suspense");case 19:return lt("SuspenseList");case 0:case 15:return Xe(a.type,!1);case 11:return Xe(a.type.render,!1);case 1:return Xe(a.type,!0);case 31:return lt("Activity");default:return""}}function nt(a){try{var o="",u=null;do o+=Oe(a,u),u=a,a=a.return;while(a);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var gt=Object.prototype.hasOwnProperty,Mt=r.unstable_scheduleCallback,qr=r.unstable_cancelCallback,fa=r.unstable_shouldYield,Qn=r.unstable_requestPaint,qt=r.unstable_now,an=r.unstable_getCurrentPriorityLevel,Pn=r.unstable_ImmediatePriority,_i=r.unstable_UserBlockingPriority,gr=r.unstable_NormalPriority,dt=r.unstable_LowPriority,Ye=r.unstable_IdlePriority,Ut=r.log,Tr=r.unstable_setDisableYieldValue,Ot=null,Kt=null;function sn(a){if(typeof Ut=="function"&&Tr(a),Kt&&typeof Kt.setStrictMode=="function")try{Kt.setStrictMode(Ot,a)}catch{}}var Yt=Math.clz32?Math.clz32:Oa,cs=Math.log,En=Math.LN2;function Oa(a){return a>>>=0,a===0?32:31-(cs(a)/En|0)|0}var Jn=256,Tn=262144,$t=4194304;function wn(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Ui(a,o,u){var h=a.pendingLanes;if(h===0)return 0;var g=0,v=a.suspendedLanes,b=a.pingedLanes;a=a.warmLanes;var L=h&134217727;return L!==0?(h=L&~v,h!==0?g=wn(h):(b&=L,b!==0?g=wn(b):u||(u=L&~a,u!==0&&(g=wn(u))))):(L=h&~v,L!==0?g=wn(L):b!==0?g=wn(b):u||(u=h&~a,u!==0&&(g=wn(u)))),g===0?0:o!==0&&o!==g&&(o&v)===0&&(v=g&-g,u=o&-o,v>=u||v===32&&(u&4194048)!==0)?o:g}function vi(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function Tf(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dc(){var a=$t;return $t<<=1,($t&62914560)===0&&($t=4194304),a}function zi(a){for(var o=[],u=0;31>u;u++)o.push(a);return o}function us(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function wf(a,o,u,h,g,v){var b=a.pendingLanes;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=u,a.entangledLanes&=u,a.errorRecoveryDisabledLanes&=u,a.shellSuspendCounter=0;var L=a.entanglements,re=a.expirationTimes,me=a.hiddenUpdates;for(u=b&~u;0<u;){var be=31-Yt(u),Ce=1<<be;L[be]=0,re[be]=-1;var _e=me[be];if(_e!==null)for(me[be]=null,be=0;be<_e.length;be++){var Ee=_e[be];Ee!==null&&(Ee.lane&=-536870913)}u&=~Ce}h!==0&&fs(a,h,0),v!==0&&g===0&&a.tag!==0&&(a.suspendedLanes|=v&~(b&~o))}function fs(a,o,u){a.pendingLanes|=o,a.suspendedLanes&=~o;var h=31-Yt(o);a.entangledLanes|=o,a.entanglements[h]=a.entanglements[h]|1073741824|u&261930}function hs(a,o){var u=a.entangledLanes|=o;for(a=a.entanglements;u;){var h=31-Yt(u),g=1<<h;g&o|a[h]&o&&(a[h]|=o),u&=~g}}function hl(a,o){var u=o&-o;return u=(u&42)!==0?1:ds(u),(u&(a.suspendedLanes|o))!==0?0:u}function ds(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ha(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function F(){var a=le.p;return a!==0?a:(a=window.event,a===void 0?32:Aw(a.type))}function K(a,o){var u=le.p;try{return le.p=a,o()}finally{le.p=u}}var z=Math.random().toString(36).slice(2),H="__reactFiber$"+z,G="__reactProps$"+z,Y="__reactContainer$"+z,he="__reactEvents$"+z,Ae="__reactListeners$"+z,de="__reactHandles$"+z,ge="__reactResources$"+z,pe="__reactMarker$"+z;function Me(a){delete a[H],delete a[G],delete a[he],delete a[Ae],delete a[de]}function Be(a){var o=a[H];if(o)return o;for(var u=a.parentNode;u;){if(o=u[Y]||u[H]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(a=cw(a);a!==null;){if(u=a[H])return u;a=cw(a)}return o}a=u,u=a.parentNode}return null}function Ge(a){if(a=a[H]||a[Y]){var o=a.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return a}return null}function Fe(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(n(33))}function He(a){var o=a[ge];return o||(o=a[ge]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ze(a){a[pe]=!0}var Qt=new Set,Jt={};function dr(a,o){Mn(a,o),Mn(a+"Capture",o)}function Mn(a,o){for(Jt[a]=o,a=0;a<o.length;a++)Qt.add(o[a])}var da=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ma={},xi={};function Ys(a){return gt.call(xi,a)?!0:gt.call(ma,a)?!1:da.test(a)?xi[a]=!0:(ma[a]=!0,!1)}function Ln(a,o,u){if(Ys(o))if(u===null)a.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+u)}}function yi(a,o,u){if(u===null)a.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+u)}}function Kr(a,o,u,h){if(h===null)a.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(u);return}a.setAttributeNS(o,u,""+h)}}function hn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function $s(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Sf(a,o,u){var h=Object.getOwnPropertyDescriptor(a.constructor.prototype,o);if(!a.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,v=h.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return g.call(this)},set:function(b){u=""+b,v.call(this,b)}}),Object.defineProperty(a,o,{enumerable:h.enumerable}),{getValue:function(){return u},setValue:function(b){u=""+b},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Zt(a){if(!a._valueTracker){var o=$s(a)?"checked":"value";a._valueTracker=Sf(a,o,""+a[o])}}function dl(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return a&&(h=$s(a)?a.checked?"true":"false":a.value),a=h,a!==u?(o.setValue(a),!0):!1}function Fa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var ml=/[\n"\\]/g;function si(a){return a.replace(ml,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Nc(a,o,u,h,g,v,b,L){a.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?a.type=b:a.removeAttribute("type"),o!=null?b==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+hn(o)):a.value!==""+hn(o)&&(a.value=""+hn(o)):b!=="submit"&&b!=="reset"||a.removeAttribute("value"),o!=null?Af(a,b,hn(o)):u!=null?Af(a,b,hn(u)):h!=null&&a.removeAttribute("value"),g==null&&v!=null&&(a.defaultChecked=!!v),g!=null&&(a.checked=g&&typeof g!="function"&&typeof g!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?a.name=""+hn(L):a.removeAttribute("name")}function id(a,o,u,h,g,v,b,L){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(a.type=v),o!=null||u!=null){if(!(v!=="submit"&&v!=="reset"||o!=null)){Zt(a);return}u=u!=null?""+hn(u):"",o=o!=null?""+hn(o):u,L||o===a.value||(a.value=o),a.defaultValue=o}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,a.checked=L?a.checked:!!h,a.defaultChecked=!!h,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.name=b),Zt(a)}function Af(a,o,u){o==="number"&&Fa(a.ownerDocument)===a||a.defaultValue===""+u||(a.defaultValue=""+u)}function Qs(a,o,u,h){if(a=a.options,o){o={};for(var g=0;g<u.length;g++)o["$"+u[g]]=!0;for(u=0;u<a.length;u++)g=o.hasOwnProperty("$"+a[u].value),a[u].selected!==g&&(a[u].selected=g),g&&h&&(a[u].defaultSelected=!0)}else{for(u=""+hn(u),o=null,g=0;g<a.length;g++){if(a[g].value===u){a[g].selected=!0,h&&(a[g].defaultSelected=!0);return}o!==null||a[g].disabled||(o=a[g])}o!==null&&(o.selected=!0)}}function ad(a,o,u){if(o!=null&&(o=""+hn(o),o!==a.value&&(a.value=o),u==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=u!=null?""+hn(u):""}function Js(a,o,u,h){if(o==null){if(h!=null){if(u!=null)throw Error(n(92));if(xe(h)){if(1<h.length)throw Error(n(93));h=h[0]}u=h}u==null&&(u=""),o=u}u=hn(o),a.defaultValue=u,h=a.textContent,h===u&&h!==""&&h!==null&&(a.value=h),Zt(a)}function oi(a,o){if(o){var u=a.firstChild;if(u&&u===a.lastChild&&u.nodeType===3){u.nodeValue=o;return}}a.textContent=o}var sd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bf(a,o,u){var h=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":h?a.setProperty(o,u):typeof u!="number"||u===0||sd.has(o)?o==="float"?a.cssFloat=u:a[o]=(""+u).trim():a[o]=u+"px"}function If(a,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(a=a.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?a.setProperty(h,""):h==="float"?a.cssFloat="":a[h]="");for(var g in o)h=o[g],o.hasOwnProperty(g)&&u[g]!==h&&bf(a,g,h)}else for(var v in o)o.hasOwnProperty(v)&&bf(a,v,o[v])}function Oc(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var od=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fc(a){return Zs.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function pa(){}var kf=null;function ji(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var eo=null,Pa=null;function pl(a){var o=Ge(a);if(o&&(a=o.stateNode)){var u=a[G]||null;e:switch(a=o.stateNode,o.type){case"input":if(Nc(a,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=a;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+si(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==a&&h.form===a.form){var g=h[G]||null;if(!g)throw Error(n(90));Nc(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<u.length;o++)h=u[o],h.form===a.form&&dl(h)}break e;case"textarea":ad(a,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Qs(a,!!u.multiple,o,!1)}}}var Pc=!1;function to(a,o,u){if(Pc)return a(o,u);Pc=!0;try{var h=a(o);return h}finally{if(Pc=!1,(eo!==null||Pa!==null)&&(em(),eo&&(o=eo,a=Pa,Pa=eo=null,pl(o),a)))for(o=0;o<a.length;o++)pl(a[o])}}function ga(a,o){var u=a.stateNode;if(u===null)return null;var h=u[G]||null;if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(a=a.type,h=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!h;break e;default:a=!1}if(a)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var Hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gl=!1;if(Hi)try{var or={};Object.defineProperty(or,"passive",{get:function(){gl=!0}}),window.addEventListener("test",or,or),window.removeEventListener("test",or,or)}catch{gl=!1}var Ma=null,Cf=null,_l=null;function Rf(){if(_l)return _l;var a,o=Cf,u=o.length,h,g="value"in Ma?Ma.value:Ma.textContent,v=g.length;for(a=0;a<u&&o[a]===g[a];a++);var b=u-a;for(h=1;h<=b&&o[u-h]===g[v-h];h++);return _l=g.slice(a,1<h?1-h:void 0)}function vl(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function ms(){return!0}function _a(){return!1}function Sn(a){function o(u,h,g,v,b){this._reactName=u,this._targetInst=g,this.type=h,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var L in a)a.hasOwnProperty(L)&&(u=a[L],this[L]=u?u(v):v[L]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ms:_a,this.isPropagationStopped=_a,this}return _(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ms)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ms)},persist:function(){},isPersistent:ms}),o}var ps={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},La=Sn(ps),ro=_({},ps,{view:0,detail:0}),Df=Sn(ro),no,Mc,Va,Lc=_({},ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:io,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Va&&(Va&&a.type==="mousemove"?(no=a.screenX-Va.screenX,Mc=a.screenY-Va.screenY):Mc=no=0,Va=a),no)},movementY:function(a){return"movementY"in a?a.movementY:Mc}}),Nf=Sn(Lc),xl=_({},Lc,{dataTransfer:0}),ld=Sn(xl),cd=_({},ro,{relatedTarget:0}),yl=Sn(cd),Of=_({},ps,{animationName:0,elapsedTime:0,pseudoElement:0}),ud=Sn(Of),Vc=_({},ps,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),fd=Sn(Vc),hd=_({},ps,{data:0}),Ba=Sn(hd),dd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},md={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gd(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=pd[a])?!!o[a]:!1}function io(){return gd}var Zn=_({},ro,{key:function(a){if(a.key){var o=dd[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=vl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?md[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:io,charCode:function(a){return a.type==="keypress"?vl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?vl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),_d=Sn(Zn),vd=_({},Lc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gs=Sn(vd),p=_({},ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:io}),w=Sn(p),I=_({},ps,{propertyName:0,elapsedTime:0,pseudoElement:0}),j=Sn(I),ue=_({},Lc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),ye=Sn(ue),je=_({},ps,{newState:0,oldState:0}),_t=Sn(je),Br=[9,13,27,32],Wt=Hi&&"CompositionEvent"in window,wr=null;Hi&&"documentMode"in document&&(wr=document.documentMode);var Gi=Hi&&"TextEvent"in window&&!wr,Ua=Hi&&(!Wt||wr&&8<wr&&11>=wr),va=" ",xa=!1;function El(a,o){switch(a){case"keyup":return Br.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bc(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Uc=!1;function t3(a,o){switch(a){case"compositionend":return Bc(o);case"keypress":return o.which!==32?null:(xa=!0,va);case"textInput":return a=o.data,a===va&&xa?null:a;default:return null}}function r3(a,o){if(Uc)return a==="compositionend"||!Wt&&El(a,o)?(a=Rf(),_l=Cf=Ma=null,Uc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ua&&o.locale!=="ko"?null:o.data;default:return null}}var n3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hE(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!n3[a.type]:o==="textarea"}function dE(a,o,u,h){eo?Pa?Pa.push(h):Pa=[h]:eo=h,o=om(o,"onChange"),0<o.length&&(u=new La("onChange","change",null,u,h),a.push({event:u,listeners:o}))}var Ff=null,Pf=null;function i3(a){YT(a,0)}function xd(a){var o=Fe(a);if(dl(o))return a}function mE(a,o){if(a==="change")return o}var pE=!1;if(Hi){var Dg;if(Hi){var Ng="oninput"in document;if(!Ng){var gE=document.createElement("div");gE.setAttribute("oninput","return;"),Ng=typeof gE.oninput=="function"}Dg=Ng}else Dg=!1;pE=Dg&&(!document.documentMode||9<document.documentMode)}function _E(){Ff&&(Ff.detachEvent("onpropertychange",vE),Pf=Ff=null)}function vE(a){if(a.propertyName==="value"&&xd(Pf)){var o=[];dE(o,Pf,a,ji(a)),to(i3,o)}}function a3(a,o,u){a==="focusin"?(_E(),Ff=o,Pf=u,Ff.attachEvent("onpropertychange",vE)):a==="focusout"&&_E()}function s3(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return xd(Pf)}function o3(a,o){if(a==="click")return xd(o)}function l3(a,o){if(a==="input"||a==="change")return xd(o)}function c3(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var Ei=typeof Object.is=="function"?Object.is:c3;function Mf(a,o){if(Ei(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var u=Object.keys(a),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var g=u[h];if(!gt.call(o,g)||!Ei(a[g],o[g]))return!1}return!0}function xE(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function yE(a,o){var u=xE(a);a=0;for(var h;u;){if(u.nodeType===3){if(h=a+u.textContent.length,a<=o&&h>=o)return{node:u,offset:o-a};a=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=xE(u)}}function EE(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?EE(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function TE(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=Fa(a.document);o instanceof a.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)a=o.contentWindow;else break;o=Fa(a.document)}return o}function Og(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var u3=Hi&&"documentMode"in document&&11>=document.documentMode,zc=null,Fg=null,Lf=null,Pg=!1;function wE(a,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Pg||zc==null||zc!==Fa(h)||(h=zc,"selectionStart"in h&&Og(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Lf&&Mf(Lf,h)||(Lf=h,h=om(Fg,"onSelect"),0<h.length&&(o=new La("onSelect","select",null,o,u),a.push({event:o,listeners:h}),o.target=zc)))}function Tl(a,o){var u={};return u[a.toLowerCase()]=o.toLowerCase(),u["Webkit"+a]="webkit"+o,u["Moz"+a]="moz"+o,u}var jc={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionrun:Tl("Transition","TransitionRun"),transitionstart:Tl("Transition","TransitionStart"),transitioncancel:Tl("Transition","TransitionCancel"),transitionend:Tl("Transition","TransitionEnd")},Mg={},SE={};Hi&&(SE=document.createElement("div").style,"AnimationEvent"in window||(delete jc.animationend.animation,delete jc.animationiteration.animation,delete jc.animationstart.animation),"TransitionEvent"in window||delete jc.transitionend.transition);function wl(a){if(Mg[a])return Mg[a];if(!jc[a])return a;var o=jc[a],u;for(u in o)if(o.hasOwnProperty(u)&&u in SE)return Mg[a]=o[u];return a}var AE=wl("animationend"),bE=wl("animationiteration"),IE=wl("animationstart"),f3=wl("transitionrun"),h3=wl("transitionstart"),d3=wl("transitioncancel"),kE=wl("transitionend"),CE=new Map,Lg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lg.push("scrollEnd");function ya(a,o){CE.set(a,o),dr(o,[a])}var yd=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},qi=[],Hc=0,Vg=0;function Ed(){for(var a=Hc,o=Vg=Hc=0;o<a;){var u=qi[o];qi[o++]=null;var h=qi[o];qi[o++]=null;var g=qi[o];qi[o++]=null;var v=qi[o];if(qi[o++]=null,h!==null&&g!==null){var b=h.pending;b===null?g.next=g:(g.next=b.next,b.next=g),h.pending=g}v!==0&&RE(u,g,v)}}function Td(a,o,u,h){qi[Hc++]=a,qi[Hc++]=o,qi[Hc++]=u,qi[Hc++]=h,Vg|=h,a.lanes|=h,a=a.alternate,a!==null&&(a.lanes|=h)}function Bg(a,o,u,h){return Td(a,o,u,h),wd(a)}function Sl(a,o){return Td(a,null,null,o),wd(a)}function RE(a,o,u){a.lanes|=u;var h=a.alternate;h!==null&&(h.lanes|=u);for(var g=!1,v=a.return;v!==null;)v.childLanes|=u,h=v.alternate,h!==null&&(h.childLanes|=u),v.tag===22&&(a=v.stateNode,a===null||a._visibility&1||(g=!0)),a=v,v=v.return;return a.tag===3?(v=a.stateNode,g&&o!==null&&(g=31-Yt(u),a=v.hiddenUpdates,h=a[g],h===null?a[g]=[o]:h.push(o),o.lane=u|536870912),v):null}function wd(a){if(50<ah)throw ah=0,X1=null,Error(n(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var Gc={};function m3(a,o,u,h){this.tag=a,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ti(a,o,u,h){return new m3(a,o,u,h)}function Ug(a){return a=a.prototype,!(!a||!a.isReactComponent)}function _s(a,o){var u=a.alternate;return u===null?(u=Ti(a.tag,o,a.key,a.mode),u.elementType=a.elementType,u.type=a.type,u.stateNode=a.stateNode,u.alternate=a,a.alternate=u):(u.pendingProps=o,u.type=a.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=a.flags&65011712,u.childLanes=a.childLanes,u.lanes=a.lanes,u.child=a.child,u.memoizedProps=a.memoizedProps,u.memoizedState=a.memoizedState,u.updateQueue=a.updateQueue,o=a.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=a.sibling,u.index=a.index,u.ref=a.ref,u.refCleanup=a.refCleanup,u}function DE(a,o){a.flags&=65011714;var u=a.alternate;return u===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,o=u.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function Sd(a,o,u,h,g,v){var b=0;if(h=a,typeof a=="function")Ug(a)&&(b=1);else if(typeof a=="string")b=xN(a,u,q.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case C:return a=Ti(31,u,o,g),a.elementType=C,a.lanes=v,a;case E:return Al(u.children,g,v,o);case S:b=8,g|=24;break;case D:return a=Ti(12,u,o,g|2),a.elementType=D,a.lanes=v,a;case Z:return a=Ti(13,u,o,g),a.elementType=Z,a.lanes=v,a;case X:return a=Ti(19,u,o,g),a.elementType=X,a.lanes=v,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case k:b=10;break e;case U:b=9;break e;case W:b=11;break e;case A:b=14;break e;case R:b=16,h=null;break e}b=29,u=Error(n(130,a===null?"null":typeof a,"")),h=null}return o=Ti(b,u,o,g),o.elementType=a,o.type=h,o.lanes=v,o}function Al(a,o,u,h){return a=Ti(7,a,h,o),a.lanes=u,a}function zg(a,o,u){return a=Ti(6,a,null,o),a.lanes=u,a}function NE(a){var o=Ti(18,null,null,0);return o.stateNode=a,o}function jg(a,o,u){return o=Ti(4,a.children!==null?a.children:[],a.key,o),o.lanes=u,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var OE=new WeakMap;function Ki(a,o){if(typeof a=="object"&&a!==null){var u=OE.get(a);return u!==void 0?u:(o={value:a,source:o,stack:nt(o)},OE.set(a,o),o)}return{value:a,source:o,stack:nt(o)}}var qc=[],Kc=0,Ad=null,Vf=0,Wi=[],Xi=0,ao=null,za=1,ja="";function vs(a,o){qc[Kc++]=Vf,qc[Kc++]=Ad,Ad=a,Vf=o}function FE(a,o,u){Wi[Xi++]=za,Wi[Xi++]=ja,Wi[Xi++]=ao,ao=a;var h=za;a=ja;var g=32-Yt(h)-1;h&=~(1<<g),u+=1;var v=32-Yt(o)+g;if(30<v){var b=g-g%5;v=(h&(1<<b)-1).toString(32),h>>=b,g-=b,za=1<<32-Yt(o)+g|u<<g|h,ja=v+a}else za=1<<v|u<<g|h,ja=a}function Hg(a){a.return!==null&&(vs(a,1),FE(a,1,0))}function Gg(a){for(;a===Ad;)Ad=qc[--Kc],qc[Kc]=null,Vf=qc[--Kc],qc[Kc]=null;for(;a===ao;)ao=Wi[--Xi],Wi[Xi]=null,ja=Wi[--Xi],Wi[Xi]=null,za=Wi[--Xi],Wi[Xi]=null}function PE(a,o){Wi[Xi++]=za,Wi[Xi++]=ja,Wi[Xi++]=ao,za=o.id,ja=o.overflow,ao=a}var An=null,_r=null,Ft=!1,so=null,Yi=!1,qg=Error(n(519));function oo(a){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bf(Ki(o,a)),qg}function ME(a){var o=a.stateNode,u=a.type,h=a.memoizedProps;switch(o[H]=a,o[G]=h,u){case"dialog":kt("cancel",o),kt("close",o);break;case"iframe":case"object":case"embed":kt("load",o);break;case"video":case"audio":for(u=0;u<oh.length;u++)kt(oh[u],o);break;case"source":kt("error",o);break;case"img":case"image":case"link":kt("error",o),kt("load",o);break;case"details":kt("toggle",o);break;case"input":kt("invalid",o),id(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":kt("invalid",o);break;case"textarea":kt("invalid",o),Js(o,h.value,h.defaultValue,h.children)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||h.suppressHydrationWarning===!0||ZT(o.textContent,u)?(h.popover!=null&&(kt("beforetoggle",o),kt("toggle",o)),h.onScroll!=null&&kt("scroll",o),h.onScrollEnd!=null&&kt("scrollend",o),h.onClick!=null&&(o.onclick=pa),o=!0):o=!1,o||oo(a,!0)}function LE(a){for(An=a.return;An;)switch(An.tag){case 5:case 31:case 13:Yi=!1;return;case 27:case 3:Yi=!0;return;default:An=An.return}}function Wc(a){if(a!==An)return!1;if(!Ft)return LE(a),Ft=!0,!1;var o=a.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=a.type,u=!(u!=="form"&&u!=="button")||c_(a.type,a.memoizedProps)),u=!u),u&&_r&&oo(a),LE(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));_r=lw(a)}else if(o===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));_r=lw(a)}else o===27?(o=_r,To(a.type)?(a=m_,m_=null,_r=a):_r=o):_r=An?Qi(a.stateNode.nextSibling):null;return!0}function bl(){_r=An=null,Ft=!1}function Kg(){var a=so;return a!==null&&(fi===null?fi=a:fi.push.apply(fi,a),so=null),a}function Bf(a){so===null?so=[a]:so.push(a)}var Wg=J(null),Il=null,xs=null;function lo(a,o,u){Q(Wg,o._currentValue),o._currentValue=u}function ys(a){a._currentValue=Wg.current,O(Wg)}function Xg(a,o,u){for(;a!==null;){var h=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),a===u)break;a=a.return}}function Yg(a,o,u,h){var g=a.child;for(g!==null&&(g.return=a);g!==null;){var v=g.dependencies;if(v!==null){var b=g.child;v=v.firstContext;e:for(;v!==null;){var L=v;v=g;for(var re=0;re<o.length;re++)if(L.context===o[re]){v.lanes|=u,L=v.alternate,L!==null&&(L.lanes|=u),Xg(v.return,u,a),h||(b=null);break e}v=L.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(n(341));b.lanes|=u,v=b.alternate,v!==null&&(v.lanes|=u),Xg(b,u,a),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===a){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function Xc(a,o,u,h){a=null;for(var g=o,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var L=g.type;Ei(g.pendingProps.value,b.value)||(a!==null?a.push(L):a=[L])}}else if(g===Te.current){if(b=g.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(a!==null?a.push(hh):a=[hh])}g=g.return}a!==null&&Yg(o,a,u,h),o.flags|=262144}function bd(a){for(a=a.firstContext;a!==null;){if(!Ei(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function kl(a){Il=a,xs=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function bn(a){return VE(Il,a)}function Id(a,o){return Il===null&&kl(a),VE(a,o)}function VE(a,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},xs===null){if(a===null)throw Error(n(308));xs=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else xs=xs.next=o;return u}var p3=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(u,h){a.push(h)}};this.abort=function(){o.aborted=!0,a.forEach(function(u){return u()})}},g3=r.unstable_scheduleCallback,_3=r.unstable_NormalPriority,Wr={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $g(){return{controller:new p3,data:new Map,refCount:0}}function Uf(a){a.refCount--,a.refCount===0&&g3(_3,function(){a.controller.abort()})}var zf=null,Qg=0,Yc=0,$c=null;function v3(a,o){if(zf===null){var u=zf=[];Qg=0,Yc=e_(),$c={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Qg++,o.then(BE,BE),o}function BE(){if(--Qg===0&&zf!==null){$c!==null&&($c.status="fulfilled");var a=zf;zf=null,Yc=0,$c=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function x3(a,o){var u=[],h={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return a.then(function(){h.status="fulfilled",h.value=o;for(var g=0;g<u.length;g++)(0,u[g])(o)},function(g){for(h.status="rejected",h.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),h}var UE=ne.S;ne.S=function(a,o){wT=qt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&v3(a,o),UE!==null&&UE(a,o)};var Cl=J(null);function Jg(){var a=Cl.current;return a!==null?a:mr.pooledCache}function kd(a,o){o===null?Q(Cl,Cl.current):Q(Cl,o.pool)}function zE(){var a=Jg();return a===null?null:{parent:Wr._currentValue,pool:a}}var Qc=Error(n(460)),Zg=Error(n(474)),Cd=Error(n(542)),Rd={then:function(){}};function jE(a){return a=a.status,a==="fulfilled"||a==="rejected"}function HE(a,o,u){switch(u=a[u],u===void 0?a.push(o):u!==o&&(o.then(pa,pa),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,qE(a),a;default:if(typeof o.status=="string")o.then(pa,pa);else{if(a=mr,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=o,a.status="pending",a.then(function(h){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=h}},function(h){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,qE(a),a}throw Dl=o,Qc}}function Rl(a){try{var o=a._init;return o(a._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Dl=u,Qc):u}}var Dl=null;function GE(){if(Dl===null)throw Error(n(459));var a=Dl;return Dl=null,a}function qE(a){if(a===Qc||a===Cd)throw Error(n(483))}var Jc=null,jf=0;function Dd(a){var o=jf;return jf+=1,Jc===null&&(Jc=[]),HE(Jc,a,o)}function Hf(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Nd(a,o){throw o.$$typeof===x?Error(n(525)):(a=Object.prototype.toString.call(o),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function KE(a){function o(se,ie){if(a){var fe=se.deletions;fe===null?(se.deletions=[ie],se.flags|=16):fe.push(ie)}}function u(se,ie){if(!a)return null;for(;ie!==null;)o(se,ie),ie=ie.sibling;return null}function h(se){for(var ie=new Map;se!==null;)se.key!==null?ie.set(se.key,se):ie.set(se.index,se),se=se.sibling;return ie}function g(se,ie){return se=_s(se,ie),se.index=0,se.sibling=null,se}function v(se,ie,fe){return se.index=fe,a?(fe=se.alternate,fe!==null?(fe=fe.index,fe<ie?(se.flags|=67108866,ie):fe):(se.flags|=67108866,ie)):(se.flags|=1048576,ie)}function b(se){return a&&se.alternate===null&&(se.flags|=67108866),se}function L(se,ie,fe,ke){return ie===null||ie.tag!==6?(ie=zg(fe,se.mode,ke),ie.return=se,ie):(ie=g(ie,fe),ie.return=se,ie)}function re(se,ie,fe,ke){var at=fe.type;return at===E?be(se,ie,fe.props.children,ke,fe.key):ie!==null&&(ie.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===R&&Rl(at)===ie.type)?(ie=g(ie,fe.props),Hf(ie,fe),ie.return=se,ie):(ie=Sd(fe.type,fe.key,fe.props,null,se.mode,ke),Hf(ie,fe),ie.return=se,ie)}function me(se,ie,fe,ke){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==fe.containerInfo||ie.stateNode.implementation!==fe.implementation?(ie=jg(fe,se.mode,ke),ie.return=se,ie):(ie=g(ie,fe.children||[]),ie.return=se,ie)}function be(se,ie,fe,ke,at){return ie===null||ie.tag!==7?(ie=Al(fe,se.mode,ke,at),ie.return=se,ie):(ie=g(ie,fe),ie.return=se,ie)}function Ce(se,ie,fe){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=zg(""+ie,se.mode,fe),ie.return=se,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case y:return fe=Sd(ie.type,ie.key,ie.props,null,se.mode,fe),Hf(fe,ie),fe.return=se,fe;case T:return ie=jg(ie,se.mode,fe),ie.return=se,ie;case R:return ie=Rl(ie),Ce(se,ie,fe)}if(xe(ie)||M(ie))return ie=Al(ie,se.mode,fe,null),ie.return=se,ie;if(typeof ie.then=="function")return Ce(se,Dd(ie),fe);if(ie.$$typeof===k)return Ce(se,Id(se,ie),fe);Nd(se,ie)}return null}function _e(se,ie,fe,ke){var at=ie!==null?ie.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return at!==null?null:L(se,ie,""+fe,ke);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:return fe.key===at?re(se,ie,fe,ke):null;case T:return fe.key===at?me(se,ie,fe,ke):null;case R:return fe=Rl(fe),_e(se,ie,fe,ke)}if(xe(fe)||M(fe))return at!==null?null:be(se,ie,fe,ke,null);if(typeof fe.then=="function")return _e(se,ie,Dd(fe),ke);if(fe.$$typeof===k)return _e(se,ie,Id(se,fe),ke);Nd(se,fe)}return null}function Ee(se,ie,fe,ke,at){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return se=se.get(fe)||null,L(ie,se,""+ke,at);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case y:return se=se.get(ke.key===null?fe:ke.key)||null,re(ie,se,ke,at);case T:return se=se.get(ke.key===null?fe:ke.key)||null,me(ie,se,ke,at);case R:return ke=Rl(ke),Ee(se,ie,fe,ke,at)}if(xe(ke)||M(ke))return se=se.get(fe)||null,be(ie,se,ke,at,null);if(typeof ke.then=="function")return Ee(se,ie,fe,Dd(ke),at);if(ke.$$typeof===k)return Ee(se,ie,fe,Id(ie,ke),at);Nd(ie,ke)}return null}function Je(se,ie,fe,ke){for(var at=null,zt=null,tt=ie,yt=ie=0,Rt=null;tt!==null&&yt<fe.length;yt++){tt.index>yt?(Rt=tt,tt=null):Rt=tt.sibling;var jt=_e(se,tt,fe[yt],ke);if(jt===null){tt===null&&(tt=Rt);break}a&&tt&&jt.alternate===null&&o(se,tt),ie=v(jt,ie,yt),zt===null?at=jt:zt.sibling=jt,zt=jt,tt=Rt}if(yt===fe.length)return u(se,tt),Ft&&vs(se,yt),at;if(tt===null){for(;yt<fe.length;yt++)tt=Ce(se,fe[yt],ke),tt!==null&&(ie=v(tt,ie,yt),zt===null?at=tt:zt.sibling=tt,zt=tt);return Ft&&vs(se,yt),at}for(tt=h(tt);yt<fe.length;yt++)Rt=Ee(tt,se,yt,fe[yt],ke),Rt!==null&&(a&&Rt.alternate!==null&&tt.delete(Rt.key===null?yt:Rt.key),ie=v(Rt,ie,yt),zt===null?at=Rt:zt.sibling=Rt,zt=Rt);return a&&tt.forEach(function(Io){return o(se,Io)}),Ft&&vs(se,yt),at}function ct(se,ie,fe,ke){if(fe==null)throw Error(n(151));for(var at=null,zt=null,tt=ie,yt=ie=0,Rt=null,jt=fe.next();tt!==null&&!jt.done;yt++,jt=fe.next()){tt.index>yt?(Rt=tt,tt=null):Rt=tt.sibling;var Io=_e(se,tt,jt.value,ke);if(Io===null){tt===null&&(tt=Rt);break}a&&tt&&Io.alternate===null&&o(se,tt),ie=v(Io,ie,yt),zt===null?at=Io:zt.sibling=Io,zt=Io,tt=Rt}if(jt.done)return u(se,tt),Ft&&vs(se,yt),at;if(tt===null){for(;!jt.done;yt++,jt=fe.next())jt=Ce(se,jt.value,ke),jt!==null&&(ie=v(jt,ie,yt),zt===null?at=jt:zt.sibling=jt,zt=jt);return Ft&&vs(se,yt),at}for(tt=h(tt);!jt.done;yt++,jt=fe.next())jt=Ee(tt,se,yt,jt.value,ke),jt!==null&&(a&&jt.alternate!==null&&tt.delete(jt.key===null?yt:jt.key),ie=v(jt,ie,yt),zt===null?at=jt:zt.sibling=jt,zt=jt);return a&&tt.forEach(function(RN){return o(se,RN)}),Ft&&vs(se,yt),at}function ur(se,ie,fe,ke){if(typeof fe=="object"&&fe!==null&&fe.type===E&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:e:{for(var at=fe.key;ie!==null;){if(ie.key===at){if(at=fe.type,at===E){if(ie.tag===7){u(se,ie.sibling),ke=g(ie,fe.props.children),ke.return=se,se=ke;break e}}else if(ie.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===R&&Rl(at)===ie.type){u(se,ie.sibling),ke=g(ie,fe.props),Hf(ke,fe),ke.return=se,se=ke;break e}u(se,ie);break}else o(se,ie);ie=ie.sibling}fe.type===E?(ke=Al(fe.props.children,se.mode,ke,fe.key),ke.return=se,se=ke):(ke=Sd(fe.type,fe.key,fe.props,null,se.mode,ke),Hf(ke,fe),ke.return=se,se=ke)}return b(se);case T:e:{for(at=fe.key;ie!==null;){if(ie.key===at)if(ie.tag===4&&ie.stateNode.containerInfo===fe.containerInfo&&ie.stateNode.implementation===fe.implementation){u(se,ie.sibling),ke=g(ie,fe.children||[]),ke.return=se,se=ke;break e}else{u(se,ie);break}else o(se,ie);ie=ie.sibling}ke=jg(fe,se.mode,ke),ke.return=se,se=ke}return b(se);case R:return fe=Rl(fe),ur(se,ie,fe,ke)}if(xe(fe))return Je(se,ie,fe,ke);if(M(fe)){if(at=M(fe),typeof at!="function")throw Error(n(150));return fe=at.call(fe),ct(se,ie,fe,ke)}if(typeof fe.then=="function")return ur(se,ie,Dd(fe),ke);if(fe.$$typeof===k)return ur(se,ie,Id(se,fe),ke);Nd(se,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,ie!==null&&ie.tag===6?(u(se,ie.sibling),ke=g(ie,fe),ke.return=se,se=ke):(u(se,ie),ke=zg(fe,se.mode,ke),ke.return=se,se=ke),b(se)):u(se,ie)}return function(se,ie,fe,ke){try{jf=0;var at=ur(se,ie,fe,ke);return Jc=null,at}catch(tt){if(tt===Qc||tt===Cd)throw tt;var zt=Ti(29,tt,null,se.mode);return zt.lanes=ke,zt.return=se,zt}finally{}}}var Nl=KE(!0),WE=KE(!1),co=!1;function e1(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function t1(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function uo(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function fo(a,o,u){var h=a.updateQueue;if(h===null)return null;if(h=h.shared,(Xt&2)!==0){var g=h.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),h.pending=o,o=wd(a),RE(a,null,u),o}return Td(a,h,o,u),wd(a)}function Gf(a,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var h=o.lanes;h&=a.pendingLanes,u|=h,o.lanes=u,hs(a,u)}}function r1(a,o){var u=a.updateQueue,h=a.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var g=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var b={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};v===null?g=v=b:v=v.next=b,u=u.next}while(u!==null);v===null?g=v=o:v=v.next=o}else g=v=o;u={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:h.shared,callbacks:h.callbacks},a.updateQueue=u;return}a=u.lastBaseUpdate,a===null?u.firstBaseUpdate=o:a.next=o,u.lastBaseUpdate=o}var n1=!1;function qf(){if(n1){var a=$c;if(a!==null)throw a}}function Kf(a,o,u,h){n1=!1;var g=a.updateQueue;co=!1;var v=g.firstBaseUpdate,b=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var re=L,me=re.next;re.next=null,b===null?v=me:b.next=me,b=re;var be=a.alternate;be!==null&&(be=be.updateQueue,L=be.lastBaseUpdate,L!==b&&(L===null?be.firstBaseUpdate=me:L.next=me,be.lastBaseUpdate=re))}if(v!==null){var Ce=g.baseState;b=0,be=me=re=null,L=v;do{var _e=L.lane&-536870913,Ee=_e!==L.lane;if(Ee?(Ct&_e)===_e:(h&_e)===_e){_e!==0&&_e===Yc&&(n1=!0),be!==null&&(be=be.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var Je=a,ct=L;_e=o;var ur=u;switch(ct.tag){case 1:if(Je=ct.payload,typeof Je=="function"){Ce=Je.call(ur,Ce,_e);break e}Ce=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=ct.payload,_e=typeof Je=="function"?Je.call(ur,Ce,_e):Je,_e==null)break e;Ce=_({},Ce,_e);break e;case 2:co=!0}}_e=L.callback,_e!==null&&(a.flags|=64,Ee&&(a.flags|=8192),Ee=g.callbacks,Ee===null?g.callbacks=[_e]:Ee.push(_e))}else Ee={lane:_e,tag:L.tag,payload:L.payload,callback:L.callback,next:null},be===null?(me=be=Ee,re=Ce):be=be.next=Ee,b|=_e;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;Ee=L,L=Ee.next,Ee.next=null,g.lastBaseUpdate=Ee,g.shared.pending=null}}while(!0);be===null&&(re=Ce),g.baseState=re,g.firstBaseUpdate=me,g.lastBaseUpdate=be,v===null&&(g.shared.lanes=0),_o|=b,a.lanes=b,a.memoizedState=Ce}}function XE(a,o){if(typeof a!="function")throw Error(n(191,a));a.call(o)}function YE(a,o){var u=a.callbacks;if(u!==null)for(a.callbacks=null,a=0;a<u.length;a++)XE(u[a],o)}var Zc=J(null),Od=J(0);function $E(a,o){a=Cs,Q(Od,a),Q(Zc,o),Cs=a|o.baseLanes}function i1(){Q(Od,Cs),Q(Zc,Zc.current)}function a1(){Cs=Od.current,O(Zc),O(Od)}var wi=J(null),$i=null;function ho(a){var o=a.alternate;Q(Ur,Ur.current&1),Q(wi,a),$i===null&&(o===null||Zc.current!==null||o.memoizedState!==null)&&($i=a)}function s1(a){Q(Ur,Ur.current),Q(wi,a),$i===null&&($i=a)}function QE(a){a.tag===22?(Q(Ur,Ur.current),Q(wi,a),$i===null&&($i=a)):mo()}function mo(){Q(Ur,Ur.current),Q(wi,wi.current)}function Si(a){O(wi),$i===a&&($i=null),O(Ur)}var Ur=J(0);function Fd(a){for(var o=a;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||h_(u)||d_(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Es=0,vt=null,lr=null,Xr=null,Pd=!1,eu=!1,Ol=!1,Md=0,Wf=0,tu=null,y3=0;function Nr(){throw Error(n(321))}function o1(a,o){if(o===null)return!1;for(var u=0;u<o.length&&u<a.length;u++)if(!Ei(a[u],o[u]))return!1;return!0}function l1(a,o,u,h,g,v){return Es=v,vt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ne.H=a===null||a.memoizedState===null?F2:w1,Ol=!1,v=u(h,g),Ol=!1,eu&&(v=ZE(o,u,h,g)),JE(a),v}function JE(a){ne.H=$f;var o=lr!==null&&lr.next!==null;if(Es=0,Xr=lr=vt=null,Pd=!1,Wf=0,tu=null,o)throw Error(n(300));a===null||Yr||(a=a.dependencies,a!==null&&bd(a)&&(Yr=!0))}function ZE(a,o,u,h){vt=a;var g=0;do{if(eu&&(tu=null),Wf=0,eu=!1,25<=g)throw Error(n(301));if(g+=1,Xr=lr=null,a.updateQueue!=null){var v=a.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ne.H=P2,v=o(u,h)}while(eu);return v}function E3(){var a=ne.H,o=a.useState()[0];return o=typeof o.then=="function"?Xf(o):o,a=a.useState()[0],(lr!==null?lr.memoizedState:null)!==a&&(vt.flags|=1024),o}function c1(){var a=Md!==0;return Md=0,a}function u1(a,o,u){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~u}function f1(a){if(Pd){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Pd=!1}Es=0,Xr=lr=vt=null,eu=!1,Wf=Md=0,tu=null}function ei(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xr===null?vt.memoizedState=Xr=a:Xr=Xr.next=a,Xr}function zr(){if(lr===null){var a=vt.alternate;a=a!==null?a.memoizedState:null}else a=lr.next;var o=Xr===null?vt.memoizedState:Xr.next;if(o!==null)Xr=o,lr=a;else{if(a===null)throw vt.alternate===null?Error(n(467)):Error(n(310));lr=a,a={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},Xr===null?vt.memoizedState=Xr=a:Xr=Xr.next=a}return Xr}function Ld(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xf(a){var o=Wf;return Wf+=1,tu===null&&(tu=[]),a=HE(tu,a,o),o=vt,(Xr===null?o.memoizedState:Xr.next)===null&&(o=o.alternate,ne.H=o===null||o.memoizedState===null?F2:w1),a}function Vd(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Xf(a);if(a.$$typeof===k)return bn(a)}throw Error(n(438,String(a)))}function h1(a){var o=null,u=vt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var h=vt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Ld(),vt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(a),h=0;h<a;h++)u[h]=V;return o.index++,u}function Ts(a,o){return typeof o=="function"?o(a):o}function Bd(a){var o=zr();return d1(o,lr,a)}function d1(a,o,u){var h=a.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=u;var g=a.baseQueue,v=h.pending;if(v!==null){if(g!==null){var b=g.next;g.next=v.next,v.next=b}o.baseQueue=g=v,h.pending=null}if(v=a.baseState,g===null)a.memoizedState=v;else{o=g.next;var L=b=null,re=null,me=o,be=!1;do{var Ce=me.lane&-536870913;if(Ce!==me.lane?(Ct&Ce)===Ce:(Es&Ce)===Ce){var _e=me.revertLane;if(_e===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),Ce===Yc&&(be=!0);else if((Es&_e)===_e){me=me.next,_e===Yc&&(be=!0);continue}else Ce={lane:0,revertLane:me.revertLane,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(L=re=Ce,b=v):re=re.next=Ce,vt.lanes|=_e,_o|=_e;Ce=me.action,Ol&&u(v,Ce),v=me.hasEagerState?me.eagerState:u(v,Ce)}else _e={lane:Ce,revertLane:me.revertLane,gesture:me.gesture,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(L=re=_e,b=v):re=re.next=_e,vt.lanes|=Ce,_o|=Ce;me=me.next}while(me!==null&&me!==o);if(re===null?b=v:re.next=L,!Ei(v,a.memoizedState)&&(Yr=!0,be&&(u=$c,u!==null)))throw u;a.memoizedState=v,a.baseState=b,a.baseQueue=re,h.lastRenderedState=v}return g===null&&(h.lanes=0),[a.memoizedState,h.dispatch]}function m1(a){var o=zr(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=a;var h=u.dispatch,g=u.pending,v=o.memoizedState;if(g!==null){u.pending=null;var b=g=g.next;do v=a(v,b.action),b=b.next;while(b!==g);Ei(v,o.memoizedState)||(Yr=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),u.lastRenderedState=v}return[v,h]}function e2(a,o,u){var h=vt,g=zr(),v=Ft;if(v){if(u===void 0)throw Error(n(407));u=u()}else u=o();var b=!Ei((lr||g).memoizedState,u);if(b&&(g.memoizedState=u,Yr=!0),g=g.queue,_1(n2.bind(null,h,g,a),[a]),g.getSnapshot!==o||b||Xr!==null&&Xr.memoizedState.tag&1){if(h.flags|=2048,ru(9,{destroy:void 0},r2.bind(null,h,g,u,o),null),mr===null)throw Error(n(349));v||(Es&127)!==0||t2(h,o,u)}return u}function t2(a,o,u){a.flags|=16384,a={getSnapshot:o,value:u},o=vt.updateQueue,o===null?(o=Ld(),vt.updateQueue=o,o.stores=[a]):(u=o.stores,u===null?o.stores=[a]:u.push(a))}function r2(a,o,u,h){o.value=u,o.getSnapshot=h,i2(o)&&a2(a)}function n2(a,o,u){return u(function(){i2(o)&&a2(a)})}function i2(a){var o=a.getSnapshot;a=a.value;try{var u=o();return!Ei(a,u)}catch{return!0}}function a2(a){var o=Sl(a,2);o!==null&&hi(o,a,2)}function p1(a){var o=ei();if(typeof a=="function"){var u=a;if(a=u(),Ol){sn(!0);try{u()}finally{sn(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:a},o}function s2(a,o,u,h){return a.baseState=u,d1(a,lr,typeof h=="function"?h:Ts)}function T3(a,o,u,h,g){if(jd(a))throw Error(n(485));if(a=o.action,a!==null){var v={payload:g,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){v.listeners.push(b)}};ne.T!==null?u(!0):v.isTransition=!1,h(v),u=o.pending,u===null?(v.next=o.pending=v,o2(o,v)):(v.next=u.next,o.pending=u.next=v)}}function o2(a,o){var u=o.action,h=o.payload,g=a.state;if(o.isTransition){var v=ne.T,b={};ne.T=b;try{var L=u(g,h),re=ne.S;re!==null&&re(b,L),l2(a,o,L)}catch(me){g1(a,o,me)}finally{v!==null&&b.types!==null&&(v.types=b.types),ne.T=v}}else try{v=u(g,h),l2(a,o,v)}catch(me){g1(a,o,me)}}function l2(a,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){c2(a,o,h)},function(h){return g1(a,o,h)}):c2(a,o,u)}function c2(a,o,u){o.status="fulfilled",o.value=u,u2(o),a.state=u,o=a.pending,o!==null&&(u=o.next,u===o?a.pending=null:(u=u.next,o.next=u,o2(a,u)))}function g1(a,o,u){var h=a.pending;if(a.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=u,u2(o),o=o.next;while(o!==h)}a.action=null}function u2(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function f2(a,o){return o}function h2(a,o){if(Ft){var u=mr.formState;if(u!==null){e:{var h=vt;if(Ft){if(_r){t:{for(var g=_r,v=Yi;g.nodeType!==8;){if(!v){g=null;break t}if(g=Qi(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){_r=Qi(g.nextSibling),h=g.data==="F!";break e}}oo(h)}h=!1}h&&(o=u[0])}}return u=ei(),u.memoizedState=u.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f2,lastRenderedState:o},u.queue=h,u=D2.bind(null,vt,h),h.dispatch=u,h=p1(!1),v=T1.bind(null,vt,!1,h.queue),h=ei(),g={state:o,dispatch:null,action:a,pending:null},h.queue=g,u=T3.bind(null,vt,g,v,u),g.dispatch=u,h.memoizedState=a,[o,u,!1]}function d2(a){var o=zr();return m2(o,lr,a)}function m2(a,o,u){if(o=d1(a,o,f2)[0],a=Bd(Ts)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Xf(o)}catch(b){throw b===Qc?Cd:b}else h=o;o=zr();var g=o.queue,v=g.dispatch;return u!==o.memoizedState&&(vt.flags|=2048,ru(9,{destroy:void 0},w3.bind(null,g,u),null)),[h,v,a]}function w3(a,o){a.action=o}function p2(a){var o=zr(),u=lr;if(u!==null)return m2(o,u,a);zr(),o=o.memoizedState,u=zr();var h=u.queue.dispatch;return u.memoizedState=a,[o,h,!1]}function ru(a,o,u,h){return a={tag:a,create:u,deps:h,inst:o,next:null},o=vt.updateQueue,o===null&&(o=Ld(),vt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=a.next=a:(h=u.next,u.next=a,a.next=h,o.lastEffect=a),a}function g2(){return zr().memoizedState}function Ud(a,o,u,h){var g=ei();vt.flags|=a,g.memoizedState=ru(1|o,{destroy:void 0},u,h===void 0?null:h)}function zd(a,o,u,h){var g=zr();h=h===void 0?null:h;var v=g.memoizedState.inst;lr!==null&&h!==null&&o1(h,lr.memoizedState.deps)?g.memoizedState=ru(o,v,u,h):(vt.flags|=a,g.memoizedState=ru(1|o,v,u,h))}function _2(a,o){Ud(8390656,8,a,o)}function _1(a,o){zd(2048,8,a,o)}function S3(a){vt.flags|=4;var o=vt.updateQueue;if(o===null)o=Ld(),vt.updateQueue=o,o.events=[a];else{var u=o.events;u===null?o.events=[a]:u.push(a)}}function v2(a){var o=zr().memoizedState;return S3({ref:o,nextImpl:a}),function(){if((Xt&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function x2(a,o){return zd(4,2,a,o)}function y2(a,o){return zd(4,4,a,o)}function E2(a,o){if(typeof o=="function"){a=a();var u=o(a);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function T2(a,o,u){u=u!=null?u.concat([a]):null,zd(4,4,E2.bind(null,o,a),u)}function v1(){}function w2(a,o){var u=zr();o=o===void 0?null:o;var h=u.memoizedState;return o!==null&&o1(o,h[1])?h[0]:(u.memoizedState=[a,o],a)}function S2(a,o){var u=zr();o=o===void 0?null:o;var h=u.memoizedState;if(o!==null&&o1(o,h[1]))return h[0];if(h=a(),Ol){sn(!0);try{a()}finally{sn(!1)}}return u.memoizedState=[h,o],h}function x1(a,o,u){return u===void 0||(Es&1073741824)!==0&&(Ct&261930)===0?a.memoizedState=o:(a.memoizedState=u,a=AT(),vt.lanes|=a,_o|=a,u)}function A2(a,o,u,h){return Ei(u,o)?u:Zc.current!==null?(a=x1(a,u,h),Ei(a,o)||(Yr=!0),a):(Es&42)===0||(Es&1073741824)!==0&&(Ct&261930)===0?(Yr=!0,a.memoizedState=u):(a=AT(),vt.lanes|=a,_o|=a,o)}function b2(a,o,u,h,g){var v=le.p;le.p=v!==0&&8>v?v:8;var b=ne.T,L={};ne.T=L,T1(a,!1,o,u);try{var re=g(),me=ne.S;if(me!==null&&me(L,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var be=x3(re,h);Yf(a,o,be,Ii(a))}else Yf(a,o,h,Ii(a))}catch(Ce){Yf(a,o,{then:function(){},status:"rejected",reason:Ce},Ii())}finally{le.p=v,b!==null&&L.types!==null&&(b.types=L.types),ne.T=b}}function A3(){}function y1(a,o,u,h){if(a.tag!==5)throw Error(n(476));var g=I2(a).queue;b2(a,g,o,Le,u===null?A3:function(){return k2(a),u(h)})}function I2(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:Le,baseState:Le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:Le},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:u},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function k2(a){var o=I2(a);o.next===null&&(o=a.alternate.memoizedState),Yf(a,o.next.queue,{},Ii())}function E1(){return bn(hh)}function C2(){return zr().memoizedState}function R2(){return zr().memoizedState}function b3(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var u=Ii();a=uo(u);var h=fo(o,a,u);h!==null&&(hi(h,o,u),Gf(h,o,u)),o={cache:$g()},a.payload=o;return}o=o.return}}function I3(a,o,u){var h=Ii();u={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},jd(a)?N2(o,u):(u=Bg(a,o,u,h),u!==null&&(hi(u,a,h),O2(u,o,h)))}function D2(a,o,u){var h=Ii();Yf(a,o,u,h)}function Yf(a,o,u,h){var g={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(jd(a))N2(o,g);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var b=o.lastRenderedState,L=v(b,u);if(g.hasEagerState=!0,g.eagerState=L,Ei(L,b))return Td(a,o,g,0),mr===null&&Ed(),!1}catch{}finally{}if(u=Bg(a,o,g,h),u!==null)return hi(u,a,h),O2(u,o,h),!0}return!1}function T1(a,o,u,h){if(h={lane:2,revertLane:e_(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},jd(a)){if(o)throw Error(n(479))}else o=Bg(a,u,h,2),o!==null&&hi(o,a,2)}function jd(a){var o=a.alternate;return a===vt||o!==null&&o===vt}function N2(a,o){eu=Pd=!0;var u=a.pending;u===null?o.next=o:(o.next=u.next,u.next=o),a.pending=o}function O2(a,o,u){if((u&4194048)!==0){var h=o.lanes;h&=a.pendingLanes,u|=h,o.lanes=u,hs(a,u)}}var $f={readContext:bn,use:Vd,useCallback:Nr,useContext:Nr,useEffect:Nr,useImperativeHandle:Nr,useLayoutEffect:Nr,useInsertionEffect:Nr,useMemo:Nr,useReducer:Nr,useRef:Nr,useState:Nr,useDebugValue:Nr,useDeferredValue:Nr,useTransition:Nr,useSyncExternalStore:Nr,useId:Nr,useHostTransitionStatus:Nr,useFormState:Nr,useActionState:Nr,useOptimistic:Nr,useMemoCache:Nr,useCacheRefresh:Nr};$f.useEffectEvent=Nr;var F2={readContext:bn,use:Vd,useCallback:function(a,o){return ei().memoizedState=[a,o===void 0?null:o],a},useContext:bn,useEffect:_2,useImperativeHandle:function(a,o,u){u=u!=null?u.concat([a]):null,Ud(4194308,4,E2.bind(null,o,a),u)},useLayoutEffect:function(a,o){return Ud(4194308,4,a,o)},useInsertionEffect:function(a,o){Ud(4,2,a,o)},useMemo:function(a,o){var u=ei();o=o===void 0?null:o;var h=a();if(Ol){sn(!0);try{a()}finally{sn(!1)}}return u.memoizedState=[h,o],h},useReducer:function(a,o,u){var h=ei();if(u!==void 0){var g=u(o);if(Ol){sn(!0);try{u(o)}finally{sn(!1)}}}else g=o;return h.memoizedState=h.baseState=g,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:g},h.queue=a,a=a.dispatch=I3.bind(null,vt,a),[h.memoizedState,a]},useRef:function(a){var o=ei();return a={current:a},o.memoizedState=a},useState:function(a){a=p1(a);var o=a.queue,u=D2.bind(null,vt,o);return o.dispatch=u,[a.memoizedState,u]},useDebugValue:v1,useDeferredValue:function(a,o){var u=ei();return x1(u,a,o)},useTransition:function(){var a=p1(!1);return a=b2.bind(null,vt,a.queue,!0,!1),ei().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,u){var h=vt,g=ei();if(Ft){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),mr===null)throw Error(n(349));(Ct&127)!==0||t2(h,o,u)}g.memoizedState=u;var v={value:u,getSnapshot:o};return g.queue=v,_2(n2.bind(null,h,v,a),[a]),h.flags|=2048,ru(9,{destroy:void 0},r2.bind(null,h,v,u,o),null),u},useId:function(){var a=ei(),o=mr.identifierPrefix;if(Ft){var u=ja,h=za;u=(h&~(1<<32-Yt(h)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Md++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=y3++,o="_"+o+"r_"+u.toString(32)+"_";return a.memoizedState=o},useHostTransitionStatus:E1,useFormState:h2,useActionState:h2,useOptimistic:function(a){var o=ei();o.memoizedState=o.baseState=a;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=T1.bind(null,vt,!0,u),u.dispatch=o,[a,o]},useMemoCache:h1,useCacheRefresh:function(){return ei().memoizedState=b3.bind(null,vt)},useEffectEvent:function(a){var o=ei(),u={impl:a};return o.memoizedState=u,function(){if((Xt&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},w1={readContext:bn,use:Vd,useCallback:w2,useContext:bn,useEffect:_1,useImperativeHandle:T2,useInsertionEffect:x2,useLayoutEffect:y2,useMemo:S2,useReducer:Bd,useRef:g2,useState:function(){return Bd(Ts)},useDebugValue:v1,useDeferredValue:function(a,o){var u=zr();return A2(u,lr.memoizedState,a,o)},useTransition:function(){var a=Bd(Ts)[0],o=zr().memoizedState;return[typeof a=="boolean"?a:Xf(a),o]},useSyncExternalStore:e2,useId:C2,useHostTransitionStatus:E1,useFormState:d2,useActionState:d2,useOptimistic:function(a,o){var u=zr();return s2(u,lr,a,o)},useMemoCache:h1,useCacheRefresh:R2};w1.useEffectEvent=v2;var P2={readContext:bn,use:Vd,useCallback:w2,useContext:bn,useEffect:_1,useImperativeHandle:T2,useInsertionEffect:x2,useLayoutEffect:y2,useMemo:S2,useReducer:m1,useRef:g2,useState:function(){return m1(Ts)},useDebugValue:v1,useDeferredValue:function(a,o){var u=zr();return lr===null?x1(u,a,o):A2(u,lr.memoizedState,a,o)},useTransition:function(){var a=m1(Ts)[0],o=zr().memoizedState;return[typeof a=="boolean"?a:Xf(a),o]},useSyncExternalStore:e2,useId:C2,useHostTransitionStatus:E1,useFormState:p2,useActionState:p2,useOptimistic:function(a,o){var u=zr();return lr!==null?s2(u,lr,a,o):(u.baseState=a,[a,u.queue.dispatch])},useMemoCache:h1,useCacheRefresh:R2};P2.useEffectEvent=v2;function S1(a,o,u,h){o=a.memoizedState,u=u(h,o),u=u==null?o:_({},o,u),a.memoizedState=u,a.lanes===0&&(a.updateQueue.baseState=u)}var A1={enqueueSetState:function(a,o,u){a=a._reactInternals;var h=Ii(),g=uo(h);g.payload=o,u!=null&&(g.callback=u),o=fo(a,g,h),o!==null&&(hi(o,a,h),Gf(o,a,h))},enqueueReplaceState:function(a,o,u){a=a._reactInternals;var h=Ii(),g=uo(h);g.tag=1,g.payload=o,u!=null&&(g.callback=u),o=fo(a,g,h),o!==null&&(hi(o,a,h),Gf(o,a,h))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var u=Ii(),h=uo(u);h.tag=2,o!=null&&(h.callback=o),o=fo(a,h,u),o!==null&&(hi(o,a,u),Gf(o,a,u))}};function M2(a,o,u,h,g,v,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(h,v,b):o.prototype&&o.prototype.isPureReactComponent?!Mf(u,h)||!Mf(g,v):!0}function L2(a,o,u,h){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==a&&A1.enqueueReplaceState(o,o.state,null)}function Fl(a,o){var u=o;if("ref"in o){u={};for(var h in o)h!=="ref"&&(u[h]=o[h])}if(a=a.defaultProps){u===o&&(u=_({},u));for(var g in a)u[g]===void 0&&(u[g]=a[g])}return u}function V2(a){yd(a)}function B2(a){console.error(a)}function U2(a){yd(a)}function Hd(a,o){try{var u=a.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function z2(a,o,u){try{var h=a.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function b1(a,o,u){return u=uo(u),u.tag=3,u.payload={element:null},u.callback=function(){Hd(a,o)},u}function j2(a){return a=uo(a),a.tag=3,a}function H2(a,o,u,h){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var v=h.value;a.payload=function(){return g(v)},a.callback=function(){z2(o,u,h)}}var b=u.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){z2(o,u,h),typeof g!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var L=h.stack;this.componentDidCatch(h.value,{componentStack:L!==null?L:""})})}function k3(a,o,u,h,g){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=u.alternate,o!==null&&Xc(o,u,g,!0),u=wi.current,u!==null){switch(u.tag){case 31:case 13:return $i===null?tm():u.alternate===null&&Or===0&&(Or=3),u.flags&=-257,u.flags|=65536,u.lanes=g,h===Rd?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([h]):o.add(h),Q1(a,h,g)),!1;case 22:return u.flags|=65536,h===Rd?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([h]):u.add(h)),Q1(a,h,g)),!1}throw Error(n(435,u.tag))}return Q1(a,h,g),tm(),!1}if(Ft)return o=wi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,h!==qg&&(a=Error(n(422),{cause:h}),Bf(Ki(a,u)))):(h!==qg&&(o=Error(n(423),{cause:h}),Bf(Ki(o,u))),a=a.current.alternate,a.flags|=65536,g&=-g,a.lanes|=g,h=Ki(h,u),g=b1(a.stateNode,h,g),r1(a,g),Or!==4&&(Or=2)),!1;var v=Error(n(520),{cause:h});if(v=Ki(v,u),ih===null?ih=[v]:ih.push(v),Or!==4&&(Or=2),o===null)return!0;h=Ki(h,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,a=g&-g,u.lanes|=a,a=b1(u.stateNode,h,a),r1(u,a),!1;case 1:if(o=u.type,v=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(vo===null||!vo.has(v))))return u.flags|=65536,g&=-g,u.lanes|=g,g=j2(g),H2(g,a,u,h),r1(u,g),!1}u=u.return}while(u!==null);return!1}var I1=Error(n(461)),Yr=!1;function In(a,o,u,h){o.child=a===null?WE(o,null,u,h):Nl(o,a.child,u,h)}function G2(a,o,u,h,g){u=u.render;var v=o.ref;if("ref"in h){var b={};for(var L in h)L!=="ref"&&(b[L]=h[L])}else b=h;return kl(o),h=l1(a,o,u,b,v,g),L=c1(),a!==null&&!Yr?(u1(a,o,g),ws(a,o,g)):(Ft&&L&&Hg(o),o.flags|=1,In(a,o,h,g),o.child)}function q2(a,o,u,h,g){if(a===null){var v=u.type;return typeof v=="function"&&!Ug(v)&&v.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=v,K2(a,o,v,h,g)):(a=Sd(u.type,null,h,o,o.mode,g),a.ref=o.ref,a.return=o,o.child=a)}if(v=a.child,!P1(a,g)){var b=v.memoizedProps;if(u=u.compare,u=u!==null?u:Mf,u(b,h)&&a.ref===o.ref)return ws(a,o,g)}return o.flags|=1,a=_s(v,h),a.ref=o.ref,a.return=o,o.child=a}function K2(a,o,u,h,g){if(a!==null){var v=a.memoizedProps;if(Mf(v,h)&&a.ref===o.ref)if(Yr=!1,o.pendingProps=h=v,P1(a,g))(a.flags&131072)!==0&&(Yr=!0);else return o.lanes=a.lanes,ws(a,o,g)}return k1(a,o,u,h,g)}function W2(a,o,u,h){var g=h.children,v=a!==null?a.memoizedState:null;if(a===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(v=v!==null?v.baseLanes|u:u,a!==null){for(h=o.child=a.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~v}else h=0,o.child=null;return X2(a,o,v,u,h)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&kd(o,v!==null?v.cachePool:null),v!==null?$E(o,v):i1(),QE(o);else return h=o.lanes=536870912,X2(a,o,v!==null?v.baseLanes|u:u,u,h)}else v!==null?(kd(o,v.cachePool),$E(o,v),mo(),o.memoizedState=null):(a!==null&&kd(o,null),i1(),mo());return In(a,o,g,u),o.child}function Qf(a,o){return a!==null&&a.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function X2(a,o,u,h,g){var v=Jg();return v=v===null?null:{parent:Wr._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},a!==null&&kd(o,null),i1(),QE(o),a!==null&&Xc(a,o,h,!0),o.childLanes=g,null}function Gd(a,o){return o=Kd({mode:o.mode,children:o.children},a.mode),o.ref=a.ref,a.child=o,o.return=a,o}function Y2(a,o,u){return Nl(o,a.child,null,u),a=Gd(o,o.pendingProps),a.flags|=2,Si(o),o.memoizedState=null,a}function C3(a,o,u){var h=o.pendingProps,g=(o.flags&128)!==0;if(o.flags&=-129,a===null){if(Ft){if(h.mode==="hidden")return a=Gd(o,h),o.lanes=536870912,Qf(null,a);if(s1(o),(a=_r)?(a=ow(a,Yi),a=a!==null&&a.data==="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:ao!==null?{id:za,overflow:ja}:null,retryLane:536870912,hydrationErrors:null},u=NE(a),u.return=o,o.child=u,An=o,_r=null)):a=null,a===null)throw oo(o);return o.lanes=536870912,null}return Gd(o,h)}var v=a.memoizedState;if(v!==null){var b=v.dehydrated;if(s1(o),g)if(o.flags&256)o.flags&=-257,o=Y2(a,o,u);else if(o.memoizedState!==null)o.child=a.child,o.flags|=128,o=null;else throw Error(n(558));else if(Yr||Xc(a,o,u,!1),g=(u&a.childLanes)!==0,Yr||g){if(h=mr,h!==null&&(b=hl(h,u),b!==0&&b!==v.retryLane))throw v.retryLane=b,Sl(a,b),hi(h,a,b),I1;tm(),o=Y2(a,o,u)}else a=v.treeContext,_r=Qi(b.nextSibling),An=o,Ft=!0,so=null,Yi=!1,a!==null&&PE(o,a),o=Gd(o,h),o.flags|=4096;return o}return a=_s(a.child,{mode:h.mode,children:h.children}),a.ref=o.ref,o.child=a,a.return=o,a}function qd(a,o){var u=o.ref;if(u===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(a===null||a.ref!==u)&&(o.flags|=4194816)}}function k1(a,o,u,h,g){return kl(o),u=l1(a,o,u,h,void 0,g),h=c1(),a!==null&&!Yr?(u1(a,o,g),ws(a,o,g)):(Ft&&h&&Hg(o),o.flags|=1,In(a,o,u,g),o.child)}function $2(a,o,u,h,g,v){return kl(o),o.updateQueue=null,u=ZE(o,h,u,g),JE(a),h=c1(),a!==null&&!Yr?(u1(a,o,v),ws(a,o,v)):(Ft&&h&&Hg(o),o.flags|=1,In(a,o,u,v),o.child)}function Q2(a,o,u,h,g){if(kl(o),o.stateNode===null){var v=Gc,b=u.contextType;typeof b=="object"&&b!==null&&(v=bn(b)),v=new u(h,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=A1,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=h,v.state=o.memoizedState,v.refs={},e1(o),b=u.contextType,v.context=typeof b=="object"&&b!==null?bn(b):Gc,v.state=o.memoizedState,b=u.getDerivedStateFromProps,typeof b=="function"&&(S1(o,u,b,h),v.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(b=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),b!==v.state&&A1.enqueueReplaceState(v,v.state,null),Kf(o,h,v,g),qf(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(a===null){v=o.stateNode;var L=o.memoizedProps,re=Fl(u,L);v.props=re;var me=v.context,be=u.contextType;b=Gc,typeof be=="object"&&be!==null&&(b=bn(be));var Ce=u.getDerivedStateFromProps;be=typeof Ce=="function"||typeof v.getSnapshotBeforeUpdate=="function",L=o.pendingProps!==L,be||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(L||me!==b)&&L2(o,v,h,b),co=!1;var _e=o.memoizedState;v.state=_e,Kf(o,h,v,g),qf(),me=o.memoizedState,L||_e!==me||co?(typeof Ce=="function"&&(S1(o,u,Ce,h),me=o.memoizedState),(re=co||M2(o,u,re,h,_e,me,b))?(be||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=me),v.props=h,v.state=me,v.context=b,h=re):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{v=o.stateNode,t1(a,o),b=o.memoizedProps,be=Fl(u,b),v.props=be,Ce=o.pendingProps,_e=v.context,me=u.contextType,re=Gc,typeof me=="object"&&me!==null&&(re=bn(me)),L=u.getDerivedStateFromProps,(me=typeof L=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b!==Ce||_e!==re)&&L2(o,v,h,re),co=!1,_e=o.memoizedState,v.state=_e,Kf(o,h,v,g),qf();var Ee=o.memoizedState;b!==Ce||_e!==Ee||co||a!==null&&a.dependencies!==null&&bd(a.dependencies)?(typeof L=="function"&&(S1(o,u,L,h),Ee=o.memoizedState),(be=co||M2(o,u,be,h,_e,Ee,re)||a!==null&&a.dependencies!==null&&bd(a.dependencies))?(me||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(h,Ee,re),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(h,Ee,re)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=Ee),v.props=h,v.state=Ee,v.context=re,h=be):(typeof v.componentDidUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&_e===a.memoizedState||(o.flags|=1024),h=!1)}return v=h,qd(a,o),h=(o.flags&128)!==0,v||h?(v=o.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,a!==null&&h?(o.child=Nl(o,a.child,null,g),o.child=Nl(o,null,u,g)):In(a,o,u,g),o.memoizedState=v.state,a=o.child):a=ws(a,o,g),a}function J2(a,o,u,h){return bl(),o.flags|=256,In(a,o,u,h),o.child}var C1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function R1(a){return{baseLanes:a,cachePool:zE()}}function D1(a,o,u){return a=a!==null?a.childLanes&~u:0,o&&(a|=bi),a}function Z2(a,o,u){var h=o.pendingProps,g=!1,v=(o.flags&128)!==0,b;if((b=v)||(b=a!==null&&a.memoizedState===null?!1:(Ur.current&2)!==0),b&&(g=!0,o.flags&=-129),b=(o.flags&32)!==0,o.flags&=-33,a===null){if(Ft){if(g?ho(o):mo(),(a=_r)?(a=ow(a,Yi),a=a!==null&&a.data!=="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:ao!==null?{id:za,overflow:ja}:null,retryLane:536870912,hydrationErrors:null},u=NE(a),u.return=o,o.child=u,An=o,_r=null)):a=null,a===null)throw oo(o);return d_(a)?o.lanes=32:o.lanes=536870912,null}var L=h.children;return h=h.fallback,g?(mo(),g=o.mode,L=Kd({mode:"hidden",children:L},g),h=Al(h,g,u,null),L.return=o,h.return=o,L.sibling=h,o.child=L,h=o.child,h.memoizedState=R1(u),h.childLanes=D1(a,b,u),o.memoizedState=C1,Qf(null,h)):(ho(o),N1(o,L))}var re=a.memoizedState;if(re!==null&&(L=re.dehydrated,L!==null)){if(v)o.flags&256?(ho(o),o.flags&=-257,o=O1(a,o,u)):o.memoizedState!==null?(mo(),o.child=a.child,o.flags|=128,o=null):(mo(),L=h.fallback,g=o.mode,h=Kd({mode:"visible",children:h.children},g),L=Al(L,g,u,null),L.flags|=2,h.return=o,L.return=o,h.sibling=L,o.child=h,Nl(o,a.child,null,u),h=o.child,h.memoizedState=R1(u),h.childLanes=D1(a,b,u),o.memoizedState=C1,o=Qf(null,h));else if(ho(o),d_(L)){if(b=L.nextSibling&&L.nextSibling.dataset,b)var me=b.dgst;b=me,h=Error(n(419)),h.stack="",h.digest=b,Bf({value:h,source:null,stack:null}),o=O1(a,o,u)}else if(Yr||Xc(a,o,u,!1),b=(u&a.childLanes)!==0,Yr||b){if(b=mr,b!==null&&(h=hl(b,u),h!==0&&h!==re.retryLane))throw re.retryLane=h,Sl(a,h),hi(b,a,h),I1;h_(L)||tm(),o=O1(a,o,u)}else h_(L)?(o.flags|=192,o.child=a.child,o=null):(a=re.treeContext,_r=Qi(L.nextSibling),An=o,Ft=!0,so=null,Yi=!1,a!==null&&PE(o,a),o=N1(o,h.children),o.flags|=4096);return o}return g?(mo(),L=h.fallback,g=o.mode,re=a.child,me=re.sibling,h=_s(re,{mode:"hidden",children:h.children}),h.subtreeFlags=re.subtreeFlags&65011712,me!==null?L=_s(me,L):(L=Al(L,g,u,null),L.flags|=2),L.return=o,h.return=o,h.sibling=L,o.child=h,Qf(null,h),h=o.child,L=a.child.memoizedState,L===null?L=R1(u):(g=L.cachePool,g!==null?(re=Wr._currentValue,g=g.parent!==re?{parent:re,pool:re}:g):g=zE(),L={baseLanes:L.baseLanes|u,cachePool:g}),h.memoizedState=L,h.childLanes=D1(a,b,u),o.memoizedState=C1,Qf(a.child,h)):(ho(o),u=a.child,a=u.sibling,u=_s(u,{mode:"visible",children:h.children}),u.return=o,u.sibling=null,a!==null&&(b=o.deletions,b===null?(o.deletions=[a],o.flags|=16):b.push(a)),o.child=u,o.memoizedState=null,u)}function N1(a,o){return o=Kd({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function Kd(a,o){return a=Ti(22,a,null,o),a.lanes=0,a}function O1(a,o,u){return Nl(o,a.child,null,u),a=N1(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function eT(a,o,u){a.lanes|=o;var h=a.alternate;h!==null&&(h.lanes|=o),Xg(a.return,o,u)}function F1(a,o,u,h,g,v){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:g,treeForkCount:v}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=u,b.tailMode=g,b.treeForkCount=v)}function tT(a,o,u){var h=o.pendingProps,g=h.revealOrder,v=h.tail;h=h.children;var b=Ur.current,L=(b&2)!==0;if(L?(b=b&1|2,o.flags|=128):b&=1,Q(Ur,b),In(a,o,h,u),h=Ft?Vf:0,!L&&a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&eT(a,u,o);else if(a.tag===19)eT(a,u,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(g){case"forwards":for(u=o.child,g=null;u!==null;)a=u.alternate,a!==null&&Fd(a)===null&&(g=u),u=u.sibling;u=g,u===null?(g=o.child,o.child=null):(g=u.sibling,u.sibling=null),F1(o,!1,g,u,v,h);break;case"backwards":case"unstable_legacy-backwards":for(u=null,g=o.child,o.child=null;g!==null;){if(a=g.alternate,a!==null&&Fd(a)===null){o.child=g;break}a=g.sibling,g.sibling=u,u=g,g=a}F1(o,!0,u,null,v,h);break;case"together":F1(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function ws(a,o,u){if(a!==null&&(o.dependencies=a.dependencies),_o|=o.lanes,(u&o.childLanes)===0)if(a!==null){if(Xc(a,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(n(153));if(o.child!==null){for(a=o.child,u=_s(a,a.pendingProps),o.child=u,u.return=o;a.sibling!==null;)a=a.sibling,u=u.sibling=_s(a,a.pendingProps),u.return=o;u.sibling=null}return o.child}function P1(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&bd(a)))}function R3(a,o,u){switch(o.tag){case 3:Re(o,o.stateNode.containerInfo),lo(o,Wr,a.memoizedState.cache),bl();break;case 27:case 5:De(o);break;case 4:Re(o,o.stateNode.containerInfo);break;case 10:lo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,s1(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(ho(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Z2(a,o,u):(ho(o),a=ws(a,o,u),a!==null?a.sibling:null);ho(o);break;case 19:var g=(a.flags&128)!==0;if(h=(u&o.childLanes)!==0,h||(Xc(a,o,u,!1),h=(u&o.childLanes)!==0),g){if(h)return tT(a,o,u);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Q(Ur,Ur.current),h)break;return null;case 22:return o.lanes=0,W2(a,o,u,o.pendingProps);case 24:lo(o,Wr,a.memoizedState.cache)}return ws(a,o,u)}function rT(a,o,u){if(a!==null)if(a.memoizedProps!==o.pendingProps)Yr=!0;else{if(!P1(a,u)&&(o.flags&128)===0)return Yr=!1,R3(a,o,u);Yr=(a.flags&131072)!==0}else Yr=!1,Ft&&(o.flags&1048576)!==0&&FE(o,Vf,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(a=Rl(o.elementType),o.type=a,typeof a=="function")Ug(a)?(h=Fl(a,h),o.tag=1,o=Q2(null,o,a,h,u)):(o.tag=0,o=k1(null,o,a,h,u));else{if(a!=null){var g=a.$$typeof;if(g===W){o.tag=11,o=G2(null,o,a,h,u);break e}else if(g===A){o.tag=14,o=q2(null,o,a,h,u);break e}}throw o=ve(a)||a,Error(n(306,o,""))}}return o;case 0:return k1(a,o,o.type,o.pendingProps,u);case 1:return h=o.type,g=Fl(h,o.pendingProps),Q2(a,o,h,g,u);case 3:e:{if(Re(o,o.stateNode.containerInfo),a===null)throw Error(n(387));h=o.pendingProps;var v=o.memoizedState;g=v.element,t1(a,o),Kf(o,h,null,u);var b=o.memoizedState;if(h=b.cache,lo(o,Wr,h),h!==v.cache&&Yg(o,[Wr],u,!0),qf(),h=b.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:b.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=J2(a,o,h,u);break e}else if(h!==g){g=Ki(Error(n(424)),o),Bf(g),o=J2(a,o,h,u);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(_r=Qi(a.firstChild),An=o,Ft=!0,so=null,Yi=!0,u=WE(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(bl(),h===g){o=ws(a,o,u);break e}In(a,o,h,u)}o=o.child}return o;case 26:return qd(a,o),a===null?(u=dw(o.type,null,o.pendingProps,null))?o.memoizedState=u:Ft||(u=o.type,a=o.pendingProps,h=lm(oe.current).createElement(u),h[H]=o,h[G]=a,kn(h,u,a),Ze(h),o.stateNode=h):o.memoizedState=dw(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return De(o),a===null&&Ft&&(h=o.stateNode=uw(o.type,o.pendingProps,oe.current),An=o,Yi=!0,g=_r,To(o.type)?(m_=g,_r=Qi(h.firstChild)):_r=g),In(a,o,o.pendingProps.children,u),qd(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&Ft&&((g=h=_r)&&(h=sN(h,o.type,o.pendingProps,Yi),h!==null?(o.stateNode=h,An=o,_r=Qi(h.firstChild),Yi=!1,g=!0):g=!1),g||oo(o)),De(o),g=o.type,v=o.pendingProps,b=a!==null?a.memoizedProps:null,h=v.children,c_(g,v)?h=null:b!==null&&c_(g,b)&&(o.flags|=32),o.memoizedState!==null&&(g=l1(a,o,E3,null,null,u),hh._currentValue=g),qd(a,o),In(a,o,h,u),o.child;case 6:return a===null&&Ft&&((a=u=_r)&&(u=oN(u,o.pendingProps,Yi),u!==null?(o.stateNode=u,An=o,_r=null,a=!0):a=!1),a||oo(o)),null;case 13:return Z2(a,o,u);case 4:return Re(o,o.stateNode.containerInfo),h=o.pendingProps,a===null?o.child=Nl(o,null,h,u):In(a,o,h,u),o.child;case 11:return G2(a,o,o.type,o.pendingProps,u);case 7:return In(a,o,o.pendingProps,u),o.child;case 8:return In(a,o,o.pendingProps.children,u),o.child;case 12:return In(a,o,o.pendingProps.children,u),o.child;case 10:return h=o.pendingProps,lo(o,o.type,h.value),In(a,o,h.children,u),o.child;case 9:return g=o.type._context,h=o.pendingProps.children,kl(o),g=bn(g),h=h(g),o.flags|=1,In(a,o,h,u),o.child;case 14:return q2(a,o,o.type,o.pendingProps,u);case 15:return K2(a,o,o.type,o.pendingProps,u);case 19:return tT(a,o,u);case 31:return C3(a,o,u);case 22:return W2(a,o,u,o.pendingProps);case 24:return kl(o),h=bn(Wr),a===null?(g=Jg(),g===null&&(g=mr,v=$g(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=u),g=v),o.memoizedState={parent:h,cache:g},e1(o),lo(o,Wr,g)):((a.lanes&u)!==0&&(t1(a,o),Kf(o,null,null,u),qf()),g=a.memoizedState,v=o.memoizedState,g.parent!==h?(g={parent:h,cache:h},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),lo(o,Wr,h)):(h=v.cache,lo(o,Wr,h),h!==g.cache&&Yg(o,[Wr],u,!0))),In(a,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Ss(a){a.flags|=4}function M1(a,o,u,h,g){if((o=(a.mode&32)!==0)&&(o=!1),o){if(a.flags|=16777216,(g&335544128)===g)if(a.stateNode.complete)a.flags|=8192;else if(CT())a.flags|=8192;else throw Dl=Rd,Zg}else a.flags&=-16777217}function nT(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!vw(o))if(CT())a.flags|=8192;else throw Dl=Rd,Zg}function Wd(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?Dc():536870912,a.lanes|=o,su|=o)}function Jf(a,o){if(!Ft)switch(a.tailMode){case"hidden":o=a.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?a.tail=null:u.sibling=null;break;case"collapsed":u=a.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:h.sibling=null}}function vr(a){var o=a.alternate!==null&&a.alternate.child===a.child,u=0,h=0;if(o)for(var g=a.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=h,a.childLanes=u,o}function D3(a,o,u){var h=o.pendingProps;switch(Gg(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(o),null;case 1:return vr(o),null;case 3:return u=o.stateNode,h=null,a!==null&&(h=a.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),ys(Wr),Se(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(a===null||a.child===null)&&(Wc(o)?Ss(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Kg())),vr(o),null;case 26:var g=o.type,v=o.memoizedState;return a===null?(Ss(o),v!==null?(vr(o),nT(o,v)):(vr(o),M1(o,g,null,h,u))):v?v!==a.memoizedState?(Ss(o),vr(o),nT(o,v)):(vr(o),o.flags&=-16777217):(a=a.memoizedProps,a!==h&&Ss(o),vr(o),M1(o,g,a,h,u)),null;case 27:if(st(o),u=oe.current,g=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==h&&Ss(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return vr(o),null}a=q.current,Wc(o)?ME(o):(a=uw(g,h,u),o.stateNode=a,Ss(o))}return vr(o),null;case 5:if(st(o),g=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==h&&Ss(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return vr(o),null}if(v=q.current,Wc(o))ME(o);else{var b=lm(oe.current);switch(v){case 1:v=b.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:v=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":v=b.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":v=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":v=b.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof h.is=="string"?b.createElement("select",{is:h.is}):b.createElement("select"),h.multiple?v.multiple=!0:h.size&&(v.size=h.size);break;default:v=typeof h.is=="string"?b.createElement(g,{is:h.is}):b.createElement(g)}}v[H]=o,v[G]=h;e:for(b=o.child;b!==null;){if(b.tag===5||b.tag===6)v.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===o)break e;for(;b.sibling===null;){if(b.return===null||b.return===o)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}o.stateNode=v;e:switch(kn(v,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Ss(o)}}return vr(o),M1(o,o.type,a===null?null:a.memoizedProps,o.pendingProps,u),null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==h&&Ss(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(n(166));if(a=oe.current,Wc(o)){if(a=o.stateNode,u=o.memoizedProps,h=null,g=An,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}a[H]=o,a=!!(a.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||ZT(a.nodeValue,u)),a||oo(o,!0)}else a=lm(a).createTextNode(h),a[H]=o,o.stateNode=a}return vr(o),null;case 31:if(u=o.memoizedState,a===null||a.memoizedState!==null){if(h=Wc(o),u!==null){if(a===null){if(!h)throw Error(n(318));if(a=o.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[H]=o}else bl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;vr(o),a=!1}else u=Kg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=u),a=!0;if(!a)return o.flags&256?(Si(o),o):(Si(o),null);if((o.flags&128)!==0)throw Error(n(558))}return vr(o),null;case 13:if(h=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(g=Wc(o),h!==null&&h.dehydrated!==null){if(a===null){if(!g)throw Error(n(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[H]=o}else bl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;vr(o),g=!1}else g=Kg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(Si(o),o):(Si(o),null)}return Si(o),(o.flags&128)!==0?(o.lanes=u,o):(u=h!==null,a=a!==null&&a.memoizedState!==null,u&&(h=o.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),v=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(v=h.memoizedState.cachePool.pool),v!==g&&(h.flags|=2048)),u!==a&&u&&(o.child.flags|=8192),Wd(o,o.updateQueue),vr(o),null);case 4:return Se(),a===null&&i_(o.stateNode.containerInfo),vr(o),null;case 10:return ys(o.type),vr(o),null;case 19:if(O(Ur),h=o.memoizedState,h===null)return vr(o),null;if(g=(o.flags&128)!==0,v=h.rendering,v===null)if(g)Jf(h,!1);else{if(Or!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(v=Fd(a),v!==null){for(o.flags|=128,Jf(h,!1),a=v.updateQueue,o.updateQueue=a,Wd(o,a),o.subtreeFlags=0,a=u,u=o.child;u!==null;)DE(u,a),u=u.sibling;return Q(Ur,Ur.current&1|2),Ft&&vs(o,h.treeForkCount),o.child}a=a.sibling}h.tail!==null&&qt()>Jd&&(o.flags|=128,g=!0,Jf(h,!1),o.lanes=4194304)}else{if(!g)if(a=Fd(v),a!==null){if(o.flags|=128,g=!0,a=a.updateQueue,o.updateQueue=a,Wd(o,a),Jf(h,!0),h.tail===null&&h.tailMode==="hidden"&&!v.alternate&&!Ft)return vr(o),null}else 2*qt()-h.renderingStartTime>Jd&&u!==536870912&&(o.flags|=128,g=!0,Jf(h,!1),o.lanes=4194304);h.isBackwards?(v.sibling=o.child,o.child=v):(a=h.last,a!==null?a.sibling=v:o.child=v,h.last=v)}return h.tail!==null?(a=h.tail,h.rendering=a,h.tail=a.sibling,h.renderingStartTime=qt(),a.sibling=null,u=Ur.current,Q(Ur,g?u&1|2:u&1),Ft&&vs(o,h.treeForkCount),a):(vr(o),null);case 22:case 23:return Si(o),a1(),h=o.memoizedState!==null,a!==null?a.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(u&536870912)!==0&&(o.flags&128)===0&&(vr(o),o.subtreeFlags&6&&(o.flags|=8192)):vr(o),u=o.updateQueue,u!==null&&Wd(o,u.retryQueue),u=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==u&&(o.flags|=2048),a!==null&&O(Cl),null;case 24:return u=null,a!==null&&(u=a.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ys(Wr),vr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function N3(a,o){switch(Gg(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return ys(Wr),Se(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return st(o),null;case 31:if(o.memoizedState!==null){if(Si(o),o.alternate===null)throw Error(n(340));bl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 13:if(Si(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(n(340));bl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return O(Ur),null;case 4:return Se(),null;case 10:return ys(o.type),null;case 22:case 23:return Si(o),a1(),a!==null&&O(Cl),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return ys(Wr),null;case 25:return null;default:return null}}function iT(a,o){switch(Gg(o),o.tag){case 3:ys(Wr),Se();break;case 26:case 27:case 5:st(o);break;case 4:Se();break;case 31:o.memoizedState!==null&&Si(o);break;case 13:Si(o);break;case 19:O(Ur);break;case 10:ys(o.type);break;case 22:case 23:Si(o),a1(),a!==null&&O(Cl);break;case 24:ys(Wr)}}function Zf(a,o){try{var u=o.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var g=h.next;u=g;do{if((u.tag&a)===a){h=void 0;var v=u.create,b=u.inst;h=v(),b.destroy=h}u=u.next}while(u!==g)}}catch(L){tr(o,o.return,L)}}function po(a,o,u){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var v=g.next;h=v;do{if((h.tag&a)===a){var b=h.inst,L=b.destroy;if(L!==void 0){b.destroy=void 0,g=o;var re=u,me=L;try{me()}catch(be){tr(g,re,be)}}}h=h.next}while(h!==v)}}catch(be){tr(o,o.return,be)}}function aT(a){var o=a.updateQueue;if(o!==null){var u=a.stateNode;try{YE(o,u)}catch(h){tr(a,a.return,h)}}}function sT(a,o,u){u.props=Fl(a.type,a.memoizedProps),u.state=a.memoizedState;try{u.componentWillUnmount()}catch(h){tr(a,o,h)}}function eh(a,o){try{var u=a.ref;if(u!==null){switch(a.tag){case 26:case 27:case 5:var h=a.stateNode;break;case 30:h=a.stateNode;break;default:h=a.stateNode}typeof u=="function"?a.refCleanup=u(h):u.current=h}}catch(g){tr(a,o,g)}}function Ha(a,o){var u=a.ref,h=a.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(g){tr(a,o,g)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){tr(a,o,g)}else u.current=null}function oT(a){var o=a.type,u=a.memoizedProps,h=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(g){tr(a,a.return,g)}}function L1(a,o,u){try{var h=a.stateNode;eN(h,a.type,u,o),h[G]=o}catch(g){tr(a,a.return,g)}}function lT(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&To(a.type)||a.tag===4}function V1(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||lT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&To(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function B1(a,o,u){var h=a.tag;if(h===5||h===6)a=a.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(a,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(a),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=pa));else if(h!==4&&(h===27&&To(a.type)&&(u=a.stateNode,o=null),a=a.child,a!==null))for(B1(a,o,u),a=a.sibling;a!==null;)B1(a,o,u),a=a.sibling}function Xd(a,o,u){var h=a.tag;if(h===5||h===6)a=a.stateNode,o?u.insertBefore(a,o):u.appendChild(a);else if(h!==4&&(h===27&&To(a.type)&&(u=a.stateNode),a=a.child,a!==null))for(Xd(a,o,u),a=a.sibling;a!==null;)Xd(a,o,u),a=a.sibling}function cT(a){var o=a.stateNode,u=a.memoizedProps;try{for(var h=a.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);kn(o,h,u),o[H]=a,o[G]=u}catch(v){tr(a,a.return,v)}}var As=!1,$r=!1,U1=!1,uT=typeof WeakSet=="function"?WeakSet:Set,dn=null;function O3(a,o){if(a=a.containerInfo,o_=pm,a=TE(a),Og(a)){if("selectionStart"in a)var u={start:a.selectionStart,end:a.selectionEnd};else e:{u=(u=a.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var g=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var b=0,L=-1,re=-1,me=0,be=0,Ce=a,_e=null;t:for(;;){for(var Ee;Ce!==u||g!==0&&Ce.nodeType!==3||(L=b+g),Ce!==v||h!==0&&Ce.nodeType!==3||(re=b+h),Ce.nodeType===3&&(b+=Ce.nodeValue.length),(Ee=Ce.firstChild)!==null;)_e=Ce,Ce=Ee;for(;;){if(Ce===a)break t;if(_e===u&&++me===g&&(L=b),_e===v&&++be===h&&(re=b),(Ee=Ce.nextSibling)!==null)break;Ce=_e,_e=Ce.parentNode}Ce=Ee}u=L===-1||re===-1?null:{start:L,end:re}}else u=null}u=u||{start:0,end:0}}else u=null;for(l_={focusedElem:a,selectionRange:u},pm=!1,dn=o;dn!==null;)if(o=dn,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,dn=a;else for(;dn!==null;){switch(o=dn,v=o.alternate,a=o.flags,o.tag){case 0:if((a&4)!==0&&(a=o.updateQueue,a=a!==null?a.events:null,a!==null))for(u=0;u<a.length;u++)g=a[u],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&v!==null){a=void 0,u=o,g=v.memoizedProps,v=v.memoizedState,h=u.stateNode;try{var Je=Fl(u.type,g);a=h.getSnapshotBeforeUpdate(Je,v),h.__reactInternalSnapshotBeforeUpdate=a}catch(ct){tr(u,u.return,ct)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,u=a.nodeType,u===9)f_(a);else if(u===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":f_(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=o.sibling,a!==null){a.return=o.return,dn=a;break}dn=o.return}}function fT(a,o,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:Is(a,u),h&4&&Zf(5,u);break;case 1:if(Is(a,u),h&4)if(a=u.stateNode,o===null)try{a.componentDidMount()}catch(b){tr(u,u.return,b)}else{var g=Fl(u.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(g,o,a.__reactInternalSnapshotBeforeUpdate)}catch(b){tr(u,u.return,b)}}h&64&&aT(u),h&512&&eh(u,u.return);break;case 3:if(Is(a,u),h&64&&(a=u.updateQueue,a!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{YE(a,o)}catch(b){tr(u,u.return,b)}}break;case 27:o===null&&h&4&&cT(u);case 26:case 5:Is(a,u),o===null&&h&4&&oT(u),h&512&&eh(u,u.return);break;case 12:Is(a,u);break;case 31:Is(a,u),h&4&&mT(a,u);break;case 13:Is(a,u),h&4&&pT(a,u),h&64&&(a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(u=j3.bind(null,u),lN(a,u))));break;case 22:if(h=u.memoizedState!==null||As,!h){o=o!==null&&o.memoizedState!==null||$r,g=As;var v=$r;As=h,($r=o)&&!v?ks(a,u,(u.subtreeFlags&8772)!==0):Is(a,u),As=g,$r=v}break;case 30:break;default:Is(a,u)}}function hT(a){var o=a.alternate;o!==null&&(a.alternate=null,hT(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&Me(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Sr=null,li=!1;function bs(a,o,u){for(u=u.child;u!==null;)dT(a,o,u),u=u.sibling}function dT(a,o,u){if(Kt&&typeof Kt.onCommitFiberUnmount=="function")try{Kt.onCommitFiberUnmount(Ot,u)}catch{}switch(u.tag){case 26:$r||Ha(u,o),bs(a,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:$r||Ha(u,o);var h=Sr,g=li;To(u.type)&&(Sr=u.stateNode,li=!1),bs(a,o,u),ch(u.stateNode),Sr=h,li=g;break;case 5:$r||Ha(u,o);case 6:if(h=Sr,g=li,Sr=null,bs(a,o,u),Sr=h,li=g,Sr!==null)if(li)try{(Sr.nodeType===9?Sr.body:Sr.nodeName==="HTML"?Sr.ownerDocument.body:Sr).removeChild(u.stateNode)}catch(v){tr(u,o,v)}else try{Sr.removeChild(u.stateNode)}catch(v){tr(u,o,v)}break;case 18:Sr!==null&&(li?(a=Sr,aw(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,u.stateNode),mu(a)):aw(Sr,u.stateNode));break;case 4:h=Sr,g=li,Sr=u.stateNode.containerInfo,li=!0,bs(a,o,u),Sr=h,li=g;break;case 0:case 11:case 14:case 15:po(2,u,o),$r||po(4,u,o),bs(a,o,u);break;case 1:$r||(Ha(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"&&sT(u,o,h)),bs(a,o,u);break;case 21:bs(a,o,u);break;case 22:$r=(h=$r)||u.memoizedState!==null,bs(a,o,u),$r=h;break;default:bs(a,o,u)}}function mT(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{mu(a)}catch(u){tr(o,o.return,u)}}}function pT(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{mu(a)}catch(u){tr(o,o.return,u)}}function F3(a){switch(a.tag){case 31:case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new uT),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new uT),o;default:throw Error(n(435,a.tag))}}function Yd(a,o){var u=F3(a);o.forEach(function(h){if(!u.has(h)){u.add(h);var g=H3.bind(null,a,h);h.then(g,g)}})}function ci(a,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var g=u[h],v=a,b=o,L=b;e:for(;L!==null;){switch(L.tag){case 27:if(To(L.type)){Sr=L.stateNode,li=!1;break e}break;case 5:Sr=L.stateNode,li=!1;break e;case 3:case 4:Sr=L.stateNode.containerInfo,li=!0;break e}L=L.return}if(Sr===null)throw Error(n(160));dT(v,b,g),Sr=null,li=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)gT(o,a),o=o.sibling}var Ea=null;function gT(a,o){var u=a.alternate,h=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ci(o,a),ui(a),h&4&&(po(3,a,a.return),Zf(3,a),po(5,a,a.return));break;case 1:ci(o,a),ui(a),h&512&&($r||u===null||Ha(u,u.return)),h&64&&As&&(a=a.updateQueue,a!==null&&(h=a.callbacks,h!==null&&(u=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var g=Ea;if(ci(o,a),ui(a),h&512&&($r||u===null||Ha(u,u.return)),h&4){var v=u!==null?u.memoizedState:null;if(h=a.memoizedState,u===null)if(h===null)if(a.stateNode===null){e:{h=a.type,u=a.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":v=g.getElementsByTagName("title")[0],(!v||v[pe]||v[H]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(h),g.head.insertBefore(v,g.querySelector("head > title"))),kn(v,h,u),v[H]=a,Ze(v),h=v;break e;case"link":var b=gw("link","href",g).get(h+(u.href||""));if(b){for(var L=0;L<b.length;L++)if(v=b[L],v.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&v.getAttribute("rel")===(u.rel==null?null:u.rel)&&v.getAttribute("title")===(u.title==null?null:u.title)&&v.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){b.splice(L,1);break t}}v=g.createElement(h),kn(v,h,u),g.head.appendChild(v);break;case"meta":if(b=gw("meta","content",g).get(h+(u.content||""))){for(L=0;L<b.length;L++)if(v=b[L],v.getAttribute("content")===(u.content==null?null:""+u.content)&&v.getAttribute("name")===(u.name==null?null:u.name)&&v.getAttribute("property")===(u.property==null?null:u.property)&&v.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&v.getAttribute("charset")===(u.charSet==null?null:u.charSet)){b.splice(L,1);break t}}v=g.createElement(h),kn(v,h,u),g.head.appendChild(v);break;default:throw Error(n(468,h))}v[H]=a,Ze(v),h=v}a.stateNode=h}else _w(g,a.type,a.stateNode);else a.stateNode=pw(g,h,a.memoizedProps);else v!==h?(v===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):v.count--,h===null?_w(g,a.type,a.stateNode):pw(g,h,a.memoizedProps)):h===null&&a.stateNode!==null&&L1(a,a.memoizedProps,u.memoizedProps)}break;case 27:ci(o,a),ui(a),h&512&&($r||u===null||Ha(u,u.return)),u!==null&&h&4&&L1(a,a.memoizedProps,u.memoizedProps);break;case 5:if(ci(o,a),ui(a),h&512&&($r||u===null||Ha(u,u.return)),a.flags&32){g=a.stateNode;try{oi(g,"")}catch(Je){tr(a,a.return,Je)}}h&4&&a.stateNode!=null&&(g=a.memoizedProps,L1(a,g,u!==null?u.memoizedProps:g)),h&1024&&(U1=!0);break;case 6:if(ci(o,a),ui(a),h&4){if(a.stateNode===null)throw Error(n(162));h=a.memoizedProps,u=a.stateNode;try{u.nodeValue=h}catch(Je){tr(a,a.return,Je)}}break;case 3:if(fm=null,g=Ea,Ea=cm(o.containerInfo),ci(o,a),Ea=g,ui(a),h&4&&u!==null&&u.memoizedState.isDehydrated)try{mu(o.containerInfo)}catch(Je){tr(a,a.return,Je)}U1&&(U1=!1,_T(a));break;case 4:h=Ea,Ea=cm(a.stateNode.containerInfo),ci(o,a),ui(a),Ea=h;break;case 12:ci(o,a),ui(a);break;case 31:ci(o,a),ui(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Yd(a,h)));break;case 13:ci(o,a),ui(a),a.child.flags&8192&&a.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Qd=qt()),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Yd(a,h)));break;case 22:g=a.memoizedState!==null;var re=u!==null&&u.memoizedState!==null,me=As,be=$r;if(As=me||g,$r=be||re,ci(o,a),$r=be,As=me,ui(a),h&8192)e:for(o=a.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(u===null||re||As||$r||Pl(a)),u=null,o=a;;){if(o.tag===5||o.tag===26){if(u===null){re=u=o;try{if(v=re.stateNode,g)b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{L=re.stateNode;var Ce=re.memoizedProps.style,_e=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;L.style.display=_e==null||typeof _e=="boolean"?"":(""+_e).trim()}}catch(Je){tr(re,re.return,Je)}}}else if(o.tag===6){if(u===null){re=o;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(Je){tr(re,re.return,Je)}}}else if(o.tag===18){if(u===null){re=o;try{var Ee=re.stateNode;g?sw(Ee,!0):sw(re.stateNode,!1)}catch(Je){tr(re,re.return,Je)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=a.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,Yd(a,u))));break;case 19:ci(o,a),ui(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Yd(a,h)));break;case 30:break;case 21:break;default:ci(o,a),ui(a)}}function ui(a){var o=a.flags;if(o&2){try{for(var u,h=a.return;h!==null;){if(lT(h)){u=h;break}h=h.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var g=u.stateNode,v=V1(a);Xd(a,v,g);break;case 5:var b=u.stateNode;u.flags&32&&(oi(b,""),u.flags&=-33);var L=V1(a);Xd(a,L,b);break;case 3:case 4:var re=u.stateNode.containerInfo,me=V1(a);B1(a,me,re);break;default:throw Error(n(161))}}catch(be){tr(a,a.return,be)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function _T(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;_T(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function Is(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)fT(a,o.alternate,o),o=o.sibling}function Pl(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:po(4,o,o.return),Pl(o);break;case 1:Ha(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&sT(o,o.return,u),Pl(o);break;case 27:ch(o.stateNode);case 26:case 5:Ha(o,o.return),Pl(o);break;case 22:o.memoizedState===null&&Pl(o);break;case 30:Pl(o);break;default:Pl(o)}a=a.sibling}}function ks(a,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,g=a,v=o,b=v.flags;switch(v.tag){case 0:case 11:case 15:ks(g,v,u),Zf(4,v);break;case 1:if(ks(g,v,u),h=v,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(me){tr(h,h.return,me)}if(h=v,g=h.updateQueue,g!==null){var L=h.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)XE(re[g],L)}catch(me){tr(h,h.return,me)}}u&&b&64&&aT(v),eh(v,v.return);break;case 27:cT(v);case 26:case 5:ks(g,v,u),u&&h===null&&b&4&&oT(v),eh(v,v.return);break;case 12:ks(g,v,u);break;case 31:ks(g,v,u),u&&b&4&&mT(g,v);break;case 13:ks(g,v,u),u&&b&4&&pT(g,v);break;case 22:v.memoizedState===null&&ks(g,v,u),eh(v,v.return);break;case 30:break;default:ks(g,v,u)}o=o.sibling}}function z1(a,o){var u=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==u&&(a!=null&&a.refCount++,u!=null&&Uf(u))}function j1(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Uf(a))}function Ta(a,o,u,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)vT(a,o,u,h),o=o.sibling}function vT(a,o,u,h){var g=o.flags;switch(o.tag){case 0:case 11:case 15:Ta(a,o,u,h),g&2048&&Zf(9,o);break;case 1:Ta(a,o,u,h);break;case 3:Ta(a,o,u,h),g&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Uf(a)));break;case 12:if(g&2048){Ta(a,o,u,h),a=o.stateNode;try{var v=o.memoizedProps,b=v.id,L=v.onPostCommit;typeof L=="function"&&L(b,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(re){tr(o,o.return,re)}}else Ta(a,o,u,h);break;case 31:Ta(a,o,u,h);break;case 13:Ta(a,o,u,h);break;case 23:break;case 22:v=o.stateNode,b=o.alternate,o.memoizedState!==null?v._visibility&2?Ta(a,o,u,h):th(a,o):v._visibility&2?Ta(a,o,u,h):(v._visibility|=2,nu(a,o,u,h,(o.subtreeFlags&10256)!==0||!1)),g&2048&&z1(b,o);break;case 24:Ta(a,o,u,h),g&2048&&j1(o.alternate,o);break;default:Ta(a,o,u,h)}}function nu(a,o,u,h,g){for(g=g&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var v=a,b=o,L=u,re=h,me=b.flags;switch(b.tag){case 0:case 11:case 15:nu(v,b,L,re,g),Zf(8,b);break;case 23:break;case 22:var be=b.stateNode;b.memoizedState!==null?be._visibility&2?nu(v,b,L,re,g):th(v,b):(be._visibility|=2,nu(v,b,L,re,g)),g&&me&2048&&z1(b.alternate,b);break;case 24:nu(v,b,L,re,g),g&&me&2048&&j1(b.alternate,b);break;default:nu(v,b,L,re,g)}o=o.sibling}}function th(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=a,h=o,g=h.flags;switch(h.tag){case 22:th(u,h),g&2048&&z1(h.alternate,h);break;case 24:th(u,h),g&2048&&j1(h.alternate,h);break;default:th(u,h)}o=o.sibling}}var rh=8192;function iu(a,o,u){if(a.subtreeFlags&rh)for(a=a.child;a!==null;)xT(a,o,u),a=a.sibling}function xT(a,o,u){switch(a.tag){case 26:iu(a,o,u),a.flags&rh&&a.memoizedState!==null&&yN(u,Ea,a.memoizedState,a.memoizedProps);break;case 5:iu(a,o,u);break;case 3:case 4:var h=Ea;Ea=cm(a.stateNode.containerInfo),iu(a,o,u),Ea=h;break;case 22:a.memoizedState===null&&(h=a.alternate,h!==null&&h.memoizedState!==null?(h=rh,rh=16777216,iu(a,o,u),rh=h):iu(a,o,u));break;default:iu(a,o,u)}}function yT(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function nh(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];dn=h,TT(h,a)}yT(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ET(a),a=a.sibling}function ET(a){switch(a.tag){case 0:case 11:case 15:nh(a),a.flags&2048&&po(9,a,a.return);break;case 3:nh(a);break;case 12:nh(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,$d(a)):nh(a);break;default:nh(a)}}function $d(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];dn=h,TT(h,a)}yT(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:po(8,o,o.return),$d(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,$d(o));break;default:$d(o)}a=a.sibling}}function TT(a,o){for(;dn!==null;){var u=dn;switch(u.tag){case 0:case 11:case 15:po(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Uf(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,dn=h;else e:for(u=a;dn!==null;){h=dn;var g=h.sibling,v=h.return;if(hT(h),h===u){dn=null;break e}if(g!==null){g.return=v,dn=g;break e}dn=v}}}var P3={getCacheForType:function(a){var o=bn(Wr),u=o.data.get(a);return u===void 0&&(u=a(),o.data.set(a,u)),u},cacheSignal:function(){return bn(Wr).controller.signal}},M3=typeof WeakMap=="function"?WeakMap:Map,Xt=0,mr=null,It=null,Ct=0,er=0,Ai=null,go=!1,au=!1,H1=!1,Cs=0,Or=0,_o=0,Ml=0,G1=0,bi=0,su=0,ih=null,fi=null,q1=!1,Qd=0,wT=0,Jd=1/0,Zd=null,vo=null,on=0,xo=null,ou=null,Rs=0,K1=0,W1=null,ST=null,ah=0,X1=null;function Ii(){return(Xt&2)!==0&&Ct!==0?Ct&-Ct:ne.T!==null?e_():F()}function AT(){if(bi===0)if((Ct&536870912)===0||Ft){var a=Tn;Tn<<=1,(Tn&3932160)===0&&(Tn=262144),bi=a}else bi=536870912;return a=wi.current,a!==null&&(a.flags|=32),bi}function hi(a,o,u){(a===mr&&(er===2||er===9)||a.cancelPendingCommit!==null)&&(lu(a,0),yo(a,Ct,bi,!1)),us(a,u),((Xt&2)===0||a!==mr)&&(a===mr&&((Xt&2)===0&&(Ml|=u),Or===4&&yo(a,Ct,bi,!1)),Ga(a))}function bT(a,o,u){if((Xt&6)!==0)throw Error(n(327));var h=!u&&(o&127)===0&&(o&a.expiredLanes)===0||vi(a,o),g=h?B3(a,o):$1(a,o,!0),v=h;do{if(g===0){au&&!h&&yo(a,o,0,!1);break}else{if(u=a.current.alternate,v&&!L3(u)){g=$1(a,o,!1),v=!1;continue}if(g===2){if(v=o,a.errorRecoveryDisabledLanes&v)var b=0;else b=a.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){o=b;e:{var L=a;g=ih;var re=L.current.memoizedState.isDehydrated;if(re&&(lu(L,b).flags|=256),b=$1(L,b,!1),b!==2){if(H1&&!re){L.errorRecoveryDisabledLanes|=v,Ml|=v,g=4;break e}v=fi,fi=g,v!==null&&(fi===null?fi=v:fi.push.apply(fi,v))}g=b}if(v=!1,g!==2)continue}}if(g===1){lu(a,0),yo(a,o,0,!0);break}e:{switch(h=a,v=g,v){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:yo(h,o,bi,!go);break e;case 2:fi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(g=Qd+300-qt(),10<g)){if(yo(h,o,bi,!go),Ui(h,0,!0)!==0)break e;Rs=o,h.timeoutHandle=nw(IT.bind(null,h,u,fi,Zd,q1,o,bi,Ml,su,go,v,"Throttled",-0,0),g);break e}IT(h,u,fi,Zd,q1,o,bi,Ml,su,go,v,null,-0,0)}}break}while(!0);Ga(a)}function IT(a,o,u,h,g,v,b,L,re,me,be,Ce,_e,Ee){if(a.timeoutHandle=-1,Ce=o.subtreeFlags,Ce&8192||(Ce&16785408)===16785408){Ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pa},xT(o,v,Ce);var Je=(v&62914560)===v?Qd-qt():(v&4194048)===v?wT-qt():0;if(Je=EN(Ce,Je),Je!==null){Rs=v,a.cancelPendingCommit=Je(PT.bind(null,a,o,v,u,h,g,b,L,re,be,Ce,null,_e,Ee)),yo(a,v,b,!me);return}}PT(a,o,v,u,h,g,b,L,re)}function L3(a){for(var o=a;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var g=u[h],v=g.getSnapshot;g=g.value;try{if(!Ei(v(),g))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function yo(a,o,u,h){o&=~G1,o&=~Ml,a.suspendedLanes|=o,a.pingedLanes&=~o,h&&(a.warmLanes|=o),h=a.expirationTimes;for(var g=o;0<g;){var v=31-Yt(g),b=1<<v;h[v]=-1,g&=~b}u!==0&&fs(a,u,o)}function em(){return(Xt&6)===0?(sh(0),!1):!0}function Y1(){if(It!==null){if(er===0)var a=It.return;else a=It,xs=Il=null,f1(a),Jc=null,jf=0,a=It;for(;a!==null;)iT(a.alternate,a),a=a.return;It=null}}function lu(a,o){var u=a.timeoutHandle;u!==-1&&(a.timeoutHandle=-1,nN(u)),u=a.cancelPendingCommit,u!==null&&(a.cancelPendingCommit=null,u()),Rs=0,Y1(),mr=a,It=u=_s(a.current,null),Ct=o,er=0,Ai=null,go=!1,au=vi(a,o),H1=!1,su=bi=G1=Ml=_o=Or=0,fi=ih=null,q1=!1,(o&8)!==0&&(o|=o&32);var h=a.entangledLanes;if(h!==0)for(a=a.entanglements,h&=o;0<h;){var g=31-Yt(h),v=1<<g;o|=a[g],h&=~v}return Cs=o,Ed(),u}function kT(a,o){vt=null,ne.H=$f,o===Qc||o===Cd?(o=GE(),er=3):o===Zg?(o=GE(),er=4):er=o===I1?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ai=o,It===null&&(Or=1,Hd(a,Ki(o,a.current)))}function CT(){var a=wi.current;return a===null?!0:(Ct&4194048)===Ct?$i===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?a===$i:!1}function RT(){var a=ne.H;return ne.H=$f,a===null?$f:a}function DT(){var a=ne.A;return ne.A=P3,a}function tm(){Or=4,go||(Ct&4194048)!==Ct&&wi.current!==null||(au=!0),(_o&134217727)===0&&(Ml&134217727)===0||mr===null||yo(mr,Ct,bi,!1)}function $1(a,o,u){var h=Xt;Xt|=2;var g=RT(),v=DT();(mr!==a||Ct!==o)&&(Zd=null,lu(a,o)),o=!1;var b=Or;e:do try{if(er!==0&&It!==null){var L=It,re=Ai;switch(er){case 8:Y1(),b=6;break e;case 3:case 2:case 9:case 6:wi.current===null&&(o=!0);var me=er;if(er=0,Ai=null,cu(a,L,re,me),u&&au){b=0;break e}break;default:me=er,er=0,Ai=null,cu(a,L,re,me)}}V3(),b=Or;break}catch(be){kT(a,be)}while(!0);return o&&a.shellSuspendCounter++,xs=Il=null,Xt=h,ne.H=g,ne.A=v,It===null&&(mr=null,Ct=0,Ed()),b}function V3(){for(;It!==null;)NT(It)}function B3(a,o){var u=Xt;Xt|=2;var h=RT(),g=DT();mr!==a||Ct!==o?(Zd=null,Jd=qt()+500,lu(a,o)):au=vi(a,o);e:do try{if(er!==0&&It!==null){o=It;var v=Ai;t:switch(er){case 1:er=0,Ai=null,cu(a,o,v,1);break;case 2:case 9:if(jE(v)){er=0,Ai=null,OT(o);break}o=function(){er!==2&&er!==9||mr!==a||(er=7),Ga(a)},v.then(o,o);break e;case 3:er=7;break e;case 4:er=5;break e;case 7:jE(v)?(er=0,Ai=null,OT(o)):(er=0,Ai=null,cu(a,o,v,7));break;case 5:var b=null;switch(It.tag){case 26:b=It.memoizedState;case 5:case 27:var L=It;if(b?vw(b):L.stateNode.complete){er=0,Ai=null;var re=L.sibling;if(re!==null)It=re;else{var me=L.return;me!==null?(It=me,rm(me)):It=null}break t}}er=0,Ai=null,cu(a,o,v,5);break;case 6:er=0,Ai=null,cu(a,o,v,6);break;case 8:Y1(),Or=6;break e;default:throw Error(n(462))}}U3();break}catch(be){kT(a,be)}while(!0);return xs=Il=null,ne.H=h,ne.A=g,Xt=u,It!==null?0:(mr=null,Ct=0,Ed(),Or)}function U3(){for(;It!==null&&!fa();)NT(It)}function NT(a){var o=rT(a.alternate,a,Cs);a.memoizedProps=a.pendingProps,o===null?rm(a):It=o}function OT(a){var o=a,u=o.alternate;switch(o.tag){case 15:case 0:o=$2(u,o,o.pendingProps,o.type,void 0,Ct);break;case 11:o=$2(u,o,o.pendingProps,o.type.render,o.ref,Ct);break;case 5:f1(o);default:iT(u,o),o=It=DE(o,Cs),o=rT(u,o,Cs)}a.memoizedProps=a.pendingProps,o===null?rm(a):It=o}function cu(a,o,u,h){xs=Il=null,f1(o),Jc=null,jf=0;var g=o.return;try{if(k3(a,g,o,u,Ct)){Or=1,Hd(a,Ki(u,a.current)),It=null;return}}catch(v){if(g!==null)throw It=g,v;Or=1,Hd(a,Ki(u,a.current)),It=null;return}o.flags&32768?(Ft||h===1?a=!0:au||(Ct&536870912)!==0?a=!1:(go=a=!0,(h===2||h===9||h===3||h===6)&&(h=wi.current,h!==null&&h.tag===13&&(h.flags|=16384))),FT(o,a)):rm(o)}function rm(a){var o=a;do{if((o.flags&32768)!==0){FT(o,go);return}a=o.return;var u=D3(o.alternate,o,Cs);if(u!==null){It=u;return}if(o=o.sibling,o!==null){It=o;return}It=o=a}while(o!==null);Or===0&&(Or=5)}function FT(a,o){do{var u=N3(a.alternate,a);if(u!==null){u.flags&=32767,It=u;return}if(u=a.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(a=a.sibling,a!==null)){It=a;return}It=a=u}while(a!==null);Or=6,It=null}function PT(a,o,u,h,g,v,b,L,re){a.cancelPendingCommit=null;do nm();while(on!==0);if((Xt&6)!==0)throw Error(n(327));if(o!==null){if(o===a.current)throw Error(n(177));if(v=o.lanes|o.childLanes,v|=Vg,wf(a,u,v,b,L,re),a===mr&&(It=mr=null,Ct=0),ou=o,xo=a,Rs=u,K1=v,W1=g,ST=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,G3(gr,function(){return UT(),null})):(a.callbackNode=null,a.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=ne.T,ne.T=null,g=le.p,le.p=2,b=Xt,Xt|=4;try{O3(a,o,u)}finally{Xt=b,le.p=g,ne.T=h}}on=1,MT(),LT(),VT()}}function MT(){if(on===1){on=0;var a=xo,o=ou,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=ne.T,ne.T=null;var h=le.p;le.p=2;var g=Xt;Xt|=4;try{gT(o,a);var v=l_,b=TE(a.containerInfo),L=v.focusedElem,re=v.selectionRange;if(b!==L&&L&&L.ownerDocument&&EE(L.ownerDocument.documentElement,L)){if(re!==null&&Og(L)){var me=re.start,be=re.end;if(be===void 0&&(be=me),"selectionStart"in L)L.selectionStart=me,L.selectionEnd=Math.min(be,L.value.length);else{var Ce=L.ownerDocument||document,_e=Ce&&Ce.defaultView||window;if(_e.getSelection){var Ee=_e.getSelection(),Je=L.textContent.length,ct=Math.min(re.start,Je),ur=re.end===void 0?ct:Math.min(re.end,Je);!Ee.extend&&ct>ur&&(b=ur,ur=ct,ct=b);var se=yE(L,ct),ie=yE(L,ur);if(se&&ie&&(Ee.rangeCount!==1||Ee.anchorNode!==se.node||Ee.anchorOffset!==se.offset||Ee.focusNode!==ie.node||Ee.focusOffset!==ie.offset)){var fe=Ce.createRange();fe.setStart(se.node,se.offset),Ee.removeAllRanges(),ct>ur?(Ee.addRange(fe),Ee.extend(ie.node,ie.offset)):(fe.setEnd(ie.node,ie.offset),Ee.addRange(fe))}}}}for(Ce=[],Ee=L;Ee=Ee.parentNode;)Ee.nodeType===1&&Ce.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<Ce.length;L++){var ke=Ce[L];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}pm=!!o_,l_=o_=null}finally{Xt=g,le.p=h,ne.T=u}}a.current=o,on=2}}function LT(){if(on===2){on=0;var a=xo,o=ou,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=ne.T,ne.T=null;var h=le.p;le.p=2;var g=Xt;Xt|=4;try{fT(a,o.alternate,o)}finally{Xt=g,le.p=h,ne.T=u}}on=3}}function VT(){if(on===4||on===3){on=0,Qn();var a=xo,o=ou,u=Rs,h=ST;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?on=5:(on=0,ou=xo=null,BT(a,a.pendingLanes));var g=a.pendingLanes;if(g===0&&(vo=null),ha(u),o=o.stateNode,Kt&&typeof Kt.onCommitFiberRoot=="function")try{Kt.onCommitFiberRoot(Ot,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=ne.T,g=le.p,le.p=2,ne.T=null;try{for(var v=a.onRecoverableError,b=0;b<h.length;b++){var L=h[b];v(L.value,{componentStack:L.stack})}}finally{ne.T=o,le.p=g}}(Rs&3)!==0&&nm(),Ga(a),g=a.pendingLanes,(u&261930)!==0&&(g&42)!==0?a===X1?ah++:(ah=0,X1=a):ah=0,sh(0)}}function BT(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Uf(o)))}function nm(){return MT(),LT(),VT(),UT()}function UT(){if(on!==5)return!1;var a=xo,o=K1;K1=0;var u=ha(Rs),h=ne.T,g=le.p;try{le.p=32>u?32:u,ne.T=null,u=W1,W1=null;var v=xo,b=Rs;if(on=0,ou=xo=null,Rs=0,(Xt&6)!==0)throw Error(n(331));var L=Xt;if(Xt|=4,ET(v.current),vT(v,v.current,b,u),Xt=L,sh(0,!1),Kt&&typeof Kt.onPostCommitFiberRoot=="function")try{Kt.onPostCommitFiberRoot(Ot,v)}catch{}return!0}finally{le.p=g,ne.T=h,BT(a,o)}}function zT(a,o,u){o=Ki(u,o),o=b1(a.stateNode,o,2),a=fo(a,o,2),a!==null&&(us(a,2),Ga(a))}function tr(a,o,u){if(a.tag===3)zT(a,a,u);else for(;o!==null;){if(o.tag===3){zT(o,a,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(vo===null||!vo.has(h))){a=Ki(u,a),u=j2(2),h=fo(o,u,2),h!==null&&(H2(u,h,o,a),us(h,2),Ga(h));break}}o=o.return}}function Q1(a,o,u){var h=a.pingCache;if(h===null){h=a.pingCache=new M3;var g=new Set;h.set(o,g)}else g=h.get(o),g===void 0&&(g=new Set,h.set(o,g));g.has(u)||(H1=!0,g.add(u),a=z3.bind(null,a,o,u),o.then(a,a))}function z3(a,o,u){var h=a.pingCache;h!==null&&h.delete(o),a.pingedLanes|=a.suspendedLanes&u,a.warmLanes&=~u,mr===a&&(Ct&u)===u&&(Or===4||Or===3&&(Ct&62914560)===Ct&&300>qt()-Qd?(Xt&2)===0&&lu(a,0):G1|=u,su===Ct&&(su=0)),Ga(a)}function jT(a,o){o===0&&(o=Dc()),a=Sl(a,o),a!==null&&(us(a,o),Ga(a))}function j3(a){var o=a.memoizedState,u=0;o!==null&&(u=o.retryLane),jT(a,u)}function H3(a,o){var u=0;switch(a.tag){case 31:case 13:var h=a.stateNode,g=a.memoizedState;g!==null&&(u=g.retryLane);break;case 19:h=a.stateNode;break;case 22:h=a.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(o),jT(a,u)}function G3(a,o){return Mt(a,o)}var im=null,uu=null,J1=!1,am=!1,Z1=!1,Eo=0;function Ga(a){a!==uu&&a.next===null&&(uu===null?im=uu=a:uu=uu.next=a),am=!0,J1||(J1=!0,K3())}function sh(a,o){if(!Z1&&am){Z1=!0;do for(var u=!1,h=im;h!==null;){if(a!==0){var g=h.pendingLanes;if(g===0)var v=0;else{var b=h.suspendedLanes,L=h.pingedLanes;v=(1<<31-Yt(42|a)+1)-1,v&=g&~(b&~L),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(u=!0,KT(h,v))}else v=Ct,v=Ui(h,h===mr?v:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(v&3)===0||vi(h,v)||(u=!0,KT(h,v));h=h.next}while(u);Z1=!1}}function q3(){HT()}function HT(){am=J1=!1;var a=0;Eo!==0&&rN()&&(a=Eo);for(var o=qt(),u=null,h=im;h!==null;){var g=h.next,v=GT(h,o);v===0?(h.next=null,u===null?im=g:u.next=g,g===null&&(uu=u)):(u=h,(a!==0||(v&3)!==0)&&(am=!0)),h=g}on!==0&&on!==5||sh(a),Eo!==0&&(Eo=0)}function GT(a,o){for(var u=a.suspendedLanes,h=a.pingedLanes,g=a.expirationTimes,v=a.pendingLanes&-62914561;0<v;){var b=31-Yt(v),L=1<<b,re=g[b];re===-1?((L&u)===0||(L&h)!==0)&&(g[b]=Tf(L,o)):re<=o&&(a.expiredLanes|=L),v&=~L}if(o=mr,u=Ct,u=Ui(a,a===o?u:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h=a.callbackNode,u===0||a===o&&(er===2||er===9)||a.cancelPendingCommit!==null)return h!==null&&h!==null&&qr(h),a.callbackNode=null,a.callbackPriority=0;if((u&3)===0||vi(a,u)){if(o=u&-u,o===a.callbackPriority)return o;switch(h!==null&&qr(h),ha(u)){case 2:case 8:u=_i;break;case 32:u=gr;break;case 268435456:u=Ye;break;default:u=gr}return h=qT.bind(null,a),u=Mt(u,h),a.callbackPriority=o,a.callbackNode=u,o}return h!==null&&h!==null&&qr(h),a.callbackPriority=2,a.callbackNode=null,2}function qT(a,o){if(on!==0&&on!==5)return a.callbackNode=null,a.callbackPriority=0,null;var u=a.callbackNode;if(nm()&&a.callbackNode!==u)return null;var h=Ct;return h=Ui(a,a===mr?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h===0?null:(bT(a,h,o),GT(a,qt()),a.callbackNode!=null&&a.callbackNode===u?qT.bind(null,a):null)}function KT(a,o){if(nm())return null;bT(a,o,!0)}function K3(){iN(function(){(Xt&6)!==0?Mt(Pn,q3):HT()})}function e_(){if(Eo===0){var a=Yc;a===0&&(a=Jn,Jn<<=1,(Jn&261888)===0&&(Jn=256)),Eo=a}return Eo}function WT(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Fc(""+a)}function XT(a,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,a.id&&u.setAttribute("form",a.id),o.parentNode.insertBefore(u,o),a=new FormData(a),u.parentNode.removeChild(u),a}function W3(a,o,u,h,g){if(o==="submit"&&u&&u.stateNode===g){var v=WT((g[G]||null).action),b=h.submitter;b&&(o=(o=b[G]||null)?WT(o.formAction):b.getAttribute("formAction"),o!==null&&(v=o,b=null));var L=new La("action","action",null,h,g);a.push({event:L,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Eo!==0){var re=b?XT(g,b):new FormData(g);y1(u,{pending:!0,data:re,method:g.method,action:v},null,re)}}else typeof v=="function"&&(L.preventDefault(),re=b?XT(g,b):new FormData(g),y1(u,{pending:!0,data:re,method:g.method,action:v},v,re))},currentTarget:g}]})}}for(var t_=0;t_<Lg.length;t_++){var r_=Lg[t_],X3=r_.toLowerCase(),Y3=r_[0].toUpperCase()+r_.slice(1);ya(X3,"on"+Y3)}ya(AE,"onAnimationEnd"),ya(bE,"onAnimationIteration"),ya(IE,"onAnimationStart"),ya("dblclick","onDoubleClick"),ya("focusin","onFocus"),ya("focusout","onBlur"),ya(f3,"onTransitionRun"),ya(h3,"onTransitionStart"),ya(d3,"onTransitionCancel"),ya(kE,"onTransitionEnd"),Mn("onMouseEnter",["mouseout","mouseover"]),Mn("onMouseLeave",["mouseout","mouseover"]),Mn("onPointerEnter",["pointerout","pointerover"]),Mn("onPointerLeave",["pointerout","pointerover"]),dr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),dr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),dr("onBeforeInput",["compositionend","keypress","textInput","paste"]),dr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),dr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),dr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(oh));function YT(a,o){o=(o&4)!==0;for(var u=0;u<a.length;u++){var h=a[u],g=h.event;h=h.listeners;e:{var v=void 0;if(o)for(var b=h.length-1;0<=b;b--){var L=h[b],re=L.instance,me=L.currentTarget;if(L=L.listener,re!==v&&g.isPropagationStopped())break e;v=L,g.currentTarget=me;try{v(g)}catch(be){yd(be)}g.currentTarget=null,v=re}else for(b=0;b<h.length;b++){if(L=h[b],re=L.instance,me=L.currentTarget,L=L.listener,re!==v&&g.isPropagationStopped())break e;v=L,g.currentTarget=me;try{v(g)}catch(be){yd(be)}g.currentTarget=null,v=re}}}}function kt(a,o){var u=o[he];u===void 0&&(u=o[he]=new Set);var h=a+"__bubble";u.has(h)||($T(o,a,2,!1),u.add(h))}function n_(a,o,u){var h=0;o&&(h|=4),$T(u,a,h,o)}var sm="_reactListening"+Math.random().toString(36).slice(2);function i_(a){if(!a[sm]){a[sm]=!0,Qt.forEach(function(u){u!=="selectionchange"&&($3.has(u)||n_(u,!1,a),n_(u,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[sm]||(o[sm]=!0,n_("selectionchange",!1,o))}}function $T(a,o,u,h){switch(Aw(o)){case 2:var g=SN;break;case 8:g=AN;break;default:g=x_}u=g.bind(null,o,u,a),g=void 0,!gl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),h?g!==void 0?a.addEventListener(o,u,{capture:!0,passive:g}):a.addEventListener(o,u,!0):g!==void 0?a.addEventListener(o,u,{passive:g}):a.addEventListener(o,u,!1)}function a_(a,o,u,h,g){var v=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var L=h.stateNode.containerInfo;if(L===g)break;if(b===4)for(b=h.return;b!==null;){var re=b.tag;if((re===3||re===4)&&b.stateNode.containerInfo===g)return;b=b.return}for(;L!==null;){if(b=Be(L),b===null)return;if(re=b.tag,re===5||re===6||re===26||re===27){h=v=b;continue e}L=L.parentNode}}h=h.return}to(function(){var me=v,be=ji(u),Ce=[];e:{var _e=CE.get(a);if(_e!==void 0){var Ee=La,Je=a;switch(a){case"keypress":if(vl(u)===0)break e;case"keydown":case"keyup":Ee=_d;break;case"focusin":Je="focus",Ee=yl;break;case"focusout":Je="blur",Ee=yl;break;case"beforeblur":case"afterblur":Ee=yl;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Nf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=ld;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=w;break;case AE:case bE:case IE:Ee=ud;break;case kE:Ee=j;break;case"scroll":case"scrollend":Ee=Df;break;case"wheel":Ee=ye;break;case"copy":case"cut":case"paste":Ee=fd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=gs;break;case"toggle":case"beforetoggle":Ee=_t}var ct=(o&4)!==0,ur=!ct&&(a==="scroll"||a==="scrollend"),se=ct?_e!==null?_e+"Capture":null:_e;ct=[];for(var ie=me,fe;ie!==null;){var ke=ie;if(fe=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||fe===null||se===null||(ke=ga(ie,se),ke!=null&&ct.push(lh(ie,ke,fe))),ur)break;ie=ie.return}0<ct.length&&(_e=new Ee(_e,Je,null,u,be),Ce.push({event:_e,listeners:ct}))}}if((o&7)===0){e:{if(_e=a==="mouseover"||a==="pointerover",Ee=a==="mouseout"||a==="pointerout",_e&&u!==kf&&(Je=u.relatedTarget||u.fromElement)&&(Be(Je)||Je[Y]))break e;if((Ee||_e)&&(_e=be.window===be?be:(_e=be.ownerDocument)?_e.defaultView||_e.parentWindow:window,Ee?(Je=u.relatedTarget||u.toElement,Ee=me,Je=Je?Be(Je):null,Je!==null&&(ur=s(Je),ct=Je.tag,Je!==ur||ct!==5&&ct!==27&&ct!==6)&&(Je=null)):(Ee=null,Je=me),Ee!==Je)){if(ct=Nf,ke="onMouseLeave",se="onMouseEnter",ie="mouse",(a==="pointerout"||a==="pointerover")&&(ct=gs,ke="onPointerLeave",se="onPointerEnter",ie="pointer"),ur=Ee==null?_e:Fe(Ee),fe=Je==null?_e:Fe(Je),_e=new ct(ke,ie+"leave",Ee,u,be),_e.target=ur,_e.relatedTarget=fe,ke=null,Be(be)===me&&(ct=new ct(se,ie+"enter",Je,u,be),ct.target=fe,ct.relatedTarget=ur,ke=ct),ur=ke,Ee&&Je)t:{for(ct=Q3,se=Ee,ie=Je,fe=0,ke=se;ke;ke=ct(ke))fe++;ke=0;for(var at=ie;at;at=ct(at))ke++;for(;0<fe-ke;)se=ct(se),fe--;for(;0<ke-fe;)ie=ct(ie),ke--;for(;fe--;){if(se===ie||ie!==null&&se===ie.alternate){ct=se;break t}se=ct(se),ie=ct(ie)}ct=null}else ct=null;Ee!==null&&QT(Ce,_e,Ee,ct,!1),Je!==null&&ur!==null&&QT(Ce,ur,Je,ct,!0)}}e:{if(_e=me?Fe(me):window,Ee=_e.nodeName&&_e.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&_e.type==="file")var zt=mE;else if(hE(_e))if(pE)zt=l3;else{zt=s3;var tt=a3}else Ee=_e.nodeName,!Ee||Ee.toLowerCase()!=="input"||_e.type!=="checkbox"&&_e.type!=="radio"?me&&Oc(me.elementType)&&(zt=mE):zt=o3;if(zt&&(zt=zt(a,me))){dE(Ce,zt,u,be);break e}tt&&tt(a,_e,me),a==="focusout"&&me&&_e.type==="number"&&me.memoizedProps.value!=null&&Af(_e,"number",_e.value)}switch(tt=me?Fe(me):window,a){case"focusin":(hE(tt)||tt.contentEditable==="true")&&(zc=tt,Fg=me,Lf=null);break;case"focusout":Lf=Fg=zc=null;break;case"mousedown":Pg=!0;break;case"contextmenu":case"mouseup":case"dragend":Pg=!1,wE(Ce,u,be);break;case"selectionchange":if(u3)break;case"keydown":case"keyup":wE(Ce,u,be)}var yt;if(Wt)e:{switch(a){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else Uc?El(a,u)&&(Rt="onCompositionEnd"):a==="keydown"&&u.keyCode===229&&(Rt="onCompositionStart");Rt&&(Ua&&u.locale!=="ko"&&(Uc||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&Uc&&(yt=Rf()):(Ma=be,Cf="value"in Ma?Ma.value:Ma.textContent,Uc=!0)),tt=om(me,Rt),0<tt.length&&(Rt=new Ba(Rt,a,null,u,be),Ce.push({event:Rt,listeners:tt}),yt?Rt.data=yt:(yt=Bc(u),yt!==null&&(Rt.data=yt)))),(yt=Gi?t3(a,u):r3(a,u))&&(Rt=om(me,"onBeforeInput"),0<Rt.length&&(tt=new Ba("onBeforeInput","beforeinput",null,u,be),Ce.push({event:tt,listeners:Rt}),tt.data=yt)),W3(Ce,a,me,u,be)}YT(Ce,o)})}function lh(a,o,u){return{instance:a,listener:o,currentTarget:u}}function om(a,o){for(var u=o+"Capture",h=[];a!==null;){var g=a,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=ga(a,u),g!=null&&h.unshift(lh(a,g,v)),g=ga(a,o),g!=null&&h.push(lh(a,g,v))),a.tag===3)return h;a=a.return}return[]}function Q3(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function QT(a,o,u,h,g){for(var v=o._reactName,b=[];u!==null&&u!==h;){var L=u,re=L.alternate,me=L.stateNode;if(L=L.tag,re!==null&&re===h)break;L!==5&&L!==26&&L!==27||me===null||(re=me,g?(me=ga(u,v),me!=null&&b.unshift(lh(u,me,re))):g||(me=ga(u,v),me!=null&&b.push(lh(u,me,re)))),u=u.return}b.length!==0&&a.push({event:o,listeners:b})}var J3=/\r\n?/g,Z3=/\u0000|\uFFFD/g;function JT(a){return(typeof a=="string"?a:""+a).replace(J3,`
`).replace(Z3,"")}function ZT(a,o){return o=JT(o),JT(a)===o}function cr(a,o,u,h,g,v){switch(u){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||oi(a,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&oi(a,""+h);break;case"className":yi(a,"class",h);break;case"tabIndex":yi(a,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":yi(a,u,h);break;case"style":If(a,h,v);break;case"data":if(o!=="object"){yi(a,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||u!=="href")){a.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(u);break}h=Fc(""+h),a.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){a.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(u==="formAction"?(o!=="input"&&cr(a,o,"name",g.name,g,null),cr(a,o,"formEncType",g.formEncType,g,null),cr(a,o,"formMethod",g.formMethod,g,null),cr(a,o,"formTarget",g.formTarget,g,null)):(cr(a,o,"encType",g.encType,g,null),cr(a,o,"method",g.method,g,null),cr(a,o,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(u);break}h=Fc(""+h),a.setAttribute(u,h);break;case"onClick":h!=null&&(a.onclick=pa);break;case"onScroll":h!=null&&kt("scroll",a);break;case"onScrollEnd":h!=null&&kt("scrollend",a);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(n(60));a.innerHTML=u}}break;case"multiple":a.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":a.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){a.removeAttribute("xlink:href");break}u=Fc(""+h),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(u,""+h):a.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(u,""):a.removeAttribute(u);break;case"capture":case"download":h===!0?a.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(u,h):a.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?a.setAttribute(u,h):a.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?a.removeAttribute(u):a.setAttribute(u,h);break;case"popover":kt("beforetoggle",a),kt("toggle",a),Ln(a,"popover",h);break;case"xlinkActuate":Kr(a,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Kr(a,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Kr(a,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Kr(a,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Kr(a,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Kr(a,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Kr(a,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Kr(a,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Kr(a,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Ln(a,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=od.get(u)||u,Ln(a,u,h))}}function s_(a,o,u,h,g,v){switch(u){case"style":If(a,h,v);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(n(60));a.innerHTML=u}}break;case"children":typeof h=="string"?oi(a,h):(typeof h=="number"||typeof h=="bigint")&&oi(a,""+h);break;case"onScroll":h!=null&&kt("scroll",a);break;case"onScrollEnd":h!=null&&kt("scrollend",a);break;case"onClick":h!=null&&(a.onclick=pa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Jt.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),o=u.slice(2,g?u.length-7:void 0),v=a[G]||null,v=v!=null?v[u]:null,typeof v=="function"&&a.removeEventListener(o,v,g),typeof h=="function")){typeof v!="function"&&v!==null&&(u in a?a[u]=null:a.hasAttribute(u)&&a.removeAttribute(u)),a.addEventListener(o,h,g);break e}u in a?a[u]=h:h===!0?a.setAttribute(u,""):Ln(a,u,h)}}}function kn(a,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",a),kt("load",a);var h=!1,g=!1,v;for(v in u)if(u.hasOwnProperty(v)){var b=u[v];if(b!=null)switch(v){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:cr(a,o,v,b,u,null)}}g&&cr(a,o,"srcSet",u.srcSet,u,null),h&&cr(a,o,"src",u.src,u,null);return;case"input":kt("invalid",a);var L=v=b=g=null,re=null,me=null;for(h in u)if(u.hasOwnProperty(h)){var be=u[h];if(be!=null)switch(h){case"name":g=be;break;case"type":b=be;break;case"checked":re=be;break;case"defaultChecked":me=be;break;case"value":v=be;break;case"defaultValue":L=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(n(137,o));break;default:cr(a,o,h,be,u,null)}}id(a,v,L,re,me,b,g,!1);return;case"select":kt("invalid",a),h=b=v=null;for(g in u)if(u.hasOwnProperty(g)&&(L=u[g],L!=null))switch(g){case"value":v=L;break;case"defaultValue":b=L;break;case"multiple":h=L;default:cr(a,o,g,L,u,null)}o=v,u=b,a.multiple=!!h,o!=null?Qs(a,!!h,o,!1):u!=null&&Qs(a,!!h,u,!0);return;case"textarea":kt("invalid",a),v=g=h=null;for(b in u)if(u.hasOwnProperty(b)&&(L=u[b],L!=null))switch(b){case"value":h=L;break;case"defaultValue":g=L;break;case"children":v=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(n(91));break;default:cr(a,o,b,L,u,null)}Js(a,h,g,v);return;case"option":for(re in u)if(u.hasOwnProperty(re)&&(h=u[re],h!=null))switch(re){case"selected":a.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:cr(a,o,re,h,u,null)}return;case"dialog":kt("beforetoggle",a),kt("toggle",a),kt("cancel",a),kt("close",a);break;case"iframe":case"object":kt("load",a);break;case"video":case"audio":for(h=0;h<oh.length;h++)kt(oh[h],a);break;case"image":kt("error",a),kt("load",a);break;case"details":kt("toggle",a);break;case"embed":case"source":case"link":kt("error",a),kt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in u)if(u.hasOwnProperty(me)&&(h=u[me],h!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:cr(a,o,me,h,u,null)}return;default:if(Oc(o)){for(be in u)u.hasOwnProperty(be)&&(h=u[be],h!==void 0&&s_(a,o,be,h,u,void 0));return}}for(L in u)u.hasOwnProperty(L)&&(h=u[L],h!=null&&cr(a,o,L,h,u,null))}function eN(a,o,u,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,b=null,L=null,re=null,me=null,be=null;for(Ee in u){var Ce=u[Ee];if(u.hasOwnProperty(Ee)&&Ce!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":re=Ce;default:h.hasOwnProperty(Ee)||cr(a,o,Ee,null,h,Ce)}}for(var _e in h){var Ee=h[_e];if(Ce=u[_e],h.hasOwnProperty(_e)&&(Ee!=null||Ce!=null))switch(_e){case"type":v=Ee;break;case"name":g=Ee;break;case"checked":me=Ee;break;case"defaultChecked":be=Ee;break;case"value":b=Ee;break;case"defaultValue":L=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,o));break;default:Ee!==Ce&&cr(a,o,_e,Ee,h,Ce)}}Nc(a,b,L,re,me,be,v,g);return;case"select":Ee=b=L=_e=null;for(v in u)if(re=u[v],u.hasOwnProperty(v)&&re!=null)switch(v){case"value":break;case"multiple":Ee=re;default:h.hasOwnProperty(v)||cr(a,o,v,null,h,re)}for(g in h)if(v=h[g],re=u[g],h.hasOwnProperty(g)&&(v!=null||re!=null))switch(g){case"value":_e=v;break;case"defaultValue":L=v;break;case"multiple":b=v;default:v!==re&&cr(a,o,g,v,h,re)}o=L,u=b,h=Ee,_e!=null?Qs(a,!!u,_e,!1):!!h!=!!u&&(o!=null?Qs(a,!!u,o,!0):Qs(a,!!u,u?[]:"",!1));return;case"textarea":Ee=_e=null;for(L in u)if(g=u[L],u.hasOwnProperty(L)&&g!=null&&!h.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:cr(a,o,L,null,h,g)}for(b in h)if(g=h[b],v=u[b],h.hasOwnProperty(b)&&(g!=null||v!=null))switch(b){case"value":_e=g;break;case"defaultValue":Ee=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==v&&cr(a,o,b,g,h,v)}ad(a,_e,Ee);return;case"option":for(var Je in u)if(_e=u[Je],u.hasOwnProperty(Je)&&_e!=null&&!h.hasOwnProperty(Je))switch(Je){case"selected":a.selected=!1;break;default:cr(a,o,Je,null,h,_e)}for(re in h)if(_e=h[re],Ee=u[re],h.hasOwnProperty(re)&&_e!==Ee&&(_e!=null||Ee!=null))switch(re){case"selected":a.selected=_e&&typeof _e!="function"&&typeof _e!="symbol";break;default:cr(a,o,re,_e,h,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ct in u)_e=u[ct],u.hasOwnProperty(ct)&&_e!=null&&!h.hasOwnProperty(ct)&&cr(a,o,ct,null,h,_e);for(me in h)if(_e=h[me],Ee=u[me],h.hasOwnProperty(me)&&_e!==Ee&&(_e!=null||Ee!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,o));break;default:cr(a,o,me,_e,h,Ee)}return;default:if(Oc(o)){for(var ur in u)_e=u[ur],u.hasOwnProperty(ur)&&_e!==void 0&&!h.hasOwnProperty(ur)&&s_(a,o,ur,void 0,h,_e);for(be in h)_e=h[be],Ee=u[be],!h.hasOwnProperty(be)||_e===Ee||_e===void 0&&Ee===void 0||s_(a,o,be,_e,h,Ee);return}}for(var se in u)_e=u[se],u.hasOwnProperty(se)&&_e!=null&&!h.hasOwnProperty(se)&&cr(a,o,se,null,h,_e);for(Ce in h)_e=h[Ce],Ee=u[Ce],!h.hasOwnProperty(Ce)||_e===Ee||_e==null&&Ee==null||cr(a,o,Ce,_e,h,Ee)}function ew(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tN(){if(typeof performance.getEntriesByType=="function"){for(var a=0,o=0,u=performance.getEntriesByType("resource"),h=0;h<u.length;h++){var g=u[h],v=g.transferSize,b=g.initiatorType,L=g.duration;if(v&&L&&ew(b)){for(b=0,L=g.responseEnd,h+=1;h<u.length;h++){var re=u[h],me=re.startTime;if(me>L)break;var be=re.transferSize,Ce=re.initiatorType;be&&ew(Ce)&&(re=re.responseEnd,b+=be*(re<L?1:(L-me)/(re-me)))}if(--h,o+=8*(v+b)/(g.duration/1e3),a++,10<a)break}}if(0<a)return o/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var o_=null,l_=null;function lm(a){return a.nodeType===9?a:a.ownerDocument}function tw(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rw(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function c_(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var u_=null;function rN(){var a=window.event;return a&&a.type==="popstate"?a===u_?!1:(u_=a,!0):(u_=null,!1)}var nw=typeof setTimeout=="function"?setTimeout:void 0,nN=typeof clearTimeout=="function"?clearTimeout:void 0,iw=typeof Promise=="function"?Promise:void 0,iN=typeof queueMicrotask=="function"?queueMicrotask:typeof iw<"u"?function(a){return iw.resolve(null).then(a).catch(aN)}:nw;function aN(a){setTimeout(function(){throw a})}function To(a){return a==="head"}function aw(a,o){var u=o,h=0;do{var g=u.nextSibling;if(a.removeChild(u),g&&g.nodeType===8)if(u=g.data,u==="/$"||u==="/&"){if(h===0){a.removeChild(g),mu(o);return}h--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")h++;else if(u==="html")ch(a.ownerDocument.documentElement);else if(u==="head"){u=a.ownerDocument.head,ch(u);for(var v=u.firstChild;v;){var b=v.nextSibling,L=v.nodeName;v[pe]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&v.rel.toLowerCase()==="stylesheet"||u.removeChild(v),v=b}}else u==="body"&&ch(a.ownerDocument.body);u=g}while(u);mu(o)}function sw(a,o){var u=a;a=0;do{var h=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),h&&h.nodeType===8)if(u=h.data,u==="/$"){if(a===0)break;a--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||a++;u=h}while(u)}function f_(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":f_(u),Me(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}a.removeChild(u)}}function sN(a,o,u,h){for(;a.nodeType===1;){var g=u;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(h){if(!a[pe])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(v=a.getAttribute("rel"),v==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(v!==g.rel||a.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||a.getAttribute("title")!==(g.title==null?null:g.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(v=a.getAttribute("src"),(v!==(g.src==null?null:g.src)||a.getAttribute("type")!==(g.type==null?null:g.type)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&a.getAttribute("name")===v)return a}else return a;if(a=Qi(a.nextSibling),a===null)break}return null}function oN(a,o,u){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!u||(a=Qi(a.nextSibling),a===null))return null;return a}function ow(a,o){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=Qi(a.nextSibling),a===null))return null;return a}function h_(a){return a.data==="$?"||a.data==="$~"}function d_(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function lN(a,o){var u=a.ownerDocument;if(a.data==="$~")a._reactRetry=o;else if(a.data!=="$?"||u.readyState!=="loading")o();else{var h=function(){o(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),a._reactRetry=h}}function Qi(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return a}var m_=null;function lw(a){a=a.nextSibling;for(var o=0;a;){if(a.nodeType===8){var u=a.data;if(u==="/$"||u==="/&"){if(o===0)return Qi(a.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}a=a.nextSibling}return null}function cw(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var u=a.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return a;o--}else u!=="/$"&&u!=="/&"||o++}a=a.previousSibling}return null}function uw(a,o,u){switch(o=lm(u),a){case"html":if(a=o.documentElement,!a)throw Error(n(452));return a;case"head":if(a=o.head,!a)throw Error(n(453));return a;case"body":if(a=o.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function ch(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);Me(a)}var Ji=new Map,fw=new Set;function cm(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Ds=le.d;le.d={f:cN,r:uN,D:fN,C:hN,L:dN,m:mN,X:gN,S:pN,M:_N};function cN(){var a=Ds.f(),o=em();return a||o}function uN(a){var o=Ge(a);o!==null&&o.tag===5&&o.type==="form"?k2(o):Ds.r(a)}var fu=typeof document>"u"?null:document;function hw(a,o,u){var h=fu;if(h&&typeof o=="string"&&o){var g=si(o);g='link[rel="'+a+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),fw.has(g)||(fw.add(g),a={rel:a,crossOrigin:u,href:o},h.querySelector(g)===null&&(o=h.createElement("link"),kn(o,"link",a),Ze(o),h.head.appendChild(o)))}}function fN(a){Ds.D(a),hw("dns-prefetch",a,null)}function hN(a,o){Ds.C(a,o),hw("preconnect",a,o)}function dN(a,o,u){Ds.L(a,o,u);var h=fu;if(h&&a&&o){var g='link[rel="preload"][as="'+si(o)+'"]';o==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+si(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+si(u.imageSizes)+'"]')):g+='[href="'+si(a)+'"]';var v=g;switch(o){case"style":v=hu(a);break;case"script":v=du(a)}Ji.has(v)||(a=_({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:a,as:o},u),Ji.set(v,a),h.querySelector(g)!==null||o==="style"&&h.querySelector(uh(v))||o==="script"&&h.querySelector(fh(v))||(o=h.createElement("link"),kn(o,"link",a),Ze(o),h.head.appendChild(o)))}}function mN(a,o){Ds.m(a,o);var u=fu;if(u&&a){var h=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+si(h)+'"][href="'+si(a)+'"]',v=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=du(a)}if(!Ji.has(v)&&(a=_({rel:"modulepreload",href:a},o),Ji.set(v,a),u.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(fh(v)))return}h=u.createElement("link"),kn(h,"link",a),Ze(h),u.head.appendChild(h)}}}function pN(a,o,u){Ds.S(a,o,u);var h=fu;if(h&&a){var g=He(h).hoistableStyles,v=hu(a);o=o||"default";var b=g.get(v);if(!b){var L={loading:0,preload:null};if(b=h.querySelector(uh(v)))L.loading=5;else{a=_({rel:"stylesheet",href:a,"data-precedence":o},u),(u=Ji.get(v))&&p_(a,u);var re=b=h.createElement("link");Ze(re),kn(re,"link",a),re._p=new Promise(function(me,be){re.onload=me,re.onerror=be}),re.addEventListener("load",function(){L.loading|=1}),re.addEventListener("error",function(){L.loading|=2}),L.loading|=4,um(b,o,h)}b={type:"stylesheet",instance:b,count:1,state:L},g.set(v,b)}}}function gN(a,o){Ds.X(a,o);var u=fu;if(u&&a){var h=He(u).hoistableScripts,g=du(a),v=h.get(g);v||(v=u.querySelector(fh(g)),v||(a=_({src:a,async:!0},o),(o=Ji.get(g))&&g_(a,o),v=u.createElement("script"),Ze(v),kn(v,"link",a),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(g,v))}}function _N(a,o){Ds.M(a,o);var u=fu;if(u&&a){var h=He(u).hoistableScripts,g=du(a),v=h.get(g);v||(v=u.querySelector(fh(g)),v||(a=_({src:a,async:!0,type:"module"},o),(o=Ji.get(g))&&g_(a,o),v=u.createElement("script"),Ze(v),kn(v,"link",a),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(g,v))}}function dw(a,o,u,h){var g=(g=oe.current)?cm(g):null;if(!g)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=hu(u.href),u=He(g).hoistableStyles,h=u.get(o),h||(h={type:"style",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){a=hu(u.href);var v=He(g).hoistableStyles,b=v.get(a);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(a,b),(v=g.querySelector(uh(a)))&&!v._p&&(b.instance=v,b.state.loading=5),Ji.has(a)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ji.set(a,u),v||vN(g,a,u,b.state))),o&&h===null)throw Error(n(528,""));return b}if(o&&h!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=du(u),u=He(g).hoistableScripts,h=u.get(o),h||(h={type:"script",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function hu(a){return'href="'+si(a)+'"'}function uh(a){return'link[rel="stylesheet"]['+a+"]"}function mw(a){return _({},a,{"data-precedence":a.precedence,precedence:null})}function vN(a,o,u,h){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=a.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),kn(o,"link",u),Ze(o),a.head.appendChild(o))}function du(a){return'[src="'+si(a)+'"]'}function fh(a){return"script[async]"+a}function pw(a,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var h=a.querySelector('style[data-href~="'+si(u.href)+'"]');if(h)return o.instance=h,Ze(h),h;var g=_({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(a.ownerDocument||a).createElement("style"),Ze(h),kn(h,"style",g),um(h,u.precedence,a),o.instance=h;case"stylesheet":g=hu(u.href);var v=a.querySelector(uh(g));if(v)return o.state.loading|=4,o.instance=v,Ze(v),v;h=mw(u),(g=Ji.get(g))&&p_(h,g),v=(a.ownerDocument||a).createElement("link"),Ze(v);var b=v;return b._p=new Promise(function(L,re){b.onload=L,b.onerror=re}),kn(v,"link",h),o.state.loading|=4,um(v,u.precedence,a),o.instance=v;case"script":return v=du(u.src),(g=a.querySelector(fh(v)))?(o.instance=g,Ze(g),g):(h=u,(g=Ji.get(v))&&(h=_({},u),g_(h,g)),a=a.ownerDocument||a,g=a.createElement("script"),Ze(g),kn(g,"link",h),a.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,um(h,u.precedence,a));return o.instance}function um(a,o,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,v=g,b=0;b<h.length;b++){var L=h[b];if(L.dataset.precedence===o)v=L;else if(v!==g)break}v?v.parentNode.insertBefore(a,v.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(a,o.firstChild))}function p_(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function g_(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var fm=null;function gw(a,o,u){if(fm===null){var h=new Map,g=fm=new Map;g.set(u,h)}else g=fm,h=g.get(u),h||(h=new Map,g.set(u,h));if(h.has(a))return h;for(h.set(a,null),u=u.getElementsByTagName(a),g=0;g<u.length;g++){var v=u[g];if(!(v[pe]||v[H]||a==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var b=v.getAttribute(o)||"";b=a+b;var L=h.get(b);L?L.push(v):h.set(b,[v])}}return h}function _w(a,o,u){a=a.ownerDocument||a,a.head.insertBefore(u,o==="title"?a.querySelector("head > title"):null)}function xN(a,o,u){if(u===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function vw(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function yN(a,o,u,h){if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var g=hu(h.href),v=o.querySelector(uh(g));if(v){o=v._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(a.count++,a=hm.bind(a),o.then(a,a)),u.state.loading|=4,u.instance=v,Ze(v);return}v=o.ownerDocument||o,h=mw(h),(g=Ji.get(g))&&p_(h,g),v=v.createElement("link"),Ze(v);var b=v;b._p=new Promise(function(L,re){b.onload=L,b.onerror=re}),kn(v,"link",h),u.instance=v}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(a.count++,u=hm.bind(a),o.addEventListener("load",u),o.addEventListener("error",u))}}var __=0;function EN(a,o){return a.stylesheets&&a.count===0&&mm(a,a.stylesheets),0<a.count||0<a.imgCount?function(u){var h=setTimeout(function(){if(a.stylesheets&&mm(a,a.stylesheets),a.unsuspend){var v=a.unsuspend;a.unsuspend=null,v()}},6e4+o);0<a.imgBytes&&__===0&&(__=62500*tN());var g=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&mm(a,a.stylesheets),a.unsuspend)){var v=a.unsuspend;a.unsuspend=null,v()}},(a.imgBytes>__?50:800)+o);return a.unsuspend=u,function(){a.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function hm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)mm(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var dm=null;function mm(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,dm=new Map,o.forEach(TN,a),dm=null,hm.call(a))}function TN(a,o){if(!(o.state.loading&4)){var u=dm.get(a);if(u)var h=u.get(null);else{u=new Map,dm.set(a,u);for(var g=a.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var b=g[v];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(u.set(b.dataset.precedence,b),h=b)}h&&u.set(null,h)}g=o.instance,b=g.getAttribute("data-precedence"),v=u.get(b)||h,v===h&&u.set(null,g),u.set(b,g),this.count++,h=hm.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),v?v.parentNode.insertBefore(g,v.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(g,a.firstChild)),o.state.loading|=4}}var hh={$$typeof:k,Provider:null,Consumer:null,_currentValue:Le,_currentValue2:Le,_threadCount:0};function wN(a,o,u,h,g,v,b,L,re){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zi(0),this.hiddenUpdates=zi(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function xw(a,o,u,h,g,v,b,L,re,me,be,Ce){return a=new wN(a,o,u,b,re,me,be,Ce,L),o=1,v===!0&&(o|=24),v=Ti(3,null,null,o),a.current=v,v.stateNode=a,o=$g(),o.refCount++,a.pooledCache=o,o.refCount++,v.memoizedState={element:h,isDehydrated:u,cache:o},e1(v),a}function yw(a){return a?(a=Gc,a):Gc}function Ew(a,o,u,h,g,v){g=yw(g),h.context===null?h.context=g:h.pendingContext=g,h=uo(o),h.payload={element:u},v=v===void 0?null:v,v!==null&&(h.callback=v),u=fo(a,h,o),u!==null&&(hi(u,a,o),Gf(u,a,o))}function Tw(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var u=a.retryLane;a.retryLane=u!==0&&u<o?u:o}}function v_(a,o){Tw(a,o),(a=a.alternate)&&Tw(a,o)}function ww(a){if(a.tag===13||a.tag===31){var o=Sl(a,67108864);o!==null&&hi(o,a,67108864),v_(a,67108864)}}function Sw(a){if(a.tag===13||a.tag===31){var o=Ii();o=ds(o);var u=Sl(a,o);u!==null&&hi(u,a,o),v_(a,o)}}var pm=!0;function SN(a,o,u,h){var g=ne.T;ne.T=null;var v=le.p;try{le.p=2,x_(a,o,u,h)}finally{le.p=v,ne.T=g}}function AN(a,o,u,h){var g=ne.T;ne.T=null;var v=le.p;try{le.p=8,x_(a,o,u,h)}finally{le.p=v,ne.T=g}}function x_(a,o,u,h){if(pm){var g=y_(h);if(g===null)a_(a,o,h,gm,u),bw(a,h);else if(IN(g,a,o,u,h))h.stopPropagation();else if(bw(a,h),o&4&&-1<bN.indexOf(a)){for(;g!==null;){var v=Ge(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var b=wn(v.pendingLanes);if(b!==0){var L=v;for(L.pendingLanes|=2,L.entangledLanes|=2;b;){var re=1<<31-Yt(b);L.entanglements[1]|=re,b&=~re}Ga(v),(Xt&6)===0&&(Jd=qt()+500,sh(0))}}break;case 31:case 13:L=Sl(v,2),L!==null&&hi(L,v,2),em(),v_(v,2)}if(v=y_(h),v===null&&a_(a,o,h,gm,u),v===g)break;g=v}g!==null&&h.stopPropagation()}else a_(a,o,h,null,u)}}function y_(a){return a=ji(a),E_(a)}var gm=null;function E_(a){if(gm=null,a=Be(a),a!==null){var o=s(a);if(o===null)a=null;else{var u=o.tag;if(u===13){if(a=l(o),a!==null)return a;a=null}else if(u===31){if(a=c(o),a!==null)return a;a=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return gm=a,null}function Aw(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(an()){case Pn:return 2;case _i:return 8;case gr:case dt:return 32;case Ye:return 268435456;default:return 32}default:return 32}}var T_=!1,wo=null,So=null,Ao=null,dh=new Map,mh=new Map,bo=[],bN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bw(a,o){switch(a){case"focusin":case"focusout":wo=null;break;case"dragenter":case"dragleave":So=null;break;case"mouseover":case"mouseout":Ao=null;break;case"pointerover":case"pointerout":dh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":mh.delete(o.pointerId)}}function ph(a,o,u,h,g,v){return a===null||a.nativeEvent!==v?(a={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:v,targetContainers:[g]},o!==null&&(o=Ge(o),o!==null&&ww(o)),a):(a.eventSystemFlags|=h,o=a.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),a)}function IN(a,o,u,h,g){switch(o){case"focusin":return wo=ph(wo,a,o,u,h,g),!0;case"dragenter":return So=ph(So,a,o,u,h,g),!0;case"mouseover":return Ao=ph(Ao,a,o,u,h,g),!0;case"pointerover":var v=g.pointerId;return dh.set(v,ph(dh.get(v)||null,a,o,u,h,g)),!0;case"gotpointercapture":return v=g.pointerId,mh.set(v,ph(mh.get(v)||null,a,o,u,h,g)),!0}return!1}function Iw(a){var o=Be(a.target);if(o!==null){var u=s(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){a.blockedOn=o,K(a.priority,function(){Sw(u)});return}}else if(o===31){if(o=c(u),o!==null){a.blockedOn=o,K(a.priority,function(){Sw(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){a.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}a.blockedOn=null}function _m(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var u=y_(a.nativeEvent);if(u===null){u=a.nativeEvent;var h=new u.constructor(u.type,u);kf=h,u.target.dispatchEvent(h),kf=null}else return o=Ge(u),o!==null&&ww(o),a.blockedOn=u,!1;o.shift()}return!0}function kw(a,o,u){_m(a)&&u.delete(o)}function kN(){T_=!1,wo!==null&&_m(wo)&&(wo=null),So!==null&&_m(So)&&(So=null),Ao!==null&&_m(Ao)&&(Ao=null),dh.forEach(kw),mh.forEach(kw)}function vm(a,o){a.blockedOn===o&&(a.blockedOn=null,T_||(T_=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,kN)))}var xm=null;function Cw(a){xm!==a&&(xm=a,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){xm===a&&(xm=null);for(var o=0;o<a.length;o+=3){var u=a[o],h=a[o+1],g=a[o+2];if(typeof h!="function"){if(E_(h||u)===null)continue;break}var v=Ge(u);v!==null&&(a.splice(o,3),o-=3,y1(v,{pending:!0,data:g,method:u.method,action:h},h,g))}}))}function mu(a){function o(re){return vm(re,a)}wo!==null&&vm(wo,a),So!==null&&vm(So,a),Ao!==null&&vm(Ao,a),dh.forEach(o),mh.forEach(o);for(var u=0;u<bo.length;u++){var h=bo[u];h.blockedOn===a&&(h.blockedOn=null)}for(;0<bo.length&&(u=bo[0],u.blockedOn===null);)Iw(u),u.blockedOn===null&&bo.shift();if(u=(a.ownerDocument||a).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var g=u[h],v=u[h+1],b=g[G]||null;if(typeof v=="function")b||Cw(u);else if(b){var L=null;if(v&&v.hasAttribute("formAction")){if(g=v,b=v[G]||null)L=b.formAction;else if(E_(g)!==null)continue}else L=b.action;typeof L=="function"?u[h+1]=L:(u.splice(h,3),h-=3),Cw(u)}}}function Rw(){function a(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(b){return g=b})},focusReset:"manual",scroll:"manual"})}function o(){g!==null&&(g(),g=null),h||setTimeout(u,20)}function u(){if(!h&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){h=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),g!==null&&(g(),g=null)}}}function w_(a){this._internalRoot=a}ym.prototype.render=w_.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,h=Ii();Ew(u,h,a,o,null,null)},ym.prototype.unmount=w_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;Ew(a.current,2,null,a,null,null),em(),o[Y]=null}};function ym(a){this._internalRoot=a}ym.prototype.unstable_scheduleHydration=function(a){if(a){var o=F();a={blockedOn:null,target:a,priority:o};for(var u=0;u<bo.length&&o!==0&&o<bo[u].priority;u++);bo.splice(u,0,a),u===0&&Iw(a)}};var Dw=e.version;if(Dw!=="19.2.1")throw Error(n(527,Dw,"19.2.1"));le.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(o),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var CN={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Em.isDisabled&&Em.supportsFiber)try{Ot=Em.inject(CN),Kt=Em}catch{}}return _h.createRoot=function(a,o){if(!i(a))throw Error(n(299));var u=!1,h="",g=V2,v=B2,b=U2;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=xw(a,1,!1,null,null,u,h,null,g,v,b,Rw),a[Y]=o.current,i_(a),new w_(o)},_h.hydrateRoot=function(a,o,u){if(!i(a))throw Error(n(299));var h=!1,g="",v=V2,b=B2,L=U2,re=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(v=u.onUncaughtError),u.onCaughtError!==void 0&&(b=u.onCaughtError),u.onRecoverableError!==void 0&&(L=u.onRecoverableError),u.formState!==void 0&&(re=u.formState)),o=xw(a,1,!0,o,u??null,h,g,re,v,b,L,Rw),o.context=yw(null),u=o.current,h=Ii(),h=ds(h),g=uo(h),g.callback=null,fo(u,g,h),u=h,o.current.lanes=u,us(o,u),Ga(o),a[Y]=o.current,i_(a),new ym(o)},_h.version="19.2.1",_h}var zw;function zN(){if(zw)return b_.exports;zw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),b_.exports=UN(),b_.exports}var jN=zN();const HN="modulepreload",GN=function(r,e){return new URL(r,e).href},jw={},Pr=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let d=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const l=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),f=c?.nonce||c?.getAttribute("nonce");i=d(t.map(m=>{if(m=GN(m,n),m in jw)return;jw[m]=!0;const _=m.endsWith(".css"),x=_?'[rel="stylesheet"]':"";if(n)for(let T=l.length-1;T>=0;T--){const E=l[T];if(E.href===m&&(!_||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${x}`))return;const y=document.createElement("link");if(y.rel=_?"stylesheet":HN,_||(y.as="script"),y.crossOrigin="",y.href=m,f&&y.setAttribute("nonce",f),document.head.appendChild(y),_)return new Promise((T,E)=>{y.addEventListener("load",T),y.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${m}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};var r0={};r0.version="0.18.5";var Fi=1200,rc=1252,qN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ox={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Hp=function(r){qN.indexOf(r)!=-1&&(rc=ox[0]=r)};function KN(){Hp(1252)}var aa=function(r){Fi=r,Hp(r)};function Gp(){aa(1200),KN()}function ip(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function WN(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function oI(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var Du=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?WN(r.slice(2)):e==254&&t==255?oI(r.slice(2)):e==65279?r.slice(1):r},Ih=function(e){return String.fromCharCode(e)},dv=function(e){return String.fromCharCode(e)},Vt;function XN(r){Vt=r,aa=function(e){Fi=e,Hp(e)},Du=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?Vt.utils.decode(1200,ip(e.slice(2))):e},Ih=function(t){return Fi===1200?String.fromCharCode(t):Vt.utils.decode(Fi,[t&255,t>>8])[0]},dv=function(t){return Vt.utils.decode(rc,[t])[0]},MI()}var Vo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n0(r){for(var e="",t=0,n=0,i=0,s=0,l=0,c=0,f=0,d=0;d<r.length;)t=r.charCodeAt(d++),s=t>>2,n=r.charCodeAt(d++),l=(t&3)<<4|n>>4,i=r.charCodeAt(d++),c=(n&15)<<2|i>>6,f=i&63,isNaN(n)?c=f=64:isNaN(i)&&(f=64),e+=Vo.charAt(s)+Vo.charAt(l)+Vo.charAt(c)+Vo.charAt(f);return e}function Li(r){var e="",t=0,n=0,i=0,s=0,l=0,c=0,f=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<r.length;)s=Vo.indexOf(r.charAt(d++)),l=Vo.indexOf(r.charAt(d++)),t=s<<2|l>>4,e+=String.fromCharCode(t),c=Vo.indexOf(r.charAt(d++)),n=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),f=Vo.indexOf(r.charAt(d++)),i=(c&3)<<6|f,f!==64&&(e+=String.fromCharCode(i));return e}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Gs=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Qo(r){return Tt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Hw(r){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Ri=function(e){return Tt?Gs(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function O0(r){if(typeof ArrayBuffer>"u")return Ri(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function sl(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function YN(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function lx(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return lx(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var vn=Tt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Gs(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function $N(r){for(var e=[],t=0,n=r.length+250,i=Qo(r.length+255),s=0;s<r.length;++s){var l=r.charCodeAt(s);if(l<128)i[t++]=l;else if(l<2048)i[t++]=192|l>>6&31,i[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=r.charCodeAt(++s)&1023;i[t++]=240|l>>8&7,i[t++]=128|l>>2&63,i[t++]=128|c>>6&15|(l&3)<<4,i[t++]=128|c&63}else i[t++]=224|l>>12&15,i[t++]=128|l>>6&63,i[t++]=128|l&63;t>n&&(e.push(i.slice(0,t)),t=0,i=Qo(65535),n=65530)}return e.push(i.slice(0,t)),vn(e)}var Kn=/\u0000/g,kh=/[\u0001-\u0006]/g;function Pu(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function ba(r,e){var t=""+r;return t.length>=e?t:Fr("0",e-t.length)+t}function cx(r,e){var t=""+r;return t.length>=e?t:Fr(" ",e-t.length)+t}function ap(r,e){var t=""+r;return t.length>=e?t:t+Fr(" ",e-t.length)}function QN(r,e){var t=""+Math.round(r);return t.length>=e?t:Fr("0",e-t.length)+t}function JN(r,e){var t=""+r;return t.length>=e?t:Fr("0",e-t.length)+t}var Gw=Math.pow(2,32);function pu(r,e){if(r>Gw||r<-Gw)return QN(r,e);var t=Math.round(r);return JN(t,e)}function sp(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var qw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],R_=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function ZN(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Kw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},e5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function op(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,l=1,c=0,f=1,d=0,m=0,_=Math.floor(i);d<e&&(_=Math.floor(i),c=_*l+s,m=_*d+f,!(i-_<5e-8));)i=1/(i-_),s=l,l=c,f=d,d=m;if(m>e&&(d>e?(m=f,c=s):(m=d,c=l)),!t)return[0,n*c,m];var x=Math.floor(n*c/m);return[x,n*c-x*m,m]}function Bo(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,l=[],c={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)l=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),n<60&&(s=(s+6)%7),t&&(s=s5(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=s,c}var lI=new Date(1899,11,31,0,0,0),t5=lI.getTime(),r5=new Date(1900,2,1,0,0,0);function cI(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=r5&&(t+=1440*60*1e3),(t-(t5+(r.getTimezoneOffset()-lI.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ux(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function n5(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function i5(r){var e=r<0?12:11,t=ux(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function a5(r){var e=ux(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function i0(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=i5(r):e===10?t=r.toFixed(10).substr(0,12):t=a5(r),ux(n5(t.toUpperCase()))}function nc(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):i0(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Vi(14,cI(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function s5(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function o5(r,e,t,n){var i="",s=0,l=0,c=t.y,f,d=0;switch(r){case 98:c=t.y+543;case 121:switch(e.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=t.m,d=e.length;break;case 3:return R_[t.m-1][1];case 5:return R_[t.m-1][0];default:return R_[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=t.d,d=e.length;break;case 3:return qw[t.q][0];default:return qw[t.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(t.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=t.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=t.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?ba(t.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(t.S+t.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(i=ba(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=c,d=1;break}var m=d>0?ba(f,d):"";return m}function Uo(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var uI=/%/g;function l5(r,e,t){var n=e.replace(uI,""),i=e.length-n.length;return Ms(r,n,t*Math.pow(10,2*i))+Fr("%",i)}function c5(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ms(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function fI(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fI(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var hI=/# (\?+)( ?)\/( ?)(\d+)/;function u5(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),l=i-s*n,c=n;return t+(s===0?"":""+s)+" "+(l===0?Fr(" ",r[1].length+1+r[4].length):cx(l,r[1].length)+r[2]+"/"+r[3]+ba(c,r[4].length))}function f5(r,e,t){return t+(e===0?"":""+e)+Fr(" ",r[1].length+2+r[4].length)}var dI=/^#*0*\.([0#]+)/,mI=/\).*[0#]/,pI=/\(###\) ###\\?-####/;function ti(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Ww(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Xw(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function h5(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function d5(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function ea(r,e,t){if(r.charCodeAt(0)===40&&!e.match(mI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ea("n",n,t):"("+ea("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return c5(r,e,t);if(e.indexOf("%")!==-1)return l5(r,e,t);if(e.indexOf("E")!==-1)return fI(e,t);if(e.charCodeAt(0)===36)return"$"+ea(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,l,c,f=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+pu(f,e.length);if(e.match(/^[#?]+$/))return i=pu(t,0),i==="0"&&(i=""),i.length>e.length?i:ti(e.substr(0,e.length-i.length))+i;if(s=e.match(hI))return u5(s,f,d);if(e.match(/^#+0+$/))return d+pu(f,e.length-e.indexOf("0"));if(s=e.match(dI))return i=Ww(t,s[1].length).replace(/^([^\.]+)$/,"$1."+ti(s[1])).replace(/\.$/,"."+ti(s[1])).replace(/\.(\d*)$/,function(T,E){return"."+E+Fr("0",ti(s[1]).length-E.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+Ww(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+Uo(pu(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ea(r,e,-t):Uo(""+(Math.floor(t)+h5(t,s[1].length)))+"."+ba(Xw(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ea(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Pu(ea(r,e.replace(/[\\-]/g,""),t)),l=0,Pu(Pu(e.replace(/\\/g,"")).replace(/[0#]/g,function(T){return l<i.length?i.charAt(l++):T==="0"?"0":""}));if(e.match(pI))return i=ea(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=op(f,Math.pow(10,l)-1,!1),i=""+d,m=Ms("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=ap(c[2],l),m.length<s[4].length&&(m=ti(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=op(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?cx(c[1],l)+s[2]+"/"+s[3]+ap(c[2],l):Fr(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=pu(t,0),e.length<=i.length?i:ti(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var _=e.indexOf(".")-l,x=e.length-i.length-_;return ti(e.substr(0,_)+i+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=Xw(t,s[1].length),t<0?"-"+ea(r,e,-t):Uo(d5(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?ba(0,3-T.length):"")+T})+"."+ba(l,s[1].length);switch(e){case"###,##0.00":return ea(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=Uo(pu(f,0));return y!=="0"?d+y:"";case"###,###.00":return ea(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ea(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function m5(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ms(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function p5(r,e,t){var n=e.replace(uI,""),i=e.length-n.length;return Ms(r,n,t*Math.pow(10,2*i))+Fr("%",i)}function gI(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gI(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ka(r,e,t){if(r.charCodeAt(0)===40&&!e.match(mI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ka("n",n,t):"("+Ka("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return m5(r,e,t);if(e.indexOf("%")!==-1)return p5(r,e,t);if(e.indexOf("E")!==-1)return gI(e,t);if(e.charCodeAt(0)===36)return"$"+Ka(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,l,c,f=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+ba(f,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:ti(e.substr(0,e.length-i.length))+i;if(s=e.match(hI))return f5(s,f,d);if(e.match(/^#+0+$/))return d+ba(f,e.length-e.indexOf("0"));if(s=e.match(dI))return i=(""+t).replace(/^([^\.]+)$/,"$1."+ti(s[1])).replace(/\.$/,"."+ti(s[1])),i=i.replace(/\.(\d*)$/,function(T,E){return"."+E+Fr("0",ti(s[1]).length-E.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+Uo(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ka(r,e,-t):Uo(""+t)+"."+Fr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ka(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Pu(Ka(r,e.replace(/[\\-]/g,""),t)),l=0,Pu(Pu(e.replace(/\\/g,"")).replace(/[0#]/g,function(T){return l<i.length?i.charAt(l++):T==="0"?"0":""}));if(e.match(pI))return i=Ka(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=op(f,Math.pow(10,l)-1,!1),i=""+d,m=Ms("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=ap(c[2],l),m.length<s[4].length&&(m=ti(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=op(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?cx(c[1],l)+s[2]+"/"+s[3]+ap(c[2],l):Fr(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:ti(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=i.indexOf(".");var _=e.indexOf(".")-l,x=e.length-i.length-_;return ti(e.substr(0,_)+i+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ka(r,e,-t):Uo(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?ba(0,3-T.length):"")+T})+"."+ba(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=Uo(""+f);return y!=="0"?d+y:"";default:if(e.match(/\.[0#?]*$/))return Ka(r,e.slice(0,e.lastIndexOf(".")),t)+ti(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ms(r,e,t){return(t|0)===t?Ka(r,e,t):ea(r,e,t)}function g5(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var _I=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yc(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":sp(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(_I))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function _5(r,e,t,n){for(var i=[],s="",l=0,c="",f="t",d,m,_,x="H";l<r.length;)switch(c=r.charAt(l)){case"G":if(!sp(r,l))throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(_=r.charCodeAt(++l))!==34&&l<r.length;)s+=String.fromCharCode(_);i[i.length]={t:"t",v:s},++l;break;case"\\":var y=r.charAt(++l),T=y==="("||y===")"?y:"t";i[i.length]={t:T,v:y},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:e},++l;break;case"B":case"b":if(r.charAt(l+1)==="1"||r.charAt(l+1)==="2"){if(d==null&&(d=Bo(e,t,r.charAt(l+1)==="2"),d==null))return"";i[i.length]={t:"X",v:r.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Bo(e,t),d==null))return"";for(s=c;++l<r.length&&r.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),i[i.length]={t:c,v:s},f=c;break;case"A":case"a":case"":var E={t:c,v:c};if(d==null&&(d=Bo(e,t)),r.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",x="h",l+=3):r.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",l+=5,x="h"):r.substr(l,5).toUpperCase()==="/"?(d!=null&&(E.v=d.H>=12?"":""),E.t="T",l+=5,x="h"):(E.t="t",++l),d==null&&E.t==="T")return"";i[i.length]=E,f=c;break;case"[":for(s=c;r.charAt(l++)!=="]"&&l<r.length;)s+=r.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(_I)){if(d==null&&(d=Bo(e,t),d==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",yc(r)||(i[i.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=c;++l<r.length&&(c=r.charAt(l))==="0";)s+=c;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<r.length&&"0#?.,E+-%".indexOf(c=r.charAt(l))>-1;)s+=c;i[i.length]={t:"n",v:s};break;case"?":for(s=c;r.charAt(++l)===c;)s+=c;i[i.length]={t:c,v:s},f=c;break;case"*":++l,(r.charAt(l)==" "||r.charAt(l)=="*")&&++l;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<r.length&&"0123456789".indexOf(r.charAt(++l))>-1;)s+=r.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:c,v:c},++l;break;case"$":i[i.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"t",v:c},++l;break}var S=0,D=0,U;for(l=i.length-1,f="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=x,f="h",S<1&&(S=1);break;case"s":(U=i[l].v.match(/\.0+$/))&&(D=Math.max(D,U[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=i[l].t;break;case"m":f==="s"&&(i[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[l].v.match(/[Hh]/)&&(S=1),S<2&&i[l].v.match(/[Mm]/)&&(S=2),S<3&&i[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var k="",W;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=o5(i[l].t.charCodeAt(0),i[l].v,d,D),i[l].t="t";break;case"n":case"?":for(W=l+1;i[W]!=null&&((c=i[W].t)==="?"||c==="D"||(c===" "||c==="t")&&i[W+1]!=null&&(i[W+1].t==="?"||i[W+1].t==="t"&&i[W+1].v==="/")||i[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[W].v==="/"||i[W].v===" "&&i[W+1]!=null&&i[W+1].t=="?"));)i[l].v+=i[W].v,i[W]={v:"",t:";"},++W;k+=i[l].v,l=W-1;break;case"G":i[l].t="t",i[l].v=nc(e,t);break}var Z="",X,A;if(k.length>0){k.charCodeAt(0)==40?(X=e<0&&k.charCodeAt(0)===45?-e:e,A=Ms("n",k,X)):(X=e<0&&n>1?-e:e,A=Ms("n",k,X),X<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),W=A.length-1;var R=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!="t"&&i[l].v.indexOf(".")>-1){R=l;break}var C=i.length;if(R===i.length&&A.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?".indexOf(i[l].t)===-1||(W>=i[l].v.length-1?(W-=i[l].v.length,i[l].v=A.substr(W+1,i[l].v.length)):W<0?i[l].v="":(i[l].v=A.substr(0,W+1),W=-1),i[l].t="t",C=l);W>=0&&C<i.length&&(i[C].v=A.substr(0,W+1)+i[C].v)}else if(R!==i.length&&A.indexOf("E")===-1){for(W=A.indexOf(".")-1,l=R;l>=0;--l)if(!(i[l]==null||"n?".indexOf(i[l].t)===-1)){for(m=i[l].v.indexOf(".")>-1&&l===R?i[l].v.indexOf(".")-1:i[l].v.length-1,Z=i[l].v.substr(m+1);m>=0;--m)W>=0&&(i[l].v.charAt(m)==="0"||i[l].v.charAt(m)==="#")&&(Z=A.charAt(W--)+Z);i[l].v=Z,i[l].t="t",C=l}for(W>=0&&C<i.length&&(i[C].v=A.substr(0,W+1)+i[C].v),W=A.indexOf(".")+1,l=R;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==R)){for(m=i[l].v.indexOf(".")>-1&&l===R?i[l].v.indexOf(".")+1:0,Z=i[l].v.substr(0,m);m<i[l].v.length;++m)W<A.length&&(Z+=A.charAt(W++));i[l].v=Z,i[l].t="t",C=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n?".indexOf(i[l].t)>-1&&(X=n>1&&e<0&&l>0&&i[l-1].v==="-"?-e:e,i[l].v=Ms(i[l].t,i[l].v,X),i[l].t="t");var V="";for(l=0;l!==i.length;++l)i[l]!=null&&(V+=i[l].v);return V}var Yw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $w(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function v5(r,e){var t=g5(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Yw),c=t[1].match(Yw);return $w(e,l)?[n,t[0]]:$w(e,c)?[n,t[1]]:[n,t[l!=null&&c!=null?2:1]]}return[n,s]}function Vi(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:ot)[r],n==null&&(n=t.table&&t.table[Kw[r]]||ot[Kw[r]]),n==null&&(n=e5[r]||"General");break}if(sp(n,0))return nc(e,t);e instanceof Date&&(e=cI(e,t.date1904));var i=v5(n,e);if(sp(i[1]))return nc(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return _5(i[1],e,t,i[0])}function Ja(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(ot[t]==null){e<0&&(e=t);continue}if(ot[t]==r){e=t;break}}e<0&&(e=391)}return ot[e]=r,e}function F0(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Ja(r[e],e)}function uf(){ot=ZN()}var vI={format:Vi,load:Ja,_table:ot,load_table:F0,parse_date_code:Bo,is_date:yc,get_table:function(){return vI._table=ot}},x5={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},xI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function y5(r){var e=typeof r=="number"?ot[r]:r;return e=e.replace(xI,"(\\d+)"),new RegExp("^"+e+"$")}function E5(r,e,t){var n=-1,i=-1,s=-1,l=-1,c=-1,f=-1;(e.match(xI)||[]).forEach(function(_,x){var y=parseInt(t[x+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":l=y;break;case"s":f=y;break;case"m":l>=0?c=y:i=y;break}}),f>=0&&c==-1&&i>=0&&(c=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?d:n==-1&&i==-1&&s==-1?m:d+"T"+m}var T5=(function(){var r={};r.version="1.2.0";function e(){for(var A=0,R=new Array(256),C=0;C!=256;++C)A=C,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,R[C]=A;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function n(A){var R=0,C=0,V=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)N[V]=A[V];for(V=0;V!=256;++V)for(C=A[V],R=256+V;R<4096;R+=256)C=N[R]=C>>>8^A[C&255];var M=[];for(V=1;V!=16;++V)M[V-1]=typeof Int32Array<"u"?N.subarray(V*256,V*256+256):N.slice(V*256,V*256+256);return M}var i=n(t),s=i[0],l=i[1],c=i[2],f=i[3],d=i[4],m=i[5],_=i[6],x=i[7],y=i[8],T=i[9],E=i[10],S=i[11],D=i[12],U=i[13],k=i[14];function W(A,R){for(var C=R^-1,V=0,N=A.length;V<N;)C=C>>>8^t[(C^A.charCodeAt(V++))&255];return~C}function Z(A,R){for(var C=R^-1,V=A.length-15,N=0;N<V;)C=k[A[N++]^C&255]^U[A[N++]^C>>8&255]^D[A[N++]^C>>16&255]^S[A[N++]^C>>>24]^E[A[N++]]^T[A[N++]]^y[A[N++]]^x[A[N++]]^_[A[N++]]^m[A[N++]]^d[A[N++]]^f[A[N++]]^c[A[N++]]^l[A[N++]]^s[A[N++]]^t[A[N++]];for(V+=15;N<V;)C=C>>>8^t[(C^A[N++])&255];return~C}function X(A,R){for(var C=R^-1,V=0,N=A.length,M=0,B=0;V<N;)M=A.charCodeAt(V++),M<128?C=C>>>8^t[(C^M)&255]:M<2048?(C=C>>>8^t[(C^(192|M>>6&31))&255],C=C>>>8^t[(C^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,B=A.charCodeAt(V++)&1023,C=C>>>8^t[(C^(240|M>>8&7))&255],C=C>>>8^t[(C^(128|M>>2&63))&255],C=C>>>8^t[(C^(128|B>>6&15|(M&3)<<4))&255],C=C>>>8^t[(C^(128|B&63))&255]):(C=C>>>8^t[(C^(224|M>>12&15))&255],C=C>>>8^t[(C^(128|M>>6&63))&255],C=C>>>8^t[(C^(128|M&63))&255]);return~C}return r.table=t,r.bstr=W,r.buf=Z,r.str=X,r})(),it=(function(){var e={};e.version="1.2.1";function t(F,K){for(var z=F.split("/"),H=K.split("/"),G=0,Y=0,he=Math.min(z.length,H.length);G<he;++G){if(Y=z[G].length-H[G].length)return Y;if(z[G]!=H[G])return z[G]<H[G]?-1:1}return z.length-H.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var K=F.lastIndexOf("/");return K===-1?F:F.slice(0,K+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var K=F.lastIndexOf("/");return K===-1?F:F.slice(K+1)}function s(F,K){typeof K=="string"&&(K=new Date(K));var z=K.getHours();z=z<<6|K.getMinutes(),z=z<<5|K.getSeconds()>>>1,F.write_shift(2,z);var H=K.getFullYear()-1980;H=H<<4|K.getMonth()+1,H=H<<5|K.getDate(),F.write_shift(2,H)}function l(F){var K=F.read_shift(2)&65535,z=F.read_shift(2)&65535,H=new Date,G=z&31;z>>>=5;var Y=z&15;z>>>=4,H.setMilliseconds(0),H.setFullYear(z+1980),H.setMonth(Y-1),H.setDate(G);var he=K&31;K>>>=5;var Ae=K&63;return K>>>=6,H.setHours(K),H.setMinutes(Ae),H.setSeconds(he<<1),H}function c(F){Nn(F,0);for(var K={},z=0;F.l<=F.length-4;){var H=F.read_shift(2),G=F.read_shift(2),Y=F.l+G,he={};switch(H){case 21589:z=F.read_shift(1),z&1&&(he.mtime=F.read_shift(4)),G>5&&(z&2&&(he.atime=F.read_shift(4)),z&4&&(he.ctime=F.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}F.l=Y,K[H]=he}return K}var f;function d(){return f||(f={})}function m(F,K){if(F[0]==80&&F[1]==75)return Jn(F,K);if((F[0]|32)==109&&(F[1]|32)==105)return us(F,K);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var z=3,H=512,G=0,Y=0,he=0,Ae=0,de=0,ge=[],pe=F.slice(0,512);Nn(pe,0);var Me=_(pe);switch(z=Me[0],z){case 3:H=512;break;case 4:H=4096;break;case 0:if(Me[1]==0)return Jn(F,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}H!==512&&(pe=F.slice(0,H),Nn(pe,28));var Be=F.slice(0,H);x(pe,z);var Ge=pe.read_shift(4,"i");if(z===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);pe.l+=4,he=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Ae=pe.read_shift(4,"i"),G=pe.read_shift(4,"i"),de=pe.read_shift(4,"i"),Y=pe.read_shift(4,"i");for(var Fe=-1,He=0;He<109&&(Fe=pe.read_shift(4,"i"),!(Fe<0));++He)ge[He]=Fe;var Ze=y(F,H);S(de,Y,Ze,H,ge);var Qt=U(Ze,he,ge,H);Qt[he].name="!Directory",G>0&&Ae!==B&&(Qt[Ae].name="!MiniFAT"),Qt[ge[0]].name="!FAT",Qt.fat_addrs=ge,Qt.ssz=H;var Jt={},dr=[],Mn=[],da=[];k(he,Qt,Ze,dr,G,Jt,Mn,Ae),T(Mn,da,dr),dr.shift();var ma={FileIndex:Mn,FullPaths:da};return K&&K.raw&&(ma.raw={header:Be,sectors:Ze}),ma}function _(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(ve,"Header Signature: "),F.l+=16;var K=F.read_shift(2,"u");return[F.read_shift(2,"u"),K]}function x(F,K){var z=9;switch(F.l+=2,z=F.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function y(F,K){for(var z=Math.ceil(F.length/K)-1,H=[],G=1;G<z;++G)H[G-1]=F.slice(G*K,(G+1)*K);return H[z-1]=F.slice(z*K),H}function T(F,K,z){for(var H=0,G=0,Y=0,he=0,Ae=0,de=z.length,ge=[],pe=[];H<de;++H)ge[H]=pe[H]=H,K[H]=z[H];for(;Ae<pe.length;++Ae)H=pe[Ae],G=F[H].L,Y=F[H].R,he=F[H].C,ge[H]===H&&(G!==-1&&ge[G]!==G&&(ge[H]=ge[G]),Y!==-1&&ge[Y]!==Y&&(ge[H]=ge[Y])),he!==-1&&(ge[he]=H),G!==-1&&H!=ge[H]&&(ge[G]=ge[H],pe.lastIndexOf(G)<Ae&&pe.push(G)),Y!==-1&&H!=ge[H]&&(ge[Y]=ge[H],pe.lastIndexOf(Y)<Ae&&pe.push(Y));for(H=1;H<de;++H)ge[H]===H&&(Y!==-1&&ge[Y]!==Y?ge[H]=ge[Y]:G!==-1&&ge[G]!==G&&(ge[H]=ge[G]));for(H=1;H<de;++H)if(F[H].type!==0){if(Ae=H,Ae!=ge[Ae])do Ae=ge[Ae],K[H]=K[Ae]+"/"+K[H];while(Ae!==0&&ge[Ae]!==-1&&Ae!=ge[Ae]);ge[H]=-1}for(K[0]+="/",H=1;H<de;++H)F[H].type!==2&&(K[H]+="/")}function E(F,K,z){for(var H=F.start,G=F.size,Y=[],he=H;z&&G>0&&he>=0;)Y.push(K.slice(he*M,he*M+M)),G-=M,he=zl(z,he*4);return Y.length===0?we(0):vn(Y).slice(0,F.size)}function S(F,K,z,H,G){var Y=B;if(F===B){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var he=z[F],Ae=(H>>>2)-1;if(!he)return;for(var de=0;de<Ae&&(Y=zl(he,de*4))!==B;++de)G.push(Y);S(zl(he,H-4),K-1,z,H,G)}}function D(F,K,z,H,G){var Y=[],he=[];G||(G=[]);var Ae=H-1,de=0,ge=0;for(de=K;de>=0;){G[de]=!0,Y[Y.length]=de,he.push(F[de]);var pe=z[Math.floor(de*4/H)];if(ge=de*4&Ae,H<4+ge)throw new Error("FAT boundary crossed: "+de+" 4 "+H);if(!F[pe])break;de=zl(F[pe],ge)}return{nodes:Y,data:lS([he])}}function U(F,K,z,H){var G=F.length,Y=[],he=[],Ae=[],de=[],ge=H-1,pe=0,Me=0,Be=0,Ge=0;for(pe=0;pe<G;++pe)if(Ae=[],Be=pe+K,Be>=G&&(Be-=G),!he[Be]){de=[];var Fe=[];for(Me=Be;Me>=0;){Fe[Me]=!0,he[Me]=!0,Ae[Ae.length]=Me,de.push(F[Me]);var He=z[Math.floor(Me*4/H)];if(Ge=Me*4&ge,H<4+Ge)throw new Error("FAT boundary crossed: "+Me+" 4 "+H);if(!F[He]||(Me=zl(F[He],Ge),Fe[Me]))break}Y[Be]={nodes:Ae,data:lS([de])}}return Y}function k(F,K,z,H,G,Y,he,Ae){for(var de=0,ge=H.length?2:0,pe=K[F].data,Me=0,Be=0,Ge;Me<pe.length;Me+=128){var Fe=pe.slice(Me,Me+128);Nn(Fe,64),Be=Fe.read_shift(2),Ge=Xp(Fe,0,Be-ge),H.push(Ge);var He={name:Ge,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},Ze=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Ze!==0&&(He.ct=W(Fe,Fe.l-8));var Qt=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Qt!==0&&(He.mt=W(Fe,Fe.l-8)),He.start=Fe.read_shift(4,"i"),He.size=Fe.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=B,He.name=""),He.type===5?(de=He.start,G>0&&de!==B&&(K[de].name="!StreamData")):He.size>=4096?(He.storage="fat",K[He.start]===void 0&&(K[He.start]=D(z,He.start,K.fat_addrs,K.ssz)),K[He.start].name=He.name,He.content=K[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:de!==B&&He.start!==B&&K[de]&&(He.content=E(He,K[de].data,(K[Ae]||{}).data))),He.content&&Nn(He.content,0),Y[Ge]=He,he.push(He)}}function W(F,K){return new Date((_n(F,K+4)/1e7*Math.pow(2,32)+_n(F,K)/1e7-11644473600)*1e3)}function Z(F,K){return d(),m(f.readFileSync(F),K)}function X(F,K){var z=K&&K.type;switch(z||Tt&&Buffer.isBuffer(F)&&(z="buffer"),z||"base64"){case"file":return Z(F,K);case"base64":return m(Ri(Li(F)),K);case"binary":return m(Ri(F),K)}return m(F,K)}function A(F,K){var z=K||{},H=z.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=H+"/",F.FileIndex[0]={name:H,type:5}),z.CLSID&&(F.FileIndex[0].clsid=z.CLSID),R(F)}function R(F){var K="Sh33tJ5";if(!it.find(F,"/"+K)){var z=we(4);z[0]=55,z[1]=z[3]=50,z[2]=54,F.FileIndex.push({name:K,type:2,content:z,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+K),C(F)}}function C(F,K){A(F);for(var z=!1,H=!1,G=F.FullPaths.length-1;G>=0;--G){var Y=F.FileIndex[G];switch(Y.type){case 0:H?z=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(Y.R*Y.L*Y.C)&&(z=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!K)){var he=new Date(1987,1,19),Ae=0,de=Object.create?Object.create(null):{},ge=[];for(G=0;G<F.FullPaths.length;++G)de[F.FullPaths[G]]=!0,F.FileIndex[G].type!==0&&ge.push([F.FullPaths[G],F.FileIndex[G]]);for(G=0;G<ge.length;++G){var pe=n(ge[G][0]);H=de[pe],H||(ge.push([pe,{name:i(pe).replace("/",""),type:1,clsid:ne,ct:he,mt:he,content:null}]),de[pe]=!0)}for(ge.sort(function(Ge,Fe){return t(Ge[0],Fe[0])}),F.FullPaths=[],F.FileIndex=[],G=0;G<ge.length;++G)F.FullPaths[G]=ge[G][0],F.FileIndex[G]=ge[G][1];for(G=0;G<ge.length;++G){var Me=F.FileIndex[G],Be=F.FullPaths[G];if(Me.name=i(Be).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||ne,G===0)Me.C=ge.length>1?1:-1,Me.size=0,Me.type=5;else if(Be.slice(-1)=="/"){for(Ae=G+1;Ae<ge.length&&n(F.FullPaths[Ae])!=Be;++Ae);for(Me.C=Ae>=ge.length?-1:Ae,Ae=G+1;Ae<ge.length&&n(F.FullPaths[Ae])!=n(Be);++Ae);Me.R=Ae>=ge.length?-1:Ae,Me.type=1}else n(F.FullPaths[G+1]||"")==n(Be)&&(Me.R=G+1),Me.type=2}}}function V(F,K){var z=K||{};if(z.fileType=="mad")return wf(F,z);switch(C(F),z.fileType){case"zip":return $t(F,z)}var H=(function(Ge){for(var Fe=0,He=0,Ze=0;Ze<Ge.FileIndex.length;++Ze){var Qt=Ge.FileIndex[Ze];if(Qt.content){var Jt=Qt.content.length;Jt>0&&(Jt<4096?Fe+=Jt+63>>6:He+=Jt+511>>9)}}for(var dr=Ge.FullPaths.length+3>>2,Mn=Fe+7>>3,da=Fe+127>>7,ma=Mn+He+dr+da,xi=ma+127>>7,Ys=xi<=109?0:Math.ceil((xi-109)/127);ma+xi+Ys+127>>7>xi;)Ys=++xi<=109?0:Math.ceil((xi-109)/127);var Ln=[1,Ys,xi,da,dr,He,Fe,0];return Ge.FileIndex[0].size=Fe<<6,Ln[7]=(Ge.FileIndex[0].start=Ln[0]+Ln[1]+Ln[2]+Ln[3]+Ln[4]+Ln[5])+(Ln[6]+7>>3),Ln})(F),G=we(H[7]<<9),Y=0,he=0;{for(Y=0;Y<8;++Y)G.write_shift(1,xe[Y]);for(Y=0;Y<8;++Y)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),Y=0;Y<3;++Y)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,H[2]),G.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:B),G.write_shift(4,H[3]),G.write_shift(-4,H[1]?H[0]-1:B),G.write_shift(4,H[1]),Y=0;Y<109;++Y)G.write_shift(-4,Y<H[2]?H[1]+Y:-1)}if(H[1])for(he=0;he<H[1];++he){for(;Y<236+he*127;++Y)G.write_shift(-4,Y<H[2]?H[1]+Y:-1);G.write_shift(-4,he===H[1]-1?B:he+1)}var Ae=function(Ge){for(he+=Ge;Y<he-1;++Y)G.write_shift(-4,Y+1);Ge&&(++Y,G.write_shift(-4,B))};for(he=Y=0,he+=H[1];Y<he;++Y)G.write_shift(-4,le.DIFSECT);for(he+=H[2];Y<he;++Y)G.write_shift(-4,le.FATSECT);Ae(H[3]),Ae(H[4]);for(var de=0,ge=0,pe=F.FileIndex[0];de<F.FileIndex.length;++de)pe=F.FileIndex[de],pe.content&&(ge=pe.content.length,!(ge<4096)&&(pe.start=he,Ae(ge+511>>9)));for(Ae(H[6]+7>>3);G.l&511;)G.write_shift(-4,le.ENDOFCHAIN);for(he=Y=0,de=0;de<F.FileIndex.length;++de)pe=F.FileIndex[de],pe.content&&(ge=pe.content.length,!(!ge||ge>=4096)&&(pe.start=he,Ae(ge+63>>6)));for(;G.l&511;)G.write_shift(-4,le.ENDOFCHAIN);for(Y=0;Y<H[4]<<2;++Y){var Me=F.FullPaths[Y];if(!Me||Me.length===0){for(de=0;de<17;++de)G.write_shift(4,0);for(de=0;de<3;++de)G.write_shift(4,-1);for(de=0;de<12;++de)G.write_shift(4,0);continue}pe=F.FileIndex[Y],Y===0&&(pe.start=pe.size?pe.start-1:B);var Be=Y===0&&z.root||pe.name;if(ge=2*(Be.length+1),G.write_shift(64,Be,"utf16le"),G.write_shift(2,ge),G.write_shift(1,pe.type),G.write_shift(1,pe.color),G.write_shift(-4,pe.L),G.write_shift(-4,pe.R),G.write_shift(-4,pe.C),pe.clsid)G.write_shift(16,pe.clsid,"hex");else for(de=0;de<4;++de)G.write_shift(4,0);G.write_shift(4,pe.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,pe.start),G.write_shift(4,pe.size),G.write_shift(4,0)}for(Y=1;Y<F.FileIndex.length;++Y)if(pe=F.FileIndex[Y],pe.size>=4096)if(G.l=pe.start+1<<9,Tt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+511&-512;else{for(de=0;de<pe.size;++de)G.write_shift(1,pe.content[de]);for(;de&511;++de)G.write_shift(1,0)}for(Y=1;Y<F.FileIndex.length;++Y)if(pe=F.FileIndex[Y],pe.size>0&&pe.size<4096)if(Tt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+63&-64;else{for(de=0;de<pe.size;++de)G.write_shift(1,pe.content[de]);for(;de&63;++de)G.write_shift(1,0)}if(Tt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function N(F,K){var z=F.FullPaths.map(function(de){return de.toUpperCase()}),H=z.map(function(de){var ge=de.split("/");return ge[ge.length-(de.slice(-1)=="/"?2:1)]}),G=!1;K.charCodeAt(0)===47?(G=!0,K=z[0].slice(0,-1)+K):G=K.indexOf("/")!==-1;var Y=K.toUpperCase(),he=G===!0?z.indexOf(Y):H.indexOf(Y);if(he!==-1)return F.FileIndex[he];var Ae=!Y.match(kh);for(Y=Y.replace(Kn,""),Ae&&(Y=Y.replace(kh,"!")),he=0;he<z.length;++he)if((Ae?z[he].replace(kh,"!"):z[he]).replace(Kn,"")==Y||(Ae?H[he].replace(kh,"!"):H[he]).replace(Kn,"")==Y)return F.FileIndex[he];return null}var M=64,B=-2,ve="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Le(F,K,z){d();var H=V(F,z);f.writeFileSync(K,H)}function ae(F){for(var K=new Array(F.length),z=0;z<F.length;++z)K[z]=String.fromCharCode(F[z]);return K.join("")}function Pe(F,K){var z=V(F,K);switch(K&&K.type||"buffer"){case"file":return d(),f.writeFileSync(K.filename,z),z;case"binary":return typeof z=="string"?z:ae(z);case"base64":return n0(typeof z=="string"?z:ae(z));case"buffer":if(Tt)return Buffer.isBuffer(z)?z:Gs(z);case"array":return typeof z=="string"?Ri(z):z}return z}var J;function O(F){try{var K=F.InflateRaw,z=new K;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)J=F;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function Q(F,K){if(!J)return En(F,K);var z=J.InflateRaw,H=new z,G=H._processChunk(F.slice(F.l),H._finishFlushFlag);return F.l+=H.bytesRead,G}function q(F){return J?J.deflateRawSync(F):Ye(F)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(F){var K=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(K>>16|K>>8|K)&255}for(var Se=typeof Uint8Array<"u",De=Se?new Uint8Array(256):[],st=0;st<256;++st)De[st]=Re(st);function te(F,K){var z=De[F&255];return K<=8?z>>>8-K:(z=z<<8|De[F>>8&255],K<=16?z>>>16-K:(z=z<<8|De[F>>16&255],z>>>24-K))}function St(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=6?0:F[H+1]<<8))>>>z&3}function lt(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=5?0:F[H+1]<<8))>>>z&7}function At(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=4?0:F[H+1]<<8))>>>z&15}function Xe(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=3?0:F[H+1]<<8))>>>z&31}function Oe(F,K){var z=K&7,H=K>>>3;return(F[H]|(z<=1?0:F[H+1]<<8))>>>z&127}function nt(F,K,z){var H=K&7,G=K>>>3,Y=(1<<z)-1,he=F[G]>>>H;return z<8-H||(he|=F[G+1]<<8-H,z<16-H)||(he|=F[G+2]<<16-H,z<24-H)||(he|=F[G+3]<<24-H),he&Y}function gt(F,K,z){var H=K&7,G=K>>>3;return H<=5?F[G]|=(z&7)<<H:(F[G]|=z<<H&255,F[G+1]=(z&7)>>8-H),K+3}function Mt(F,K,z){var H=K&7,G=K>>>3;return z=(z&1)<<H,F[G]|=z,K+1}function qr(F,K,z){var H=K&7,G=K>>>3;return z<<=H,F[G]|=z&255,z>>>=8,F[G+1]=z,K+8}function fa(F,K,z){var H=K&7,G=K>>>3;return z<<=H,F[G]|=z&255,z>>>=8,F[G+1]=z&255,F[G+2]=z>>>8,K+16}function Qn(F,K){var z=F.length,H=2*z>K?2*z:K+5,G=0;if(z>=K)return F;if(Tt){var Y=Hw(H);if(F.copy)F.copy(Y);else for(;G<F.length;++G)Y[G]=F[G];return Y}else if(Se){var he=new Uint8Array(H);if(he.set)he.set(F);else for(;G<z;++G)he[G]=F[G];return he}return F.length=H,F}function qt(F){for(var K=new Array(F),z=0;z<F;++z)K[z]=0;return K}function an(F,K,z){var H=1,G=0,Y=0,he=0,Ae=0,de=F.length,ge=Se?new Uint16Array(32):qt(32);for(Y=0;Y<32;++Y)ge[Y]=0;for(Y=de;Y<z;++Y)F[Y]=0;de=F.length;var pe=Se?new Uint16Array(de):qt(de);for(Y=0;Y<de;++Y)ge[G=F[Y]]++,H<G&&(H=G),pe[Y]=0;for(ge[0]=0,Y=1;Y<=H;++Y)ge[Y+16]=Ae=Ae+ge[Y-1]<<1;for(Y=0;Y<de;++Y)Ae=F[Y],Ae!=0&&(pe[Y]=ge[Ae+16]++);var Me=0;for(Y=0;Y<de;++Y)if(Me=F[Y],Me!=0)for(Ae=te(pe[Y],H)>>H-Me,he=(1<<H+4-Me)-1;he>=0;--he)K[Ae|he<<Me]=Me&15|Y<<4;return H}var Pn=Se?new Uint16Array(512):qt(512),_i=Se?new Uint16Array(32):qt(32);if(!Se){for(var gr=0;gr<512;++gr)Pn[gr]=0;for(gr=0;gr<32;++gr)_i[gr]=0}(function(){for(var F=[],K=0;K<32;K++)F.push(5);an(F,_i,32);var z=[];for(K=0;K<=143;K++)z.push(8);for(;K<=255;K++)z.push(9);for(;K<=279;K++)z.push(7);for(;K<=287;K++)z.push(8);an(z,Pn,288)})();var dt=(function(){for(var K=Se?new Uint8Array(32768):[],z=0,H=0;z<Te.length-1;++z)for(;H<Te[z+1];++H)K[H]=z;for(;H<32768;++H)K[H]=29;var G=Se?new Uint8Array(259):[];for(z=0,H=0;z<oe.length-1;++z)for(;H<oe[z+1];++H)G[H]=z;function Y(Ae,de){for(var ge=0;ge<Ae.length;){var pe=Math.min(65535,Ae.length-ge),Me=ge+pe==Ae.length;for(de.write_shift(1,+Me),de.write_shift(2,pe),de.write_shift(2,~pe&65535);pe-- >0;)de[de.l++]=Ae[ge++]}return de.l}function he(Ae,de){for(var ge=0,pe=0,Me=Se?new Uint16Array(32768):[];pe<Ae.length;){var Be=Math.min(65535,Ae.length-pe);if(Be<10){for(ge=gt(de,ge,+(pe+Be==Ae.length)),ge&7&&(ge+=8-(ge&7)),de.l=ge/8|0,de.write_shift(2,Be),de.write_shift(2,~Be&65535);Be-- >0;)de[de.l++]=Ae[pe++];ge=de.l*8;continue}ge=gt(de,ge,+(pe+Be==Ae.length)+2);for(var Ge=0;Be-- >0;){var Fe=Ae[pe];Ge=(Ge<<5^Fe)&32767;var He=-1,Ze=0;if((He=Me[Ge])&&(He|=pe&-32768,He>pe&&(He-=32768),He<pe))for(;Ae[He+Ze]==Ae[pe+Ze]&&Ze<250;)++Ze;if(Ze>2){Fe=G[Ze],Fe<=22?ge=qr(de,ge,De[Fe+1]>>1)-1:(qr(de,ge,3),ge+=5,qr(de,ge,De[Fe-23]>>5),ge+=3);var Qt=Fe<8?0:Fe-4>>2;Qt>0&&(fa(de,ge,Ze-oe[Fe]),ge+=Qt),Fe=K[pe-He],ge=qr(de,ge,De[Fe]>>3),ge-=3;var Jt=Fe<4?0:Fe-2>>1;Jt>0&&(fa(de,ge,pe-He-Te[Fe]),ge+=Jt);for(var dr=0;dr<Ze;++dr)Me[Ge]=pe&32767,Ge=(Ge<<5^Ae[pe])&32767,++pe;Be-=Ze-1}else Fe<=143?Fe=Fe+48:ge=Mt(de,ge,1),ge=qr(de,ge,De[Fe]),Me[Ge]=pe&32767,++pe}ge=qr(de,ge,0)-1}return de.l=(ge+7)/8|0,de.l}return function(de,ge){return de.length<8?Y(de,ge):he(de,ge)}})();function Ye(F){var K=we(50+Math.floor(F.length*1.1)),z=dt(F,K);return K.slice(0,z)}var Ut=Se?new Uint16Array(32768):qt(32768),Tr=Se?new Uint16Array(32768):qt(32768),Ot=Se?new Uint16Array(128):qt(128),Kt=1,sn=1;function Yt(F,K){var z=Xe(F,K)+257;K+=5;var H=Xe(F,K)+1;K+=5;var G=At(F,K)+4;K+=4;for(var Y=0,he=Se?new Uint8Array(19):qt(19),Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,ge=Se?new Uint8Array(8):qt(8),pe=Se?new Uint8Array(8):qt(8),Me=he.length,Be=0;Be<G;++Be)he[ee[Be]]=Y=lt(F,K),de<Y&&(de=Y),ge[Y]++,K+=3;var Ge=0;for(ge[0]=0,Be=1;Be<=de;++Be)pe[Be]=Ge=Ge+ge[Be-1]<<1;for(Be=0;Be<Me;++Be)(Ge=he[Be])!=0&&(Ae[Be]=pe[Ge]++);var Fe=0;for(Be=0;Be<Me;++Be)if(Fe=he[Be],Fe!=0){Ge=De[Ae[Be]]>>8-Fe;for(var He=(1<<7-Fe)-1;He>=0;--He)Ot[Ge|He<<Fe]=Fe&7|Be<<3}var Ze=[];for(de=1;Ze.length<z+H;)switch(Ge=Ot[Oe(F,K)],K+=Ge&7,Ge>>>=3){case 16:for(Y=3+St(F,K),K+=2,Ge=Ze[Ze.length-1];Y-- >0;)Ze.push(Ge);break;case 17:for(Y=3+lt(F,K),K+=3;Y-- >0;)Ze.push(0);break;case 18:for(Y=11+Oe(F,K),K+=7;Y-- >0;)Ze.push(0);break;default:Ze.push(Ge),de<Ge&&(de=Ge);break}var Qt=Ze.slice(0,z),Jt=Ze.slice(z);for(Be=z;Be<286;++Be)Qt[Be]=0;for(Be=H;Be<30;++Be)Jt[Be]=0;return Kt=an(Qt,Ut,286),sn=an(Jt,Tr,30),K}function cs(F,K){if(F[0]==3&&!(F[1]&3))return[Qo(K),2];for(var z=0,H=0,G=Hw(K||1<<18),Y=0,he=G.length>>>0,Ae=0,de=0;(H&1)==0;){if(H=lt(F,z),z+=3,H>>>1)H>>1==1?(Ae=9,de=5):(z=Yt(F,z),Ae=Kt,de=sn);else{z&7&&(z+=8-(z&7));var ge=F[z>>>3]|F[(z>>>3)+1]<<8;if(z+=32,ge>0)for(!K&&he<Y+ge&&(G=Qn(G,Y+ge),he=G.length);ge-- >0;)G[Y++]=F[z>>>3],z+=8;continue}for(;;){!K&&he<Y+32767&&(G=Qn(G,Y+32767),he=G.length);var pe=nt(F,z,Ae),Me=H>>>1==1?Pn[pe]:Ut[pe];if(z+=Me&15,Me>>>=4,(Me>>>8&255)===0)G[Y++]=Me;else{if(Me==256)break;Me-=257;var Be=Me<8?0:Me-4>>2;Be>5&&(Be=0);var Ge=Y+oe[Me];Be>0&&(Ge+=nt(F,z,Be),z+=Be),pe=nt(F,z,de),Me=H>>>1==1?_i[pe]:Tr[pe],z+=Me&15,Me>>>=4;var Fe=Me<4?0:Me-2>>1,He=Te[Me];for(Fe>0&&(He+=nt(F,z,Fe),z+=Fe),!K&&he<Ge&&(G=Qn(G,Ge+100),he=G.length);Y<Ge;)G[Y]=G[Y-He],++Y}}}return K?[G,z+7>>>3]:[G.slice(0,Y),z+7>>>3]}function En(F,K){var z=F.slice(F.l||0),H=cs(z,K);return F.l+=H[1],H[0]}function Oa(F,K){if(F)typeof console<"u"&&console.error(K);else throw new Error(K)}function Jn(F,K){var z=F;Nn(z,0);var H=[],G=[],Y={FileIndex:H,FullPaths:G};A(Y,{root:K.root});for(var he=z.length-4;(z[he]!=80||z[he+1]!=75||z[he+2]!=5||z[he+3]!=6)&&he>=0;)--he;z.l=he+4,z.l+=4;var Ae=z.read_shift(2);z.l+=6;var de=z.read_shift(4);for(z.l=de,he=0;he<Ae;++he){z.l+=20;var ge=z.read_shift(4),pe=z.read_shift(4),Me=z.read_shift(2),Be=z.read_shift(2),Ge=z.read_shift(2);z.l+=8;var Fe=z.read_shift(4),He=c(z.slice(z.l+Me,z.l+Me+Be));z.l+=Me+Be+Ge;var Ze=z.l;z.l=Fe+4,Tn(z,ge,pe,Y,He),z.l=Ze}return Y}function Tn(F,K,z,H,G){F.l+=2;var Y=F.read_shift(2),he=F.read_shift(2),Ae=l(F);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var de=F.read_shift(4),ge=F.read_shift(4),pe=F.read_shift(4),Me=F.read_shift(2),Be=F.read_shift(2),Ge="",Fe=0;Fe<Me;++Fe)Ge+=String.fromCharCode(F[F.l++]);if(Be){var He=c(F.slice(F.l,F.l+Be));(He[21589]||{}).mt&&(Ae=He[21589].mt),((G||{})[21589]||{}).mt&&(Ae=G[21589].mt)}F.l+=Be;var Ze=F.slice(F.l,F.l+ge);switch(he){case 8:Ze=Q(F,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Qt=!1;Y&8&&(de=F.read_shift(4),de==134695760&&(de=F.read_shift(4),Qt=!0),ge=F.read_shift(4),pe=F.read_shift(4)),ge!=K&&Oa(Qt,"Bad compressed size: "+K+" != "+ge),pe!=z&&Oa(Qt,"Bad uncompressed size: "+z+" != "+pe),hs(H,Ge,Ze,{unsafe:!0,mt:Ae})}function $t(F,K){var z=K||{},H=[],G=[],Y=we(1),he=z.compression?8:0,Ae=0,de=0,ge=0,pe=0,Me=0,Be=F.FullPaths[0],Ge=Be,Fe=F.FileIndex[0],He=[],Ze=0;for(de=1;de<F.FullPaths.length;++de)if(Ge=F.FullPaths[de].slice(Be.length),Fe=F.FileIndex[de],!(!Fe.size||!Fe.content||Ge=="Sh33tJ5")){var Qt=pe,Jt=we(Ge.length);for(ge=0;ge<Ge.length;++ge)Jt.write_shift(1,Ge.charCodeAt(ge)&127);Jt=Jt.slice(0,Jt.l),He[Me]=T5.buf(Fe.content,0);var dr=Fe.content;he==8&&(dr=q(dr)),Y=we(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,Ae),Y.write_shift(2,he),Fe.mt?s(Y,Fe.mt):Y.write_shift(4,0),Y.write_shift(-4,He[Me]),Y.write_shift(4,dr.length),Y.write_shift(4,Fe.content.length),Y.write_shift(2,Jt.length),Y.write_shift(2,0),pe+=Y.length,H.push(Y),pe+=Jt.length,H.push(Jt),pe+=dr.length,H.push(dr),Y=we(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,Ae),Y.write_shift(2,he),Y.write_shift(4,0),Y.write_shift(-4,He[Me]),Y.write_shift(4,dr.length),Y.write_shift(4,Fe.content.length),Y.write_shift(2,Jt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,Qt),Ze+=Y.l,G.push(Y),Ze+=Jt.length,G.push(Jt),++Me}return Y=we(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Me),Y.write_shift(2,Me),Y.write_shift(4,Ze),Y.write_shift(4,pe),Y.write_shift(2,0),vn([vn(H),vn(G),Y])}var wn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ui(F,K){if(F.ctype)return F.ctype;var z=F.name||"",H=z.match(/\.([^\.]+)$/);return H&&wn[H[1]]||K&&(H=(z=K).match(/[\.\\]([^\.\\])+$/),H&&wn[H[1]])?wn[H[1]]:"application/octet-stream"}function vi(F){for(var K=n0(F),z=[],H=0;H<K.length;H+=76)z.push(K.slice(H,H+76));return z.join(`\r
`)+`\r
`}function Tf(F){var K=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var pe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],H=K.split(`\r
`),G=0;G<H.length;++G){var Y=H[G];if(Y.length==0){z.push("");continue}for(var he=0;he<Y.length;){var Ae=76,de=Y.slice(he,he+Ae);de.charAt(Ae-1)=="="?Ae--:de.charAt(Ae-2)=="="?Ae-=2:de.charAt(Ae-3)=="="&&(Ae-=3),de=Y.slice(he,he+Ae),he+=Ae,he<Y.length&&(de+="="),z.push(de)}}return z.join(`\r
`)}function Dc(F){for(var K=[],z=0;z<F.length;++z){for(var H=F[z];z<=F.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+F[++z];K.push(H)}for(var G=0;G<K.length;++G)K[G]=K[G].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Ri(K.join(`\r
`))}function zi(F,K,z){for(var H="",G="",Y="",he,Ae=0;Ae<10;++Ae){var de=K[Ae];if(!de||de.match(/^\s*$/))break;var ge=de.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":H=ge[2].trim();break;case"content-type":Y=ge[2].trim();break;case"content-transfer-encoding":G=ge[2].trim();break}}switch(++Ae,G.toLowerCase()){case"base64":he=Ri(Li(K.slice(Ae).join("")));break;case"quoted-printable":he=Dc(K.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var pe=hs(F,H.slice(z.length),he,{unsafe:!0});Y&&(pe.ctype=Y)}function us(F,K){if(ae(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=K&&K.root||"",H=(Tt&&Buffer.isBuffer(F)?F.toString("binary"):ae(F)).split(`\r
`),G=0,Y="";for(G=0;G<H.length;++G)if(Y=H[G],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),z||(z=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),Y.slice(0,z.length)!=z););var he=(H[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ae="--"+(he[1]||""),de=[],ge=[],pe={FileIndex:de,FullPaths:ge};A(pe);var Me,Be=0;for(G=0;G<H.length;++G){var Ge=H[G];Ge!==Ae&&Ge!==Ae+"--"||(Be++&&zi(pe,H.slice(Me,G),z),Me=G)}return pe}function wf(F,K){var z=K||{},H=z.boundary||"SheetJS";H="------="+H;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],Y=F.FullPaths[0],he=Y,Ae=F.FileIndex[0],de=1;de<F.FullPaths.length;++de)if(he=F.FullPaths[de].slice(Y.length),Ae=F.FileIndex[de],!(!Ae.size||!Ae.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var ge=Ae.content,pe=Tt&&Buffer.isBuffer(ge)?ge.toString("binary"):ae(ge),Me=0,Be=Math.min(1024,pe.length),Ge=0,Fe=0;Fe<=Be;++Fe)(Ge=pe.charCodeAt(Fe))>=32&&Ge<128&&++Me;var He=Me>=Be*4/5;G.push(H),G.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+he),G.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),G.push("Content-Type: "+Ui(Ae,he)),G.push(""),G.push(He?Tf(pe):vi(pe))}return G.push(H+`--\r
`),G.join(`\r
`)}function fs(F){var K={};return A(K,F),K}function hs(F,K,z,H){var G=H&&H.unsafe;G||A(F);var Y=!G&&it.find(F,K);if(!Y){var he=F.FullPaths[0];K.slice(0,he.length)==he?he=K:(he.slice(-1)!="/"&&(he+="/"),he=(he+K).replace("//","/")),Y={name:i(K),type:2},F.FileIndex.push(Y),F.FullPaths.push(he),G||it.utils.cfb_gc(F)}return Y.content=z,Y.size=z?z.length:0,H&&(H.CLSID&&(Y.clsid=H.CLSID),H.mt&&(Y.mt=H.mt),H.ct&&(Y.ct=H.ct)),Y}function hl(F,K){A(F);var z=it.find(F,K);if(z){for(var H=0;H<F.FileIndex.length;++H)if(F.FileIndex[H]==z)return F.FileIndex.splice(H,1),F.FullPaths.splice(H,1),!0}return!1}function ds(F,K,z){A(F);var H=it.find(F,K);if(H){for(var G=0;G<F.FileIndex.length;++G)if(F.FileIndex[G]==H)return F.FileIndex[G].name=i(z),F.FullPaths[G]=z,!0}return!1}function ha(F){C(F,!0)}return e.find=N,e.read=X,e.parse=m,e.write=Pe,e.writeFile=Le,e.utils={cfb_new:fs,cfb_add:hs,cfb_del:hl,cfb_mov:ds,cfb_gc:ha,ReadShift:Ph,CheckField:LI,prep_blob:Nn,bconcat:vn,use_zlib:O,_deflateRaw:Ye,_inflateRaw:En,consts:le},e})();let zo;function w5(r){zo=r}function S5(r){return typeof r=="string"?O0(r):Array.isArray(r)?YN(r):r}function P0(r,e,t){if(typeof zo<"u"&&zo.writeFileSync)return t?zo.writeFileSync(r,e,t):zo.writeFileSync(r,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=O0(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?Ya(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([S5(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=r,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(r);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=sl(e)),c.write(e),c.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+r)}function A5(r){if(typeof zo<"u")return zo.readFileSync(r);if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Vr(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function Qw(r,e){for(var t=[],n=Vr(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function qp(r){for(var e=[],t=Vr(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function Kp(r){for(var e=[],t=Vr(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function b5(r){for(var e=[],t=Vr(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var lp=new Date(1899,11,30,0,0,0);function cn(r,e){var t=r.getTime(),n=lp.getTime()+(r.getTimezoneOffset()-lp.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var yI=new Date,I5=lp.getTime()+(yI.getTimezoneOffset()-lp.getTimezoneOffset())*6e4,Jw=yI.getTimezoneOffset();function Wp(r){var e=new Date;return e.setTime(r*24*60*60*1e3+I5),e.getTimezoneOffset()!==Jw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Jw)*6e4),e}function k5(r){var e=0,t=0,n=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(i[s],10)}return e}var Zw=new Date("2017-02-19T19:06:09.000Z"),EI=isNaN(Zw.getFullYear())?new Date("2/19/17"):Zw,C5=EI.getFullYear()==2017;function Er(r,e){var t=new Date(r);if(C5)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(EI.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ic(r,e){if(Tt&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return Ya(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Ya(oI(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return Ya(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Ya(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function pr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=pr(r[t]));return e}function Fr(r,e){for(var t="";t.length<e;)t+=r;return t}function ka(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var R5=["january","february","march","april","may","june","july","august","september","october","november","december"];function qu(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var l=r.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&R5.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var D5=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),l=[s[0]],c=1;c<s.length;++c)l.push(i),l.push(s[c]);return l}})();function TI(r){return r?r.content&&r.type?ic(r.content,!0):r.data?Du(r.data):r.asNodeBuffer&&Tt?Du(r.asNodeBuffer().toString("binary")):r.asBinary?Du(r.asBinary()):r._data&&r._data.getContent?Du(ic(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function wI(r){if(!r)return null;if(r.data)return ip(r.data);if(r.asNodeBuffer&&Tt)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?ip(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function N5(r){return r&&r.name.slice(-4)===".bin"?wI(r):TI(r)}function na(r,e){for(var t=r.FullPaths||Vr(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var l=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||i==l)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function fx(r,e){var t=na(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Zr(r,e,t){if(!t)return N5(fx(r,e));if(!e)return null;try{return Zr(r,e)}catch{return null}}function Di(r,e,t){if(!t)return TI(fx(r,e));if(!e)return null;try{return Di(r,e)}catch{return null}}function O5(r,e,t){return wI(fx(r,e))}function eS(r){for(var e=r.FullPaths||Vr(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Et(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return Tt?n=Gs(t):n=$N(t),it.utils.cfb_add(r,e,n)}it.utils.cfb_add(r,e,t)}else r.file(e,t)}function hx(){return it.utils.cfb_new()}function SI(r,e){switch(e.type){case"base64":return it.read(r,{type:"base64"});case"binary":return it.read(r,{type:"binary"});case"buffer":case"array":return it.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ch(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var Gr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,F5=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,P5=/<[^>]*>/g,$n=Gr.match(tS)?tS:P5,M5=/<\w*:/,L5=/<(\/?)\w+:/;function ft(r,e,t){for(var n={},i=0,s=0;i!==r.length&&!((s=r.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=r.slice(0,i)),i===r.length)return n;var l=r.match(F5),c=0,f="",d=0,m="",_="",x=1;if(l)for(d=0;d!=l.length;++d){for(_=l[d],s=0;s!=_.length&&_.charCodeAt(s)!==61;++s);for(m=_.slice(0,s).trim();_.charCodeAt(s+1)==32;)++s;for(x=(i=_.charCodeAt(s+1))==34||i==39?1:0,f=_.slice(s+1+x,_.length-x),c=0;c!=m.length&&m.charCodeAt(c)!==58;++c);if(c===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var y=(c===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(c+1);if(n[y]&&m.slice(c-3,c)=="ext")continue;n[y]=f,n[y.toLowerCase()]=f}}return n}function ss(r){return r.replace(L5,"<$1")}var AI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},dx=qp(AI),Bt=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(r,function(c,f){return AI[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,l)+t(i.slice(l+3))}})(),mx=/[&<>'"]/g,V5=/[\u0000-\u0008\u000b-\u001f]/g;function ar(r){var e=r+"";return e.replace(mx,function(t){return dx[t]}).replace(V5,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function rS(r){return ar(r).replace(/ /g,"_x0020_")}var bI=/[\u0000-\u001f]/g;function px(r){var e=r+"";return e.replace(mx,function(t){return dx[t]}).replace(/\n/g,"<br/>").replace(bI,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function B5(r){var e=r+"";return e.replace(mx,function(t){return dx[t]}).replace(bI,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var nS=(function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}})();function U5(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function xr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function D_(r){for(var e="",t=0,n=0,i=0,s=0,l=0,c=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){l=(n&31)<<6,l|=i&63,e+=String.fromCharCode(l);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}l=r.charCodeAt(t++),c=((n&7)<<18|(i&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function iS(r){var e=Qo(2*r.length),t,n,i=1,s=0,l=0,c;for(n=0;n<r.length;n+=i)i=1,(c=r.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(r.charCodeAt(n+1)&63),i=2):c<240?(t=(c&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(c&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function aS(r){return Gs(r,"binary").toString("utf8")}var Tm="foo bar baz",fr=Tt&&(aS(Tm)==D_(Tm)&&aS||iS(Tm)==D_(Tm)&&iS)||D_,Ya=Tt?function(r){return Gs(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},a0=(function(){var r={};return function(t,n){var i=t+"|"+(n||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),II=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}})(),z5=(function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),j5=/<\/?(?:vt:)?variant>/g,H5=/<(?:vt:)([^>]*)>([\s\S]*)</;function sS(r,e){var t=ft(r),n=r.match(z5(t.baseType))||[],i=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var l=s.replace(j5,"").match(H5);l&&i.push({v:fr(l[2]),t:l[1]})}),i}var kI=/(^\s|\s$|\n)/;function On(r,e){return"<"+r+(e.match(kI)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function s0(r){return Vr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Ue(r,e,t){return"<"+r+(t!=null?s0(t):"")+(e!=null?(e.match(kI)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function mv(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function G5(r,e){switch(typeof r){case"string":var t=Ue("vt:lpwstr",ar(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ue((r|0)==r?"vt:i4":"vt:r8",ar(String(r)));case"boolean":return Ue("vt:bool",r?"true":"false")}if(r instanceof Date)return Ue("vt:filetime",mv(r));throw new Error("Unable to serialize "+r)}function gx(r){if(Tt&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return fr(sl(lx(r)));throw new Error("Bad input format: expected Buffer or string")}var o0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ln={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ec=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ci={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function q5(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function K5(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,l=n?-e:e;isFinite(l)?l==0?i=s=0:(i=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var c=0;c<=5;++c,s/=256)r[t+c]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var oS=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},lS=Tt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Gs(e)})):oS(r)}:oS,cS=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(Ns(r,i)));return n.join("").replace(Kn,"")},Xp=Tt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Kn,""):cS(r,e,t)}:cS,uS=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},CI=Tt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):uS(r,e,t)}:uS,fS=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(Su(r,i)));return n.join("")},ff=Tt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):fS(e,t,n)}:fS,RI=function(r,e){var t=_n(r,e);return t>0?ff(r,e+4,e+4+t-1):""},_x=RI,DI=function(r,e){var t=_n(r,e);return t>0?ff(r,e+4,e+4+t-1):""},vx=DI,NI=function(r,e){var t=2*_n(r,e);return t>0?ff(r,e+4,e+4+t-1):""},xx=NI,OI=function(e,t){var n=_n(e,t);return n>0?Xp(e,t+4,t+4+n):""},yx=OI,FI=function(r,e){var t=_n(r,e);return t>0?ff(r,e+4,e+4+t):""},Ex=FI,PI=function(r,e){return q5(r,e)},cp=PI,Tx=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Tt&&(_x=function(e,t){if(!Buffer.isBuffer(e))return RI(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},vx=function(e,t){if(!Buffer.isBuffer(e))return DI(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},xx=function(e,t){if(!Buffer.isBuffer(e))return NI(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},yx=function(e,t){if(!Buffer.isBuffer(e))return OI(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Ex=function(e,t){if(!Buffer.isBuffer(e))return FI(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},cp=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):PI(e,t)},Tx=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function MI(){Xp=function(r,e,t){return Vt.utils.decode(1200,r.slice(e,t)).replace(Kn,"")},ff=function(r,e,t){return Vt.utils.decode(65001,r.slice(e,t))},_x=function(r,e){var t=_n(r,e);return t>0?Vt.utils.decode(rc,r.slice(e+4,e+4+t-1)):""},vx=function(r,e){var t=_n(r,e);return t>0?Vt.utils.decode(Fi,r.slice(e+4,e+4+t-1)):""},xx=function(r,e){var t=2*_n(r,e);return t>0?Vt.utils.decode(1200,r.slice(e+4,e+4+t-1)):""},yx=function(r,e){var t=_n(r,e);return t>0?Vt.utils.decode(1200,r.slice(e+4,e+4+t)):""},Ex=function(r,e){var t=_n(r,e);return t>0?Vt.utils.decode(65001,r.slice(e+4,e+4+t)):""}}typeof Vt<"u"&&MI();var Su=function(r,e){return r[e]},Ns=function(r,e){return r[e+1]*256+r[e]},W5=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},_n=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},zl=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},X5=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Ph(r,e){var t="",n,i,s=[],l,c,f,d;switch(e){case"dbcs":if(d=this.l,Tt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(f=0;f<r;++f)t+=String.fromCharCode(Ns(this,d)),d+=2;r*=2;break;case"utf8":t=ff(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Xp(this,this.l,this.l+r);break;case"wstr":if(typeof Vt<"u")t=Vt.utils.decode(Fi,this.slice(this.l,this.l+2*r));else return Ph.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":t=_x(this,this.l),r=4+_n(this,this.l);break;case"lpstr-cp":t=vx(this,this.l),r=4+_n(this,this.l);break;case"lpwstr":t=xx(this,this.l),r=4+2*_n(this,this.l);break;case"lpp4":r=4+_n(this,this.l),t=yx(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+_n(this,this.l),t=Ex(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(l=Su(this,this.l+r++))!==0;)s.push(Ih(l));t=s.join("");break;case"_wstr":for(r=0,t="";(l=Ns(this,this.l+r))!==0;)s.push(Ih(l)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",d=this.l,f=0;f<r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Su(this,d),this.l=d+1,c=Ph.call(this,r-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Ih(Ns(this,d))),d+=2}t=s.join(""),r*=2;break;case"cpstr":if(typeof Vt<"u"){t=Vt.utils.decode(Fi,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(t="",d=this.l,f=0;f!=r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Su(this,d),this.l=d+1,c=Ph.call(this,r-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Ih(Su(this,d))),d+=1}t=s.join("");break;default:switch(r){case 1:return n=Su(this,this.l),this.l++,n;case 2:return n=(e==="i"?W5:Ns)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(r>0?zl:X5)(this,this.l),this.l+=4,n):(i=_n(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=cp(this,this.l):i=cp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=CI(this,this.l,r);break}}return this.l+=r,t}var Y5=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},$5=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},Q5=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function J5(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)Q5(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){if(typeof Vt<"u"&&rc==874)for(i=0;i!=e.length;++i){var s=Vt.utils.encode(rc,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var c=e.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Y5(this,e,this.l);break;case 8:if(n=8,t==="f"){K5(this,e,this.l);break}case 16:break;case-4:n=4,$5(this,e,this.l);break}return this.l+=n,this}function LI(r,e){var t=CI(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Nn(r,e){r.l=e,r.read_shift=Ph,r.chk=LI,r.write_shift=J5}function Yn(r,e){r.l+=e}function we(r){var e=Qo(r);return Nn(e,0),e}function qs(r,e,t){if(r){var n,i,s;Nn(r,r.l||0);for(var l=r.length,c=0,f=0;r.l<l;){c=r.read_shift(1),c&128&&(c=(c&127)+((r.read_shift(1)&127)<<7));var d=d0[c]||d0[65535];for(n=r.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=r.read_shift(1))&127)<<7*i;f=r.l+s;var m=d.f&&d.f(r,s,t);if(r.l=f,e(m,d,c))return}}}function pi(){var r=[],e=Tt?256:2048,t=function(d){var m=we(d);return Nn(m,0),m},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(i(),n=t(Math.max(d+1,e)))},l=function(){return i(),vn(r)},c=function(d){i(),n=d,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:c,end:l,_bufs:r}}function Ne(r,e,t,n){var i=+e,s;if(!isNaN(i)){n||(n=d0[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=r.next(s);i<=127?l.write_shift(1,i):(l.write_shift(1,(i&127)+128),l.write_shift(1,i>>7));for(var c=0;c!=4;++c)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Tx(t)&&r.push(t)}}function Mh(r,e,t){var n=pr(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function hS(r,e,t){var n=pr(r);return n.s=Mh(n.s,e.s,t),n.e=Mh(n.e,e.s,t),n}function Lh(r,e){if(r.cRel&&r.c<0)for(r=pr(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=pr(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=ut(r);return!r.cRel&&r.cRel!=null&&(t=tO(t)),!r.rRel&&r.rRel!=null&&(t=Z5(t)),t}function N_(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+yr(r.s.c)+":"+(r.e.cRel?"":"$")+yr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Mr(r.s.r)+":"+(r.e.rRel?"":"$")+Mr(r.e.r):Lh(r.s,e.biff)+":"+Lh(r.e,e.biff)}function wx(r){return parseInt(eO(r),10)-1}function Mr(r){return""+(r+1)}function Z5(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function eO(r){return r.replace(/\$(\d+)$/,"$1")}function Sx(r){for(var e=rO(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function yr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function tO(r){return r.replace(/^([A-Z])/,"$$$1")}function rO(r){return r.replace(/^\$([A-Z])/,"$1")}function nO(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dr(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function ut(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function ai(r){var e=r.indexOf(":");return e==-1?{s:Dr(r),e:Dr(r)}:{s:Dr(r.slice(0,e)),e:Dr(r.slice(e+1))}}function xt(r,e){return typeof e>"u"||typeof e=="number"?xt(r.s,r.e):(typeof r!="string"&&(r=ut(r)),typeof e!="string"&&(e=ut(e)),r==e?r:r+":"+e)}function Nt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function dS(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Vi(r.z,t?cn(e):e)}catch{}try{return r.w=Vi((r.XF||{}).numFmtId||(t?14:0),t?cn(e):e)}catch{return""+e}}function rs(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Ks[r.v]||r.v:e==null?dS(r,r.v):dS(r,e))}function ol(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function VI(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),l=0,c=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Dr(n.origin):n.origin;l=f.r,c=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=Nt(s["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var _=0;_!=e.length;++_)if(e[_]){if(!Array.isArray(e[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[_].length;++x)if(!(typeof e[_][x]>"u")){var y={v:e[_][x]},T=l+_,E=c+x;if(d.s.r>T&&(d.s.r=T),d.s.c>E&&(d.s.c=E),d.e.r<T&&(d.e.r=T),d.e.c<E&&(d.e.c=E),e[_][x]&&typeof e[_][x]=="object"&&!Array.isArray(e[_][x])&&!(e[_][x]instanceof Date))y=e[_][x];else if(Array.isArray(y.v)&&(y.f=e[_][x][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||ot[14],n.cellDates?(y.t="d",y.w=Vi(y.z,cn(y.v))):(y.t="n",y.v=cn(y.v),y.w=Vi(y.z,y.v))):y.t="s";if(i)s[T]||(s[T]=[]),s[T][E]&&s[T][E].z&&(y.z=s[T][E].z),s[T][E]=y;else{var S=ut({c:E,r:T});s[S]&&s[S].z&&(y.z=s[S].z),s[S]=y}}}return d.s.c<1e7&&(s["!ref"]=xt(d)),s}function hf(r,e){return VI(null,r,e)}function iO(r){return r.read_shift(4,"i")}function Ca(r,e){return e||(e=we(4)),e.write_shift(4,r),e}function Wn(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function xn(r,e){var t=!1;return e==null&&(t=!0,e=we(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function aO(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function sO(r,e){return e||(e=we(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Ax(r,e){var t=r.l,n=r.read_shift(1),i=Wn(r),s=[],l={t:i,h:i};if((n&1)!==0){for(var c=r.read_shift(4),f=0;f!=c;++f)s.push(aO(r));l.r=s}else l.r=[{ich:0,ifnt:0}];return r.l=t+e,l}function oO(r,e){var t=!1;return e==null&&(t=!0,e=we(15+4*r.t.length)),e.write_shift(1,0),xn(r.t,e),t?e.slice(0,e.l):e}var lO=Ax;function cO(r,e){var t=!1;return e==null&&(t=!0,e=we(23+4*r.t.length)),e.write_shift(1,1),xn(r.t,e),e.write_shift(4,1),sO({},e),t?e.slice(0,e.l):e}function ua(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Tc(r,e){return e==null&&(e=we(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function wc(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Sc(r,e){return e==null&&(e=we(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var uO=Wn,BI=xn;function bx(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function up(r,e){var t=!1;return e==null&&(t=!0,e=we(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var fO=Wn,pv=bx,Ix=up;function kx(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?cp([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):zl(e,0)>>2;return t?i/100:i}function UI(r,e){e==null&&(e=we(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function zI(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function hO(r,e){return e||(e=we(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Ac=zI,df=hO;function qn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ac(r,e){return(e||we(8)).write_shift(8,r,"f")}function dO(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),l=r.read_shift(1),c=r.read_shift(1),f=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=Xl[i];d&&(e.rgb=c0(d));break;case 2:e.rgb=c0([l,c,f]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function fp(r,e){if(e||(e=we(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function mO(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function pO(r,e){e||(e=we(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function jI(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function gO(r){return jI(r,1)}function _O(r){return jI(r,2)}var Cx=2,di=3,wm=11,mS=12,hp=19,Sm=64,vO=65,xO=71,yO=4108,EO=4126,mn=80,HI=81,TO=[mn,HI],gv={1:{n:"CodePage",t:Cx},2:{n:"Category",t:mn},3:{n:"PresentationFormat",t:mn},4:{n:"ByteCount",t:di},5:{n:"LineCount",t:di},6:{n:"ParagraphCount",t:di},7:{n:"SlideCount",t:di},8:{n:"NoteCount",t:di},9:{n:"HiddenCount",t:di},10:{n:"MultimediaClipCount",t:di},11:{n:"ScaleCrop",t:wm},12:{n:"HeadingPairs",t:yO},13:{n:"TitlesOfParts",t:EO},14:{n:"Manager",t:mn},15:{n:"Company",t:mn},16:{n:"LinksUpToDate",t:wm},17:{n:"CharacterCount",t:di},19:{n:"SharedDoc",t:wm},22:{n:"HyperlinksChanged",t:wm},23:{n:"AppVersion",t:di,p:"version"},24:{n:"DigSig",t:vO},26:{n:"ContentType",t:mn},27:{n:"ContentStatus",t:mn},28:{n:"Language",t:mn},29:{n:"Version",t:mn},255:{},2147483648:{n:"Locale",t:hp},2147483651:{n:"Behavior",t:hp},1919054434:{}},_v={1:{n:"CodePage",t:Cx},2:{n:"Title",t:mn},3:{n:"Subject",t:mn},4:{n:"Author",t:mn},5:{n:"Keywords",t:mn},6:{n:"Comments",t:mn},7:{n:"Template",t:mn},8:{n:"LastAuthor",t:mn},9:{n:"RevNumber",t:mn},10:{n:"EditTime",t:Sm},11:{n:"LastPrinted",t:Sm},12:{n:"CreatedDate",t:Sm},13:{n:"ModifiedDate",t:Sm},14:{n:"PageCount",t:di},15:{n:"WordCount",t:di},16:{n:"CharCount",t:di},17:{n:"Thumbnail",t:xO},18:{n:"Application",t:mn},19:{n:"DocSecurity",t:di},255:{},2147483648:{n:"Locale",t:hp},2147483651:{n:"Behavior",t:hp},1919054434:{}},pS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},wO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function SO(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var AO=SO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xl=pr(AO),Ks={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},vv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Am={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Rx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bO(r){var e=Rx();if(!r||!r.match)return e;var t={};if((r.match($n)||[]).forEach(function(n){var i=ft(n);switch(i[0].replace(M5,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[vv[i.ContentType]]!==void 0&&e[vv[i.ContentType]].push(i.PartName);break}}),e.xmlns!==ln.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function qI(r,e){var t=b5(vv),n=[],i;n[n.length]=Gr,n[n.length]=Ue("Types",null,{xmlns:ln.CT,"xmlns:xsd":ln.xsd,"xmlns:xsi":ln.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ue("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){r[f]&&r[f].length>0&&(i=r[f][0],n[n.length]=Ue("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Am[f][e.bookType]||Am[f].xlsx}))},l=function(f){(r[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Am[f][e.bookType]||Am[f].xlsx})})},c=function(f){(r[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:t[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function l0(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Vh(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match($n)||[]).forEach(function(i){var s=ft(i);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Ch(s.Target,e);t[c]=l,n[s.Id]=l}}),t["!id"]=n,t}function Mu(r){var e=[Gr,Ue("Relationships",null,{xmlns:ln.RELS})];return Vr(r["!id"]).forEach(function(t){e[e.length]=Ue("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function nr(r,e,t,n,i,s){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}var IO="application/vnd.oasis.opendocument.spreadsheet";function kO(r,e){for(var t=gx(r),n,i;n=o0.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ft(n[0],!1),i.path=="/"&&i.type!==IO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function CO(r){var e=[Gr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function gS(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function RO(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function DO(r){var e=[Gr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(gS(r[t][0],r[t][1])),e.push(RO("",r[t][0]));return e.push(gS("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function KI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+r0.version+"</meta:generator></office:meta></office:document-meta>"}var oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],NO=(function(){for(var r=new Array(oa.length),e=0;e<oa.length;++e){var t=oa[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r})();function WI(r){var e={};r=fr(r);for(var t=0;t<oa.length;++t){var n=oa[t],i=r.match(NO[t]);i!=null&&i.length>0&&(e[n[1]]=Bt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Er(e[n[1]]))}return e}function O_(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=ar(e),n[n.length]=t?Ue(r,e,t):On(r,e))}function XI(r,e){var t=e||{},n=[Gr,Ue("cp:coreProperties",null,{"xmlns:cp":ln.CORE_PROPS,"xmlns:dc":ln.dc,"xmlns:dcterms":ln.dcterms,"xmlns:dcmitype":ln.dcmitype,"xmlns:xsi":ln.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&O_("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:mv(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&O_("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:mv(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=oa.length;++s){var l=oa[s],c=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:r?r[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&O_(l[0],c,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Yl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],YI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function $I(r,e,t,n){var i=[];if(typeof r=="string")i=sS(r,n);else for(var s=0;s<r.length;++s)i=i.concat(r[s].map(function(m){return{v:m}}));var l=typeof e=="string"?sS(e,n).map(function(m){return m.v}):e,c=0,f=0;if(l.length>0)for(var d=0;d!==i.length;d+=2){switch(f=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function OO(r,e,t){var n={};return e||(e={}),r=fr(r),Yl.forEach(function(i){var s=(r.match(a0(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Bt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var l=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));l&&l.length>0&&(n[i[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&$I(n.HeadingPairs,n.TitlesOfParts,e,t),e}function QI(r){var e=[],t=Ue;return r||(r={}),r.Application="SheetJS",e[e.length]=Gr,e[e.length]=Ue("Properties",null,{xmlns:ln.EXT_PROPS,"xmlns:vt":ln.vt}),Yl.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ar(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+ar(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var FO=/<[^>]+>[^<]*/g;function PO(r,e){var t={},n="",i=r.match(FO);if(i)for(var s=0;s!=i.length;++s){var l=i[s],c=ft(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Bt(c.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[n]=Bt(m);break;case"bool":t[n]=xr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(m);break;case"filetime":case"date":t[n]=Er(m);break;case"cy":case"error":t[n]=Bt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return t}function JI(r){var e=[Gr,Ue("Properties",null,{xmlns:ln.CUST_PROPS,"xmlns:vt":ln.vt})];if(!r)return e.join("");var t=1;return Vr(r).forEach(function(i){++t,e[e.length]=Ue("property",G5(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:ar(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var xv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},F_;function MO(r,e,t){F_||(F_=qp(xv)),e=F_[e]||e,r[e]=t}function LO(r,e){var t=[];return Vr(xv).map(function(n){for(var i=0;i<oa.length;++i)if(oa[i][1]==n)return oa[i];for(i=0;i<Yl.length;++i)if(Yl[i][1]==n)return Yl[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(On(xv[n[1]]||n[1],i))}}),Ue("DocumentProperties",t.join(""),{xmlns:Ci.o})}function VO(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Vr(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var l=0;l<oa.length;++l)if(s==oa[l][1])return;for(l=0;l<Yl.length;++l)if(s==Yl[l][1])return;for(l=0;l<t.length;++l)if(s==t[l])return;var c=r[s],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),i.push(Ue(rS(s),c,{"dt:dt":f}))}}),e&&Vr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),i.push(Ue(rS(s),l,{"dt:dt":c}))}}),"<"+n+' xmlns="'+Ci.o+'">'+i.join("")+"</"+n+">"}function Dx(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function BO(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var l=we(8);return l.write_shift(4,n),l.write_shift(4,i),l}function ZI(r,e,t){var n=r.l,i=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return i}function ek(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function tk(r,e,t){return e===31?ek(r):ZI(r,e,t)}function yv(r,e,t){return tk(r,e,t===!1?0:4)}function UO(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return tk(r,e,0)}function zO(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var i=r.l;t[n]=r.read_shift(0,"lpwstr").replace(Kn,""),r.l-i&2&&(r.l+=2)}return t}function jO(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(Kn,"");return t}function HO(r){var e=r.l,t=dp(r,HI);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=dp(r,di);return[t,n]}function GO(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(HO(r));return t}function _S(r,e){for(var t=r.read_shift(4),n={},i=0;i!=t;++i){var s=r.read_shift(4),l=r.read_shift(4);n[s]=r.read_shift(l,e===1200?"utf16le":"utf8").replace(Kn,"").replace(kh,"!"),e===1200&&l%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function rk(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function qO(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function dp(r,e,t){var n=r.read_shift(2),i,s=t||{};if(r.l+=2,e!==mS&&n!==e&&TO.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===mS?n:e){case 2:return i=r.read_shift(2,"i"),s.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return ZI(r,n,4).replace(Kn,"");case 31:return ek(r);case 64:return Dx(r);case 65:return rk(r);case 71:return qO(r);case 80:return yv(r,n,!s.raw).replace(Kn,"");case 81:return UO(r,n).replace(Kn,"");case 4108:return GO(r);case 4126:case 4127:return n==4127?zO(r):jO(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function vS(r,e){var t=we(4),n=we(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=we(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=BO(e);break;case 31:case 80:for(n=we(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return vn([t,n])}function xS(r,e){var t=r.l,n=r.read_shift(4),i=r.read_shift(4),s=[],l=0,c=0,f=-1,d={};for(l=0;l!=i;++l){var m=r.read_shift(4),_=r.read_shift(4);s[l]=[m,_+t]}s.sort(function(U,k){return U[1]-k[1]});var x={};for(l=0;l!=i;++l){if(r.l!==s[l][1]){var y=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:r.l+2===s[l][1]&&(r.l+=2,y=!1);break;case 80:r.l<=s[l][1]&&(r.l=s[l][1],y=!1);break;case 4108:r.l<=s[l][1]&&(r.l=s[l][1],y=!1);break}if((!e||l==0)&&r.l<=s[l][1]&&(y=!1,r.l=s[l][1]),y)throw new Error("Read Error: Expected address "+s[l][1]+" at "+r.l+" :"+l)}if(e){var T=e[s[l][0]];if(x[T.n]=dp(r,T.t,{raw:!0}),T.p==="version"&&(x[T.n]=String(x[T.n]>>16)+"."+("0000"+String(x[T.n]&65535)).slice(-4)),T.n=="CodePage")switch(x[T.n]){case 0:x[T.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:aa(c=x[T.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[T.n])}}else if(s[l][0]===1){if(c=x.CodePage=dp(r,Cx),aa(c),f!==-1){var E=r.l;r.l=s[f][1],d=_S(r,c),r.l=E}}else if(s[l][0]===0){if(c===0){f=l,r.l=s[l+1][1];continue}d=_S(r,c)}else{var S=d[s[l][0]],D;switch(r[r.l]){case 65:r.l+=4,D=rk(r);break;case 30:r.l+=4,D=yv(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,D=yv(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,D=r.read_shift(4,"i");break;case 19:r.l+=4,D=r.read_shift(4);break;case 5:r.l+=4,D=r.read_shift(8,"f");break;case 11:r.l+=4,D=jr(r,4);break;case 64:r.l+=4,D=Er(Dx(r));break;default:throw new Error("unparsed value: "+r[r.l])}x[S]=D}}return r.l=t+n,x}var nk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function KO(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function yS(r,e,t){var n=we(8),i=[],s=[],l=8,c=0,f=we(8),d=we(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),s.push(f),i.push(d),l+=8+f.length,!e){d=we(8),d.write_shift(4,0),i.unshift(d);var m=[we(4)];for(m[0].write_shift(4,r.length),c=0;c<r.length;++c){var _=r[c][0];for(f=we(8+2*(_.length+1)+(_.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,_.length+1),f.write_shift(0,_,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=vn(m),s.unshift(f),l+=8+f.length}for(c=0;c<r.length;++c)if(!(e&&!e[r[c][0]])&&!(nk.indexOf(r[c][0])>-1||YI.indexOf(r[c][0])>-1)&&r[c][1]!=null){var x=r[c][1],y=0;if(e){y=+e[r[c][0]];var T=t[y];if(T.p=="version"&&typeof x=="string"){var E=x.split(".");x=(+E[0]<<16)+(+E[1]||0)}f=vS(T.t,x)}else{var S=KO(x);S==-1&&(S=31,x=String(x)),f=vS(S,x)}s.push(f),d=we(8),d.write_shift(4,e?y:2+c),i.push(d),l+=8+f.length}var D=8*(s.length+1);for(c=0;c<s.length;++c)i[c].write_shift(4,D),D+=s[c].length;return n.write_shift(4,l),n.write_shift(4,s.length),vn([n].concat(i).concat(s))}function ES(r,e,t){var n=r.content;if(!n)return{};Nn(n,0);var i,s,l,c,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==it.utils.consts.HEADER_CLSID&&m!==t)throw new Error("Bad PropertySet CLSID "+m);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),c=n.read_shift(4),i===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);i===2&&(l=n.read_shift(16),f=n.read_shift(4));var _=xS(n,e),x={SystemIdentifier:d};for(var y in _)x[y]=_[y];if(x.FMTID=s,i===1)return x;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var T;try{T=xS(n,null)}catch{}for(y in T)x[y]=T[y];return x.FMTID=[s,l],x}function TS(r,e,t,n,i,s){var l=we(i?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,it.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,i?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,i?68:48);var f=yS(r,t,n);if(c.push(f),i){var d=yS(i,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),c.push(d)}return vn(c)}function ko(r,e){return r.read_shift(e),null}function WO(r,e){e||(e=we(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function XO(r,e,t){for(var n=[],i=r.l+e;r.l<i;)n.push(t(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return n}function jr(r,e){return r.read_shift(e)===1}function ri(r,e){return e||(e=we(2)),e.write_shift(2,+!!r),e}function en(r){return r.read_shift(2,"u")}function ia(r,e){return e||(e=we(2)),e.write_shift(2,r),e}function ik(r,e){return XO(r,e,en)}function YO(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function ak(r,e,t){return t||(t=we(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function M0(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=Fi;if(t&&t.biff>=8&&(Fi=1200),!t||t.biff==8){var l=r.read_shift(1);l&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var c=n?r.read_shift(n,i):"";return Fi=s,c}function $O(r){var e=Fi;Fi=1200;var t=r.read_shift(2),n=r.read_shift(1),i=n&4,s=n&8,l=1+(n&1),c=0,f,d={};s&&(c=r.read_shift(2)),i&&(f=r.read_shift(4));var m=l==2?"dbcs-cont":"sbcs-cont",_=t===0?"":r.read_shift(t,m);return s&&(r.l+=4*c),i&&(r.l+=f),d.t=_,s||(d.raw="<t>"+d.t+"</t>",d.r=d.t),Fi=e,d}function QO(r){var e=r.t||"",t=we(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=we(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return vn(i)}function sc(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function L0(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):sc(r,n,t)}function bc(r,e,t){if(t.biff>5)return L0(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function sk(r,e,t){return t||(t=we(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function JO(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function ZO(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var i=r.read_shift((n?e-24:e)>>1,"utf16le").replace(Kn,"");return n&&(r.l+=24),i}function e6(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=r.read_shift(s>>1,"utf16le").replace(Kn,"");return t+l}function t6(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return ZO(r);case"0303000000000000c000000000000046":return e6(r);default:throw new Error("Unsupported Moniker "+t)}}function bm(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(Kn,""):"";return t}function wS(r,e){e||(e=we(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function r6(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=r.read_shift(2);r.l+=2;var s,l,c,f,d="",m,_;i&16&&(s=bm(r,t-r.l)),i&128&&(l=bm(r,t-r.l)),(i&257)===257&&(c=bm(r,t-r.l)),(i&257)===1&&(f=t6(r,t-r.l)),i&8&&(d=bm(r,t-r.l)),i&32&&(m=r.read_shift(16)),i&64&&(_=Dx(r)),r.l=t;var x=l||c||f||"";x&&d&&(x+="#"+d),x||(x="#"+d),i&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var y={Target:x};return m&&(y.guid=m),_&&(y.time=_),s&&(y.Tooltip=s),y}function n6(r){var e=we(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)e.write_shift(4,l[t]);if(s==28)n=n.slice(1),wS(n,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));var c=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)e.write_shift(2,c.charCodeAt(t));e.write_shift(2,0),s&8&&wS(i>-1?n.slice(i+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),t=0;t<n.length-3*f;++t)e.write_shift(1,n.charCodeAt(t+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function ok(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),i=r.read_shift(1);return[e,t,n,i]}function lk(r,e){var t=ok(r);return t[3]=0,t}function os(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function oc(r,e,t,n){return n||(n=we(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function i6(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function a6(r,e,t){return e===0?"":bc(r,e,t)}function s6(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),l=r.read_shift(n,"i");return[i,s,l]}function ck(r){var e=r.read_shift(2),t=kx(r);return[e,t]}function o6(r,e,t){r.l+=4,e-=4;var n=r.l+e,i=M0(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,i}function Yp(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function uk(r,e){return e||(e=we(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function fk(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),i=r.read_shift(1);return{s:{c:n,r:e},e:{c:i,r:t}}}var l6=fk;function hk(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function c6(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function u6(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function Bn(r){r.l+=2,r.l+=r.read_shift(2)}var f6={0:Bn,4:Bn,5:Bn,6:Bn,7:u6,8:Bn,9:Bn,10:Bn,11:Bn,12:Bn,13:c6,14:Bn,15:Bn,16:Bn,17:Bn,18:Bn,19:Bn,20:Bn,21:hk};function h6(r,e){for(var t=r.l+e,n=[];r.l<t;){var i=r.read_shift(2);r.l-=2;try{n.push(f6[i](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function Im(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function Nx(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=we(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function d6(r,e){return e===0||r.read_shift(2),1200}function m6(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,i=bc(r,0,t);return r.read_shift(e+n-r.l),i}function p6(r,e){var t=!e||e.biff==8,n=we(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function g6(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function _6(r,e,t){var n=r.read_shift(4),i=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=M0(r,0,t);return l.length===0&&(l="Sheet1"),{pos:n,hs:i,dt:s,name:l}}function v6(r,e){var t=!e||e.biff>=8?2:1,n=we(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function x6(r,e){for(var t=r.l+e,n=r.read_shift(4),i=r.read_shift(4),s=[],l=0;l!=i&&r.l<t;++l)s.push($O(r));return s.Count=n,s.Unique=i,s}function y6(r,e){var t=we(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=QO(r[i]);var s=vn([t].concat(n));return s.parts=[t.length].concat(n.map(function(l){return l.length})),s}function E6(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function T6(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function w6(r){var e=i6(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function S6(r){return r.read_shift(2),r.read_shift(4)}function SS(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var i=r.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function A6(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),l=r.read_shift(2),c=r.read_shift(2),f=r.read_shift(2),d=r.read_shift(2);return{Pos:[e,t],Dim:[n,i],Flags:s,CurTab:l,FirstTab:c,Selected:f,TabRatio:d}}function b6(){var r=we(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function I6(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function k6(r){var e=we(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function C6(){}function R6(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=M0(r,0,t),n}function D6(r,e){var t=r.name||"Arial",n=e&&e.biff==5,i=n?15+t.length:16+2*t.length,s=we(i);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function N6(r){var e=os(r);return e.isst=r.read_shift(4),e}function O6(r,e,t,n){var i=we(10);return oc(r,e,n,i),i.write_shift(4,t),i}function F6(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,i=os(r);t.biff==2&&r.l++;var s=L0(r,n-r.l,t);return i.val=s,i}function P6(r,e,t,n,i){var s=!i||i.biff==8,l=we(8+ +s+(1+s)*t.length);return oc(r,e,n,l),l.write_shift(2,t.length),s&&l.write_shift(1,1),l.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),l}function M6(r,e,t){var n=r.read_shift(2),i=bc(r,0,t);return[n,i]}function L6(r,e,t,n){var i=t&&t.biff==5;n||(n=we(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var V6=bc;function AS(r,e,t){var n=r.l+e,i=t.biff==8||!t.biff?4:2,s=r.read_shift(i),l=r.read_shift(i),c=r.read_shift(2),f=r.read_shift(2);return r.l=n,{s:{r:s,c},e:{r:l,c:f}}}function B6(r,e){var t=e.biff==8||!e.biff?4:2,n=we(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function U6(r){var e=r.read_shift(2),t=r.read_shift(2),n=ck(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function z6(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(ck(r));if(r.l!==t)throw new Error("MulRK read error");var l=r.read_shift(2);if(s.length!=l-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:l,rkrec:s}}function j6(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var l=r.read_shift(2);if(s.length!=l-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:l,ixfe:s}}function H6(r,e,t,n){var i={},s=r.read_shift(4),l=r.read_shift(4),c=r.read_shift(4),f=r.read_shift(2);return i.patternType=wO[c>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=l&15,i.dgRight=l>>4&15,i.dgTop=l>>8&15,i.dgBottom=l>>12&15,i.icvLeft=l>>16&127,i.icvRight=l>>23&127,i.grbitDiag=l>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=f&127,i.icvBack=f>>7&127,i.fsxButton=f>>14&1),i}function G6(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=H6(r,e,n.fStyle,t),n}function bS(r,e,t,n){var i=t&&t.biff==5;n||(n=we(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function q6(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function K6(r){var e=we(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function IS(r,e,t){var n=os(r);(t.biff==2||e==9)&&++r.l;var i=YO(r);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function W6(r,e,t,n,i,s){var l=we(8);return oc(r,e,n,l),ak(t,s,l),l}function X6(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=os(r),i=qn(r);return n.val=i,n}function Y6(r,e,t,n){var i=we(14);return oc(r,e,n,i),ac(t,i),i}var kS=a6;function $6(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=sc(r,s),c=[];n>r.l;)c.push(L0(r));return[s,i,l,c]}function CS(r,e,t){var n=r.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=o6(r,e-2,t)),s.body=i||r.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var Q6=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function RS(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(1),l=r.read_shift(1),c=r.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),f=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var d=sc(r,l,t);i&32&&(d=Q6[d.charCodeAt(0)]);var m=n-r.l;t&&t.biff==2&&--m;var _=n==r.l||c===0||!(m>0)?[]:h9(r,m,t,c);return{chKey:s,Name:d,itab:f,rgce:_}}function dk(r,e,t){if(t.biff<8)return J6(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(s6(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function J6(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=M0(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function Z6(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),i=r.read_shift(2),s=sc(r,n,t),l=sc(r,i,t);return[s,l]}function eF(r,e,t){var n=fk(r);r.l++;var i=r.read_shift(1);return e-=8,[d9(r,e,t),i,n]}function DS(r,e,t){var n=l6(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,u9(r,e,t)]}function tF(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function rF(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),l=r.read_shift(2),c=bc(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:i},c,l,s]}}function nF(r,e,t){return rF(r,e,t)}function iF(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(Yp(r));return t}function aF(r){var e=we(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)uk(r[t],e);return e}function sF(r,e,t){if(t&&t.biff<8)return lF(r,e,t);var n=hk(r),i=h6(r,e-22,n[1]);return{cmo:n,ft:i}}var oF={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=t,{fmt:n}}};function lF(r,e,t){r.l+=4;var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var l=[];return l.push((oF[n]||Yn)(r,e,t)),{cmo:[i,n,s],ft:l}}function cF(r,e,t){var n=r.l,i="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:l=JO(r,6,t);var c=r.read_shift(2);r.read_shift(2),en(r,2);var f=r.read_shift(2);r.l+=f;for(var d=1;d<r.lens.length-1;++d){if(r.l-n!=r.lens[d])throw new Error("TxO: bad continue record");var m=r[r.l],_=sc(r,r.lens[d+1]-r.lens[d]-1);if(i+=_,i.length>=(m?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return r.l=n+e,{t:i}}catch{return r.l=n+e,{t:i}}}function uF(r,e){var t=Yp(r);r.l+=16;var n=r6(r,e-24);return[t,n]}function fF(r){var e=we(24),t=Dr(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return vn([e,n6(r[1])])}function hF(r,e){r.read_shift(2);var t=Yp(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Kn,""),[t,n]}function dF(r){var e=r[1].Tooltip,t=we(10+2*(e.length+1));t.write_shift(2,2048);var n=Dr(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function mF(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=pS[t]||t,t=r.read_shift(2),e[1]=pS[t]||t,e}function pF(r){return r||(r=we(4)),r.write_shift(2,1),r.write_shift(2,1),r}function gF(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(lk(r));return t}function _F(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(lk(r));return t}function vF(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function mk(r,e,t){if(!t.cellStyles)return Yn(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),l=r.read_shift(n),c=r.read_shift(n),f=r.read_shift(2);n==2&&(r.l+=2);var d={s:i,e:s,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(d.level=f>>8&7),d}function xF(r,e){var t=we(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function yF(r,e){var t={};return e<32||(r.l+=16,t.header=qn(r),t.footer=qn(r),r.l+=2),t}function EF(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var i=r.read_shift(1);return r.l+=3,i&16&&(n.area=!0),n}function TF(r){for(var e=we(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var wF=os,SF=ik,AF=L0;function bF(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,i}function IF(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=os(r);++r.l;var i=bc(r,e-7,t);return n.t="str",n.val=i,n}function kF(r){var e=os(r);++r.l;var t=qn(r);return e.t="n",e.val=t,e}function CF(r,e,t){var n=we(15);return z0(n,r,e),n.write_shift(8,t,"f"),n}function RF(r){var e=os(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function DF(r,e,t){var n=we(9);return z0(n,r,e),n.write_shift(2,t),n}function NF(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function OF(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function FF(r,e,t){var n=r.l+e,i=os(r),s=r.read_shift(2),l=sc(r,s,t);return r.l=n,i.t="str",i.val=l,i}var PF=[2,3,48,49,131,139,140,245],Ev=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=qp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var d=[],m=Qo(1);switch(f.type){case"base64":m=Ri(Li(c));break;case"binary":m=Ri(c);break;case"buffer":case"array":m=c;break}Nn(m,0);var _=m.read_shift(1),x=!!(_&136),y=!1,T=!1;switch(_){case 2:break;case 3:break;case 48:y=!0,x=!0;break;case 49:y=!0,x=!0;break;case 131:break;case 139:break;case 140:T=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var E=0,S=521;_==2&&(E=m.read_shift(2)),m.l+=3,_!=2&&(E=m.read_shift(4)),E>1048576&&(E=1e6),_!=2&&(S=m.read_shift(2));var D=m.read_shift(2),U=f.codepage||1252;_!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(U=r[m[m.l]]),m.l+=1,m.l+=2),T&&(m.l+=36);for(var k=[],W={},Z=Math.min(m.length,_==2?521:S-10-(y?264:0)),X=T?32:11;m.l<Z&&m[m.l]!=13;)switch(W={},W.name=Vt.utils.decode(U,m.slice(m.l,m.l+X)).replace(/[\u0000\r\n].*$/g,""),m.l+=X,W.type=String.fromCharCode(m.read_shift(1)),_!=2&&!T&&(W.offset=m.read_shift(4)),W.len=m.read_shift(1),_==2&&(W.offset=m.read_shift(2)),W.dec=m.read_shift(1),W.name.length&&k.push(W),_!=2&&(m.l+=T?13:14),W.type){case"B":(!y||W.len!=8)&&f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(m[m.l]!==13&&(m.l=S-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=S;var A=0,R=0;for(d[0]=[],R=0;R!=k.length;++R)d[0][R]=k[R].name;for(;E-- >0;){if(m[m.l]===42){m.l+=D;continue}for(++m.l,d[++A]=[],R=0,R=0;R!=k.length;++R){var C=m.slice(m.l,m.l+k[R].len);m.l+=k[R].len,Nn(C,0);var V=Vt.utils.decode(U,C);switch(k[R].type){case"C":V.trim().length&&(d[A][R]=V.replace(/\s+$/,""));break;case"D":V.length===8?d[A][R]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):d[A][R]=V;break;case"F":d[A][R]=parseFloat(V.trim());break;case"+":case"I":d[A][R]=T?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":d[A][R]=!0;break;case"N":case"F":d[A][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));d[A][R]="##MEMO##"+(T?parseInt(V.trim(),10):C.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(d[A][R]=+V||0);break;case"@":d[A][R]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":d[A][R]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":d[A][R]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][R]=-C.read_shift(-8,"f");break;case"B":if(y&&k[R].len==8){d[A][R]=C.read_shift(8,"f");break}case"G":case"P":C.l+=k[R].len;break;case"0":if(k[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[R].type)}}}if(_!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=k,d}function n(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=hf(t(c,d),d);return m["!cols"]=d.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete d.DBF,m}function i(c,f){try{return ol(n(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var d=f||{};if(+d.codepage>=0&&aa(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=pi(),_=gp(c,{header:1,raw:!0,cellDates:!0}),x=_[0],y=_.slice(1),T=c["!cols"]||[],E=0,S=0,D=0,U=1;for(E=0;E<x.length;++E){if(((T[E]||{}).DBF||{}).name){x[E]=T[E].DBF.name,++D;continue}if(x[E]!=null){if(++D,typeof x[E]=="number"&&(x[E]=x[E].toString(10)),typeof x[E]!="string")throw new Error("DBF Invalid column name "+x[E]+" |"+typeof x[E]+"|");if(x.indexOf(x[E])!==E){for(S=0;S<1024;++S)if(x.indexOf(x[E]+"_"+S)==-1){x[E]+="_"+S;break}}}}var k=Nt(c["!ref"]),W=[],Z=[],X=[];for(E=0;E<=k.e.c-k.s.c;++E){var A="",R="",C=0,V=[];for(S=0;S<y.length;++S)y[S][E]!=null&&V.push(y[S][E]);if(V.length==0||x[E]==null){W[E]="?";continue}for(S=0;S<V.length;++S){switch(typeof V[S]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=V[S]instanceof Date?"D":"C";break;default:R="C"}C=Math.max(C,String(V[S]).length),A=A&&A!=R?"C":R}C>250&&(C=250),R=((T[E]||{}).DBF||{}).type,R=="C"&&T[E].DBF.len>C&&(C=T[E].DBF.len),A=="B"&&R=="N"&&(A="N",X[E]=T[E].DBF.dec,C=T[E].DBF.len),Z[E]=A=="C"||R=="N"?C:s[A]||0,U+=Z[E],W[E]=A}var N=m.next(32);for(N.write_shift(4,318902576),N.write_shift(4,y.length),N.write_shift(2,296+32*D),N.write_shift(2,U),E=0;E<4;++E)N.write_shift(4,0);for(N.write_shift(4,0|(+e[rc]||3)<<8),E=0,S=0;E<x.length;++E)if(x[E]!=null){var M=m.next(32),B=(x[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,B,"sbcs"),M.write_shift(1,W[E]=="?"?"C":W[E],"sbcs"),M.write_shift(4,S),M.write_shift(1,Z[E]||s[W[E]]||0),M.write_shift(1,X[E]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),S+=Z[E]||s[W[E]]||0}var ve=m.next(264);for(ve.write_shift(4,13),E=0;E<65;++E)ve.write_shift(4,0);for(E=0;E<y.length;++E){var xe=m.next(U);for(xe.write_shift(1,0),S=0;S<x.length;++S)if(x[S]!=null)switch(W[S]){case"L":xe.write_shift(1,y[E][S]==null?63:y[E][S]?84:70);break;case"B":xe.write_shift(8,y[E][S]||0,"f");break;case"N":var ne="0";for(typeof y[E][S]=="number"&&(ne=y[E][S].toFixed(X[S]||0)),D=0;D<Z[S]-ne.length;++D)xe.write_shift(1,32);xe.write_shift(1,ne,"sbcs");break;case"D":y[E][S]?(xe.write_shift(4,("0000"+y[E][S].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(y[E][S].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+y[E][S].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var le=String(y[E][S]!=null?y[E][S]:"").slice(0,Z[S]);for(xe.write_shift(1,le,"sbcs"),D=0;D<Z[S]-le.length;++D)xe.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:i,to_sheet:n,from_sheet:l}})(),pk=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Vr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,y){var T=r[y];return typeof T=="number"?dv(T):T},n=function(x,y,T){var E=y.charCodeAt(0)-32<<4|T.charCodeAt(0)-48;return E==59?x:dv(E)};r["|"]=254;function i(x,y){switch(y.type){case"base64":return s(Li(x),y);case"binary":return s(x,y);case"buffer":return s(Tt&&Buffer.isBuffer(x)?x.toString("binary"):sl(x),y);case"array":return s(ic(x),y)}throw new Error("Unrecognized type "+y.type)}function s(x,y){var T=x.split(/[\n\r]+/),E=-1,S=-1,D=0,U=0,k=[],W=[],Z=null,X={},A=[],R=[],C=[],V=0,N;for(+y.codepage>=0&&aa(+y.codepage);D!==T.length;++D){V=0;var M=T[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),B=M.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),ve=B[0],xe;if(M.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&W.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,le=!1,Le=!1,ae=!1,Pe=-1,J=-1;for(U=1;U<B.length;++U)switch(B[U].charAt(0)){case"A":break;case"X":S=parseInt(B[U].slice(1))-1,le=!0;break;case"Y":for(E=parseInt(B[U].slice(1))-1,le||(S=0),N=k.length;N<=E;++N)k[N]=[];break;case"K":xe=B[U].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(ka(xe))?isNaN(qu(xe).getDate())||(xe=Er(xe)):(xe=ka(xe),Z!==null&&yc(Z)&&(xe=Wp(xe))),typeof Vt<"u"&&typeof xe=="string"&&(y||{}).type!="string"&&(y||{}).codepage&&(xe=Vt.utils.decode(y.codepage,xe)),ne=!0;break;case"E":ae=!0;var O=Lu(B[U].slice(1),{r:E,c:S});k[E][S]=[k[E][S],O];break;case"S":Le=!0,k[E][S]=[k[E][S],"S5S"];break;case"G":break;case"R":Pe=parseInt(B[U].slice(1))-1;break;case"C":J=parseInt(B[U].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}if(ne&&(k[E][S]&&k[E][S].length==2?k[E][S][0]=xe:k[E][S]=xe,Z=null),Le){if(ae)throw new Error("SYLK shared formula cannot have own formula");var Q=Pe>-1&&k[Pe][J];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");k[E][S][1]=Ok(Q[1],{r:E-Pe,c:S-J})}break;case"F":var q=0;for(U=1;U<B.length;++U)switch(B[U].charAt(0)){case"X":S=parseInt(B[U].slice(1))-1,++q;break;case"Y":for(E=parseInt(B[U].slice(1))-1,N=k.length;N<=E;++N)k[N]=[];break;case"M":V=parseInt(B[U].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=W[parseInt(B[U].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=B[U].slice(1).split(" "),N=parseInt(C[0],10);N<=parseInt(C[1],10);++N)V=parseInt(C[2],10),R[N-1]=V===0?{hidden:!0}:{wch:V},Jo(R[N-1]);break;case"C":S=parseInt(B[U].slice(1))-1,R[S]||(R[S]={});break;case"R":E=parseInt(B[U].slice(1))-1,A[E]||(A[E]={}),V>0?(A[E].hpt=V,A[E].hpx=Wu(V)):V===0&&(A[E].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}q<1&&(Z=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}}return A.length>0&&(X["!rows"]=A),R.length>0&&(X["!cols"]=R),y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),[k,X]}function l(x,y){var T=i(x,y),E=T[0],S=T[1],D=hf(E,y);return Vr(S).forEach(function(U){D[U]=S[U]}),D}function c(x,y){return ol(l(x,y),y)}function f(x,y,T,E){var S="C;Y"+(T+1)+";X"+(E+1)+";K";switch(x.t){case"n":S+=x.v||0,x.f&&!x.F&&(S+=";E"+Vx(x.f,{r:T,c:E}));break;case"b":S+=x.v?"TRUE":"FALSE";break;case"e":S+=x.w||x.v;break;case"d":S+='"'+(x.w||x.v)+'"';break;case"s":S+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(x,y){y.forEach(function(T,E){var S="F;W"+(E+1)+" "+(E+1)+" ";T.hidden?S+="0":(typeof T.width=="number"&&!T.wpx&&(T.wpx=u0(T.width)),typeof T.wpx=="number"&&!T.wch&&(T.wch=f0(T.wpx)),typeof T.wch=="number"&&(S+=Math.round(T.wch))),S.charAt(S.length-1)!=" "&&x.push(S)})}function m(x,y){y.forEach(function(T,E){var S="F;";T.hidden?S+="M0;":T.hpt?S+="M"+20*T.hpt+";":T.hpx&&(S+="M"+20*h0(T.hpx)+";"),S.length>2&&x.push(S+"R"+(E+1))})}function _(x,y){var T=["ID;PWXL;N;E"],E=[],S=Nt(x["!ref"]),D,U=Array.isArray(x),k=`\r
`;T.push("P;PGeneral"),T.push("F;P0;DG0G8;M255"),x["!cols"]&&d(T,x["!cols"]),x["!rows"]&&m(T,x["!rows"]),T.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var W=S.s.r;W<=S.e.r;++W)for(var Z=S.s.c;Z<=S.e.c;++Z){var X=ut({r:W,c:Z});D=U?(x[W]||[])[Z]:x[X],!(!D||D.v==null&&(!D.f||D.F))&&E.push(f(D,x,W,Z))}return T.join(k)+k+E.join(k)+k+"E"+k}return{to_workbook:c,to_sheet:l,from_sheet:_}})(),gk=(function(){function r(s,l){switch(l.type){case"base64":return e(Li(s),l);case"binary":return e(s,l);case"buffer":return e(Tt&&Buffer.isBuffer(s)?s.toString("binary"):sl(s),l);case"array":return e(ic(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var c=s.split(`
`),f=-1,d=-1,m=0,_=[];m!==c.length;++m){if(c[m].trim()==="BOT"){_[++f]=[],d=0;continue}if(!(f<0)){var x=c[m].trim().split(","),y=x[0],T=x[1];++m;for(var E=c[m]||"";(E.match(/["]/g)||[]).length&1&&m<c.length-1;)E+=`
`+c[++m];switch(E=E.trim(),+y){case-1:if(E==="BOT"){_[++f]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?_[f][d]=!0:E==="FALSE"?_[f][d]=!1:isNaN(ka(T))?isNaN(qu(T).getDate())?_[f][d]=T:_[f][d]=Er(T):_[f][d]=ka(T),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),_[f][d++]=E!==""?E:null;break}if(E==="EOD")break}}return l&&l.sheetRows&&(_=_.slice(0,l.sheetRows)),_}function t(s,l){return hf(r(s,l),l)}function n(s,l){return ol(t(s,l),l)}var i=(function(){var s=function(f,d,m,_,x){f.push(d),f.push(m+","+_),f.push('"'+x.replace(/"/g,'""')+'"')},l=function(f,d,m,_){f.push(d+","+m),f.push(d==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(f){var d=[],m=Nt(f["!ref"]),_,x=Array.isArray(f);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,m.e.r-m.s.r+1,""),s(d,"TUPLES",0,m.e.c-m.s.c+1,""),s(d,"DATA",0,0,"");for(var y=m.s.r;y<=m.e.r;++y){l(d,-1,0,"BOT");for(var T=m.s.c;T<=m.e.c;++T){var E=ut({r:y,c:T});if(_=x?(f[y]||[])[T]:f[E],!_){l(d,1,0,"");continue}switch(_.t){case"n":var S=_.w;!S&&_.v!=null&&(S=_.v),S==null?_.f&&!_.F?l(d,1,0,"="+_.f):l(d,1,0,""):l(d,0,S,"V");break;case"b":l(d,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=Vi(_.z||ot[14],cn(Er(_.v)))),l(d,0,_.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var D=`\r
`,U=d.join(D);return U}})();return{to_workbook:n,to_sheet:t,from_sheet:i}})(),_k=(function(){function r(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(_,x){for(var y=_.split(`
`),T=-1,E=-1,S=0,D=[];S!==y.length;++S){var U=y[S].trim().split(":");if(U[0]==="cell"){var k=Dr(U[1]);if(D.length<=k.r)for(T=D.length;T<=k.r;++T)D[T]||(D[T]=[]);switch(T=k.r,E=k.c,U[2]){case"t":D[T][E]=r(U[3]);break;case"v":D[T][E]=+U[3];break;case"vtf":var W=U[U.length-1];case"vtc":switch(U[3]){case"nl":D[T][E]=!!+U[4];break;default:D[T][E]=+U[4];break}U[2]=="vtf"&&(D[T][E]=[D[T][E],W])}}}return x&&x.sheetRows&&(D=D.slice(0,x.sheetRows)),D}function n(_,x){return hf(t(_,x),x)}function i(_,x){return ol(n(_,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(_){if(!_||!_["!ref"])return"";for(var x=[],y=[],T,E="",S=ai(_["!ref"]),D=Array.isArray(_),U=S.s.r;U<=S.e.r;++U)for(var k=S.s.c;k<=S.e.c;++k)if(E=ut({r:U,c:k}),T=D?(_[U]||[])[k]:_[E],!(!T||T.v==null||T.t==="z")){switch(y=["cell",E,"t"],T.t){case"s":case"str":y.push(e(T.v));break;case"n":T.f?(y[2]="vtf",y[3]="n",y[4]=T.v,y[5]=e(T.f)):(y[2]="v",y[3]=T.v);break;case"b":y[2]="vt"+(T.f?"f":"c"),y[3]="nl",y[4]=T.v?"1":"0",y[5]=e(T.f||(T.v?"TRUE":"FALSE"));break;case"d":var W=cn(Er(T.v));y[2]="vtc",y[3]="nd",y[4]=""+W,y[5]=T.w||Vi(T.z||ot[14],W);break;case"e":continue}x.push(y.join(":"))}return x.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function m(_){return[s,l,c,l,d(_),f].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:m}})(),Ku=(function(){function r(m,_,x,y,T){T.raw?_[x][y]=m:m===""||(m==="TRUE"?_[x][y]=!0:m==="FALSE"?_[x][y]=!1:isNaN(ka(m))?isNaN(qu(m).getDate())?_[x][y]=m:_[x][y]=Er(m):_[x][y]=ka(m))}function e(m,_){var x=_||{},y=[];if(!m||m.length===0)return y;for(var T=m.split(/[\r\n]/),E=T.length-1;E>=0&&T[E].length===0;)--E;for(var S=10,D=0,U=0;U<=E;++U)D=T[U].indexOf(" "),D==-1?D=T[U].length:D++,S=Math.max(S,D);for(U=0;U<=E;++U){y[U]=[];var k=0;for(r(T[U].slice(0,S).trim(),y,U,k,x),k=1;k<=(T[U].length-S)/10+1;++k)r(T[U].slice(S+(k-1)*10,S+k*10).trim(),y,U,k,x)}return x.sheetRows&&(y=y.slice(0,x.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(m){for(var _={},x=!1,y=0,T=0;y<m.length;++y)(T=m.charCodeAt(y))==34?x=!x:!x&&T in t&&(_[T]=(_[T]||0)+1);T=[];for(y in _)Object.prototype.hasOwnProperty.call(_,y)&&T.push([_[y],y]);if(!T.length){_=n;for(y in _)Object.prototype.hasOwnProperty.call(_,y)&&T.push([_[y],y])}return T.sort(function(E,S){return E[0]-S[0]||n[E[1]]-n[S[1]]}),t[T.pop()[1]]||44}function s(m,_){var x=_||{},y="",T=x.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(y=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(y=m.charAt(4),m=m.slice(6)):y=i(m.slice(0,1024)):x&&x.FS?y=x.FS:y=i(m.slice(0,1024));var S=0,D=0,U=0,k=0,W=0,Z=y.charCodeAt(0),X=!1,A=0,R=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var C=x.dateNF!=null?y5(x.dateNF):null;function V(){var N=m.slice(k,W),M={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)M.t="z";else if(x.raw)M.t="s",M.v=N;else if(N.trim().length===0)M.t="s",M.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(M.t="s",M.v=N.slice(2,-1).replace(/""/g,'"')):$P(N)?(M.t="n",M.f=N.slice(1)):(M.t="s",M.v=N);else if(N=="TRUE")M.t="b",M.v=!0;else if(N=="FALSE")M.t="b",M.v=!1;else if(!isNaN(U=ka(N)))M.t="n",x.cellText!==!1&&(M.w=N),M.v=U;else if(!isNaN(qu(N).getDate())||C&&N.match(C)){M.z=x.dateNF||ot[14];var B=0;C&&N.match(C)&&(N=E5(N,x.dateNF,N.match(C)||[]),B=1),x.cellDates?(M.t="d",M.v=Er(N,B)):(M.t="n",M.v=cn(Er(N,B))),x.cellText!==!1&&(M.w=Vi(M.z,M.v instanceof Date?cn(M.v):M.v)),x.cellNF||delete M.z}else M.t="s",M.v=N;if(M.t=="z"||(x.dense?(T[S]||(T[S]=[]),T[S][D]=M):T[ut({c:D,r:S})]=M),k=W+1,R=m.charCodeAt(k),E.e.c<D&&(E.e.c=D),E.e.r<S&&(E.e.r=S),A==Z)++D;else if(D=0,++S,x.sheetRows&&x.sheetRows<=S)return!0}e:for(;W<m.length;++W)switch(A=m.charCodeAt(W)){case 34:R===34&&(X=!X);break;case Z:case 10:case 13:if(!X&&V())break e;break}return W-k>0&&V(),T["!ref"]=xt(E),T}function l(m,_){return!(_&&_.PRN)||_.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,_):hf(e(m,_),_)}function c(m,_){var x="",y=_.type=="string"?[0,0,0,0]:Wx(m,_);switch(_.type){case"base64":x=Li(m);break;case"binary":x=m;break;case"buffer":_.codepage==65001?x=m.toString("utf8"):_.codepage&&typeof Vt<"u"?x=Vt.utils.decode(_.codepage,m):x=Tt&&Buffer.isBuffer(m)?m.toString("binary"):sl(m);break;case"array":x=ic(m);break;case"string":x=m;break;default:throw new Error("Unrecognized type "+_.type)}return y[0]==239&&y[1]==187&&y[2]==191?x=fr(x.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?x=fr(x):_.type=="binary"&&typeof Vt<"u"&&_.codepage&&(x=Vt.utils.decode(_.codepage,Vt.utils.encode(28591,x))),x.slice(0,19)=="socialcalc:version:"?_k.to_sheet(_.type=="string"?x:fr(x),_):l(x,_)}function f(m,_){return ol(c(m,_),_)}function d(m){for(var _=[],x=Nt(m["!ref"]),y,T=Array.isArray(m),E=x.s.r;E<=x.e.r;++E){for(var S=[],D=x.s.c;D<=x.e.c;++D){var U=ut({r:E,c:D});if(y=T?(m[E]||[])[D]:m[U],!y||y.v==null){S.push("          ");continue}for(var k=(y.w||(rs(y),y.w)||"").slice(0,10);k.length<10;)k+=" ";S.push(k+(D===0?" ":""))}_.push(S.join(""))}return _.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}})();function MF(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var i=pk.to_workbook(r,t);return t.WTF=n,i}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ku.to_workbook(r,e)}}var $l=(function(){function r(O,Q,q){if(O){Nn(O,O.l||0);for(var ee=q.Enum||Pe;O.l<O.length;){var oe=O.read_shift(2),Te=ee[oe]||ee[65535],Re=O.read_shift(2),Se=O.l+Re,De=Te.f&&Te.f(O,Re,q);if(O.l=Se,Q(De,Te,oe))return}}}function e(O,Q){switch(Q.type){case"base64":return t(Ri(Li(O)),Q);case"binary":return t(Ri(O),Q);case"buffer":case"array":return t(O,Q)}throw"Unsupported type "+Q.type}function t(O,Q){if(!O)return O;var q=Q||{},ee=q.dense?[]:{},oe="Sheet1",Te="",Re=0,Se={},De=[],st=[],te={s:{r:0,c:0},e:{r:0,c:0}},St=q.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)q.Enum=Pe,r(O,function(Oe,nt,gt){switch(gt){case 0:q.vers=Oe,Oe>=4096&&(q.qpro=!0);break;case 6:te=Oe;break;case 204:Oe&&(Te=Oe);break;case 222:Te=Oe;break;case 15:case 51:q.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:gt==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=q.dateNF||ot[14],q.cellDates&&(Oe[1].t="d",Oe[1].v=Wp(Oe[1].v))),q.qpro&&Oe[3]>Re&&(ee["!ref"]=xt(te),Se[oe]=ee,De.push(oe),ee=q.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Re=Oe[3],oe=Te||"Sheet"+(Re+1),Te="");var Mt=q.dense?(ee[Oe[0].r]||[])[Oe[0].c]:ee[ut(Oe[0])];if(Mt){Mt.t=Oe[1].t,Mt.v=Oe[1].v,Oe[1].z!=null&&(Mt.z=Oe[1].z),Oe[1].f!=null&&(Mt.f=Oe[1].f);break}q.dense?(ee[Oe[0].r]||(ee[Oe[0].r]=[]),ee[Oe[0].r][Oe[0].c]=Oe[1]):ee[ut(Oe[0])]=Oe[1];break}},q);else if(O[2]==26||O[2]==14)q.Enum=J,O[2]==14&&(q.qpro=!0,O.l=0),r(O,function(Oe,nt,gt){switch(gt){case 204:oe=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>Re&&(ee["!ref"]=xt(te),Se[oe]=ee,De.push(oe),ee=q.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Re=Oe[3],oe="Sheet"+(Re+1)),St>0&&Oe[0].r>=St)break;q.dense?(ee[Oe[0].r]||(ee[Oe[0].r]=[]),ee[Oe[0].r][Oe[0].c]=Oe[1]):ee[ut(Oe[0])]=Oe[1],te.e.c<Oe[0].c&&(te.e.c=Oe[0].c),te.e.r<Oe[0].r&&(te.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(st[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:st[Oe[0]]=Oe[1],Oe[0]==Re&&(oe=Oe[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(ee["!ref"]=xt(te),Se[Te||oe]=ee,De.push(Te||oe),!st.length)return{SheetNames:De,Sheets:Se};for(var lt={},At=[],Xe=0;Xe<st.length;++Xe)Se[De[Xe]]?(At.push(st[Xe]||De[Xe]),lt[st[Xe]]=Se[st[Xe]]||Se[De[Xe]]):(At.push(st[Xe]),lt[st[Xe]]={"!ref":"A1"});return{SheetNames:At,Sheets:lt}}function n(O,Q){var q=Q||{};if(+q.codepage>=0&&aa(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=pi(),oe=Nt(O["!ref"]),Te=Array.isArray(O),Re=[];ze(ee,0,s(1030)),ze(ee,6,f(oe));for(var Se=Math.min(oe.e.r,8191),De=oe.s.r;De<=Se;++De)for(var st=Mr(De),te=oe.s.c;te<=oe.e.c;++te){De===oe.s.r&&(Re[te]=yr(te));var St=Re[te]+st,lt=Te?(O[De]||[])[te]:O[St];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?ze(ee,13,y(De,te,lt.v)):ze(ee,14,E(De,te,lt.v));else{var At=rs(lt);ze(ee,15,_(De,te,At.slice(0,239)))}}return ze(ee,1),ee.end()}function i(O,Q){var q=Q||{};if(+q.codepage>=0&&aa(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=pi();ze(ee,0,l(O));for(var oe=0,Te=0;oe<O.SheetNames.length;++oe)(O.Sheets[O.SheetNames[oe]]||{})["!ref"]&&ze(ee,27,ae(O.SheetNames[oe],Te++));var Re=0;for(oe=0;oe<O.SheetNames.length;++oe){var Se=O.Sheets[O.SheetNames[oe]];if(!(!Se||!Se["!ref"])){for(var De=Nt(Se["!ref"]),st=Array.isArray(Se),te=[],St=Math.min(De.e.r,8191),lt=De.s.r;lt<=St;++lt)for(var At=Mr(lt),Xe=De.s.c;Xe<=De.e.c;++Xe){lt===De.s.r&&(te[Xe]=yr(Xe));var Oe=te[Xe]+At,nt=st?(Se[lt]||[])[Xe]:Se[Oe];if(!(!nt||nt.t=="z"))if(nt.t=="n")ze(ee,23,V(lt,Xe,Re,nt.v));else{var gt=rs(nt);ze(ee,22,A(lt,Xe,Re,gt.slice(0,239)))}}++Re}}return ze(ee,1),ee.end()}function s(O){var Q=we(2);return Q.write_shift(2,O),Q}function l(O){var Q=we(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var q=0,ee=0,oe=0,Te=0;Te<O.SheetNames.length;++Te){var Re=O.SheetNames[Te],Se=O.Sheets[Re];if(!(!Se||!Se["!ref"])){++oe;var De=ai(Se["!ref"]);q<De.e.r&&(q=De.e.r),ee<De.e.c&&(ee=De.e.c)}}return q>8191&&(q=8191),Q.write_shift(2,q),Q.write_shift(1,oe),Q.write_shift(1,ee),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function c(O,Q,q){var ee={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&q.qpro?(ee.s.c=O.read_shift(1),O.l++,ee.s.r=O.read_shift(2),ee.e.c=O.read_shift(1),O.l++,ee.e.r=O.read_shift(2),ee):(ee.s.c=O.read_shift(2),ee.s.r=O.read_shift(2),Q==12&&q.qpro&&(O.l+=2),ee.e.c=O.read_shift(2),ee.e.r=O.read_shift(2),Q==12&&q.qpro&&(O.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function f(O){var Q=we(8);return Q.write_shift(2,O.s.c),Q.write_shift(2,O.s.r),Q.write_shift(2,O.e.c),Q.write_shift(2,O.e.r),Q}function d(O,Q,q){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(ee[0].c=O.read_shift(1),ee[3]=O.read_shift(1),ee[0].r=O.read_shift(2),O.l+=2):(ee[2]=O.read_shift(1),ee[0].c=O.read_shift(2),ee[0].r=O.read_shift(2)),ee}function m(O,Q,q){var ee=O.l+Q,oe=d(O,Q,q);if(oe[1].t="s",q.vers==20768){O.l++;var Te=O.read_shift(1);return oe[1].v=O.read_shift(Te,"utf8"),oe}return q.qpro&&O.l++,oe[1].v=O.read_shift(ee-O.l,"cstr"),oe}function _(O,Q,q){var ee=we(7+q.length);ee.write_shift(1,255),ee.write_shift(2,Q),ee.write_shift(2,O),ee.write_shift(1,39);for(var oe=0;oe<ee.length;++oe){var Te=q.charCodeAt(oe);ee.write_shift(1,Te>=128?95:Te)}return ee.write_shift(1,0),ee}function x(O,Q,q){var ee=d(O,Q,q);return ee[1].v=O.read_shift(2,"i"),ee}function y(O,Q,q){var ee=we(7);return ee.write_shift(1,255),ee.write_shift(2,Q),ee.write_shift(2,O),ee.write_shift(2,q,"i"),ee}function T(O,Q,q){var ee=d(O,Q,q);return ee[1].v=O.read_shift(8,"f"),ee}function E(O,Q,q){var ee=we(13);return ee.write_shift(1,255),ee.write_shift(2,Q),ee.write_shift(2,O),ee.write_shift(8,q,"f"),ee}function S(O,Q,q){var ee=O.l+Q,oe=d(O,Q,q);if(oe[1].v=O.read_shift(8,"f"),q.qpro)O.l=ee;else{var Te=O.read_shift(2);W(O.slice(O.l,O.l+Te),oe),O.l+=Te}return oe}function D(O,Q,q){var ee=Q&32768;return Q&=-32769,Q=(ee?O:0)+(Q>=8192?Q-16384:Q),(ee?"":"$")+(q?yr(Q):Mr(Q))}var U={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function W(O,Q){Nn(O,0);for(var q=[],ee=0,oe="",Te="",Re="",Se="";O.l<O.length;){var De=O[O.l++];switch(De){case 0:q.push(O.read_shift(8,"f"));break;case 1:Te=D(Q[0].c,O.read_shift(2),!0),oe=D(Q[0].r,O.read_shift(2),!1),q.push(Te+oe);break;case 2:{var st=D(Q[0].c,O.read_shift(2),!0),te=D(Q[0].r,O.read_shift(2),!1);Te=D(Q[0].c,O.read_shift(2),!0),oe=D(Q[0].r,O.read_shift(2),!1),q.push(st+te+":"+Te+oe)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(O.read_shift(2));break;case 6:{for(var St="";De=O[O.l++];)St+=String.fromCharCode(De);q.push('"'+St.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Se=q.pop(),Re=q.pop(),q.push(["AND","OR"][De-20]+"("+Re+","+Se+")");break;default:if(De<32&&k[De])Se=q.pop(),Re=q.pop(),q.push(Re+k[De]+Se);else if(U[De]){if(ee=U[De][1],ee==69&&(ee=O[O.l++]),ee>q.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+q.join("|")+"|");return}var lt=q.slice(-ee);q.length-=ee,q.push(U[De][0]+"("+lt.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}q.length==1?Q[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function Z(O){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=O.read_shift(2),Q[3]=O[O.l++],Q[0].c=O[O.l++],Q}function X(O,Q){var q=Z(O);return q[1].t="s",q[1].v=O.read_shift(Q-4,"cstr"),q}function A(O,Q,q,ee){var oe=we(6+ee.length);oe.write_shift(2,O),oe.write_shift(1,q),oe.write_shift(1,Q),oe.write_shift(1,39);for(var Te=0;Te<ee.length;++Te){var Re=ee.charCodeAt(Te);oe.write_shift(1,Re>=128?95:Re)}return oe.write_shift(1,0),oe}function R(O,Q){var q=Z(O);q[1].v=O.read_shift(2);var ee=q[1].v>>1;if(q[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return q[1].v=ee,q}function C(O,Q){var q=Z(O),ee=O.read_shift(4),oe=O.read_shift(4),Te=O.read_shift(2);if(Te==65535)return ee===0&&oe===3221225472?(q[1].t="e",q[1].v=15):ee===0&&oe===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Re=Te&32768;return Te=(Te&32767)-16446,q[1].v=(1-Re*2)*(oe*Math.pow(2,Te+32)+ee*Math.pow(2,Te)),q}function V(O,Q,q,ee){var oe=we(14);if(oe.write_shift(2,O),oe.write_shift(1,q),oe.write_shift(1,Q),ee==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var Te=0,Re=0,Se=0,De=0;return ee<0&&(Te=1,ee=-ee),Re=Math.log2(ee)|0,ee/=Math.pow(2,Re-31),De=ee>>>0,(De&2147483648)==0&&(ee/=2,++Re,De=ee>>>0),ee-=De,De|=2147483648,De>>>=0,ee*=Math.pow(2,32),Se=ee>>>0,oe.write_shift(4,Se),oe.write_shift(4,De),Re+=16383+(Te?32768:0),oe.write_shift(2,Re),oe}function N(O,Q){var q=C(O);return O.l+=Q-14,q}function M(O,Q){var q=Z(O),ee=O.read_shift(4);return q[1].v=ee>>6,q}function B(O,Q){var q=Z(O),ee=O.read_shift(8,"f");return q[1].v=ee,q}function ve(O,Q){var q=B(O);return O.l+=Q-10,q}function xe(O,Q){return O[O.l+Q-1]==0?O.read_shift(Q,"cstr"):""}function ne(O,Q){var q=O[O.l++];q>Q-1&&(q=Q-1);for(var ee="";ee.length<q;)ee+=String.fromCharCode(O[O.l++]);return ee}function le(O,Q,q){if(!(!q.qpro||Q<21)){var ee=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var oe=O.read_shift(Q-21,"cstr");return[ee,oe]}}function Le(O,Q){for(var q={},ee=O.l+Q;O.l<ee;){var oe=O.read_shift(2);if(oe==14e3){for(q[oe]=[0,""],q[oe][0]=O.read_shift(2);O[O.l];)q[oe][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return q}function ae(O,Q){var q=we(5+O.length);q.write_shift(2,14e3),q.write_shift(2,Q);for(var ee=0;ee<O.length;++ee){var oe=O.charCodeAt(ee);q[q.l++]=oe>127?95:oe}return q[q.l++]=0,q}var Pe={0:{n:"BOF",f:en},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:T},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})();function LF(r){var e={},t=r.match($n),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=ft(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=ox[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var VF=(function(){var r=a0("t"),e=a0("rPr");function t(s){var l=s.match(r);if(!l)return{t:"s",v:""};var c={t:"s",v:Bt(l[1])},f=s.match(e);return f&&(c.s=LF(f[1])),c}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(i).map(t).filter(function(c){return c.v})}})(),BF=(function(){var e=/(\r\n|\n)/g;function t(i,s,l){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),i.b&&(s.push("<b>"),l.push("</b>")),i.i&&(s.push("<i>"),l.push("</i>")),i.strike&&(s.push("<s>"),l.push("</s>"));var f=i.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),UF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,zF=/<(?:\w+:)?r>/,jF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ox(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Bt(fr(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=fr(r),t&&(n.h=px(n.t))):r.match(zF)&&(n.r=fr(r),n.t=Bt(fr((r.replace(jF,"").match(UF)||[]).join("").replace($n,""))),t&&(n.h=BF(VF(n.r)))),n):{t:""}}var HF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,GF=/<(?:\w+:)?(?:si|sstItem)>/g,qF=/<\/(?:\w+:)?(?:si|sstItem)>/;function KF(r,e){var t=[],n="";if(!r)return t;var i=r.match(HF);if(i){n=i[2].replace(GF,"").split(qF);for(var s=0;s!=n.length;++s){var l=Ox(n[s].trim(),e);l!=null&&(t[t.length]=l)}i=ft(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}var WF=/^\s|\s$|[\t\n\r]/;function vk(r,e){if(!e.bookSST)return"";var t=[Gr];t[t.length]=Ue("sst",null,{xmlns:Ec[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(WF)&&(s+=' xml:space="preserve"'),s+=">"+ar(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function XF(r){return[r.read_shift(4),r.read_shift(4)]}function YF(r,e){var t=[],n=!1;return qs(r,function(s,l,c){switch(c){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function $F(r,e){return e||(e=we(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var QF=oO;function JF(r){var e=pi();Ne(e,159,$F(r));for(var t=0;t<r.length;++t)Ne(e,19,QF(r[t]));return Ne(e,160),e.end()}function xk(r){if(typeof Vt<"u")return Vt.utils.encode(rc,r);for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Ls(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function ZF(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Ls(r,4),e.U=Ls(r,4),e.W=Ls(r,4),e}function e8(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},i=r.read_shift(4),s=[];i-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function t8(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(e8(r));return e}function r8(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function n8(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Ls(r,4),e.U=Ls(r,4),e.W=Ls(r,4),e}function i8(r){var e=n8(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function yk(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function Ek(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function a8(r){var e=Ls(r);switch(e.Minor){case 2:return[e.Minor,s8(r)];case 3:return[e.Minor,o8()];case 4:return[e.Minor,l8(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function s8(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=yk(r,t),i=Ek(r,r.length-r.l);return{t:"Std",h:n,v:i}}function o8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function l8(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace($n,function(s){var l=ft(s);switch(ss(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=l[c]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function c8(r,e){var t={},n=t.EncryptionVersionInfo=Ls(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var i=r.read_shift(4);return e-=4,t.EncryptionHeader=yk(r,i),e-=i,t.EncryptionVerifier=Ek(r,e),t}function u8(r){var e={},t=e.EncryptionVersionInfo=Ls(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function Fx(r){var e=0,t,n=xk(r),i=n.length+1,s,l,c,f,d;for(t=Qo(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)l=t[s],c=(e&16384)===0?0:1,f=e<<1&32767,d=c|f,e=d^l;return e^52811}var Tk=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},i=function(l,c){return n(l^c)},s=function(l){for(var c=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],_=0;_!=7;++_)m&64&&(c^=t[f]),m*=2,--f;return c};return function(l){for(var c=xk(l),f=s(c),d=c.length,m=Qo(16),_=0;_!=16;++_)m[_]=0;var x,y,T;for((d&1)===1&&(x=f>>8,m[d]=i(r[0],x),--d,x=f&255,y=c[c.length-1],m[d]=i(y,x));d>0;)--d,x=f>>8,m[d]=i(c[d],x),--d,x=f&255,m[d]=i(c[d],x);for(d=15,T=15-c.length;T>0;)x=f>>8,m[d]=i(r[T],x),--d,--T,x=f&255,m[d]=i(c[d],x),--d,--T;return m}})(),f8=function(r,e,t,n,i){i||(i=e),n||(n=Tk(r));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=n[t],l=(l>>5|l<<3)&255,i[s]=l,++t;return[i,t,n]},h8=function(r){var e=0,t=Tk(r);return function(n){var i=f8("",n,e,t);return e=i[1],i[0]}};function d8(r,e,t,n){var i={key:en(r),verificationBytes:en(r)};return t.password&&(i.verifier=Fx(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=h8(t.password)),i}function m8(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=u8(r):n.Data=c8(r,e),n}function p8(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?m8(r,e-2,n):d8(r,t.biff>=8?e:e-2,t,n),n}var wk=(function(){function r(i,s){switch(s.type){case"base64":return e(Li(i),s);case"binary":return e(i,s);case"buffer":return e(Tt&&Buffer.isBuffer(i)?i.toString("binary"):sl(i),s);case"array":return e(ic(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var l=s||{},c=l.dense?[]:{},f=i.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,_){Array.isArray(c)&&(c[_]=[]);for(var x=/\\\w+\b/g,y=0,T,E=-1;T=x.exec(m);){switch(T[0]){case"\\cell":var S=m.slice(y,x.lastIndex-T[0].length);if(S[0]==" "&&(S=S.slice(1)),++E,S.length){var D={v:S,t:"s"};Array.isArray(c)?c[_][E]=D:c[ut({r:_,c:E})]=D}break}y=x.lastIndex}E>d.e.c&&(d.e.c=E)}),c["!ref"]=xt(d),c}function t(i,s){return ol(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],l=Nt(i["!ref"]),c,f=Array.isArray(i),d=l.s.r;d<=l.e.r;++d){s.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var _=ut({r:d,c:m});c=f?(i[d]||[])[m]:i[_],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(rs(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}})();function g8(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function c0(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function _8(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(e,t,n),s=Math.min(e,t,n),l=i-s;if(l===0)return[0,0,e];var c=0,f=0,d=i+s;switch(f=l/(d>1?2-d:d),i){case e:c=((t-n)/l+6)%6;break;case t:c=(n-e)/l+2;break;case n:c=(e-t)/l+4;break}return[c/6,f,d/2]}function v8(r){var e=r[0],t=r[1],n=r[2],i=t*2*(n<.5?n:1-n),s=n-i/2,l=[s,s,s],c=6*e,f;if(t!==0)switch(c|0){case 0:case 6:f=i*c,l[0]+=i,l[1]+=f;break;case 1:f=i*(2-c),l[0]+=f,l[1]+=i;break;case 2:f=i*(c-2),l[1]+=i,l[2]+=f;break;case 3:f=i*(4-c),l[1]+=f,l[2]+=i;break;case 4:f=i*(c-4),l[2]+=i,l[0]+=f;break;case 5:f=i*(6-c),l[2]+=f,l[0]+=i;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function mp(r,e){if(e===0)return r;var t=_8(g8(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),c0(v8(t))}var Sk=6,x8=15,y8=1,Gn=Sk;function u0(r){return Math.floor((r+Math.round(128/Gn)/256)*Gn)}function f0(r){return Math.floor((r-5)/Gn*100+.5)/100}function pp(r){return Math.round((r*Gn+5)/Gn*256)/256}function P_(r){return pp(f0(u0(r)))}function Px(r){var e=Math.abs(r-P_(r)),t=Gn;if(e>.005)for(Gn=y8;Gn<x8;++Gn)Math.abs(r-P_(r))<=e&&(e=Math.abs(r-P_(r)),t=Gn);Gn=t}function Jo(r){r.width?(r.wpx=u0(r.width),r.wch=f0(r.wpx),r.MDW=Gn):r.wpx?(r.wch=f0(r.wpx),r.width=pp(r.wch),r.MDW=Gn):typeof r.wch=="number"&&(r.width=pp(r.wch),r.wpx=u0(r.width),r.MDW=Gn),r.customWidth&&delete r.customWidth}var E8=96,Ak=E8;function h0(r){return r*96/Ak}function Wu(r){return r*Ak/96}var T8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function w8(r,e,t,n){e.Borders=[];var i={},s=!1;(r[0].match($n)||[]).forEach(function(l){var c=ft(l);switch(ss(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=xr(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=xr(c.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function S8(r,e,t,n){e.Fills=[];var i={},s=!1;(r[0].match($n)||[]).forEach(function(l){var c=ft(l);switch(ss(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function A8(r,e,t,n){e.Fonts=[];var i={},s=!1;(r[0].match($n)||[]).forEach(function(l){var c=ft(l);switch(ss(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=fr(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?xr(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?xr(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?xr(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?xr(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?xr(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?xr(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?xr(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=ox[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=xr(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var f=Xl[i.color.index];i.color.index==81&&(f=Xl[1]),f||(f=Xl[1]),i.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=mp(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function b8(r,e,t){e.NumberFmt=[];for(var n=Vr(ot),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ot[n[i]];var s=r[0].match($n);if(s)for(i=0;i<s.length;++i){var l=ft(s[i]);switch(ss(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Bt(fr(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=c}Ja(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function I8(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=Ue("numFmt",null,{numFmtId:n,formatCode:ar(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var km=["numFmtId","fillId","fontId","borderId","xfId"],Cm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function k8(r,e,t){e.CellXf=[];var n,i=!1;(r[0].match($n)||[]).forEach(function(s){var l=ft(s),c=0;switch(ss(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],c=0;c<km.length;++c)n[km[c]]&&(n[km[c]]=parseInt(n[km[c]],10));for(c=0;c<Cm.length;++c)n[Cm[c]]&&(n[Cm[c]]=xr(n[Cm[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=xr(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function C8(r){var e=[];return e[e.length]=Ue("cellXfs",null),r.forEach(function(t){e[e.length]=Ue("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var R8=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var m={};if(!c)return m;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=c.match(e))&&b8(_,m,d),(_=c.match(i))&&A8(_,m,f,d),(_=c.match(n))&&S8(_,m,f,d),(_=c.match(s))&&w8(_,m,f,d),(_=c.match(t))&&k8(_,m,d),m}})();function bk(r,e){var t=[Gr,Ue("styleSheet",null,{xmlns:Ec[0],"xmlns:vt":ln.vt})],n;return r.SSF&&(n=I8(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=C8(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function D8(r,e){var t=r.read_shift(2),n=Wn(r);return[t,n]}function N8(r,e,t){t||(t=we(6+4*e.length)),t.write_shift(2,r),xn(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function O8(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=mO(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=r.read_shift(1);l!=0&&(n.underline=l);var c=r.read_shift(1);c>0&&(n.family=c);var f=r.read_shift(1);switch(f>0&&(n.charset=f),r.l++,n.color=dO(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wn(r),n}function F8(r,e){e||(e=we(153)),e.write_shift(2,r.sz*20),pO(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),fp(r.color,e);var n=0;return n=2,e.write_shift(1,n),xn(r.name,e),e.length>e.l?e.slice(0,e.l):e}var P8=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],M_,M8=Yn;function NS(r,e){e||(e=we(84)),M_||(M_=qp(P8));var t=M_[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(fp({auto:1},e),fp({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function L8(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function Ik(r,e,t){t||(t=we(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function vh(r,e){return e||(e=we(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var V8=Yn;function B8(r,e){return e||(e=we(51)),e.write_shift(1,0),vh(null,e),vh(null,e),vh(null,e),vh(null,e),vh(null,e),e.length>e.l?e.slice(0,e.l):e}function U8(r,e){return e||(e=we(52)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),up(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function z8(r,e,t){var n=we(2052);return n.write_shift(4,r),up(e,n),up(t,n),n.length>n.l?n.slice(0,n.l):n}function j8(r,e,t){var n={};n.NumberFmt=[];for(var i in ot)n.NumberFmt[i]=ot[i];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return qs(r,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],Ja(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=mp(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(m),l=!0;break;case 38:s.pop(),l=!1;break;default:if(d.T>0)s.push(m);else if(d.T<0)s.pop();else if(!l||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function H8(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(Ne(r,615,Ca(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ne(r,44,N8(i,e[i]))}),Ne(r,616))}}function G8(r){var e=1;Ne(r,611,Ca(e)),Ne(r,43,F8({sz:12,color:{theme:1},name:"Calibri",family:2})),Ne(r,612)}function q8(r){var e=2;Ne(r,603,Ca(e)),Ne(r,45,NS({patternType:"none"})),Ne(r,45,NS({patternType:"gray125"})),Ne(r,604)}function K8(r){var e=1;Ne(r,613,Ca(e)),Ne(r,46,B8()),Ne(r,614)}function W8(r){var e=1;Ne(r,626,Ca(e)),Ne(r,47,Ik({numFmtId:0},65535)),Ne(r,627)}function X8(r,e){Ne(r,617,Ca(e.length)),e.forEach(function(t){Ne(r,47,Ik(t,0))}),Ne(r,618)}function Y8(r){var e=1;Ne(r,619,Ca(e)),Ne(r,48,U8({xfId:0,name:"Normal"})),Ne(r,620)}function $8(r){var e=0;Ne(r,505,Ca(e)),Ne(r,506)}function Q8(r){var e=0;Ne(r,508,z8(e,"TableStyleMedium9","PivotStyleMedium4")),Ne(r,509)}function J8(r,e){var t=pi();return Ne(t,278),H8(t,r.SSF),G8(t),q8(t),K8(t),W8(t),X8(t,e.cellXfs),Y8(t),$8(t),Q8(t),Ne(t,279),t.end()}var Z8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function eP(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match($n)||[]).forEach(function(i){var s=ft(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Z8.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function tP(){}function rP(){}var nP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,iP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sP(r,e,t){e.themeElements={};var n;[["clrScheme",nP,eP],["fontScheme",iP,tP],["fmtScheme",aP,rP]].forEach(function(i){if(!(n=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,t)})}var oP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function kk(r,e){(!r||r.length===0)&&(r=Mx());var t,n={};if(!(t=r.match(oP)))throw new Error("themeElements not found in theme");return sP(t[0],n,e),n.raw=r,n}function Mx(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Gr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function lP(r,e,t){var n=r.l+e,i=r.read_shift(4);if(i!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var l;try{l=SI(s,{type:"array"})}catch{return}var c=Di(l,"theme/theme/theme1.xml",!0);if(c)return kk(c,t)}}function cP(r){return r.read_shift(4)}function uP(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=fP(r,4);break;case 2:e.xclrValue=ok(r);break;case 3:e.xclrValue=cP(r);break;case 4:r.l+=4;break}return r.l+=8,e}function fP(r,e){return Yn(r,e)}function hP(r,e){return Yn(r,e)}function dP(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=uP(r);break;case 6:n[1]=hP(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function mP(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),s=[];i-- >0;)s.push(dP(r,t-r.l));return{ixfe:n,ext:s}}function pP(r,e){e.forEach(function(t){t[0]})}function gP(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Wn(r)}}function _P(r){var e=we(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),xn(r.name,e),e.slice(0,e.l)}function vP(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function xP(r){var e=we(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function yP(r,e){var t=we(8+2*e.length);return t.write_shift(4,r),xn(e,t),t.slice(0,t.l)}function EP(r){return r.l+=4,r.read_shift(4)!=0}function TP(r,e){var t=we(8);return t.write_shift(4,r),t.write_shift(4,1),t}function wP(r,e,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],l=!1,c=2;return qs(r,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(_){c==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):c==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:s.push(m),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!d.T){if(!l||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function SP(){var r=pi();return Ne(r,332),Ne(r,334,Ca(1)),Ne(r,335,_P({name:"XLDAPR",version:12e4,flags:3496657072})),Ne(r,336),Ne(r,339,yP(1,"XLDAPR")),Ne(r,52),Ne(r,35,Ca(514)),Ne(r,4096,Ca(0)),Ne(r,4097,ia(1)),Ne(r,36),Ne(r,53),Ne(r,340),Ne(r,337,TP(1)),Ne(r,51,xP([[1,0]])),Ne(r,338),Ne(r,333),r.end()}function AP(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var i=!1,s=2,l;return r.replace($n,function(c){var f=ft(c);switch(ss(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):s==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),n}function Ck(){var r=[Gr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function bP(r){var e=[];if(!r)return e;var t=1;return(r.match($n)||[]).forEach(function(n){var i=ft(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function IP(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=ut(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function kP(r,e,t){var n=[];return qs(r,function(s,l,c){switch(c){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function CP(r,e,t,n){if(!r)return r;var i=n||{},s=!1;qs(r,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function RP(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var Nu=1024;function Rk(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[Ue("xml",null,{"xmlns:v":Ci.v,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:mv":Ci.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Nu<r*1e3;)Nu+=1e3;return e.forEach(function(s){var l=Dr(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ue("v:fill",f,c),m={on:"t",obscured:"t"};++Nu,i=i.concat(["<v:shape"+s0({id:"_x0000_s"+Nu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ue("v:shadow",null,m),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",On("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),On("x:AutoFill","False"),On("x:Row",String(l.r)),On("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function OS(r,e,t,n){var i=Array.isArray(r),s;e.forEach(function(l){var c=Dr(l.ref);if(i?(r[c.r]||(r[c.r]=[]),s=r[c.r][c.c]):s=r[l.ref],!s){s={t:"z"},i?r[c.r][c.c]=s:r[l.ref]=s;var f=Nt(r["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=xt(f);d!==r["!ref"]&&(r["!ref"]=d)}s.c||(s.c=[]);var m={a:l.author,t:l.t,r:l.r,T:t};l.h&&(m.h=l.h);for(var _=s.c.length-1;_>=0;--_){if(!t&&s.c[_].T)return;t&&!s.c[_].T&&s.c.splice(_,1)}if(t&&n){for(_=0;_<n.length;++_)if(m.a==n[_].id){m.a=n[_].name||m.a;break}}s.c.push(m)})}function DP(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=ft(c[0]),d={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=Dr(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var _=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!_&&!!_[1]&&Ox(_[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function Dk(r){var e=[Gr,Ue("comments",null,{xmlns:Ec[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var s=ar(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(i=t.indexOf(ar(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(On("t",ar(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)l+=`Reply:
    `+s[c]+`
`;e.push(On("t",ar(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function NP(r,e){var t=[],n=!1,i={},s=0;return r.replace($n,function(c,f){var d=ft(c);switch(ss(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=f+c.length;break;case"</text>":i.t=r.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),t}function OP(r,e,t){var n=[Gr,Ue("ThreadedComments",null,{xmlns:ln.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var s="";(i[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(Ue("threadedComment",On("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function FP(r,e){var t=[],n=!1;return r.replace($n,function(s){var l=ft(s);switch(ss(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),t}function PP(r){var e=[Gr,Ue("personList",null,{xmlns:ln.TCMNT,"xmlns:x":Ec[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(Ue("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function MP(r){var e={};e.iauthor=r.read_shift(4);var t=Ac(r);return e.rfx=t.s,e.ref=ut(t.s),r.l+=16,e}function LP(r,e){return e==null&&(e=we(36)),e.write_shift(4,r[1].iauthor),df(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var VP=Wn;function BP(r){return xn(r.slice(0,54))}function UP(r,e){var t=[],n=[],i={},s=!1;return qs(r,function(c,f,d){switch(d){case 632:n.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}function zP(r){var e=pi(),t=[];return Ne(e,628),Ne(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ne(e,632,BP(i.a)))})}),Ne(e,631),Ne(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Dr(n[0]),e:Dr(n[0])};Ne(e,635,LP([s,i])),i.t&&i.t.length>0&&Ne(e,637,cO(i)),Ne(e,636),delete i.iauthor})}),Ne(e,634),Ne(e,629),e.end()}var jP="application/vnd.ms-office.vbaProject";function HP(r){var e=it.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(e,i,r.FileIndex[n].content)}}),it.write(e)}function GP(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&it.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var Nk=["xlsb","xlsm","xlam","biff8","xla"];function qP(){return{"!type":"dialog"}}function KP(){return{"!type":"dialog"}}function WP(){return{"!type":"macro"}}function XP(){return{"!type":"macro"}}var Lu=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,l){var c=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return c?m+=e.c:--m,f?d+=e.r:--d,i+(c?"":"$")+yr(m)+(f?"":"$")+Mr(d)}return function(i,s){return e=s,i.replace(r,t)}})(),Lx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Vx=(function(){return function(e,t){return e.replace(Lx,function(n,i,s,l,c,f){var d=Sx(l)-(s?0:t.c),m=wx(f)-(c?0:t.r),_=m==0?"":c?m+1:"["+m+"]",x=d==0?"":s?d+1:"["+d+"]";return i+"R"+_+"C"+x})}})();function Ok(r,e){return r.replace(Lx,function(t,n,i,s,l,c){return n+(i=="$"?i+s:yr(Sx(s)+e.c))+(l=="$"?l+c:Mr(wx(c)+e.r))})}function YP(r,e,t){var n=ai(e),i=n.s,s=Dr(t),l={r:s.r-i.r,c:s.c-i.c};return Ok(r,l)}function $P(r){return r.length!=1}function FS(r){return r.replace(/_xlfn\./g,"")}function Qr(r){r.l+=1}function Zo(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Fk(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Pk(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),l=Zo(r),c=Zo(r);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function Pk(r){var e=Zo(r),t=Zo(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function QP(r,e,t){if(t.biff<8)return Pk(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=Zo(r),l=Zo(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Mk(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return JP(r);var n=r.read_shift(t&&t.biff==12?4:2),i=Zo(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function JP(r){var e=Zo(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function ZP(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function eM(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return tM(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;i>524287;)i-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:l,rRel:c}}function tM(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function rM(r,e,t){var n=(r[r.l++]&96)>>5,i=Fk(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function nM(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var l=Fk(r,s,t);return[n,i,l]}function iM(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function aM(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function sM(r,e,t){var n=(r[r.l++]&96)>>5,i=QP(r,e-1,t);return[n,i]}function oM(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function PS(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function lM(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function cM(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function uM(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function fM(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function hM(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function Lk(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function dM(r){return r.read_shift(2),Lk(r)}function mM(r){return r.read_shift(2),Lk(r)}function pM(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=Mk(r,0,t);return[n,i]}function gM(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=eM(r,0,t);return[n,i]}function _M(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=Mk(r,0,t);return[n,i,s]}function vM(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[E9[i],Uk[i],n]}function xM(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:yM(r);return[i,(s[0]===0?Uk:y9)[s[1]]]}function yM(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function EM(r,e,t){r.l+=t&&t.biff==2?3:4}function TM(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function wM(r){return r.l++,Ks[r.read_shift(1)]}function SM(r){return r.l++,r.read_shift(2)}function AM(r){return r.l++,r.read_shift(1)!==0}function bM(r){return r.l++,qn(r)}function IM(r,e,t){return r.l++,M0(r,e-1,t)}function kM(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=jr(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Ks[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=qn(r);break;case 2:t[1]=bc(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function CM(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?Ac:Yp)(r));return i}function RM(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var c=0;c!=i;++c)l[s][c]=kM(r,t.biff);return l}function DM(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function NM(r,e,t){if(t.biff==5)return OM(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function OM(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function FM(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function PM(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function MM(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function LM(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var VM=Yn,BM=Yn,UM=Yn;function V0(r,e,t){return r.l+=2,[ZP(r)]}function Bx(r){return r.l+=6,[]}var zM=V0,jM=Bx,HM=Bx,GM=V0;function Vk(r){return r.l+=2,[en(r),r.read_shift(2)&1]}var qM=V0,KM=Vk,WM=Bx,XM=V0,YM=V0,$M=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QM(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),l=$M[t>>2&31];return{ixti:e,coltype:t&3,rt:l,idx:n,c:i,C:s}}function JM(r){return r.l+=2,[r.read_shift(4)]}function ZM(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function e9(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function t9(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function r9(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function n9(r){return r.l+=4,[0,0]}var MS={1:{n:"PtgExp",f:TM},2:{n:"PtgTbl",f:UM},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:IM},26:{n:"PtgSheet",f:ZM},27:{n:"PtgEndSheet",f:e9},28:{n:"PtgErr",f:wM},29:{n:"PtgBool",f:AM},30:{n:"PtgInt",f:SM},31:{n:"PtgNum",f:bM},32:{n:"PtgArray",f:oM},33:{n:"PtgFunc",f:vM},34:{n:"PtgFuncVar",f:xM},35:{n:"PtgName",f:DM},36:{n:"PtgRef",f:pM},37:{n:"PtgArea",f:rM},38:{n:"PtgMemArea",f:FM},39:{n:"PtgMemErr",f:VM},40:{n:"PtgMemNoMem",f:BM},41:{n:"PtgMemFunc",f:PM},42:{n:"PtgRefErr",f:MM},43:{n:"PtgAreaErr",f:iM},44:{n:"PtgRefN",f:gM},45:{n:"PtgAreaN",f:sM},46:{n:"PtgMemAreaN",f:t9},47:{n:"PtgMemNoMemN",f:r9},57:{n:"PtgNameX",f:NM},58:{n:"PtgRef3d",f:_M},59:{n:"PtgArea3d",f:nM},60:{n:"PtgRefErr3d",f:LM},61:{n:"PtgAreaErr3d",f:aM},255:{}},i9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},a9={1:{n:"PtgElfLel",f:Vk},2:{n:"PtgElfRw",f:XM},3:{n:"PtgElfCol",f:zM},6:{n:"PtgElfRwV",f:YM},7:{n:"PtgElfColV",f:GM},10:{n:"PtgElfRadical",f:qM},11:{n:"PtgElfRadicalS",f:WM},13:{n:"PtgElfColS",f:jM},15:{n:"PtgElfColSV",f:HM},16:{n:"PtgElfRadicalLel",f:KM},25:{n:"PtgList",f:QM},29:{n:"PtgSxName",f:JM},255:{}},s9={0:{n:"PtgAttrNoop",f:n9},1:{n:"PtgAttrSemi",f:hM},2:{n:"PtgAttrIf",f:uM},4:{n:"PtgAttrChoose",f:lM},8:{n:"PtgAttrGoto",f:cM},16:{n:"PtgAttrSum",f:EM},32:{n:"PtgAttrBaxcel",f:PS},33:{n:"PtgAttrBaxcel",f:PS},64:{n:"PtgAttrSpace",f:dM},65:{n:"PtgAttrSpaceSemi",f:mM},128:{n:"PtgAttrIfError",f:fM},255:{}};function B0(r,e,t,n){if(n.biff<8)return Yn(r,e);for(var i=r.l+e,s=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=RM(r,0,n),s.push(t[l][1]);break;case"PtgMemArea":t[l][2]=CM(r,t[l][1],n),s.push(t[l][2]);break;case"PtgExp":n&&n.biff==12&&(t[l][1][1]=r.read_shift(4),s.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return e=i-r.l,e!==0&&s.push(Yn(r,e)),s}function U0(r,e,t){for(var n=r.l+e,i,s,l=[];n!=r.l;)e=n-r.l,s=r[r.l],i=MS[s]||MS[i9[s]],(s===24||s===25)&&(i=(s===24?a9:s9)[r[r.l+1]]),!i||!i.f?Yn(r,e):l.push([i.n,i.f(r,e,t)]);return l}function o9(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:i.push('"'+l[1].replace(/"/g,'""')+'"');break;default:i.push(l[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var l9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function c9(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function Bk(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function LS(r,e,t){var n=Bk(r,e,t);return n=="#REF"?n:c9(n,t)}function Hn(r,e,t,n,i){var s=i&&i.biff||8,l={s:{c:0,r:0}},c=[],f,d,m,_=0,x=0,y,T="";if(!r[0]||!r[0][0])return"";for(var E=-1,S="",D=0,U=r[0].length;D<U;++D){var k=r[0][D];switch(k[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),E>=0){switch(r[0][E][1][0]){case 0:S=Fr(" ",r[0][E][1][1]);break;case 1:S=Fr("\r",r[0][E][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][E][1][0])}d=d+S,E=-1}c.push(d+l9[k[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Mh(k[1][1],l,i),c.push(Lh(m,s));break;case"PtgRefN":m=t?Mh(k[1][1],t,i):k[1][1],c.push(Lh(m,s));break;case"PtgRef3d":_=k[1][1],m=Mh(k[1][2],l,i),T=LS(n,_,i),c.push(T+"!"+Lh(m,s));break;case"PtgFunc":case"PtgFuncVar":var W=k[1][0],Z=k[1][1];W||(W=0),W&=127;var X=W==0?[]:c.slice(-W);c.length-=W,Z==="User"&&(Z=X.shift()),c.push(Z+"("+X.join(",")+")");break;case"PtgBool":c.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(k[1]);break;case"PtgNum":c.push(String(k[1]));break;case"PtgStr":c.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(k[1]);break;case"PtgAreaN":y=hS(k[1][1],t?{s:t}:l,i),c.push(N_(y,i));break;case"PtgArea":y=hS(k[1][1],l,i),c.push(N_(y,i));break;case"PtgArea3d":_=k[1][1],y=k[1][2],T=LS(n,_,i),c.push(T+"!"+N_(y,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=k[1][2];var A=(n.names||[])[x-1]||(n[0]||[])[x],R=A?A.Name:"SH33TJSNAME"+String(x);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),c.push(R);break;case"PtgNameX":var C=k[1][1];x=k[1][2];var V;if(i.biff<=5)C<0&&(C=-C),n[C]&&(V=n[C][x]);else{var N="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][x]&&n[C][x].itab>0&&(N=n.SheetNames[n[C][x].itab-1]+"!"):N=n.SheetNames[x-1]+"!"),n[C]&&n[C][x])N+=n[C][x].Name;else if(n[0]&&n[0][x])N+=n[0][x].Name;else{var M=(Bk(n,C,i)||"").split(";;");M[x-1]?N=M[x-1]:N+="SH33TJSERRX"}c.push(N);break}V||(V={Name:"SH33TJSERRY"}),c.push(V.Name);break;case"PtgParen":var B="(",ve=")";if(E>=0){switch(S="",r[0][E][1][0]){case 2:B=Fr(" ",r[0][E][1][1])+B;break;case 3:B=Fr("\r",r[0][E][1][1])+B;break;case 4:ve=Fr(" ",r[0][E][1][1])+ve;break;case 5:ve=Fr("\r",r[0][E][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][E][1][0])}E=-1}c.push(B+c.pop()+ve);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":m={c:k[1][1],r:k[1][0]};var xe={c:t.c,r:t.r};if(n.sharedf[ut(m)]){var ne=n.sharedf[ut(m)];c.push(Hn(ne,l,xe,n,i))}else{var le=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){c.push(Hn(d[1],l,xe,n,i)),le=!0;break}le||c.push(k[1])}break;case"PtgArray":c.push("{"+o9(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var Le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&E>=0&&Le.indexOf(r[0][D][0])==-1){k=r[0][E];var ae=!0;switch(k[1][0]){case 4:ae=!1;case 0:S=Fr(" ",k[1][1]);break;case 5:ae=!1;case 1:S=Fr("\r",k[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}c.push((ae?S:"")+c.pop()+(ae?"":S)),E=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function u9(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,l=r.read_shift(i);if(l==65535)return[[],Yn(r,e-2)];var c=U0(r,l,t);return e!==l+i&&(s=B0(r,e-l-i,c,t)),r.l=n,[c,s]}function f9(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,l=r.read_shift(i);if(l==65535)return[[],Yn(r,e-2)];var c=U0(r,l,t);return e!==l+i&&(s=B0(r,e-l-i,c,t)),r.l=n,[c,s]}function h9(r,e,t,n){var i=r.l+e,s=U0(r,n,t),l;return i!==r.l&&(l=B0(r,i-r.l,s,t)),[s,l]}function d9(r,e,t){var n=r.l+e,i,s=r.read_shift(2),l=U0(r,s,t);return s==65535?[[],Yn(r,e-2)]:(e!==s+2&&(i=B0(r,n-s-2,l,t)),[l,i])}function m9(r){var e;if(Ns(r,r.l+6)!==65535)return[qn(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function p9(r){if(r==null){var e=we(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return ac(r);return ac(0)}function L_(r,e,t){var n=r.l+e,i=os(r);t.biff==2&&++r.l;var s=m9(r),l=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var c=f9(r,n-r.l,t);return{cell:i,val:s[0],formula:c,shared:l>>3&1,tt:s[1]}}function g9(r,e,t,n,i){var s=oc(e,t,i),l=p9(r.v),c=we(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var d=we(r.bf.length),m=0;m<r.bf.length;++m)d[m]=r.bf[m];var _=vn([s,l,c,d]);return _}function $p(r,e,t){var n=r.read_shift(4),i=U0(r,n,t),s=r.read_shift(4),l=s>0?B0(r,s,i,t):null;return[i,l]}var _9=$p,Qp=$p,v9=$p,x9=$p,y9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Uk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},E9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function VS(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function T9(r){var e="of:="+r.replace(Lx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function V_(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function w9(r){return r.replace(/\./,"!")}var Bh={},Vu={},Uh=typeof Map<"u";function Ux(r,e,t){var n=0,i=r.length;if(t){if(Uh?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Uh?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(Uh?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Jp(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(Gn=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=f0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=pp(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Ql(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function ll(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,s=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){Ja(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(r[i].numFmtId===n)return i;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function zk(r,e,t,n,i,s){try{n.cellNF&&(r.z=ot[e])}catch(c){if(n.WTF)throw c}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Er(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(ot[e]==null&&Ja(x5[e]||"General",e),r.t==="e")r.w=r.w||Ks[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=i0(r.v);else if(r.t==="d"){var l=cn(r.v);(l|0)===l?r.w=l.toString(10):r.w=i0(l)}else{if(r.v===void 0)return"";r.w=nc(r.v,Vu)}else r.t==="d"?r.w=Vi(e,cn(r.v),Vu):r.w=Vi(e,r.v,Vu)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=mp(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=mp(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&s.Fills)throw c}}}function S9(r,e,t){if(r&&r["!ref"]){var n=Nt(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function A9(r,e){var t=Nt(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=xt(t))}var b9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,I9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,k9=/<(?:\w:)?hyperlink [^>]*>/mg,C9=/"(\w*:\w*)"/,R9=/<(?:\w:)?col\b[^>]*[\/]?>/g,D9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,N9=/<(?:\w:)?pageMargins[^>]*\/>/g,jk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,O9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,F9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function P9(r,e,t,n,i,s,l){if(!r)return r;n||(n={"!id":{}});var c=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",_=r.match(I9);_?(d=r.slice(0,_.index),m=r.slice(_.index+_[0].length)):d=m=r;var x=d.match(jk);x?zx(x[0],c,i,t):(x=d.match(O9))&&L9(x[0],x[1]||"",c,i,t);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var T=d.slice(y,y+50).match(C9);T&&A9(c,T[1])}var E=d.match(F9);E&&E[1]&&$9(E[1],i);var S=[];if(e.cellStyles){var D=d.match(R9);D&&q9(S,D)}_&&Z9(_[1],c,e,f,s,l);var U=m.match(D9);U&&(c["!autofilter"]=W9(U[0]));var k=[],W=m.match(b9);if(W)for(y=0;y!=W.length;++y)k[y]=Nt(W[y].slice(W[y].indexOf('"')+1));var Z=m.match(k9);Z&&j9(c,Z,n);var X=m.match(N9);if(X&&(c["!margins"]=H9(ft(X[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=xt(f)),e.sheetRows>0&&c["!ref"]){var A=Nt(c["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),c["!fullref"]=c["!ref"],c["!ref"]=xt(A))}return S.length>0&&(c["!cols"]=S),k.length>0&&(c["!merges"]=k),c}function M9(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+xt(r[t])+'"/>';return e+"</mergeCells>"}function zx(r,e,t,n){var i=ft(r);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=Bt(fr(i.codeName)))}function L9(r,e,t,n,i){zx(r.slice(0,r.indexOf(">")),t,n,i)}function V9(r,e,t,n,i){var s=!1,l={},c=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[t];try{e.Workbook&&(f=e.Workbook.Sheets[t].CodeName||f)}catch{}s=!0,l.codeName=Ya(ar(f))}if(r&&r["!outline"]){var d={summaryBelow:1,summaryRight:1};r["!outline"].above&&(d.summaryBelow=0),r["!outline"].left&&(d.summaryRight=0),c=(c||"")+Ue("outlinePr",null,d)}!s&&!c||(i[i.length]=Ue("sheetPr",c,l))}var B9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],U9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function z9(r){var e={sheet:1};return B9.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),U9.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=Fx(r.password).toString(16).toUpperCase()),Ue("sheetProtection",null,e)}function j9(r,e,t){for(var n=Array.isArray(r),i=0;i!=e.length;++i){var s=ft(fr(e[i]),!0);if(!s.ref)return;var l=((t||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Bt(s.location))):(s.Target="#"+Bt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=Nt(s.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var m=ut({c:d,r:f});n?(r[f]||(r[f]=[]),r[f][d]||(r[f][d]={t:"z",v:void 0}),r[f][d].l=s):(r[m]||(r[m]={t:"z",v:void 0}),r[m].l=s)}}}function H9(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function G9(r){return Ql(r),Ue("pageMargins",null,r)}function q9(r,e){for(var t=!1,n=0;n!=e.length;++n){var i=ft(e[n],!0);i.hidden&&(i.hidden=xr(i.hidden));var s=parseInt(i.min,10)-1,l=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,Px(i.width)),Jo(i);s<=l;)r[s++]=pr(i)}}function K9(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=Ue("col",null,Jp(i,n)));return t[t.length]="</cols>",t.join("")}function W9(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function X9(r,e,t,n){var i=typeof r.ref=="string"?r.ref:xt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,l=ai(i);l.s.r==l.e.r&&(l.e.r=ai(e["!ref"]).e.r,i=xt(l));for(var c=0;c<s.length;++c){var f=s[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),Ue("autoFilter",null,{ref:i})}var Y9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $9(r,e){e.Views||(e.Views=[{}]),(r.match(Y9)||[]).forEach(function(t,n){var i=ft(t);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),xr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function Q9(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,i),{})}function J9(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",s=r.t,l=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=Ks[r.v];break;case"d":n&&n.cellDates?i=Er(r.v,-1).toISOString():(r=pr(r),r.t="n",i=""+(r.v=cn(Er(r.v)))),typeof r.z>"u"&&(r.z=ot[14]);break;default:i=r.v;break}var c=On("v",ar(i)),f={r:e},d=ll(n.cellXfs,r,n);switch(d!==0&&(f.s=d),r.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=On("v",""+Ux(n.Strings,r.v,n.revStrings)),f.t="s";break}f.t="str";break}if(r.t!=s&&(r.t=s,r.v=l),typeof r.f=="string"&&r.f){var m=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;c=Ue("f",ar(r.f),m)+(r.v!=null?c:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(f.cm=1),Ue("c",c,f)}var Z9=(function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=a0("v"),l=a0("f");return function(f,d,m,_,x,y){for(var T=0,E="",S=[],D=[],U=0,k=0,W=0,Z="",X,A,R=0,C=0,V,N,M=0,B=0,ve=Array.isArray(y.CellXf),xe,ne=[],le=[],Le=Array.isArray(d),ae=[],Pe={},J=!1,O=!!m.sheetStubs,Q=f.split(e),q=0,ee=Q.length;q!=ee;++q){E=Q[q].trim();var oe=E.length;if(oe!==0){var Te=0;e:for(T=0;T<oe;++T)switch(E[T]){case">":if(E[T-1]!="/"){++T;break e}if(m&&m.cellStyles){if(A=ft(E.slice(Te,T),!0),R=A.r!=null?parseInt(A.r,10):R+1,C=-1,m.sheetRows&&m.sheetRows<R)continue;Pe={},J=!1,A.ht&&(J=!0,Pe.hpt=parseFloat(A.ht),Pe.hpx=Wu(Pe.hpt)),A.hidden=="1"&&(J=!0,Pe.hidden=!0),A.outlineLevel!=null&&(J=!0,Pe.level=+A.outlineLevel),J&&(ae[R-1]=Pe)}break;case"<":Te=T;break}if(Te>=T)break;if(A=ft(E.slice(Te,T),!0),R=A.r!=null?parseInt(A.r,10):R+1,C=-1,!(m.sheetRows&&m.sheetRows<R)){_.s.r>R-1&&(_.s.r=R-1),_.e.r<R-1&&(_.e.r=R-1),m&&m.cellStyles&&(Pe={},J=!1,A.ht&&(J=!0,Pe.hpt=parseFloat(A.ht),Pe.hpx=Wu(Pe.hpt)),A.hidden=="1"&&(J=!0,Pe.hidden=!0),A.outlineLevel!=null&&(J=!0,Pe.level=+A.outlineLevel),J&&(ae[R-1]=Pe)),S=E.slice(T).split(r);for(var Re=0;Re!=S.length&&S[Re].trim().charAt(0)=="<";++Re);for(S=S.slice(Re),T=0;T!=S.length;++T)if(E=S[T].trim(),E.length!==0){if(D=E.match(t),U=T,k=0,W=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,D!=null&&D.length===2){for(U=0,Z=D[1],k=0;k!=Z.length&&!((W=Z.charCodeAt(k)-64)<1||W>26);++k)U=26*U+W;--U,C=U}else++C;for(k=0;k!=E.length&&E.charCodeAt(k)!==62;++k);if(++k,A=ft(E.slice(0,k),!0),A.r||(A.r=ut({r:R-1,c:C})),Z=E.slice(k),X={t:""},(D=Z.match(s))!=null&&D[1]!==""&&(X.v=Bt(D[1])),m.cellFormula){if((D=Z.match(l))!=null&&D[1]!==""){if(X.f=Bt(fr(D[1])).replace(/\r\n/g,`
`),m.xlfn||(X.f=FS(X.f)),D[0].indexOf('t="array"')>-1)X.F=(Z.match(i)||[])[1],X.F.indexOf(":")>-1&&ne.push([Nt(X.F),X.F]);else if(D[0].indexOf('t="shared"')>-1){N=ft(D[0]);var Se=Bt(fr(D[1]));m.xlfn||(Se=FS(Se)),le[parseInt(N.si,10)]=[N,Se,A.r]}}else(D=Z.match(/<f[^>]*\/>/))&&(N=ft(D[0]),le[N.si]&&(X.f=YP(le[N.si][1],le[N.si][2],A.r)));var De=Dr(A.r);for(k=0;k<ne.length;++k)De.r>=ne[k][0].s.r&&De.r<=ne[k][0].e.r&&De.c>=ne[k][0].s.c&&De.c<=ne[k][0].e.c&&(X.F=ne[k][1])}if(A.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(O)X.t="z";else continue;else X.t=A.t||"n";switch(_.s.c>C&&(_.s.c=C),_.e.c<C&&(_.e.c=C),X.t){case"n":if(X.v==""||X.v==null){if(!O)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!O)continue;X.t="z"}else V=Bh[parseInt(X.v,10)],X.v=V.t,X.r=V.r,m.cellHTML&&(X.h=V.h);break;case"str":X.t="s",X.v=X.v!=null?fr(X.v):"",m.cellHTML&&(X.h=px(X.v));break;case"inlineStr":D=Z.match(n),X.t="s",D!=null&&(V=Ox(D[1]))?(X.v=V.t,m.cellHTML&&(X.h=V.h)):X.v="";break;case"b":X.v=xr(X.v);break;case"d":m.cellDates?X.v=Er(X.v,1):(X.v=cn(Er(X.v,1)),X.t="n");break;case"e":(!m||m.cellText!==!1)&&(X.w=X.v),X.v=GI[X.v];break}if(M=B=0,xe=null,ve&&A.s!==void 0&&(xe=y.CellXf[A.s],xe!=null&&(xe.numFmtId!=null&&(M=xe.numFmtId),m.cellStyles&&xe.fillId!=null&&(B=xe.fillId))),zk(X,M,B,m,x,y),m.cellDates&&ve&&X.t=="n"&&yc(ot[M])&&(X.t="d",X.v=Wp(X.v)),A.cm&&m.xlmeta){var st=(m.xlmeta.Cell||[])[+A.cm-1];st&&st.type=="XLDAPR"&&(X.D=!0)}if(Le){var te=Dr(A.r);d[te.r]||(d[te.r]=[]),d[te.r][te.c]=X}else d[A.r]=X}}}}ae.length>0&&(d["!rows"]=ae)}})();function eL(r,e,t,n){var i=[],s=[],l=Nt(r["!ref"]),c="",f,d="",m=[],_=0,x=0,y=r["!rows"],T=Array.isArray(r),E={r:d},S,D=-1;for(x=l.s.c;x<=l.e.c;++x)m[x]=yr(x);for(_=l.s.r;_<=l.e.r;++_){for(s=[],d=Mr(_),x=l.s.c;x<=l.e.c;++x){f=m[x]+d;var U=T?(r[_]||[])[x]:r[f];U!==void 0&&(c=J9(U,f,r,e))!=null&&s.push(c)}(s.length>0||y&&y[_])&&(E={r:d},y&&y[_]&&(S=y[_],S.hidden&&(E.hidden=1),D=-1,S.hpx?D=h0(S.hpx):S.hpt&&(D=S.hpt),D>-1&&(E.ht=D,E.customHeight=1),S.level&&(E.outlineLevel=S.level)),i[i.length]=Ue("row",s.join(""),E))}if(y)for(;_<y.length;++_)y&&y[_]&&(E={r:_+1},S=y[_],S.hidden&&(E.hidden=1),D=-1,S.hpx?D=h0(S.hpx):S.hpt&&(D=S.hpt),D>-1&&(E.ht=D,E.customHeight=1),S.level&&(E.outlineLevel=S.level),i[i.length]=Ue("row","",E));return i.join("")}function Hk(r,e,t,n){var i=[Gr,Ue("worksheet",null,{xmlns:Ec[0],"xmlns:r":ln.r})],s=t.SheetNames[r],l=0,c="",f=t.Sheets[s];f==null&&(f={});var d=f["!ref"]||"A1",m=Nt(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=xt(m)}n||(n={}),f["!comments"]=[];var _=[];V9(f,t,r,e,i),i[i.length]=Ue("dimension",null,{ref:d}),i[i.length]=Q9(f,e,r,t),e.sheetFormat&&(i[i.length]=Ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(i[i.length]=K9(f,f["!cols"])),i[l=i.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=eL(f,e),c.length>0&&(i[i.length]=c)),i.length>l+1&&(i[i.length]="</sheetData>",i[l]=i[l].replace("/>",">")),f["!protect"]&&(i[i.length]=z9(f["!protect"])),f["!autofilter"]!=null&&(i[i.length]=X9(f["!autofilter"],f,t,r)),f["!merges"]!=null&&f["!merges"].length>0&&(i[i.length]=M9(f["!merges"]));var x=-1,y,T=-1;return f["!links"].length>0&&(i[i.length]="<hyperlinks>",f["!links"].forEach(function(E){E[1].Target&&(y={ref:E[0]},E[1].Target.charAt(0)!="#"&&(T=nr(n,-1,ar(E[1].Target).replace(/#.*$/,""),bt.HLINK),y["r:id"]="rId"+T),(x=E[1].Target.indexOf("#"))>-1&&(y.location=ar(E[1].Target.slice(x+1))),E[1].Tooltip&&(y.tooltip=ar(E[1].Tooltip)),i[i.length]=Ue("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(i[i.length]=G9(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=On("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:d}))),_.length>0&&(T=nr(n,-1,"../drawings/drawing"+(r+1)+".xml",bt.DRAW),i[i.length]=Ue("drawing",null,{"r:id":"rId"+T}),f["!drawing"]=_),f["!comments"].length>0&&(T=nr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML),i[i.length]=Ue("legacyDrawing",null,{"r:id":"rId"+T}),f["!legacy"]=T),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function tL(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function rL(r,e,t){var n=we(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;i.hpx?s=h0(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;i.level&&(l|=i.level),i.hidden&&(l|=16),(i.hpx||i.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var c=0,f=n.l;n.l+=4;for(var d={r,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var _=-1,x=-1,y=m<<10;y<m+1<<10;++y){d.c=y;var T=Array.isArray(t)?(t[d.r]||[])[d.c]:t[ut(d)];T&&(_<0&&(_=y),x=y)}_<0||(++c,n.write_shift(4,_),n.write_shift(4,x))}var E=n.l;return n.l=f,n.write_shift(4,c),n.l=E,n.length>n.l?n.slice(0,n.l):n}function nL(r,e,t,n){var i=rL(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&Ne(r,0,i)}var iL=Ac,aL=df;function sL(){}function oL(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=uO(r),t}function lL(r,e,t){t==null&&(t=we(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return fp({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),BI(r,t),t.slice(0,t.l)}function cL(r){var e=ua(r);return[e]}function uL(r,e,t){return t==null&&(t=we(8)),Tc(e,t)}function fL(r){var e=wc(r);return[e]}function hL(r,e,t){return t==null&&(t=we(4)),Sc(e,t)}function dL(r){var e=ua(r),t=r.read_shift(1);return[e,t,"b"]}function mL(r,e,t){return t==null&&(t=we(9)),Tc(e,t),t.write_shift(1,r.v?1:0),t}function pL(r){var e=wc(r),t=r.read_shift(1);return[e,t,"b"]}function gL(r,e,t){return t==null&&(t=we(5)),Sc(e,t),t.write_shift(1,r.v?1:0),t}function _L(r){var e=ua(r),t=r.read_shift(1);return[e,t,"e"]}function vL(r,e,t){return t==null&&(t=we(9)),Tc(e,t),t.write_shift(1,r.v),t}function xL(r){var e=wc(r),t=r.read_shift(1);return[e,t,"e"]}function yL(r,e,t){return t==null&&(t=we(8)),Sc(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function EL(r){var e=ua(r),t=r.read_shift(4);return[e,t,"s"]}function TL(r,e,t){return t==null&&(t=we(12)),Tc(e,t),t.write_shift(4,e.v),t}function wL(r){var e=wc(r),t=r.read_shift(4);return[e,t,"s"]}function SL(r,e,t){return t==null&&(t=we(8)),Sc(e,t),t.write_shift(4,e.v),t}function AL(r){var e=ua(r),t=qn(r);return[e,t,"n"]}function bL(r,e,t){return t==null&&(t=we(16)),Tc(e,t),ac(r.v,t),t}function Gk(r){var e=wc(r),t=qn(r);return[e,t,"n"]}function IL(r,e,t){return t==null&&(t=we(12)),Sc(e,t),ac(r.v,t),t}function kL(r){var e=ua(r),t=kx(r);return[e,t,"n"]}function CL(r,e,t){return t==null&&(t=we(12)),Tc(e,t),UI(r.v,t),t}function RL(r){var e=wc(r),t=kx(r);return[e,t,"n"]}function DL(r,e,t){return t==null&&(t=we(8)),Sc(e,t),UI(r.v,t),t}function NL(r){var e=ua(r),t=Ax(r);return[e,t,"is"]}function OL(r){var e=ua(r),t=Wn(r);return[e,t,"str"]}function FL(r,e,t){return t==null&&(t=we(12+4*r.v.length)),Tc(e,t),xn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function PL(r){var e=wc(r),t=Wn(r);return[e,t,"str"]}function ML(r,e,t){return t==null&&(t=we(8+4*r.v.length)),Sc(e,t),xn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function LL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=r.read_shift(1),l=[i,s,"b"];if(t.cellFormula){r.l+=2;var c=Qp(r,n-r.l,t);l[3]=Hn(c,null,i,t.supbooks,t)}else r.l=n;return l}function VL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=r.read_shift(1),l=[i,s,"e"];if(t.cellFormula){r.l+=2;var c=Qp(r,n-r.l,t);l[3]=Hn(c,null,i,t.supbooks,t)}else r.l=n;return l}function BL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=qn(r),l=[i,s,"n"];if(t.cellFormula){r.l+=2;var c=Qp(r,n-r.l,t);l[3]=Hn(c,null,i,t.supbooks,t)}else r.l=n;return l}function UL(r,e,t){var n=r.l+e,i=ua(r);i.r=t["!row"];var s=Wn(r),l=[i,s,"str"];if(t.cellFormula){r.l+=2;var c=Qp(r,n-r.l,t);l[3]=Hn(c,null,i,t.supbooks,t)}else r.l=n;return l}var zL=Ac,jL=df;function HL(r,e){return e==null&&(e=we(4)),e.write_shift(4,r),e}function GL(r,e){var t=r.l+e,n=Ac(r),i=bx(r),s=Wn(r),l=Wn(r),c=Wn(r);r.l=t;var f={rfx:n,relId:i,loc:s,display:c};return l&&(f.Tooltip=l),f}function qL(r,e){var t=we(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));df({s:Dr(r[0]),e:Dr(r[0])},t),Ix("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return xn(i||"",t),xn(r[1].Tooltip||"",t),xn("",t),t.slice(0,t.l)}function KL(){}function WL(r,e,t){var n=r.l+e,i=zI(r),s=r.read_shift(1),l=[i];if(l[2]=s,t.cellFormula){var c=_9(r,n-r.l,t);l[1]=c}else r.l=n;return l}function XL(r,e,t){var n=r.l+e,i=Ac(r),s=[i];if(t.cellFormula){var l=x9(r,n-r.l,t);s[1]=l,r.l=n}else r.l=n;return s}function YL(r,e,t){t==null&&(t=we(18));var n=Jp(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var qk=["left","right","top","bottom","header","footer"];function $L(r){var e={};return qk.forEach(function(t){e[t]=qn(r)}),e}function QL(r,e){return e==null&&(e=we(48)),Ql(r),qk.forEach(function(t){ac(r[t],e)}),e}function JL(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function ZL(r,e,t){t==null&&(t=we(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function eV(r){var e=we(24);return e.write_shift(4,4),e.write_shift(4,1),df(r,e),e}function tV(r,e){return e==null&&(e=we(66)),e.write_shift(2,r.password?Fx(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function rV(){}function nV(){}function iV(r,e,t,n,i,s,l){if(!r)return r;var c=e||{};n||(n={"!id":{}});var f=c.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,x=!1,y,T,E,S,D,U,k,W,Z,X=[];c.biff=12,c["!row"]=0;var A=0,R=!1,C=[],V={},N=c.supbooks||i.supbooks||[[]];if(N.sharedf=V,N.arrayf=C,N.SheetNames=i.SheetNames||i.Sheets.map(function(Le){return Le.name}),!c.supbooks&&(c.supbooks=N,i.Names))for(var M=0;M<i.Names.length;++M)N[0][M+1]=i.Names[M];var B=[],ve=[],xe=!1;d0[16]={n:"BrtShortReal",f:Gk};var ne;if(qs(r,function(ae,Pe,J){if(!x)switch(J){case 148:d=ae;break;case 0:y=ae,c.sheetRows&&c.sheetRows<=y.r&&(x=!0),W=Mr(S=y.r),c["!row"]=y.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Wu(ae.hpt)),ve[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(T={t:ae[2]},ae[2]){case"n":T.v=ae[1];break;case"s":k=Bh[ae[1]],T.v=k.t,T.r=k.r;break;case"b":T.v=!!ae[1];break;case"e":T.v=ae[1],c.cellText!==!1&&(T.w=Ks[T.v]);break;case"str":T.t="s",T.v=ae[1];break;case"is":T.t="s",T.v=ae[1].t;break}if((E=l.CellXf[ae[0].iStyleRef])&&zk(T,E.numFmtId,null,c,s,l),D=ae[0].c==-1?D+1:ae[0].c,c.dense?(f[S]||(f[S]=[]),f[S][D]=T):f[yr(D)+W]=T,c.cellFormula){for(R=!1,A=0;A<C.length;++A){var O=C[A];y.r>=O[0].s.r&&y.r<=O[0].e.r&&D>=O[0].s.c&&D<=O[0].e.c&&(T.F=xt(O[0]),R=!0)}!R&&ae.length>3&&(T.f=ae[3])}if(m.s.r>y.r&&(m.s.r=y.r),m.s.c>D&&(m.s.c=D),m.e.r<y.r&&(m.e.r=y.r),m.e.c<D&&(m.e.c=D),c.cellDates&&E&&T.t=="n"&&yc(ot[E.numFmtId])){var Q=Bo(T.v);Q&&(T.t="d",T.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}ne&&(ne.type=="XLDAPR"&&(T.D=!0),ne=void 0);break;case 1:case 12:if(!c.sheetStubs||_)break;T={t:"z",v:void 0},D=ae[0].c==-1?D+1:ae[0].c,c.dense?(f[S]||(f[S]=[]),f[S][D]=T):f[yr(D)+W]=T,m.s.r>y.r&&(m.s.r=y.r),m.s.c>D&&(m.s.c=D),m.e.r<y.r&&(m.e.r=y.r),m.e.c<D&&(m.e.c=D),ne&&(ne.type=="XLDAPR"&&(T.D=!0),ne=void 0);break;case 176:X.push(ae);break;case 49:ne=((c.xlmeta||{}).Cell||[])[ae-1];break;case 494:var q=n["!id"][ae.relId];for(q?(ae.Target=q.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=q):ae.relId==""&&(ae.Target="#"+ae.loc),S=ae.rfx.s.r;S<=ae.rfx.e.r;++S)for(D=ae.rfx.s.c;D<=ae.rfx.e.c;++D)c.dense?(f[S]||(f[S]=[]),f[S][D]||(f[S][D]={t:"z",v:void 0}),f[S][D].l=ae):(U=ut({c:D,r:S}),f[U]||(f[U]={t:"z",v:void 0}),f[U].l=ae);break;case 426:if(!c.cellFormula)break;C.push(ae),Z=c.dense?f[S][D]:f[yr(D)+W],Z.f=Hn(ae[1],m,{r:y.r,c:D},N,c),Z.F=xt(ae[0]);break;case 427:if(!c.cellFormula)break;V[ut(ae[0].s)]=ae[1],Z=c.dense?f[S][D]:f[yr(D)+W],Z.f=Hn(ae[1],m,{r:y.r,c:D},N,c);break;case 60:if(!c.cellStyles)break;for(;ae.e>=ae.s;)B[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},xe||(xe=!0,Px(ae.w/256)),Jo(B[ae.e+1]);break;case 161:f["!autofilter"]={ref:xt(ae)};break;case 476:f["!margins"]=ae;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),ae.name&&(i.Sheets[t].CodeName=ae.name),(ae.above||ae.left)&&(f["!outline"]={above:ae.above,left:ae.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ae.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!Pe.T){if(!_||c.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=xt(d||m)),c.sheetRows&&f["!ref"]){var le=Nt(f["!ref"]);c.sheetRows<=+le.e.r&&(le.e.r=c.sheetRows-1,le.e.r>m.e.r&&(le.e.r=m.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>m.e.c&&(le.e.c=m.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),f["!fullref"]=f["!ref"],f["!ref"]=xt(le))}return X.length>0&&(f["!merges"]=X),B.length>0&&(f["!cols"]=B),ve.length>0&&(f["!rows"]=ve),f}function aV(r,e,t,n,i,s,l){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=pr(e),e.z=e.z||ot[14],e.v=cn(Er(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var f={r:t,c:n};switch(f.s=ll(i.cellXfs,e,i),e.l&&s["!links"].push([ut(f),e.l]),e.c&&s["!comments"].push([ut(f),e.c]),e.t){case"s":case"str":return i.bookSST?(c=Ux(i.Strings,e.v,i.revStrings),f.t="s",f.v=c,l?Ne(r,18,SL(e,f)):Ne(r,7,TL(e,f))):(f.t="str",l?Ne(r,17,ML(e,f)):Ne(r,6,FL(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Ne(r,13,DL(e,f)):Ne(r,2,CL(e,f)):l?Ne(r,16,IL(e,f)):Ne(r,5,bL(e,f)),!0;case"b":return f.t="b",l?Ne(r,15,gL(e,f)):Ne(r,4,mL(e,f)),!0;case"e":return f.t="e",l?Ne(r,14,yL(e,f)):Ne(r,3,vL(e,f)),!0}return l?Ne(r,12,hL(e,f)):Ne(r,1,uL(e,f)),!0}function sV(r,e,t,n){var i=Nt(e["!ref"]||"A1"),s,l="",c=[];Ne(r,145);var f=Array.isArray(e),d=i.e.r;e["!rows"]&&(d=Math.max(i.e.r,e["!rows"].length-1));for(var m=i.s.r;m<=d;++m){l=Mr(m),nL(r,e,i,m);var _=!1;if(m<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){m===i.s.r&&(c[x]=yr(x)),s=c[x]+l;var y=f?(e[m]||[])[x]:e[s];if(!y){_=!1;continue}_=aV(r,y,m,x,n,e,_)}}Ne(r,146)}function oV(r,e){!e||!e["!merges"]||(Ne(r,177,HL(e["!merges"].length)),e["!merges"].forEach(function(t){Ne(r,176,jL(t))}),Ne(r,178))}function lV(r,e){!e||!e["!cols"]||(Ne(r,390),e["!cols"].forEach(function(t,n){t&&Ne(r,60,YL(n,t))}),Ne(r,391))}function cV(r,e){!e||!e["!ref"]||(Ne(r,648),Ne(r,649,eV(Nt(e["!ref"]))),Ne(r,650))}function uV(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=nr(t,-1,n[1].Target.replace(/#.*$/,""),bt.HLINK);Ne(r,494,qL(n,i))}}),delete e["!links"]}function fV(r,e,t,n){if(e["!comments"].length>0){var i=nr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",bt.VML);Ne(r,551,Ix("rId"+i)),e["!legacy"]=i}}function hV(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:xt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,c=ai(s);c.s.r==c.e.r&&(c.e.r=ai(e["!ref"]).e.r,s=xt(c));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+t.SheetNames[n]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Ne(r,161,df(Nt(s))),Ne(r,162)}}function dV(r,e,t){Ne(r,133),Ne(r,137,ZL(e,t)),Ne(r,138),Ne(r,134)}function mV(r,e){e["!protect"]&&Ne(r,535,tV(e["!protect"]))}function pV(r,e,t,n){var i=pi(),s=t.SheetNames[r],l=t.Sheets[s]||{},c=s;try{t&&t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}var f=Nt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ne(i,129),(t.vbaraw||l["!outline"])&&Ne(i,147,lL(c,l["!outline"])),Ne(i,148,aL(f)),dV(i,l,t.Workbook),lV(i,l),sV(i,l,r,e),mV(i,l),hV(i,l,t,r),oV(i,l),uV(i,l,n),l["!margins"]&&Ne(i,476,QL(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&cV(i,l),fV(i,l,r,n),Ne(i,130),i.end()}function gV(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=t?+l[2]:l[2])});var i=Bt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function _V(r,e,t,n,i,s){var l=s||{"!type":"chart"};if(!r)return s;var c=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var x=gV(_);m.s.r=m.s.c=0,m.e.c=c,d=yr(c),x[0].forEach(function(y,T){l[d+Mr(T)]={t:"n",v:y,z:x[1]},f=T}),m.e.r<f&&(m.e.r=f),++c}),c>0&&(l["!ref"]=xt(m)),l}function vV(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,c=r.match(jk);return c&&zx(c[0],s,i,t),(l=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function xV(r,e){r.l+=10;var t=Wn(r);return{name:t}}function yV(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return qs(r,function(f,d,m){switch(m){case 550:s["!rel"]=f;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),f.name&&(i.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var jx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],EV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],TV=[],wV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function BS(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=xr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function US(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=xr(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function Kk(r){US(r.WBProps,jx),US(r.CalcPr,wV),BS(r.WBView,EV),BS(r.Sheets,TV),Vu.date1904=xr(r.WBProps.date1904)}function SV(r){return!r.Workbook||!r.Workbook.WBProps?"false":xr(r.Workbook.WBProps.date1904)?"true":"false"}var AV="][*?/\\".split("");function Wk(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return AV.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function bV(r,e,t){r.forEach(function(n,i){Wk(n);for(var s=0;s<i;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var l=e&&e[i]&&e[i].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function Xk(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];bV(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)S9(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var IV=/<\w+:workbook/;function kV(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},l=0;if(r.replace($n,function(f,d){var m=ft(f);switch(ss(m[0])){case"<?xml":break;case"<workbook":f.match(IV)&&(i="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=m[i];break;case"</workbook>":break;case"<fileVersion":delete m[0],t.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jx.forEach(function(_){if(m[_[0]]!=null)switch(_[2]){case"bool":t.WBProps[_[0]]=xr(m[_[0]]);break;case"int":t.WBProps[_[0]]=parseInt(m[_[0]],10);break;default:t.WBProps[_[0]]=m[_[0]]}}),m.codeName&&(t.WBProps.CodeName=fr(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],t.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Bt(fr(m.name)),delete m[0],t.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=fr(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),xr(m.hidden||"0")&&(s.Hidden=!0),l=d+f.length;break;case"</definedName>":s.Ref=Bt(fr(r.slice(l,d))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],t.CalcPr=m;break;case"<calcPr/>":delete m[0],t.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Ec.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Kk(t),t}function Yk(r){var e=[Gr];e[e.length]=Ue("workbook",null,{xmlns:Ec[0],"xmlns:r":ln.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(jx.forEach(function(c){r.Workbook.WBProps[c[0]]!=null&&r.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=r.Workbook.WBProps[c[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ue("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var l={name:ar(r.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Ue("sheet",null,l)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(e[e.length]=Ue("definedName",ar(c.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function CV(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=pv(r),t.name=Wn(r),t}function RV(r,e){return e||(e=we(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Ix(r.strRelID,e),xn(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function DV(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?Wn(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function NV(r,e){e||(e=we(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),BI(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function OV(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function FV(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=fO(r),l=v9(r,0,t),c=bx(r);r.l=n;var f={Name:s,Ptg:l};return i<268435455&&(f.Sheet=i),c&&(f.Comment=c),f}function PV(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],d0[16]={n:"BrtFRTArchID$",f:OV},qs(r,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Hn(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(m),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),Kk(t),t.Names=s,t.supbooks=l,t}function MV(r,e){Ne(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ne(r,156,RV(i))}Ne(r,144)}function LV(r,e){e||(e=we(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return xn("SheetJS",e),xn(r0.version,e),xn(r0.version,e),xn("7262",e),e.length>e.l?e.slice(0,e.l):e}function VV(r,e){e||(e=we(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function BV(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&s==-1&&(s=n);s>i||(Ne(r,135),Ne(r,158,VV(i)),Ne(r,136))}}function UV(r,e){var t=pi();return Ne(t,131),Ne(t,128,LV()),Ne(t,153,NV(r.Workbook&&r.Workbook.WBProps||null)),BV(t,r),MV(t,r),Ne(t,132),t.end()}function zV(r,e,t){return e.slice(-4)===".bin"?PV(r,t):kV(r,t)}function jV(r,e,t,n,i,s,l,c){return e.slice(-4)===".bin"?iV(r,n,t,i,s,l,c):P9(r,n,t,i,s,l,c)}function HV(r,e,t,n,i,s,l,c){return e.slice(-4)===".bin"?yV(r,n,t,i,s):vV(r,n,t,i,s)}function GV(r,e,t,n,i,s,l,c){return e.slice(-4)===".bin"?WP():XP()}function qV(r,e,t,n,i,s,l,c){return e.slice(-4)===".bin"?qP():KP()}function KV(r,e,t,n){return e.slice(-4)===".bin"?j8(r,t,n):R8(r,t,n)}function WV(r,e,t){return kk(r,t)}function XV(r,e,t){return e.slice(-4)===".bin"?YF(r,t):KF(r,t)}function YV(r,e,t){return e.slice(-4)===".bin"?UP(r,t):DP(r,t)}function $V(r,e,t){return e.slice(-4)===".bin"?kP(r):bP(r)}function QV(r,e,t,n){return t.slice(-4)===".bin"?CP(r,e,t,n):void 0}function JV(r,e,t){return e.slice(-4)===".bin"?wP(r,e,t):AP(r,e,t)}function ZV(r,e,t){return(e.slice(-4)===".bin"?UV:Yk)(r)}function eB(r,e,t,n,i){return(e.slice(-4)===".bin"?pV:Hk)(r,t,n,i)}function tB(r,e,t){return(e.slice(-4)===".bin"?J8:bk)(r,t)}function rB(r,e,t){return(e.slice(-4)===".bin"?JF:vk)(r,t)}function nB(r,e,t){return(e.slice(-4)===".bin"?zP:Dk)(r)}function iB(r){return(r.slice(-4)===".bin"?SP:Ck)()}var $k=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Qk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wa(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=r.match($k),s,l,c,f;if(i)for(f=0;f!=i.length;++f)s=i[f].match(Qk),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),n[c]=s[2].slice(1,s[2].length-1));return n}function aB(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match($k),i,s,l,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(Qk),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),t[l]=i[2].slice(1,i[2].length-1));return t}var zh;function sB(r,e){var t=zh[r]||Bt(r);return t==="General"?nc(e):Vi(t,e)}function oB(r,e,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=xr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Er(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[Bt(e)]=i}function lB(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||Ks[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=i0(r.v):r.w=nc(r.v):r.w=sB(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=zh[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&yc(n)){var i=Bo(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function cB(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=T8[n.Pattern]||n.Pattern)}r[e.ID]=e}function uB(r,e,t,n,i,s,l,c,f,d){var m="General",_=n.StyleID,x={};d=d||{};var y=[],T=0;for(_===void 0&&c&&(_=c.StyleID),_===void 0&&l&&(_=l.StyleID);s[_]!==void 0&&(s[_].nf&&(m=s[_].nf),s[_].Interior&&y.push(s[_].Interior),!!s[_].Parent);)_=s[_].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=xr(r);break;case"String":n.t="s",n.r=nS(Bt(r)),n.v=r.indexOf("<")>-1?Bt(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(Er(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Bt(r):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GI[r],d.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=nS(e||r));break}if(lB(n,m,d),d.cellFormula!==!1)if(n.Formula){var E=Bt(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=Lu(E,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Lu("RC:RC",i):n.ArrayRange&&(n.F=Lu(n.ArrayRange,i),f.push([Nt(n.F),n.F]))}else for(T=0;T<f.length;++T)i.r>=f[T][0].s.r&&i.r<=f[T][0].e.r&&i.c>=f[T][0].s.c&&i.c<=f[T][0].e.c&&(n.F=f[T][1]);d.cellStyles&&(y.forEach(function(S){!x.patternType&&S.patternType&&(x.patternType=S.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fB(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function B_(r,e){var t=e||{};uf();var n=Du(gx(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof Vt<"u"?n=Vt.utils.decode(65001,ip(n)):n=fr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var l=pr(t);return l.type="string",Ku.to_workbook(n,l)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(nt){i.indexOf("<"+nt)>=0&&(s=!0)}),s)return WB(n,t);zh={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,m={},_=[],x=t.dense?[]:{},y="",T={},E={},S=wa('<Data ss:Type="String">'),D=0,U=0,k=0,W={s:{r:2e6,c:2e6},e:{r:0,c:0}},Z={},X={},A="",R=0,C=[],V={},N={},M=0,B=[],ve=[],xe={},ne=[],le,Le=!1,ae=[],Pe=[],J={},O=0,Q=0,q={Sheets:[],WBProps:{date1904:!1}},ee={};o0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=o0.exec(n);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?uB(n.slice(D,c.index),A,S,f[f.length-1][0]=="comment"?xe:T,{c:U,r:k},Z,ne[U],E,ae,t):(A="",S=wa(c[0]),D=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ve.length>0&&(T.c=ve),(!t.sheetRows||t.sheetRows>k)&&T.v!==void 0&&(t.dense?(x[k]||(x[k]=[]),x[k][U]=T):x[yr(U)+Mr(k)]=T),T.HRef&&(T.l={Target:Bt(T.HRef)},T.HRefScreenTip&&(T.l.Tooltip=T.HRefScreenTip),delete T.HRef,delete T.HRefScreenTip),(T.MergeAcross||T.MergeDown)&&(O=U+(parseInt(T.MergeAcross,10)|0),Q=k+(parseInt(T.MergeDown,10)|0),C.push({s:{c:U,r:k},e:{c:O,r:Q}})),!t.sheetStubs)T.MergeAcross?U=O+1:++U;else if(T.MergeAcross||T.MergeDown){for(var Te=U;Te<=O;++Te)for(var Re=k;Re<=Q;++Re)(Te>U||Re>k)&&(t.dense?(x[Re]||(x[Re]=[]),x[Re][Te]={t:"z"}):x[yr(Te)+Mr(Re)]={t:"z"});U=O+1}else++U;else T=aB(c[0]),T.Index&&(U=+T.Index-1),U<W.s.c&&(W.s.c=U),U>W.e.c&&(W.e.c=U),c[0].slice(-2)==="/>"&&++U,ve=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(k<W.s.r&&(W.s.r=k),k>W.e.r&&(W.e.r=k),c[0].slice(-2)==="/>"&&(E=wa(c[0]),E.Index&&(k=+E.Index-1)),U=0,++k):(E=wa(c[0]),E.Index&&(k=+E.Index-1),J={},(E.AutoFitHeight=="0"||E.Height)&&(J.hpx=parseInt(E.Height,10),J.hpt=h0(J.hpx),Pe[k]=J),E.Hidden=="1"&&(J.hidden=!0,Pe[k]=J));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));_.push(y),W.s.r<=W.e.r&&W.s.c<=W.e.c&&(x["!ref"]=xt(W),t.sheetRows&&t.sheetRows<=W.e.r&&(x["!fullref"]=x["!ref"],W.e.r=t.sheetRows-1,x["!ref"]=xt(W))),C.length&&(x["!merges"]=C),ne.length>0&&(x["!cols"]=ne),Pe.length>0&&(x["!rows"]=Pe),m[y]=x}else W={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=U=0,f.push([c[3],!1]),d=wa(c[0]),y=Bt(d.Name),x=t.dense?[]:{},C=[],ae=[],Pe=[],ee={name:y,Hidden:0},q.Sheets.push(ee);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),ne=[],Le=!1}break;case"style":c[1]==="/"?cB(Z,X,t):X=wa(c[0]);break;case"numberformat":X.nf=Bt(wa(c[0]).Format||"General"),zh[X.nf]&&(X.nf=zh[X.nf]);for(var Se=0;Se!=392&&ot[Se]!=X.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(ot[Se]==null){Ja(X.nf,Se);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(le=wa(c[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!Le&&le.wpx>10){Le=!0,Gn=Sk;for(var De=0;De<ne.length;++De)ne[De]&&Jo(ne[De])}Le&&Jo(le),ne[le.Index-1||ne.length]=le;for(var st=0;st<+le.Span;++st)ne[ne.length]=pr(le);break;case"namedrange":if(c[1]==="/")break;q.Names||(q.Names=[]);var te=ft(c[0]),St={Name:te.Name,Ref:Lu(te.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(St.Sheet=q.Sheets.length-1),q.Names.push(St);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?A+=n.slice(R,c.index):R=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;X.Interior=wa(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?MO(V,oe,n.slice(M,c.index)):M=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));fB(xe),ve.push(xe)}else f.push([c[3],!1]),d=wa(c[0]),xe={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var lt=wa(c[0]);x["!autofilter"]={ref:Lu(lt.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return qS(n,t);var At=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:At=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:At=!1}break;case"excelworkbook":switch(c[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:At=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:At=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(M,c.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else M=c.index+c[0].length;break;case"header":x["!margins"]||Ql(x["!margins"]={},"xlml"),isNaN(+ft(c[0]).Margin)||(x["!margins"].header=+ft(c[0]).Margin);break;case"footer":x["!margins"]||Ql(x["!margins"]={},"xlml"),isNaN(+ft(c[0]).Margin)||(x["!margins"].footer=+ft(c[0]).Margin);break;case"pagemargins":var Xe=ft(c[0]);x["!margins"]||Ql(x["!margins"]={},"xlml"),isNaN(+Xe.Top)||(x["!margins"].top=+Xe.Top),isNaN(+Xe.Left)||(x["!margins"].left=+Xe.Left),isNaN(+Xe.Right)||(x["!margins"].right=+Xe.Right),isNaN(+Xe.Bottom)||(x["!margins"].bottom=+Xe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:At=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:At=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:At=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:At=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:At=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:At=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:At=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:At=!1}break;case"smarttags":break;default:At=!1;break}if(At||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?oB(N,oe,B,n.slice(M,c.index)):(B=c,M=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Oe={};return!t.bookSheets&&!t.bookProps&&(Oe.Sheets=m),Oe.SheetNames=_,Oe.Workbook=q,Oe.SSF=pr(ot),Oe.Props=V,Oe.Custprops=N,Oe}function Tv(r,e){switch(qx(e=e||{}),e.type||"base64"){case"base64":return B_(Li(r),e);case"binary":case"buffer":case"file":return B_(r,e);case"array":return B_(sl(r),e)}}function hB(r,e){var t=[];return r.Props&&t.push(LO(r.Props,e)),r.Custprops&&t.push(VO(r.Props,r.Custprops)),t.join("")}function dB(){return""}function mB(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ue("NumberFormat",null,{"ss:Format":ar(ot[n.numFmtId])}));var l={"ss:ID":"s"+(21+i)};t.push(Ue("Style",s.join(""),l))}),Ue("Styles",t.join(""))}function Jk(r){return Ue("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+Vx(r.Ref,{r:0,c:0})})}function pB(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(Jk(i)))}return Ue("Names",t.join(""))}function gB(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],l=0;l<i.length;++l){var c=i[l];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||s.push(Jk(c)))}return s.join("")}function _B(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(Ue("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(Ue("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(Ue("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(Ue("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(On("ProtectContents","True")),r["!protect"].objects&&i.push(On("ProtectObjects","True")),r["!protect"].scenarios&&i.push(On("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(On("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(On("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){r["!protect"][l[0]]&&i.push("<"+l[1]+"/>")})),i.length==0?"":Ue("WorksheetOptions",i.join(""),{xmlns:Ci.x})}function vB(r){return r.map(function(e){var t=U5(e.t||""),n=Ue("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":e.a})}).join("")}function xB(r,e,t,n,i,s,l){if(!r||r.v==null&&r.f==null)return"";var c={};if(r.f&&(c["ss:Formula"]="="+ar(Vx(r.f,l))),r.F&&r.F.slice(0,e.length)==e){var f=Dr(r.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(r.l&&r.l.Target&&(c["ss:HRef"]=ar(r.l.Target),r.l.Tooltip&&(c["x:HRefScreenTip"]=ar(r.l.Tooltip))),t["!merges"])for(var d=t["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(c["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(c["ss:MergeDown"]=d[m].e.r-d[m].s.r));var _="",x="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":_="Number",x=String(r.v);break;case"b":_="Boolean",x=r.v?"1":"0";break;case"e":_="Error",x=Ks[r.v];break;case"d":_="DateTime",x=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||ot[14]);break;case"s":_="String",x=B5(r.v||"");break}var y=ll(n.cellXfs,r,n);c["ss:StyleID"]="s"+(21+y),c["ss:Index"]=l.c+1;var T=r.v!=null?x:"",E=r.t=="z"?"":'<Data ss:Type="'+_+'">'+T+"</Data>";return(r.c||[]).length>0&&(E+=vB(r.c)),Ue("Cell",E,c)}function yB(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Wu(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function EB(r,e,t,n){if(!r["!ref"])return"";var i=Nt(r["!ref"]),s=r["!merges"]||[],l=0,c=[];r["!cols"]&&r["!cols"].forEach(function(S,D){Jo(S);var U=!!S.width,k=Jp(D,S),W={"ss:Index":D+1};U&&(W["ss:Width"]=u0(k.width)),S.hidden&&(W["ss:Hidden"]="1"),c.push(Ue("Column",null,W))});for(var f=Array.isArray(r),d=i.s.r;d<=i.e.r;++d){for(var m=[yB(d,(r["!rows"]||[])[d])],_=i.s.c;_<=i.e.c;++_){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>_)&&!(s[l].s.r>d)&&!(s[l].e.c<_)&&!(s[l].e.r<d)){(s[l].s.c!=_||s[l].s.r!=d)&&(x=!0);break}if(!x){var y={r:d,c:_},T=ut(y),E=f?(r[d]||[])[_]:r[T];m.push(xB(E,T,r,e,t,n,y))}}m.push("</Row>"),m.length>2&&c.push(m.join(""))}return c.join("")}function TB(r,e,t){var n=[],i=t.SheetNames[r],s=t.Sheets[i],l=s?gB(s,e,r,t):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?EB(s,e,r,t):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(_B(s,e,r,t)),n.join("")}function wB(r,e){e||(e={}),r.SSF||(r.SSF=pr(ot)),r.SSF&&(uf(),F0(r.SSF),e.revssf=Kp(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],ll(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(hB(r,e)),t.push(dB()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(Ue("Worksheet",TB(n,e,r),{"ss:Name":ar(r.SheetNames[n])}));return t[2]=mB(r,e),t[3]=pB(r),Gr+Ue("Workbook",t.join(""),{xmlns:Ci.ss,"xmlns:o":Ci.o,"xmlns:x":Ci.x,"xmlns:ss":Ci.ss,"xmlns:dt":Ci.dt,"xmlns:html":Ci.html})}function SB(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=gO(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=_O(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var AB=[60,1084,2066,2165,2175];function bB(r,e,t,n,i){var s=n,l=[],c=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&c.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}l.push(c),t.l+=s;for(var f=Ns(t,t.l),d=wv[f],m=0;d!=null&&AB.indexOf(f)>-1;)s=Ns(t,t.l+2),m=t.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),c=t.slice(m,t.l+4+s),l.push(c),t.l+=4+s,d=wv[f=Ns(t,t.l)];var _=vn(l);Nn(_,0);var x=0;_.lens=[];for(var y=0;y<l.length;++y)_.lens.push(x),x+=l[y].length;if(_.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+_.length+" < "+n;return e.f(_,_.length,i)}function qa(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=ot[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||Ks[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=i0(r.v):r.w=nc(r.v):r.w=Vi(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&yc(ot[n]||String(n))){var i=Bo(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Rm(r,e,t){return{v:r,ixfe:e,t}}function IB(r,e){var t={opts:{}},n={},i=e.dense?[]:{},s={},l={},c=null,f=[],d="",m={},_,x="",y,T,E,S,D={},U=[],k,W,Z=[],X=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},C=function(Ye){return Ye<8?Xl[Ye]:Ye<64&&X[Ye-8]||Xl[Ye]},V=function(Ye,Ut,Tr){var Ot=Ut.XF.data;if(!(!Ot||!Ot.patternType||!Tr||!Tr.cellStyles)){Ut.s={},Ut.s.patternType=Ot.patternType;var Kt;(Kt=c0(C(Ot.icvFore)))&&(Ut.s.fgColor={rgb:Kt}),(Kt=c0(C(Ot.icvBack)))&&(Ut.s.bgColor={rgb:Kt})}},N=function(Ye,Ut,Tr){if(!(J>1)&&!(Tr.sheetRows&&Ye.r>=Tr.sheetRows)){if(Tr.cellStyles&&Ut.XF&&Ut.XF.data&&V(Ye,Ut,Tr),delete Ut.ixfe,delete Ut.XF,_=Ye,x=ut(Ye),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ye.r<l.s.r&&(l.s.r=Ye.r),Ye.c<l.s.c&&(l.s.c=Ye.c),Ye.r+1>l.e.r&&(l.e.r=Ye.r+1),Ye.c+1>l.e.c&&(l.e.c=Ye.c+1),Tr.cellFormula&&Ut.f){for(var Ot=0;Ot<U.length;++Ot)if(!(U[Ot][0].s.c>Ye.c||U[Ot][0].s.r>Ye.r)&&!(U[Ot][0].e.c<Ye.c||U[Ot][0].e.r<Ye.r)){Ut.F=xt(U[Ot][0]),(U[Ot][0].s.c!=Ye.c||U[Ot][0].s.r!=Ye.r)&&delete Ut.f,Ut.f&&(Ut.f=""+Hn(U[Ot][1],l,Ye,ae,M));break}}Tr.dense?(i[Ye.r]||(i[Ye.r]=[]),i[Ye.r][Ye.c]=Ut):i[x]=Ut}},M={enc:!1,sbcch:0,snames:[],sharedf:D,arrayf:U,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var B,ve=[],xe=[],ne=[],le=[],Le=!1,ae=[];ae.SheetNames=M.snames,ae.sharedf=M.sharedf,ae.arrayf=M.arrayf,ae.names=[],ae.XTI=[];var Pe=0,J=0,O=0,Q=[],q=[],ee;M.codepage=1200,aa(1200);for(var oe=!1;r.l<r.length-1;){var Te=r.l,Re=r.read_shift(2);if(Re===0&&Pe===10)break;var Se=r.l===r.length?0:r.read_shift(2),De=wv[Re];if(De&&De.f){if(e.bookSheets&&Pe===133&&Re!==133)break;if(Pe=Re,De.r===2||De.r==12){var st=r.read_shift(2);if(Se-=2,!M.enc&&st!==Re&&((st&255)<<8|st>>8)!==Re)throw new Error("rt mismatch: "+st+"!="+Re);De.r==12&&(r.l+=10,Se-=10)}var te={};if(Re===10?te=De.f(r,Se,M):te=bB(Re,De,r,Se,M),J==0&&[9,521,1033,2057].indexOf(Pe)===-1)continue;switch(Re){case 34:t.opts.Date1904=A.WBProps.date1904=te;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(M.enc||(r.l=0),M.enc=te,!e.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=te;break;case 66:var St=Number(te);switch(St){case 21010:St=1200;break;case 32768:St=1e4;break;case 32769:St=1252;break}aa(M.codepage=St),oe=!0;break;case 317:M.rrtabid=te;break;case 25:M.winlocked=te;break;case 439:t.opts.RefreshAll=te;break;case 12:t.opts.CalcCount=te;break;case 16:t.opts.CalcDelta=te;break;case 17:t.opts.CalcIter=te;break;case 13:t.opts.CalcMode=te;break;case 14:t.opts.CalcPrecision=te;break;case 95:t.opts.CalcSaveRecalc=te;break;case 15:M.CalcRefMode=te;break;case 2211:t.opts.FullCalc=te;break;case 129:te.fDialog&&(i["!type"]="dialog"),te.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),te.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Z.push(te);break;case 430:ae.push([te]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(te);break;case 24:case 536:ee={Name:te.Name,Ref:Hn(te.rgce,l,null,ae,M)},te.itab>0&&(ee.Sheet=te.itab-1),ae.names.push(ee),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(q[te.itab-1]={ref:xt(te.rgce[0][0][1][2])});break;case 22:M.ExternCount=te;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(te),ae.XTI=ae.XTI.concat(te);break;case 2196:if(M.biff<8)break;ee!=null&&(ee.Comment=te[1]);break;case 18:i["!protect"]=te;break;case 19:te!==0&&M.WTF&&console.error("Password verifier: "+te);break;case 133:s[te.pos]=te,M.snames.push(te.name);break;case 10:{if(--J)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,i["!ref"]=xt(l),e.sheetRows&&e.sheetRows<=l.e.r){var lt=l.e.r;l.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=xt(l),l.e.r=lt}l.e.r++,l.e.c++}ve.length>0&&(i["!merges"]=ve),xe.length>0&&(i["!objects"]=xe),ne.length>0&&(i["!cols"]=ne),le.length>0&&(i["!rows"]=le),A.Sheets.push(R)}d===""?m=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[Re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),M.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(M.biff=5,oe=!0,aa(M.codepage=28591)),M.biff==8&&te.BIFFVer==0&&te.dt==16&&(M.biff=2),J++)break;if(i=e.dense?[]:{},M.biff<8&&!oe&&(oe=!0,aa(M.codepage=e.codepage||1252)),M.biff<5||te.BIFFVer==0&&te.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var At={pos:r.l-Se,name:d};s[At.pos]=At,M.snames.push(d)}else d=(s[Te]||{name:""}).name;te.dt==32&&(i["!type"]="chart"),te.dt==64&&(i["!type"]="macro"),ve=[],xe=[],M.arrayf=U=[],ne=[],le=[],Le=!1,R={Hidden:(s[Te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[te.r]||[])[te.c]:i[ut({c:te.c,r:te.r})])&&++te.c,k={ixfe:te.ixfe,XF:Z[te.ixfe]||{},v:te.val,t:"n"},O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:te.c,r:te.r},k,e);break;case 5:case 517:k={ixfe:te.ixfe,XF:Z[te.ixfe],v:te.val,t:te.t},O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:te.c,r:te.r},k,e);break;case 638:k={ixfe:te.ixfe,XF:Z[te.ixfe],v:te.rknum,t:"n"},O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:te.c,r:te.r},k,e);break;case 189:for(var Xe=te.c;Xe<=te.C;++Xe){var Oe=te.rkrec[Xe-te.c][0];k={ixfe:Oe,XF:Z[Oe],v:te.rkrec[Xe-te.c][1],t:"n"},O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:Xe,r:te.r},k,e)}break;case 6:case 518:case 1030:{if(te.val=="String"){c=te;break}if(k=Rm(te.val,te.cell.ixfe,te.tt),k.XF=Z[k.ixfe],e.cellFormula){var nt=te.formula;if(nt&&nt[0]&&nt[0][0]&&nt[0][0][0]=="PtgExp"){var gt=nt[0][0][1][0],Mt=nt[0][0][1][1],qr=ut({r:gt,c:Mt});D[qr]?k.f=""+Hn(te.formula,l,te.cell,ae,M):k.F=((e.dense?(i[gt]||[])[Mt]:i[qr])||{}).F}else k.f=""+Hn(te.formula,l,te.cell,ae,M)}O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N(te.cell,k,e),c=te}break;case 7:case 519:if(c)c.val=te,k=Rm(te,c.cell.ixfe,"s"),k.XF=Z[k.ixfe],e.cellFormula&&(k.f=""+Hn(c.formula,l,c.cell,ae,M)),O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N(c.cell,k,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{U.push(te);var fa=ut(te[0].s);if(y=e.dense?(i[te[0].s.r]||[])[te[0].s.c]:i[fa],e.cellFormula&&y){if(!c||!fa||!y)break;y.f=""+Hn(te[1],l,te[0],ae,M),y.F=xt(te[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;D[ut(c.cell)]=te[0],y=e.dense?(i[c.cell.r]||[])[c.cell.c]:i[ut(c.cell)],(y||{}).f=""+Hn(te[0],l,_,ae,M)}}break;case 253:k=Rm(f[te.isst].t,te.ixfe,"s"),f[te.isst].h&&(k.h=f[te.isst].h),k.XF=Z[k.ixfe],O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:te.c,r:te.r},k,e);break;case 513:e.sheetStubs&&(k={ixfe:te.ixfe,XF:Z[te.ixfe],t:"z"},O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:te.c,r:te.r},k,e));break;case 190:if(e.sheetStubs)for(var Qn=te.c;Qn<=te.C;++Qn){var qt=te.ixfe[Qn-te.c];k={ixfe:qt,XF:Z[qt],t:"z"},O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:Qn,r:te.r},k,e)}break;case 214:case 516:case 4:k=Rm(te.val,te.ixfe,"s"),k.XF=Z[k.ixfe],O>0&&(k.z=Q[k.ixfe>>8&63]),qa(k,e,t.opts.Date1904),N({c:te.c,r:te.r},k,e);break;case 0:case 512:J===1&&(l=te);break;case 252:f=te;break;case 1054:if(M.biff==4){Q[O++]=te[1];for(var an=0;an<O+163&&ot[an]!=te[1];++an);an>=163&&Ja(te[1],O+163)}else Ja(te[1],te[0]);break;case 30:{Q[O++]=te;for(var Pn=0;Pn<O+163&&ot[Pn]!=te;++Pn);Pn>=163&&Ja(te,O+163)}break;case 229:ve=ve.concat(te);break;case 93:xe[te.cmo[0]]=M.lastobj=te;break;case 438:M.lastobj.TxO=te;break;case 127:M.lastobj.ImData=te;break;case 440:for(S=te[0].s.r;S<=te[0].e.r;++S)for(E=te[0].s.c;E<=te[0].e.c;++E)y=e.dense?(i[S]||[])[E]:i[ut({c:E,r:S})],y&&(y.l=te[1]);break;case 2048:for(S=te[0].s.r;S<=te[0].e.r;++S)for(E=te[0].s.c;E<=te[0].e.c;++E)y=e.dense?(i[S]||[])[E]:i[ut({c:E,r:S})],y&&y.l&&(y.l.Tooltip=te[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;y=e.dense?(i[te[0].r]||[])[te[0].c]:i[ut(te[0])];var _i=xe[te[2]];y||(e.dense?(i[te[0].r]||(i[te[0].r]=[]),y=i[te[0].r][te[0].c]={t:"z"}):y=i[ut(te[0])]={t:"z"},l.e.r=Math.max(l.e.r,te[0].r),l.s.r=Math.min(l.s.r,te[0].r),l.e.c=Math.max(l.e.c,te[0].c),l.s.c=Math.min(l.s.c,te[0].c)),y.c||(y.c=[]),T={a:te[1],t:_i.TxO.t},y.c.push(T)}break;case 2173:pP(Z[te.ixfe],te.ext);break;case 125:{if(!M.cellStyles)break;for(;te.e>=te.s;)ne[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},Le||(Le=!0,Px(te.w/256)),Jo(ne[te.e+1])}break;case 520:{var gr={};te.level!=null&&(le[te.r]=gr,gr.level=te.level),te.hidden&&(le[te.r]=gr,gr.hidden=!0),te.hpt&&(le[te.r]=gr,gr.hpt=te.hpt,gr.hpx=Wu(te.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ql(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Re]]=te;break;case 161:i["!margins"]||Ql(i["!margins"]={}),i["!margins"].header=te.header,i["!margins"].footer=te.footer;break;case 574:te.RTL&&(A.Views[0].RTL=!0);break;case 146:X=te;break;case 2198:B=te;break;case 140:W=te;break;case 442:d?R.CodeName=te||R.name:A.WBProps.CodeName=te||"ThisWorkbook";break}}else De||console.error("Missing Info for XLS Record 0x"+Re.toString(16)),r.l+=Se}return t.SheetNames=Vr(s).sort(function(dt,Ye){return Number(dt)-Number(Ye)}).map(function(dt){return s[dt].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&m["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=m)):t.Preamble=m,t.Sheets&&q.forEach(function(dt,Ye){t.Sheets[t.SheetNames[Ye]]["!autofilter"]=dt}),t.Strings=f,t.SSF=pr(ot),M.enc&&(t.Encryption=M.enc),B&&(t.Themes=B),t.Metadata={},W!==void 0&&(t.Metadata.Country=W),ae.names.length>0&&(A.Names=ae.names),t.Workbook=A,t}var jh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function kB(r,e,t){var n=it.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ES(n,gv,jh.DSI);for(var s in i)e[s]=i[s]}catch(d){if(t.WTF)throw d}var l=it.find(r,"/!SummaryInformation");if(l&&l.size>0)try{var c=ES(l,_v,jh.SI);for(var f in c)e[f]==null&&(e[f]=c[f])}catch(d){if(t.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&($I(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function CB(r,e){var t=[],n=[],i=[],s=0,l,c=Qw(gv,"n"),f=Qw(_v,"n");if(r.Props)for(l=Vr(r.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(c,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:i).push([l[s],r.Props[l[s]]]);if(r.Custprops)for(l=Vr(r.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(c,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:i).push([l[s],r.Custprops[l[s]]]);var d=[];for(s=0;s<i.length;++s)nk.indexOf(i[s][0])>-1||YI.indexOf(i[s][0])>-1||i[s][1]!=null&&d.push(i[s]);n.length&&it.utils.cfb_add(e,"/SummaryInformation",TS(n,jh.SI,f,_v)),(t.length||d.length)&&it.utils.cfb_add(e,"/DocumentSummaryInformation",TS(t,jh.DSI,c,gv,d.length?d:null,jh.UDI))}function Hx(r,e){e||(e={}),qx(e),Gp(),e.codepage&&Hp(e.codepage);var t,n;if(r.FullPaths){if(it.find(r,"/encryption"))throw new Error("File is password-protected");t=it.find(r,"!CompObj"),n=it.find(r,"/Workbook")||it.find(r,"/Book")}else{switch(e.type){case"base64":r=Ri(Li(r));break;case"binary":r=Ri(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}Nn(r,0),n={content:r}}var i,s;if(t&&SB(t),e.bookProps&&!e.bookSheets)i={};else{var l=Tt?"buffer":"array";if(n&&n.content)i=IB(n.content,e);else if((s=it.find(r,"PerfectOffice_MAIN"))&&s.content)i=$l.to_workbook(s.content,(e.type=l,e));else if((s=it.find(r,"NativeContent_MAIN"))&&s.content)i=$l.to_workbook(s.content,(e.type=l,e));else throw(s=it.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&it.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=HP(r))}var c={};return r.FullPaths&&kB(r,c,e),i.Props=i.Custprops=c,e.bookFiles&&(i.cfb=r),i}function RB(r,e){var t=e||{},n=it.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return it.utils.cfb_add(n,i,Zk(r,t)),t.biff==8&&(r.Props||r.Custprops)&&CB(r,n),t.biff==8&&r.vbaraw&&GP(n,it.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var d0={0:{f:tL},1:{f:cL},2:{f:kL},3:{f:_L},4:{f:dL},5:{f:AL},6:{f:OL},7:{f:EL},8:{f:UL},9:{f:BL},10:{f:LL},11:{f:VL},12:{f:fL},13:{f:RL},14:{f:xL},15:{f:pL},16:{f:Gk},17:{f:PL},18:{f:wL},19:{f:Ax},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:FV},40:{},42:{},43:{f:O8},44:{f:D8},45:{f:M8},46:{f:V8},47:{f:L8},48:{},49:{f:iO},50:{},51:{f:vP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:mk},62:{f:NL},63:{f:IP},64:{f:rV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:oL},148:{f:iL,p:16},151:{f:KL},152:{},153:{f:DV},154:{},155:{},156:{f:CV},157:{},158:{},159:{T:1,f:XF},160:{T:-1},161:{T:1,f:Ac},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gP},336:{T:-1},337:{f:EP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:WL},427:{f:XL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$L},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:sL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:GL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:VP},633:{T:1},634:{T:-1},635:{T:1,f:MP},636:{T:-1},637:{f:lO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:xV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:nV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},wv={6:{f:L_},10:{f:ko},12:{f:en},13:{f:en},14:{f:jr},15:{f:jr},16:{f:qn},17:{f:jr},18:{f:jr},19:{f:en},20:{f:kS},21:{f:kS},23:{f:dk},24:{f:RS},25:{f:jr},26:{},27:{},28:{f:nF},29:{},34:{f:jr},35:{f:CS},38:{f:qn},39:{f:qn},40:{f:qn},41:{f:qn},42:{f:jr},43:{f:jr},47:{f:p8},49:{f:R6},51:{f:en},60:{},61:{f:A6},64:{f:jr},65:{f:C6},66:{f:en},77:{},80:{},81:{},82:{},85:{f:en},89:{},90:{},91:{},92:{f:m6},93:{f:sF},94:{},95:{f:jr},96:{},97:{},99:{f:jr},125:{f:mk},128:{f:q6},129:{f:g6},130:{f:en},131:{f:jr},132:{f:jr},133:{f:_6},134:{},140:{f:mF},141:{f:en},144:{},146:{f:_F},151:{},152:{},153:{},154:{},155:{},156:{f:en},157:{},158:{},160:{f:SF},161:{f:yF},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:z6},190:{f:j6},193:{f:ko},197:{},198:{},199:{},200:{},201:{},202:{f:jr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:en},220:{},221:{f:jr},222:{},224:{f:G6},225:{f:d6},226:{f:ko},227:{},229:{f:iF},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:x6},253:{f:N6},255:{f:E6},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ik},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jr},353:{f:ko},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$6},431:{f:jr},432:{},433:{},434:{},437:{},438:{f:cF},439:{f:jr},440:{f:uF},441:{},442:{f:L0},443:{},444:{f:en},445:{},446:{},448:{f:ko},449:{f:S6,r:2},450:{f:ko},512:{f:AS},513:{f:wF},515:{f:X6},516:{f:F6},517:{f:IS},519:{f:AF},520:{f:T6},523:{},545:{f:DS},549:{f:SS},566:{},574:{f:I6},638:{f:U6},659:{},1048:{},1054:{f:M6},1084:{},1212:{f:eF},2048:{f:hF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Im},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ko},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vF,r:12},2173:{f:mP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Z6,r:12},2197:{},2198:{f:lP,r:12},2199:{},2200:{},2201:{},2202:{f:tF,r:12},2203:{f:ko},2204:{},2205:{},2206:{},2207:{},2211:{f:w6},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:en},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:EF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:gF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:AS},1:{},2:{f:RF},3:{f:kF},4:{f:IF},5:{f:IS},7:{f:NF},8:{},9:{f:Im},11:{},22:{f:en},30:{f:V6},31:{},32:{},33:{f:DS},36:{},37:{f:SS},50:{f:OF},62:{},52:{},67:{},68:{f:en},69:{},86:{},126:{},127:{f:bF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:FF},223:{},234:{},354:{},421:{},518:{f:L_},521:{f:Im},536:{f:RS},547:{f:CS},561:{},579:{},1030:{f:L_},1033:{f:Im},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(r,e,t,n){var i=e;if(!isNaN(i)){var s=n||(t||[]).length||0,l=r.next(4);l.write_shift(2,i),l.write_shift(2,s),s>0&&Tx(t)&&r.push(t)}}function DB(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return ze(r,e,t,i);var s=e;if(!isNaN(s)){for(var l=t.parts||[],c=0,f=0,d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;var m=r.next(4);for(m.write_shift(2,s),m.write_shift(2,d),r.push(t.slice(f,f+d)),f+=d;f<i;){for(m=r.next(4),m.write_shift(2,60),d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;m.write_shift(2,d),r.push(t.slice(f,f+d)),f+=d}}}function z0(r,e,t){return r||(r=we(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function NB(r,e,t,n){var i=we(9);return z0(i,r,e),ak(t,n||"b",i),i}function OB(r,e,t){var n=we(8+2*t.length);return z0(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function FB(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?cn(Er(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ze(r,2,DF(t,n,i)):ze(r,3,CF(t,n,i));return;case"b":case"e":ze(r,5,NB(t,n,e.v,e.t));return;case"s":case"str":ze(r,4,OB(t,n,(e.v||"").slice(0,255)));return}ze(r,1,z0(null,t,n))}function PB(r,e,t,n){var i=Array.isArray(e),s=Nt(e["!ref"]||"A1"),l,c="",f=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=xt(s)}for(var d=s.s.r;d<=s.e.r;++d){c=Mr(d);for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(f[m]=yr(m)),l=f[m]+c;var _=i?(e[d]||[])[m]:e[l];_&&FB(r,_,d,m)}}}function MB(r,e){for(var t=e||{},n=pi(),i=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ze(n,t.biff==4?1033:t.biff==3?521:9,Nx(r,16,t)),PB(n,r.Sheets[r.SheetNames[i]],i,t),ze(n,10),n.end()}function LB(r,e,t){ze(r,49,D6({sz:12,name:"Arial"},t))}function VB(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ze(r,1054,L6(i,e[i],t))})}function BB(r,e){var t=we(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ze(r,2151,t),t=we(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),uk(Nt(e["!ref"]||"A1"),t),t.write_shift(4,4),ze(r,2152,t)}function UB(r,e){for(var t=0;t<16;++t)ze(r,224,bS({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ze(r,224,bS(n,0,e))})}function zB(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];ze(r,440,fF(n)),n[1].Tooltip&&ze(r,2048,dF(n))}delete e["!links"]}function jB(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&ze(r,125,xF(Jp(i,n),i))})}}function HB(r,e,t,n,i){var s=16+ll(i.cellXfs,e,i);if(e.v==null&&!e.bf){ze(r,513,oc(t,n,s));return}if(e.bf)ze(r,6,g9(e,t,n,i,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?cn(Er(e.v)):e.v;ze(r,515,Y6(t,n,l,s));break;case"b":case"e":ze(r,517,W6(t,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var c=Ux(i.Strings,e.v,i.revStrings);ze(r,253,O6(t,n,c,s))}else ze(r,516,P6(t,n,(e.v||"").slice(0,255),s,i));break;default:ze(r,513,oc(t,n,s))}}function GB(r,e,t){var n=pi(),i=t.SheetNames[r],s=t.Sheets[i]||{},l=(t||{}).Workbook||{},c=(l.Sheets||[])[r]||{},f=Array.isArray(s),d=e.biff==8,m,_="",x=[],y=Nt(s["!ref"]||"A1"),T=d?65536:16384;if(y.e.c>255||y.e.r>=T){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,T-1)}ze(n,2057,Nx(t,16,e)),ze(n,13,ia(1)),ze(n,12,ia(100)),ze(n,15,ri(!0)),ze(n,17,ri(!1)),ze(n,16,ac(.001)),ze(n,95,ri(!0)),ze(n,42,ri(!1)),ze(n,43,ri(!1)),ze(n,130,ia(1)),ze(n,128,K6()),ze(n,131,ri(!1)),ze(n,132,ri(!1)),d&&jB(n,s["!cols"]),ze(n,512,B6(y,e)),d&&(s["!links"]=[]);for(var E=y.s.r;E<=y.e.r;++E){_=Mr(E);for(var S=y.s.c;S<=y.e.c;++S){E===y.s.r&&(x[S]=yr(S)),m=x[S]+_;var D=f?(s[E]||[])[S]:s[m];D&&(HB(n,D,E,S,e),d&&D.l&&s["!links"].push([m,D.l]))}}var U=c.CodeName||c.name||i;return d&&ze(n,574,k6((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&ze(n,229,aF(s["!merges"])),d&&zB(n,s),ze(n,442,sk(U)),d&&BB(n,s),ze(n,10),n.end()}function qB(r,e,t){var n=pi(),i=(r||{}).Workbook||{},s=i.Sheets||[],l=i.WBProps||{},c=t.biff==8,f=t.biff==5;if(ze(n,2057,Nx(r,5,t)),t.bookType=="xla"&&ze(n,135),ze(n,225,c?ia(1200):null),ze(n,193,WO(2)),f&&ze(n,191),f&&ze(n,192),ze(n,226),ze(n,92,p6("SheetJS",t)),ze(n,66,ia(c?1200:1252)),c&&ze(n,353,ia(0)),c&&ze(n,448),ze(n,317,TF(r.SheetNames.length)),c&&r.vbaraw&&ze(n,211),c&&r.vbaraw){var d=l.CodeName||"ThisWorkbook";ze(n,442,sk(d))}ze(n,156,ia(17)),ze(n,25,ri(!1)),ze(n,18,ri(!1)),ze(n,19,ia(0)),c&&ze(n,431,ri(!1)),c&&ze(n,444,ia(0)),ze(n,61,b6()),ze(n,64,ri(!1)),ze(n,141,ia(0)),ze(n,34,ri(SV(r)=="true")),ze(n,14,ri(!0)),c&&ze(n,439,ri(!1)),ze(n,218,ia(0)),LB(n,r,t),VB(n,r.SSF,t),UB(n,t),c&&ze(n,352,ri(!1));var m=n.end(),_=pi();c&&ze(_,140,pF()),c&&t.Strings&&DB(_,252,y6(t.Strings)),ze(_,10);var x=_.end(),y=pi(),T=0,E=0;for(E=0;E<r.SheetNames.length;++E)T+=(c?12:11)+(c?2:1)*r.SheetNames[E].length;var S=m.length+T+x.length;for(E=0;E<r.SheetNames.length;++E){var D=s[E]||{};ze(y,133,v6({pos:S,hs:D.Hidden||0,dt:0,name:r.SheetNames[E]},t)),S+=e[E].length}var U=y.end();if(T!=U.length)throw new Error("BS8 "+T+" != "+U.length);var k=[];return m.length&&k.push(m),U.length&&k.push(U),x.length&&k.push(x),vn(k)}function KB(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=pr(ot)),r&&r.SSF&&(uf(),F0(r.SSF),t.revssf=Kp(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Kx(t),t.cellXfs=[],ll(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=GB(i,t,r);return n.unshift(qB(r,n,t)),vn(n)}function Zk(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=ai(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return KB(r,e);case 4:case 3:case 2:return MB(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function zS(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),l=i.index,c=s&&s.index||r.length,f=D5(r.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,_=0,x=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},T=[];for(l=0;l<f.length;++l){var E=f[l].trim(),S=E.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}m=0;continue}if(!(S!="<td"&&S!="<th")){var D=E.split(/<\/t[dh]>/i);for(c=0;c<D.length;++c){var U=D[c].trim();if(U.match(/<t[dh]/i)){for(var k=U,W=0;k.charAt(0)=="<"&&(W=k.indexOf(">"))>-1;)k=k.slice(W+1);for(var Z=0;Z<T.length;++Z){var X=T[Z];X.s.c==m&&X.s.r<d&&d<=X.e.r&&(m=X.e.c+1,Z=-1)}var A=ft(U.slice(0,U.indexOf(">")));x=A.colspan?+A.colspan:1,((_=+A.rowspan)>1||x>1)&&T.push({s:{r:d,c:m},e:{r:d+(_||1)-1,c:m+x-1}});var R=A.t||A["data-t"]||"";if(!k.length){m+=x;continue}if(k=II(k),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>m&&(y.s.c=m),y.e.c<m&&(y.e.c=m),!k.length){m+=x;continue}var C={t:"s",v:k};t.raw||!k.trim().length||R=="s"||(k==="TRUE"?C={t:"b",v:!0}:k==="FALSE"?C={t:"b",v:!1}:isNaN(ka(k))?isNaN(qu(k).getDate())||(C={t:"d",v:Er(k)},t.cellDates||(C={t:"n",v:cn(C.v)}),C.z=t.dateNF||ot[14]):C={t:"n",v:ka(k)}),t.dense?(n[d]||(n[d]=[]),n[d][m]=C):n[ut({r:d,c:m})]=C,m+=x}}}}return n["!ref"]=xt(y),T.length&&(n["!merges"]=T),n}function eC(r,e,t,n){for(var i=r["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,f=0,d=0;d<i.length;++d)if(!(i[d].s.r>t||i[d].s.c>l)&&!(i[d].e.r<t||i[d].e.c<l)){if(i[d].s.r<t||i[d].s.c<l){c=-1;break}c=i[d].e.r-i[d].s.r+1,f=i[d].e.c-i[d].s.c+1;break}if(!(c<0)){var m=ut({r:t,c:l}),_=n.dense?(r[t]||[])[l]:r[m],x=_&&_.v!=null&&(_.h||px(_.w||(rs(_),_.w)||""))||"",y={};c>1&&(y.rowspan=c),f>1&&(y.colspan=f),n.editable?x='<span contenteditable="true">'+x+"</span>":_&&(y["data-t"]=_&&_.t||"z",_.v!=null&&(y["data-v"]=_.v),_.z!=null&&(y["data-z"]=_.z),_.l&&(_.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+_.l.Target+'">'+x+"</a>")),y.id=(n.id||"sjs")+"-"+m,s.push(Ue("td",x,y))}}var T="<tr>";return T+s.join("")+"</tr>"}var tC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rC="</body></html>";function WB(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return ol(zS(t[0],e),e);var n=Qx();return t.forEach(function(i,s){Jx(n,zS(i,e),"Sheet"+(s+1))}),n}function nC(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function iC(r,e){var t=e||{},n=t.header!=null?t.header:tC,i=t.footer!=null?t.footer:rC,s=[n],l=ai(r["!ref"]);t.dense=Array.isArray(r),s.push(nC(r,l,t));for(var c=l.s.r;c<=l.e.r;++c)s.push(eC(r,l,c,t));return s.push("</table>"+i),s.join("")}function aC(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;i=l.r,s=l.c}var c=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var m=ai(r["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),i==-1&&(d.e.r=i=m.e.r+1)}var _=[],x=0,y=r["!rows"]||(r["!rows"]=[]),T=0,E=0,S=0,D=0,U=0,k=0;for(r["!cols"]||(r["!cols"]=[]);T<c.length&&E<f;++T){var W=c[T];if(jS(W)){if(n.display)continue;y[E]={hidden:!0}}var Z=W.children;for(S=D=0;S<Z.length;++S){var X=Z[S];if(!(n.display&&jS(X))){var A=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):II(X.innerHTML),R=X.getAttribute("data-z")||X.getAttribute("z");for(x=0;x<_.length;++x){var C=_[x];C.s.c==D+s&&C.s.r<E+i&&E+i<=C.e.r&&(D=C.e.c+1-s,x=-1)}k=+X.getAttribute("colspan")||1,((U=+X.getAttribute("rowspan")||1)>1||k>1)&&_.push({s:{r:E+i,c:D+s},e:{r:E+i+(U||1)-1,c:D+s+(k||1)-1}});var V={t:"s",v:A},N=X.getAttribute("data-t")||X.getAttribute("t")||"";A!=null&&(A.length==0?V.t=N||"z":n.raw||A.trim().length==0||N=="s"||(A==="TRUE"?V={t:"b",v:!0}:A==="FALSE"?V={t:"b",v:!1}:isNaN(ka(A))?isNaN(qu(A).getDate())||(V={t:"d",v:Er(A)},n.cellDates||(V={t:"n",v:cn(V.v)}),V.z=n.dateNF||ot[14]):V={t:"n",v:ka(A)})),V.z===void 0&&R!=null&&(V.z=R);var M="",B=X.getElementsByTagName("A");if(B&&B.length)for(var ve=0;ve<B.length&&!(B[ve].hasAttribute("href")&&(M=B[ve].getAttribute("href"),M.charAt(0)!="#"));++ve);M&&M.charAt(0)!="#"&&(V.l={Target:M}),n.dense?(r[E+i]||(r[E+i]=[]),r[E+i][D+s]=V):r[ut({c:D+s,r:E+i})]=V,d.e.c<D+s&&(d.e.c=D+s),D+=k}}++E}return _.length&&(r["!merges"]=(r["!merges"]||[]).concat(_)),d.e.r=Math.max(d.e.r,E-1+i),r["!ref"]=xt(d),E>=f&&(r["!fullref"]=xt((d.e.r=c.length-T+E-1+i,d))),r}function sC(r,e){var t=e||{},n=t.dense?[]:{};return aC(n,r,e)}function XB(r,e){return ol(sC(r,e),e)}function jS(r){var e="",t=YB(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function YB(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $B(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Bt(e.replace(/<[^>]*>/g,""));return[t]}var HS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function oC(r,e){var t=e||{},n=gx(r),i=[],s,l,c={name:""},f="",d=0,m,_,x={},y=[],T=t.dense?[]:{},E,S,D={value:""},U="",k=0,W=[],Z=-1,X=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,C={},V=[],N={},M=0,B=0,ve=[],xe=1,ne=1,le=[],Le={Names:[]},ae={},Pe=["",""],J=[],O={},Q="",q=0,ee=!1,oe=!1,Te=0;for(o0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=o0.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?T["!ref"]=xt(A):T["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=A.e.r&&(T["!fullref"]=T["!ref"],A.e.r=t.sheetRows-1,T["!ref"]=xt(A)),V.length&&(T["!merges"]=V),ve.length&&(T["!rows"]=ve),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),y.push(m.name),x[m.name]=T,oe=!1):E[0].charAt(E[0].length-2)!=="/"&&(m=ft(E[0],!1),Z=X=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,T=t.dense?[]:{},V=[],ve=[],oe=!0);break;case"table-row-group":E[1]==="/"?--R:++R;break;case"table-row":case"":if(E[1]==="/"){Z+=xe,xe=1;break}if(_=ft(E[0],!1),_.?Z=_.-1:Z==-1&&(Z=0),xe=+_["number-rows-repeated"]||1,xe<10)for(Te=0;Te<xe;++Te)R>0&&(ve[Z+Te]={level:R});X=-1;break;case"covered-table-cell":E[1]!=="/"&&++X,t.sheetStubs&&(t.dense?(T[Z]||(T[Z]=[]),T[Z][X]={t:"z"}):T[ut({r:Z,c:X})]={t:"z"}),U="",W=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++X,D=ft(E[0],!1),ne=parseInt(D["number-columns-repeated"]||"1",10),S={t:"z",v:null},D.formula&&t.cellFormula!=!1&&(S.f=VS(Bt(D.formula))),(D.||D["value-type"])=="string"&&(S.t="s",S.v=Bt(D["string-value"]||""),t.dense?(T[Z]||(T[Z]=[]),T[Z][X]=S):T[ut({r:Z,c:X})]=S),X+=ne-1;else if(E[1]!=="/"){++X,U="",k=0,W=[],ne=1;var Re=xe?Z+xe-1:Z;if(X>A.e.c&&(A.e.c=X),X<A.s.c&&(A.s.c=X),Z<A.s.r&&(A.s.r=Z),Re>A.e.r&&(A.e.r=Re),D=ft(E[0],!1),J=[],O={},S={t:D.||D["value-type"],v:null},t.cellFormula)if(D.formula&&(D.formula=Bt(D.formula)),D["number-matrix-columns-spanned"]&&D["number-matrix-rows-spanned"]&&(M=parseInt(D["number-matrix-rows-spanned"],10)||0,B=parseInt(D["number-matrix-columns-spanned"],10)||0,N={s:{r:Z,c:X},e:{r:Z+M-1,c:X+B-1}},S.F=xt(N),le.push([N,S.F])),D.formula)S.f=VS(D.formula);else for(Te=0;Te<le.length;++Te)Z>=le[Te][0].s.r&&Z<=le[Te][0].e.r&&X>=le[Te][0].s.c&&X<=le[Te][0].e.c&&(S.F=le[Te][1]);switch((D["number-columns-spanned"]||D["number-rows-spanned"])&&(M=parseInt(D["number-rows-spanned"],10)||0,B=parseInt(D["number-columns-spanned"],10)||0,N={s:{r:Z,c:X},e:{r:Z+M-1,c:X+B-1}},V.push(N)),D["number-columns-repeated"]&&(ne=parseInt(D["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=xr(D["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(D.value);break;case"percentage":S.t="n",S.v=parseFloat(D.value);break;case"currency":S.t="n",S.v=parseFloat(D.value);break;case"date":S.t="d",S.v=Er(D["date-value"]),t.cellDates||(S.t="n",S.v=cn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=k5(D["time-value"])/86400,t.cellDates&&(S.t="d",S.v=Wp(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(D.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",D["string-value"]!=null&&(U=Bt(D["string-value"]),W=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(ee=!1,S.t==="s"&&(S.v=U||"",W.length&&(S.R=W),ee=k==0),ae.Target&&(S.l=ae),J.length>0&&(S.c=J,J=[]),U&&t.cellText!==!1&&(S.w=U),ee&&(S.t="z",delete S.v),(!ee||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=Z))for(var Se=0;Se<xe;++Se){if(ne=parseInt(D["number-columns-repeated"]||"1",10),t.dense)for(T[Z+Se]||(T[Z+Se]=[]),T[Z+Se][X]=Se==0?S:pr(S);--ne>0;)T[Z+Se][X+ne]=pr(S);else for(T[ut({r:Z+Se,c:X})]=S;--ne>0;)T[ut({r:Z+Se,c:X+ne})]=pr(S);A.e.c<=X&&(A.e.c=X)}ne=parseInt(D["number-columns-repeated"]||"1",10),X+=ne-1,ne=0,S={},U="",W=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((s=i.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((s=i.pop())[0]!==E[3])throw"Bad state: "+s;O.t=U,W.length&&(O.R=W),O.a=Q,J.push(O)}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);Q="",q=0,U="",k=0,W=[];break;case"creator":E[1]==="/"?Q=n.slice(q,E.index):q=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((s=i.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);U="",k=0,W=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(C[c.name]=f,(s=i.pop())[0]!==E[3])throw"Bad state: "+s}else E[0].charAt(E[0].length-2)!=="/"&&(f="",c=ft(E[0],!1),i.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":l=ft(E[0],!1),f+=HS[E[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":l=ft(E[0],!1),f+=HS[E[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,E.index);break}else d=E.index+E[0].length;break;case"named-range":l=ft(E[0],!1),Pe=V_(l["cell-range-address"]);var De={Name:l.name,Ref:Pe[0]+"!"+Pe[1]};oe&&(De.Sheet=y.length),Le.Names.push(De);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(E[1]==="/"&&(!D||!D["string-value"])){var st=$B(n.slice(k,E.index));U=(U.length>0?U+`
`:"")+st[0]}else ft(E[0],!1),k=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{Pe=V_(ft(E[0])["target-range-address"]),x[Pe[0]]["!autofilter"]={ref:Pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ae=ft(E[0],!1),!ae.href)break;ae.Target=Bt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Pe=V_(ae.Target.slice(1)),ae.Target="#"+Pe[0]+"!"+Pe[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(E)}}var te={Sheets:x,SheetNames:y,Workbook:Le};return t.bookSheets&&delete te.Sheets,te}function GS(r,e){e=e||{},na(r,"META-INF/manifest.xml")&&kO(Zr(r,"META-INF/manifest.xml"),e);var t=Di(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=oC(fr(t),e);return na(r,"meta.xml")&&(n.Props=WI(Zr(r,"meta.xml"))),n}function qS(r,e){return oC(r,e)}var QB=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+s0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Gr+e}})(),KS=(function(){var r=function(s){return ar(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,l,c){var f=[];f.push('      <table:table table:name="'+ar(l.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,m=0,_=ai(s["!ref"]||"A1"),x=s["!merges"]||[],y=0,T=Array.isArray(s);if(s["!cols"])for(m=0;m<=_.e.c;++m)f.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var E="",S=s["!rows"]||[];for(d=0;d<_.s.r;++d)E=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+E+`></table:table-row>
`);for(;d<=_.e.r;++d){for(E=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+E+`>
`),m=0;m<_.s.c;++m)f.push(e);for(;m<=_.e.c;++m){var D=!1,U={},k="";for(y=0;y!=x.length;++y)if(!(x[y].s.c>m)&&!(x[y].s.r>d)&&!(x[y].e.c<m)&&!(x[y].e.r<d)){(x[y].s.c!=m||x[y].s.r!=d)&&(D=!0),U["table:number-columns-spanned"]=x[y].e.c-x[y].s.c+1,U["table:number-rows-spanned"]=x[y].e.r-x[y].s.r+1;break}if(D){f.push(t);continue}var W=ut({r:d,c:m}),Z=T?(s[d]||[])[m]:s[W];if(Z&&Z.f&&(U["table:formula"]=ar(T9(Z.f)),Z.F&&Z.F.slice(0,W.length)==W)){var X=ai(Z.F);U["table:number-matrix-columns-spanned"]=X.e.c-X.s.c+1,U["table:number-matrix-rows-spanned"]=X.e.r-X.s.r+1}if(!Z){f.push(e);continue}switch(Z.t){case"b":k=Z.v?"TRUE":"FALSE",U["office:value-type"]="boolean",U["office:boolean-value"]=Z.v?"true":"false";break;case"n":k=Z.w||String(Z.v||0),U["office:value-type"]="float",U["office:value"]=Z.v||0;break;case"s":case"str":k=Z.v==null?"":Z.v,U["office:value-type"]="string";break;case"d":k=Z.w||Er(Z.v).toISOString(),U["office:value-type"]="date",U["office:date-value"]=Er(Z.v).toISOString(),U["table:style-name"]="ce1";break;default:f.push(e);continue}var A=r(k);if(Z.l&&Z.l.Target){var R=Z.l.Target;R=R.charAt(0)=="#"?"#"+w9(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),A=Ue("text:a",A,{"xlink:href":R.replace(/&/g,"&amp;")})}f.push("          "+Ue("table:table-cell",Ue("text:p",A,{}),U)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},i=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var _=d["!cols"][m];if(_.width==null&&_.wpx==null&&_.wch==null)continue;Jo(_),_.ods=c;var x=d["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++c}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var _=d["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+_+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,c){var f=[Gr],d=s0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=s0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(KI().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),i(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var _=0;_!=l.SheetNames.length;++_)f.push(n(l.Sheets[l.SheetNames[_]],l,_));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function lC(r,e){if(e.bookType=="fods")return KS(r,e);var t=hx(),n="",i=[],s=[];return n="mimetype",Et(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Et(t,n,KS(r,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Et(t,n,QB(r,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Et(t,n,Gr+KI()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Et(t,n,DO(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Et(t,n,CO(i)),t}function lc(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Sv(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):fr(sl(r))}function JB(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Ri(Ya(r))}function ZB(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function el(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function WS(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function e7(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,i=e+13;i>=e;--i)n=n*256+r[i];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function t7(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)r[e+s]=i&255;r[e+15]|=t>=0?0:128}function m0(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function rr(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Lr(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Ht(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=m0(r,t),s=i&7;i=Math.floor(i/8);var l=0,c;if(i==0)break;switch(s){case 0:{for(var f=t[0];r[t[0]++]>=128;);c=r.slice(f,t[0])}break;case 5:l=4,c=r.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=r.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=m0(r,t),c=r.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var d={data:c,type:s};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function Cn(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(rr(n*8+i.type)),i.type==2&&e.push(rr(i.data.length)),e.push(i.data))})}),el(e)}function Gx(r,e){return r?.map(function(t){return e(t.data)})||[]}function ta(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=m0(r,n),s=Ht(r.slice(n[0],n[0]+i));n[0]+=i;var l={id:Lr(s[1][0].data),messages:[]};s[2].forEach(function(c){var f=Ht(c.data),d=Lr(f[3][0].data);l.messages.push({meta:f,data:r.slice(n[0],n[0]+d)}),n[0]+=d}),(e=s[3])!=null&&e[0]&&(l.merge=Lr(s[3][0].data)>>>0>0),t.push(l)}return t}function gu(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:rr(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:rr(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(l){i.push(l.data),l.meta[3]=[{type:0,data:rr(l.data.length)}],n[2].push({data:Cn(l.meta),type:2})});var s=Cn(n);e.push(rr(s.length)),e.push(s),i.forEach(function(l){return e.push(l)})}),el(e)}function r7(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=m0(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var l=e[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[t[0]],c>1&&(l|=e[t[0]+1]<<8),c>2&&(l|=e[t[0]+2]<<16),c>3&&(l|=e[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}i.push(e.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,d=0;if(s==1?(d=(e[t[0]]>>2&7)+4,f=(e[t[0]++]&224)<<3,f|=e[t[0]++]):(d=(e[t[0]++]>>2)+1,s==2?(f=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(f=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[el(i)],f==0)throw new Error("Invalid offset 0");if(f>i[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(i.push(i[0].slice(-f)),d-=f;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-f,-f+d))}}var m=el(i);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function ra(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(r7(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return el(e)}function _u(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=rr(n),l=s.length;e.push(s),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),l+=n,i[0]=0,i[1]=l&255,i[2]=l>>8&255,i[3]=l>>16&255,t+=n}return el(e)}function n7(r,e,t,n){var i=lc(r),s=i.getUint32(4,!0),l=(n>1?12:8)+WS(s&(n>1?3470:398))*4,c=-1,f=-1,d=NaN,m=new Date(2001,0,1);s&512&&(c=i.getUint32(l,!0),l+=4),l+=WS(s&(n>1?12288:4096))*4,s&16&&(f=i.getUint32(l,!0),l+=4),s&32&&(d=i.getFloat64(l,!0),l+=8),s&64&&(m.setTime(m.getTime()+i.getFloat64(l,!0)*1e3),l+=8);var _;switch(r[2]){case 0:break;case 2:_={t:"n",v:d};break;case 3:_={t:"s",v:e[f]};break;case 5:_={t:"d",v:m};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(c>-1)_={t:"s",v:t[c]};else if(f>-1)_={t:"s",v:e[f]};else if(!isNaN(d))_={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return _}function i7(r,e,t){var n=lc(r),i=n.getUint32(8,!0),s=12,l=-1,c=-1,f=NaN,d=NaN,m=new Date(2001,0,1);i&1&&(f=e7(r,s),s+=16),i&2&&(d=n.getFloat64(s,!0),s+=8),i&4&&(m.setTime(m.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(c=n.getUint32(s,!0),s+=4),i&16&&(l=n.getUint32(s,!0),s+=4);var _;switch(r[1]){case 0:break;case 2:_={t:"n",v:f};break;case 3:_={t:"s",v:e[c]};break;case 5:_={t:"d",v:m};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(l>-1)_={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:_={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return _}function U_(r,e){var t=new Uint8Array(32),n=lc(t),i=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,t7(t,i,r.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,i)}function z_(r,e){var t=new Uint8Array(32),n=lc(t),i=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),s|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,i)}function a7(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return n7(r,e,t,r[0]);case 5:return i7(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function zn(r){var e=Ht(r);return m0(e[1][0].data)}function XS(r,e){var t=Ht(e.data),n=Lr(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(l){var c=Ht(l.data),f=Lr(c[1][0].data)>>>0;switch(n){case 1:s[f]=Sv(c[3][0].data);break;case 8:{var d=r[zn(c[9][0].data)][0],m=Ht(d.data),_=r[zn(m[1][0].data)][0],x=Lr(_.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var y=Ht(_.data);s[f]=y[3].map(function(T){return Sv(T.data)}).join("")}break}}),s}function s7(r,e){var t,n,i,s,l,c,f,d,m,_,x,y,T,E,S=Ht(r),D=Lr(S[1][0].data)>>>0,U=Lr(S[2][0].data)>>>0,k=((n=(t=S[8])==null?void 0:t[0])==null?void 0:n.data)&&Lr(S[8][0].data)>0||!1,W,Z;if((s=(i=S[7])==null?void 0:i[0])!=null&&s.data&&e!=0)W=(c=(l=S[7])==null?void 0:l[0])==null?void 0:c.data,Z=(d=(f=S[6])==null?void 0:f[0])==null?void 0:d.data;else if((_=(m=S[4])==null?void 0:m[0])!=null&&_.data&&e!=1)W=(y=(x=S[4])==null?void 0:x[0])==null?void 0:y.data,Z=(E=(T=S[3])==null?void 0:T[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var X=k?4:1,A=lc(W),R=[],C=0;C<W.length/2;++C){var V=A.getUint16(C*2,!0);V<65535&&R.push([C,V])}if(R.length!=U)throw"Expected ".concat(U," cells, found ").concat(R.length);var N=[];for(C=0;C<R.length-1;++C)N[R[C][0]]=Z.subarray(R[C][1]*X,R[C+1][1]*X);return R.length>=1&&(N[R[R.length-1][0]]=Z.subarray(R[R.length-1][1]*X)),{R:D,cells:N}}function o7(r,e){var t,n=Ht(e.data),i=(t=n?.[7])!=null&&t[0]?Lr(n[7][0].data)>>>0>0?1:0:-1,s=Gx(n[5],function(l){return s7(l,i)});return{nrows:Lr(n[4][0].data)>>>0,data:s.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,d){if(l[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));l[c.R][d]=f}),l},[])}}function l7(r,e,t){var n,i=Ht(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Lr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Lr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=xt(s);var l=Ht(i[4][0].data),c=XS(r,r[zn(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?XS(r,r[zn(l[17][0].data)][0]):[],d=Ht(l[3][0].data),m=0;d[1].forEach(function(_){var x=Ht(_.data),y=r[zn(x[2][0].data)][0],T=Lr(y.meta[1][0].data);if(T!=6002)throw new Error("6001 unexpected reference to ".concat(T));var E=o7(r,y);E.data.forEach(function(S,D){S.forEach(function(U,k){var W=ut({r:m+D,c:k}),Z=a7(U,c,f);Z&&(t[W]=Z)})}),m+=E.nrows})}function c7(r,e){var t=Ht(e.data),n={"!ref":"A1"},i=r[zn(t[2][0].data)],s=Lr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return l7(r,i[0],n),n}function u7(r,e){var t,n=Ht(e.data),i={name:(t=n[1])!=null&&t[0]?Sv(n[1][0].data):"",sheets:[]},s=Gx(n[2],zn);return s.forEach(function(l){r[l].forEach(function(c){var f=Lr(c.meta[1][0].data);f==6e3&&i.sheets.push(c7(r,c))})}),i}function f7(r,e){var t=Qx(),n=Ht(e.data),i=Gx(n[1],zn);if(i.forEach(function(s){r[s].forEach(function(l){var c=Lr(l.meta[1][0].data);if(c==2){var f=u7(r,l);f.sheets.forEach(function(d,m){Jx(t,d,m==0?f.name:f.name+"_"+m,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function j_(r){var e,t,n,i,s={},l=[];if(r.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=ra(f.content)}catch(_){return console.log("?? "+f.content.length+" "+(_.message||_))}var m;try{m=ta(d)}catch(_){return console.log("## "+(_.message||_))}m.forEach(function(_){s[_.id]=_.messages,l.push(_.id)})}}),!l.length)throw new Error("File has no messages");var c=((i=(n=(t=(e=s?.[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Lr(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||l.forEach(function(f){s[f].forEach(function(d){var m=Lr(d.meta[1][0].data)>>>0;if(m==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return f7(s,c)}function h7(r,e,t){var n,i,s,l;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(s=r[8])==null?void 0:s[0])==null?void 0:l.data)&&Lr(r[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,d=lc(r[7][0].data),m=0,_=[],x=lc(r[4][0].data),y=0,T=[],E=0;E<e.length;++E){if(e[E]==null){d.setUint16(E*2,65535,!0),x.setUint16(E*2,65535);continue}d.setUint16(E*2,m,!0),x.setUint16(E*2,y,!0);var S,D;switch(typeof e[E]){case"string":S=U_({t:"s",v:e[E]},t),D=z_({t:"s",v:e[E]},t);break;case"number":S=U_({t:"n",v:e[E]},t),D=z_({t:"n",v:e[E]},t);break;case"boolean":S=U_({t:"b",v:e[E]},t),D=z_({t:"b",v:e[E]},t);break;default:throw new Error("Unsupported value "+e[E])}_.push(S),m+=S.length,T.push(D),y+=D.length,++f}for(r[2][0].data=rr(f);E<r[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),x.setUint16(E*2,65535,!0);return r[6][0].data=el(_),r[3][0].data=el(T),f}function d7(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ai(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(xt(n)));var s=gp(t,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(Q){return Q.forEach(function(q){typeof q=="string"&&l.push(q)})});var c={},f=[],d=it.read(e.numbers,{type:"base64"});d.FileIndex.map(function(Q,q){return[Q,d.FullPaths[q]]}).forEach(function(Q){var q=Q[0],ee=Q[1];if(q.type==2&&q.name.match(/\.iwa/)){var oe=q.content,Te=ra(oe),Re=ta(Te);Re.forEach(function(Se){f.push(Se.id),c[Se.id]={deps:[],location:ee,type:Lr(Se.messages[0].meta[1][0].data)}})}}),f.sort(function(Q,q){return Q-q});var m=f.filter(function(Q){return Q>1}).map(function(Q){return[Q,rr(Q)]});d.FileIndex.map(function(Q,q){return[Q,d.FullPaths[q]]}).forEach(function(Q){var q=Q[0];if(Q[1],!!q.name.match(/\.iwa/)){var ee=ta(ra(q.content));ee.forEach(function(oe){oe.messages.forEach(function(Te){m.forEach(function(Re){oe.messages.some(function(Se){return Lr(Se.meta[1][0].data)!=11006&&ZB(Se.data,Re[1])})&&c[Re[0]].deps.push(oe.id)})})})}});for(var _=it.find(d,c[1].location),x=ta(ra(_.content)),y,T=0;T<x.length;++T){var E=x[T];E.id==1&&(y=E)}var S=zn(Ht(y.messages[0].data)[1][0].data);for(_=it.find(d,c[S].location),x=ta(ra(_.content)),T=0;T<x.length;++T)E=x[T],E.id==S&&(y=E);for(S=zn(Ht(y.messages[0].data)[2][0].data),_=it.find(d,c[S].location),x=ta(ra(_.content)),T=0;T<x.length;++T)E=x[T],E.id==S&&(y=E);for(S=zn(Ht(y.messages[0].data)[2][0].data),_=it.find(d,c[S].location),x=ta(ra(_.content)),T=0;T<x.length;++T)E=x[T],E.id==S&&(y=E);var D=Ht(y.messages[0].data);{D[6][0].data=rr(n.e.r+1),D[7][0].data=rr(n.e.c+1);var U=zn(D[46][0].data),k=it.find(d,c[U].location),W=ta(ra(k.content));{for(var Z=0;Z<W.length&&W[Z].id!=U;++Z);if(W[Z].id!=U)throw"Bad ColumnRowUIDMapArchive";var X=Ht(W[Z].messages[0].data);X[1]=[],X[2]=[],X[3]=[];for(var A=0;A<=n.e.c;++A){var R=[];R[1]=R[2]=[{type:0,data:rr(A+420690)}],X[1].push({type:2,data:Cn(R)}),X[2].push({type:0,data:rr(A)}),X[3].push({type:0,data:rr(A)})}X[4]=[],X[5]=[],X[6]=[];for(var C=0;C<=n.e.r;++C)R=[],R[1]=R[2]=[{type:0,data:rr(C+726270)}],X[4].push({type:2,data:Cn(R)}),X[5].push({type:0,data:rr(C)}),X[6].push({type:0,data:rr(C)});W[Z].messages[0].data=Cn(X)}k.content=_u(gu(W)),k.size=k.content.length,delete D[46];var V=Ht(D[4][0].data);{V[7][0].data=rr(n.e.r+1);var N=Ht(V[1][0].data),M=zn(N[2][0].data);k=it.find(d,c[M].location),W=ta(ra(k.content));{if(W[0].id!=M)throw"Bad HeaderStorageBucket";var B=Ht(W[0].messages[0].data);for(C=0;C<s.length;++C){var ve=Ht(B[2][0].data);ve[1][0].data=rr(C),ve[4][0].data=rr(s[C].length),B[2][C]={type:B[2][0].type,data:Cn(ve)}}W[0].messages[0].data=Cn(B)}k.content=_u(gu(W)),k.size=k.content.length;var xe=zn(V[2][0].data);k=it.find(d,c[xe].location),W=ta(ra(k.content));{if(W[0].id!=xe)throw"Bad HeaderStorageBucket";for(B=Ht(W[0].messages[0].data),A=0;A<=n.e.c;++A)ve=Ht(B[2][0].data),ve[1][0].data=rr(A),ve[4][0].data=rr(n.e.r+1),B[2][A]={type:B[2][0].type,data:Cn(ve)};W[0].messages[0].data=Cn(B)}k.content=_u(gu(W)),k.size=k.content.length;var ne=zn(V[4][0].data);(function(){for(var Q=it.find(d,c[ne].location),q=ta(ra(Q.content)),ee,oe=0;oe<q.length;++oe){var Te=q[oe];Te.id==ne&&(ee=Te)}var Re=Ht(ee.messages[0].data);{Re[3]=[];var Se=[];l.forEach(function(te,St){Se[1]=[{type:0,data:rr(St)}],Se[2]=[{type:0,data:rr(1)}],Se[3]=[{type:2,data:JB(te)}],Re[3].push({type:2,data:Cn(Se)})})}ee.messages[0].data=Cn(Re);var De=gu(q),st=_u(De);Q.content=st,Q.size=Q.content.length})();var le=Ht(V[3][0].data);{var Le=le[1][0];delete le[2];var ae=Ht(Le.data);{var Pe=zn(ae[2][0].data);(function(){for(var Q=it.find(d,c[Pe].location),q=ta(ra(Q.content)),ee,oe=0;oe<q.length;++oe){var Te=q[oe];Te.id==Pe&&(ee=Te)}var Re=Ht(ee.messages[0].data);{delete Re[6],delete le[7];var Se=new Uint8Array(Re[5][0].data);Re[5]=[];for(var De=0,st=0;st<=n.e.r;++st){var te=Ht(Se);De+=h7(te,s[st],l),te[1][0].data=rr(st),Re[5].push({data:Cn(te),type:2})}Re[1]=[{type:0,data:rr(n.e.c+1)}],Re[2]=[{type:0,data:rr(n.e.r+1)}],Re[3]=[{type:0,data:rr(De)}],Re[4]=[{type:0,data:rr(n.e.r+1)}]}ee.messages[0].data=Cn(Re);var St=gu(q),lt=_u(St);Q.content=lt,Q.size=Q.content.length})()}Le.data=Cn(ae)}V[3][0].data=Cn(le)}D[4][0].data=Cn(V)}y.messages[0].data=Cn(D);var J=gu(x),O=_u(J);return _.content=O,_.size=_.content.length,d}function cC(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function qx(r){cC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function Kx(r){cC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function m7(r){return bt.WS.indexOf(r)>-1?"sheet":r==bt.CS?"chart":r==bt.DS?"dialog":r==bt.MS?"macro":r&&r.length?r:"sheet"}function p7(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,m7(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function g7(r,e,t,n,i,s,l,c,f,d,m,_){try{s[n]=Vh(Di(r,t,!0),e);var x=Zr(r,e),y;switch(c){case"sheet":y=jV(x,e,i,f,s[n],d,m,_);break;case"chart":if(y=HV(x,e,i,f,s[n],d,m,_),!y||!y["!drawel"])break;var T=Ch(y["!drawel"].Target,e),E=l0(T),S=RP(Di(r,T,!0),Vh(Di(r,E,!0),T)),D=Ch(S,T),U=l0(D);y=_V(Di(r,D,!0),D,f,Vh(Di(r,U,!0),D),d,y);break;case"macro":y=GV(x,e,i,f,s[n],d,m,_);break;case"dialog":y=qV(x,e,i,f,s[n],d,m,_);break;default:throw new Error("Unrecognized sheet type "+c)}l[n]=y;var k=[];s&&s[n]&&Vr(s[n]).forEach(function(W){var Z="";if(s[n][W].Type==bt.CMNT){Z=Ch(s[n][W].Target,e);var X=YV(Zr(r,Z,!0),Z,f);if(!X||!X.length)return;OS(y,X,!1)}s[n][W].Type==bt.TCMNT&&(Z=Ch(s[n][W].Target,e),k=k.concat(NP(Zr(r,Z,!0),f)))}),k&&k.length&&OS(y,k,!0,f.people||[])}catch(W){if(f.WTF)throw W}}function Zi(r){return r.charAt(0)=="/"?r.slice(1):r}function uC(r,e){if(uf(),e=e||{},qx(e),na(r,"META-INF/manifest.xml")||na(r,"objectdata.xml"))return GS(r,e);if(na(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof j_<"u"){if(r.FileIndex)return j_(r);var t=it.utils.cfb_new();return eS(r).forEach(function(ve){Et(t,ve,O5(r,ve))}),j_(t)}throw new Error("Unsupported NUMBERS file")}if(!na(r,"[Content_Types].xml"))throw na(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):na(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=eS(r),i=bO(Di(r,"[Content_Types].xml")),s=!1,l,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",Zr(r,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!Zr(r,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(Bh=[],i.sst)try{Bh=XV(Zr(r,Zi(i.sst)),i.sst,e)}catch(ve){if(e.WTF)throw ve}e.cellStyles&&i.themes.length&&(f=WV(Di(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=KV(Zr(r,Zi(i.style)),i.style,f,e))}i.links.map(function(ve){try{var xe=Vh(Di(r,l0(Zi(ve))),ve);return QV(Zr(r,Zi(ve)),xe,ve,e)}catch{}});var m=zV(Zr(r,Zi(i.workbooks[0])),i.workbooks[0],e),_={},x="";i.coreprops.length&&(x=Zr(r,Zi(i.coreprops[0]),!0),x&&(_=WI(x)),i.extprops.length!==0&&(x=Zr(r,Zi(i.extprops[0]),!0),x&&OO(x,_,e)));var y={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(x=Di(r,Zi(i.custprops[0]),!0),x&&(y=PO(x,e)));var T={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(xe){return xe.name}):_.Worksheets&&_.SheetNames.length>0&&(l=_.SheetNames),e.bookProps&&(T.Props=_,T.Custprops=y),e.bookSheets&&typeof l<"u"&&(T.SheetNames=l),e.bookSheets?T.SheetNames:e.bookProps))return T;l={};var E={};e.bookDeps&&i.calcchain&&(E=$V(Zr(r,Zi(i.calcchain)),i.calcchain));var S=0,D={},U,k;{var W=m.Sheets;_.Worksheets=W.length,_.SheetNames=[];for(var Z=0;Z!=W.length;++Z)_.SheetNames[Z]=W[Z].name}var X=s?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),R=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");na(r,R)||(R="xl/_rels/workbook."+X+".rels");var C=Vh(Di(r,R,!0),R.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=JV(Zr(r,Zi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=FP(Zr(r,Zi(i.people[0])),e)),C&&(C=p7(C,m.Sheets));var V=Zr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=_.Worksheets;++S){var N="sheet";if(C&&C[S]?(U="xl/"+C[S][1].replace(/[\/]?xl\//,""),na(r,U)||(U=C[S][1]),na(r,U)||(U=R.replace(/_rels\/.*$/,"")+C[S][1]),N=C[S][2]):(U="xl/worksheets/sheet"+(S+1-V)+"."+X,U=U.replace(/sheet0\./,"sheet.")),k=U.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(_.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,B=0;B!=e.sheets.length;++B)typeof e.sheets[B]=="number"&&e.sheets[B]==S&&(M=1),typeof e.sheets[B]=="string"&&e.sheets[B].toLowerCase()==_.SheetNames[S].toLowerCase()&&(M=1);if(!M)continue e}}g7(r,U,k,_.SheetNames[S],S,D,l,N,e,m,f,d)}return T={Directory:i,Workbook:m,Props:_,Custprops:y,Deps:E,Sheets:l,SheetNames:_.SheetNames,Strings:Bh,Styles:d,Themes:f,SSF:pr(ot)},e&&e.bookFiles&&(r.files?(T.keys=n,T.files=r.files):(T.keys=[],T.files={},r.FullPaths.forEach(function(ve,xe){ve=ve.replace(/^Root Entry[\/]/,""),T.keys.push(ve),T.files[ve]=r.FileIndex[xe]}))),e&&e.bookVBA&&(i.vba.length>0?T.vbaraw=Zr(r,Zi(i.vba[0]),!0):i.defaults&&i.defaults.bin===jP&&(T.vbaraw=Zr(r,"xl/vbaProject.bin",!0))),T}function _7(r,e){var t=e||{},n="Workbook",i=it.find(r,n);try{if(n="/!DataSpaces/Version",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ZF(i.content),n="/!DataSpaces/DataSpaceMap",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=t8(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=r8(i.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);i8(i.content)}catch{}if(n="/EncryptionInfo",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=a8(i.content);if(n="/EncryptedPackage",i=it.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function v7(r,e){return e.bookType=="ods"?lC(r,e):e.bookType=="numbers"?d7(r,e):e.bookType=="xlsb"?x7(r,e):fC(r,e)}function x7(r,e){Nu=1024,r&&!r.SSF&&(r.SSF=pr(ot)),r&&r.SSF&&(uf(),F0(r.SSF),e.revssf=Kp(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=Nk.indexOf(e.bookType)>-1,i=Rx();Kx(e=e||{});var s=hx(),l="",c=0;if(e.cellXfs=[],ll(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),l="docProps/core.xml",Et(s,l,XI(r.Props,e)),i.coreprops.push(l),nr(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var f=[],d=0;d<r.SheetNames.length;++d)(r.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(r.SheetNames[d]);r.Props.SheetNames=f}for(r.Props.Worksheets=r.Props.SheetNames.length,Et(s,l,QI(r.Props)),i.extprops.push(l),nr(e.rels,3,l,bt.EXT_PROPS),r.Custprops!==r.Props&&Vr(r.Custprops||{}).length>0&&(l="docProps/custom.xml",Et(s,l,JI(r.Custprops)),i.custprops.push(l),nr(e.rels,4,l,bt.CUST_PROPS)),c=1;c<=r.SheetNames.length;++c){var m={"!id":{}},_=r.Sheets[r.SheetNames[c-1]],x=(_||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Et(s,l,eB(c-1,l,e,r,m)),i.sheets.push(l),nr(e.wbrels,-1,"worksheets/sheet"+c+"."+t,bt.WS[0])}if(_){var y=_["!comments"],T=!1,E="";y&&y.length>0&&(E="xl/comments"+c+"."+t,Et(s,E,nB(y,E)),i.comments.push(E),nr(m,-1,"../comments"+c+"."+t,bt.CMNT),T=!0),_["!legacy"]&&T&&Et(s,"xl/drawings/vmlDrawing"+c+".vml",Rk(c,_["!comments"])),delete _["!comments"],delete _["!legacy"]}m["!id"].rId1&&Et(s,l0(l),Mu(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,Et(s,l,rB(e.Strings,l,e)),i.strs.push(l),nr(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,Et(s,l,ZV(r,l)),i.workbooks.push(l),nr(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",Et(s,l,Mx(r.Themes,e)),i.themes.push(l),nr(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,Et(s,l,tB(r,l,e)),i.styles.push(l),nr(e.wbrels,-1,"styles."+t,bt.STY),r.vbaraw&&n&&(l="xl/vbaProject.bin",Et(s,l,r.vbaraw),i.vba.push(l),nr(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,Et(s,l,iB(l)),i.metadata.push(l),nr(e.wbrels,-1,"metadata."+t,bt.XLMETA),Et(s,"[Content_Types].xml",qI(i,e)),Et(s,"_rels/.rels",Mu(e.rels)),Et(s,"xl/_rels/workbook."+t+".rels",Mu(e.wbrels)),delete e.revssf,delete e.ssf,s}function fC(r,e){Nu=1024,r&&!r.SSF&&(r.SSF=pr(ot)),r&&r.SSF&&(uf(),F0(r.SSF),e.revssf=Kp(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=Nk.indexOf(e.bookType)>-1,i=Rx();Kx(e=e||{});var s=hx(),l="",c=0;if(e.cellXfs=[],ll(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),l="docProps/core.xml",Et(s,l,XI(r.Props,e)),i.coreprops.push(l),nr(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var f=[],d=0;d<r.SheetNames.length;++d)(r.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(r.SheetNames[d]);r.Props.SheetNames=f}r.Props.Worksheets=r.Props.SheetNames.length,Et(s,l,QI(r.Props)),i.extprops.push(l),nr(e.rels,3,l,bt.EXT_PROPS),r.Custprops!==r.Props&&Vr(r.Custprops||{}).length>0&&(l="docProps/custom.xml",Et(s,l,JI(r.Custprops)),i.custprops.push(l),nr(e.rels,4,l,bt.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,c=1;c<=r.SheetNames.length;++c){var _={"!id":{}},x=r.Sheets[r.SheetNames[c-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+c+"."+t,Et(s,l,Hk(c-1,e,r,_)),i.sheets.push(l),nr(e.wbrels,-1,"worksheets/sheet"+c+"."+t,bt.WS[0])}if(x){var T=x["!comments"],E=!1,S="";if(T&&T.length>0){var D=!1;T.forEach(function(U){U[1].forEach(function(k){k.T==!0&&(D=!0)})}),D&&(S="xl/threadedComments/threadedComment"+c+"."+t,Et(s,S,OP(T,m,e)),i.threadedcomments.push(S),nr(_,-1,"../threadedComments/threadedComment"+c+"."+t,bt.TCMNT)),S="xl/comments"+c+"."+t,Et(s,S,Dk(T)),i.comments.push(S),nr(_,-1,"../comments"+c+"."+t,bt.CMNT),E=!0}x["!legacy"]&&E&&Et(s,"xl/drawings/vmlDrawing"+c+".vml",Rk(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}_["!id"].rId1&&Et(s,l0(l),Mu(_))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,Et(s,l,vk(e.Strings,e)),i.strs.push(l),nr(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,Et(s,l,Yk(r)),i.workbooks.push(l),nr(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",Et(s,l,Mx(r.Themes,e)),i.themes.push(l),nr(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,Et(s,l,bk(r,e)),i.styles.push(l),nr(e.wbrels,-1,"styles."+t,bt.STY),r.vbaraw&&n&&(l="xl/vbaProject.bin",Et(s,l,r.vbaraw),i.vba.push(l),nr(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,Et(s,l,Ck()),i.metadata.push(l),nr(e.wbrels,-1,"metadata."+t,bt.XLMETA),m.length>1&&(l="xl/persons/person.xml",Et(s,l,PP(m)),i.people.push(l),nr(e.wbrels,-1,"persons/person.xml",bt.PEOPLE)),Et(s,"[Content_Types].xml",qI(i,e)),Et(s,"_rels/.rels",Mu(e.rels)),Et(s,"xl/_rels/workbook."+t+".rels",Mu(e.wbrels)),delete e.revssf,delete e.ssf,s}function Wx(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Li(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function y7(r,e){return it.find(r,"EncryptedPackage")?_7(r,e):Hx(r,e)}function E7(r,e){var t,n=r,i=e||{};return i.type||(i.type=Tt&&Buffer.isBuffer(r)?"buffer":"base64"),t=SI(n,i),uC(t,i)}function hC(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Tv(r.slice(t),e);default:break e}return Ku.to_workbook(r,e)}function T7(r,e){var t="",n=Wx(r,e);switch(e.type){case"base64":t=Li(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=ic(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=fr(t)),e.type="binary",hC(t,e)}function w7(r,e){var t=r;return e.type=="base64"&&(t=Li(t)),t=Vt.utils.decode(1200,t.slice(2),"str"),e.type="binary",hC(t,e)}function S7(r){return r.match(/[^\x00-\x7F]/)?Ya(r):r}function H_(r,e,t,n){return n?(t.type="string",Ku.to_workbook(r,t)):Ku.to_workbook(e,t)}function Xu(r,e){Gp();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Xu(new Uint8Array(r),(t=pr(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Vu={},t.dateNF&&(Vu.dateNF=t.dateNF),t.type||(t.type=Tt&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=Tt?"buffer":"binary",n=A5(r),typeof Uint8Array<"u"&&!Tt&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=S7(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=pr(t),t.type="array",Xu(lx(n),t)}switch((i=Wx(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return y7(it.read(n,t),t);break;case 9:if(i[1]<=8)return Hx(n,t);break;case 60:return Tv(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return MF(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return gk.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?E7(n,t):H_(r,n,t,s);case 239:return i[3]===60?Tv(n,t):H_(r,n,t,s);case 255:if(i[1]===254)return w7(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return $l.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return $l.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Ev.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return wk.to_workbook(n,t);break;case 10:case 13:case 32:return T7(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return PF.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Ev.to_workbook(n,t):H_(r,n,t,s)}function YS(r,e){var t=e||{};return t.type="file",Xu(r,t)}function dC(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return P0(e.file,it.write(r,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return it.write(r,e)}function A7(r,e){var t=pr(e||{}),n=v7(r,t);return mC(n,t)}function b7(r,e){var t=pr(e||{}),n=fC(r,t);return mC(n,t)}function mC(r,e){var t={},n=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?it.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(O0(i))}return e.password&&typeof encrypt_agile<"u"?dC(encrypt_agile(i,e.password),e):e.type==="file"?P0(e.file,i):e.type=="string"?fr(i):i}function I7(r,e){var t=e||{},n=RB(r,t);return dC(n,t)}function Wa(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return n0(Ya(n));case"binary":return Ya(n);case"string":return r;case"file":return P0(e.file,n,"utf8");case"buffer":return Tt?Gs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Wa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function k7(r,e){switch(e.type){case"base64":return n0(r);case"binary":return r;case"string":return r;case"file":return P0(e.file,r,"binary");case"buffer":return Tt?Gs(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Dm(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?n0(t):e.type=="string"?fr(t):t;case"file":return P0(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function Xx(r,e){Gp(),Xk(r);var t=pr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Xx(r,t);return t.type="array",O0(n)}return b7(r,t)}function Zp(r,e){Gp(),Xk(r);var t=pr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Zp(r,t);return t.type="array",O0(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Wa(wB(r,t),t);case"slk":case"sylk":return Wa(pk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return Wa(iC(r.Sheets[r.SheetNames[i]],t),t);case"txt":return k7(_C(r.Sheets[r.SheetNames[i]],t),t);case"csv":return Wa($x(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return Wa(gk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return Dm(Ev.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return Wa(Ku.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return Wa(wk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return Wa(_k.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return Wa(lC(r,t),t);case"wk1":return Dm($l.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return Dm($l.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Dm(Zk(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),I7(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return A7(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Yx(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Jl(r,e,t){var n=t||{};return n.type="file",n.file=e,Yx(n),Zp(r,n)}function C7(r,e,t){var n=t||{};return n.type="file",n.file=e,Yx(n),Xx(r,n)}function R7(r,e,t,n){var i=t||{};i.type="file",i.file=r,Yx(i),i.type="buffer";var s=n;return s instanceof Function||(s=t),zo.writeFile(r,Zp(e,i),s)}function pC(r,e,t,n,i,s,l,c){var f=Mr(t),d=c.defval,m=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),_=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!l||r[t])for(var y=e.s.c;y<=e.e.c;++y){var T=l?r[t][y]:r[n[y]+f];if(T===void 0||T.t===void 0){if(d===void 0)continue;s[y]!=null&&(x[s[y]]=d);continue}var E=T.v;switch(T.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+T.t)}if(s[y]!=null){if(E==null)if(T.t=="e"&&E===null)x[s[y]]=null;else if(d!==void 0)x[s[y]]=d;else if(m&&E===null)x[s[y]]=null;else continue;else x[s[y]]=m&&(T.t!=="n"||T.t==="n"&&c.rawNumbers!==!1)?E:rs(T,E,c);E!=null&&(_=!1)}}return{row:x,isempty:_}}function gp(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:r["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=Nt(m);break;case"number":f=Nt(r["!ref"]),f.s.r=m;break;default:f=m}n>0&&(i=0);var _=Mr(f.s.r),x=[],y=[],T=0,E=0,S=Array.isArray(r),D=f.s.r,U=0,k={};S&&!r[D]&&(r[D]=[]);var W=d.skipHidden&&r["!cols"]||[],Z=d.skipHidden&&r["!rows"]||[];for(U=f.s.c;U<=f.e.c;++U)if(!(W[U]||{}).hidden)switch(x[U]=yr(U),t=S?r[D][U]:r[x[U]+_],n){case 1:s[U]=U-f.s.c;break;case 2:s[U]=x[U];break;case 3:s[U]=d.header[U-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=rs(t,null,d),E=k[l]||0,!E)k[l]=1;else{do c=l+"_"+E++;while(k[c]);k[l]=E,k[c]=1}s[U]=c}for(D=f.s.r+i;D<=f.e.r;++D)if(!(Z[D]||{}).hidden){var X=pC(r,f,D,x,n,s,S,d);(X.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[T++]=X.row)}return y.length=T,y}var $S=/"/g;function gC(r,e,t,n,i,s,l,c){for(var f=!0,d=[],m="",_=Mr(t),x=e.s.c;x<=e.e.c;++x)if(n[x]){var y=c.dense?(r[t]||[])[x]:r[n[x]+_];if(y==null)m="";else if(y.v!=null){f=!1,m=""+(c.rawNumbers&&y.t=="n"?y.v:rs(y,null,c));for(var T=0,E=0;T!==m.length;++T)if((E=m.charCodeAt(T))===i||E===s||E===34||c.forceQuotes){m='"'+m.replace($S,'""')+'"';break}m=="ID"&&(m='"ID"')}else y.f!=null&&!y.F?(f=!1,m="="+y.f,m.indexOf(",")>=0&&(m='"'+m.replace($S,'""')+'"')):m="";d.push(m)}return c.blankrows===!1&&f?null:d.join(l)}function $x(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=Nt(r["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",_=[];n.dense=Array.isArray(r);for(var x=n.skipHidden&&r["!cols"]||[],y=n.skipHidden&&r["!rows"]||[],T=i.s.c;T<=i.e.c;++T)(x[T]||{}).hidden||(_[T]=yr(T));for(var E=0,S=i.s.r;S<=i.e.r;++S)(y[S]||{}).hidden||(m=gC(r,i,S,_,l,f,s,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&t.push((E++?c:"")+m)));return delete n.dense,t.join("")}function _C(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=$x(r,e);if(typeof Vt>"u"||e.type=="string")return t;var n=Vt.utils.encode(1200,t,"str");return""+n}function D7(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=Nt(r["!ref"]),s="",l=[],c,f=[],d=Array.isArray(r);for(c=i.s.c;c<=i.e.c;++c)l[c]=yr(c);for(var m=i.s.r;m<=i.e.r;++m)for(s=Mr(m),c=i.s.c;c<=i.e.c;++c)if(e=l[c]+s,t=d?(r[m]||[])[c]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}f[f.length]=e+"="+n}return f}function vC(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},l=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Dr(n.origin):n.origin;l=f.r,c=f.c}var d,m={s:{c:0,r:0},e:{c,r:l+e.length-1+i}};if(s["!ref"]){var _=Nt(s["!ref"]);m.e.c=Math.max(m.e.c,_.e.c),m.e.r=Math.max(m.e.r,_.e.r),l==-1&&(l=_.e.r+1,m.e.r=l+e.length-1+i)}else l==-1&&(l=0,m.e.r=e.length-1+i);var x=n.header||[],y=0;e.forEach(function(E,S){Vr(E).forEach(function(D){(y=x.indexOf(D))==-1&&(x[y=x.length]=D);var U=E[D],k="z",W="",Z=ut({c:c+y,r:l+S+i});d=p0(s,Z),U&&typeof U=="object"&&!(U instanceof Date)?s[Z]=U:(typeof U=="number"?k="n":typeof U=="boolean"?k="b":typeof U=="string"?k="s":U instanceof Date?(k="d",n.cellDates||(k="n",U=cn(U)),W=n.dateNF||ot[14]):U===null&&n.nullError&&(k="e",U=0),d?(d.t=k,d.v=U,delete d.w,delete d.R,W&&(d.z=W)):s[Z]=d={t:k,v:U},W&&(d.z=W))})}),m.e.c=Math.max(m.e.c,c+x.length-1);var T=Mr(l);if(i)for(y=0;y<x.length;++y)s[yr(y+c)+T]={t:"s",v:x[y]};return s["!ref"]=xt(m),s}function N7(r,e){return vC(null,r,e)}function p0(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=Dr(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?p0(r,ut(e)):p0(r,ut({r:e,c:t||0}))}function O7(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Qx(){return{SheetNames:[],Sheets:{}}}function Jx(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var l=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=l+i)!=-1;++i);}if(Wk(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function F7(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=O7(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function P7(r,e){return r.z=e,r}function xC(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function M7(r,e,t){return xC(r,"#"+e,t)}function L7(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function V7(r,e,t,n){for(var i=typeof e!="string"?e:Nt(e),s=typeof e=="string"?e:xt(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c){var f=p0(r,l,c);f.t="n",f.F=s,delete f.v,l==i.s.r&&c==i.s.c&&(f.f=t,n&&(f.D=!0))}return r}var pn={encode_col:yr,encode_row:Mr,encode_cell:ut,encode_range:xt,decode_col:Sx,decode_row:wx,split_cell:nO,decode_cell:Dr,decode_range:ai,format_cell:rs,sheet_add_aoa:VI,sheet_add_json:vC,sheet_add_dom:aC,aoa_to_sheet:hf,json_to_sheet:N7,table_to_sheet:sC,table_to_book:XB,sheet_to_csv:$x,sheet_to_txt:_C,sheet_to_json:gp,sheet_to_html:iC,sheet_to_formulae:D7,sheet_to_row_object_array:gp,sheet_get_cell:p0,book_new:Qx,book_append_sheet:Jx,book_set_sheet_visibility:F7,cell_set_number_format:P7,cell_set_hyperlink:xC,cell_set_internal_link:M7,cell_add_comment:L7,sheet_set_array_formula:V7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},eg;function B7(r){eg=r}function U7(r,e){var t=eg(),n=e??{};if(r==null||r["!ref"]==null)return t.push(null),t;var i=Nt(r["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",_=[];n.dense=Array.isArray(r);for(var x=n.skipHidden&&r["!cols"]||[],y=n.skipHidden&&r["!rows"]||[],T=i.s.c;T<=i.e.c;++T)(x[T]||{}).hidden||(_[T]=yr(T));var E=i.s.r,S=!1,D=0;return t._read=function(){if(!S)return S=!0,t.push("\uFEFF");for(;E<=i.e.r;)if(++E,!(y[E-1]||{}).hidden&&(m=gC(r,i,E-1,_,l,f,s,n),m!=null&&(n.strip&&(m=m.replace(d,"")),m||n.blankrows!==!1)))return t.push((D++?c:"")+m);return t.push(null)},t}function z7(r,e){var t=eg(),n=e||{},i=n.header!=null?n.header:tC,s=n.footer!=null?n.footer:rC;t.push(i);var l=ai(r["!ref"]);n.dense=Array.isArray(r),t.push(nC(r,l,n));var c=l.s.r,f=!1;return t._read=function(){if(c>l.e.r)return f||(f=!0,t.push("</table>"+s)),t.push(null);for(;c<=l.e.r;){t.push(eC(r,l,c,n)),++c;break}},t}function j7(r,e){var t=eg({objectMode:!0});if(r==null||r["!ref"]==null)return t.push(null),t;var n={t:"n",v:0},i=0,s=1,l=[],c=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},_=m.range!=null?m.range:r["!ref"];switch(m.header===1?i=1:m.header==="A"?i=2:Array.isArray(m.header)&&(i=3),typeof _){case"string":d=Nt(_);break;case"number":d=Nt(r["!ref"]),d.s.r=_;break;default:d=_}i>0&&(s=0);var x=Mr(d.s.r),y=[],T=0,E=Array.isArray(r),S=d.s.r,D=0,U={};E&&!r[S]&&(r[S]=[]);var k=m.skipHidden&&r["!cols"]||[],W=m.skipHidden&&r["!rows"]||[];for(D=d.s.c;D<=d.e.c;++D)if(!(k[D]||{}).hidden)switch(y[D]=yr(D),n=E?r[S][D]:r[y[D]+x],i){case 1:l[D]=D-d.s.c;break;case 2:l[D]=y[D];break;case 3:l[D]=m.header[D-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),f=c=rs(n,null,m),T=U[c]||0,!T)U[c]=1;else{do f=c+"_"+T++;while(U[f]);U[c]=T,U[f]=1}l[D]=f}return S=d.s.r+s,t._read=function(){for(;S<=d.e.r;)if(!(W[S-1]||{}).hidden){var Z=pC(r,d,S,y,i,l,E,m);if(++S,Z.isempty===!1||(i===1?m.blankrows!==!1:m.blankrows)){t.push(Z.row);return}}return t.push(null)},t}var H7={to_json:j7,to_html:z7,to_csv:U7,set_readable:B7};const G7=r0.version,g0=Object.freeze(Object.defineProperty({__proto__:null,CFB:it,SSF:vI,parse_xlscfb:Hx,parse_zip:uC,read:Xu,readFile:YS,readFileSync:YS,set_cptable:XN,set_fs:w5,stream:H7,utils:pn,version:G7,write:Zp,writeFile:Jl,writeFileAsync:R7,writeFileSync:Jl,writeFileXLSX:C7,writeXLSX:Xx},Symbol.toStringTag,{value:"Module"})),yC=qe.createContext(null),j0=()=>{const r=qe.useContext(yC);if(!r)throw new Error("useToast must be used within a ToastProvider");return r},q7=()=>{};var QS={};const EC=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},K7=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],l=r[t++],c=r[t++],f=((i&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const s=r[t++],l=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|l&63)}}return e.join("")},TC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],l=i+1<r.length,c=l?r[i+1]:0,f=i+2<r.length,d=f?r[i+2]:0,m=s>>2,_=(s&3)<<4|c>>4;let x=(c&15)<<2|d>>6,y=d&63;f||(y=64,l||(x=64)),n.push(t[m],t[_],t[x],t[y])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(EC(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):K7(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],c=i<r.length?t[r.charAt(i)]:0;++i;const d=i<r.length?t[r.charAt(i)]:64;++i;const _=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||c==null||d==null||_==null)throw new W7;const x=s<<2|c>>4;if(n.push(x),d!==64){const y=c<<4&240|d>>2;if(n.push(y),_!==64){const T=d<<6&192|_;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class W7 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const X7=function(r){const e=EC(r);return TC.encodeByteArray(e,!0)},_p=function(r){return X7(r).replace(/\./g,"")},wC=function(r){try{return TC.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function SC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Y7=()=>SC().__FIREBASE_DEFAULTS__,$7=()=>{if(typeof process>"u"||typeof QS>"u")return;const r=QS.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},Q7=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&wC(r[1]);return e&&JSON.parse(e)},tg=()=>{try{return q7()||Y7()||$7()||Q7()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},AC=r=>tg()?.emulatorHosts?.[r],J7=r=>{const e=AC(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},bC=()=>tg()?.config,IC=r=>tg()?.[`_${r}`];class Z7{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}function mf(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function kC(r){return(await fetch(r,{credentials:"include"})).ok}function eU(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...r};return[_p(JSON.stringify(t)),_p(JSON.stringify(l)),""].join(".")}const Hh={};function tU(){const r={prod:[],emulator:[]};for(const e of Object.keys(Hh))Hh[e]?r.emulator.push(e):r.prod.push(e);return r}function rU(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let JS=!1;function CC(r,e){if(typeof window>"u"||typeof document>"u"||!mf(window.location.host)||Hh[r]===e||Hh[r]||JS)return;Hh[r]=e;function t(x){return`__firebase__banner__${x}`}const n="__firebase__banner",s=tU().prod.length>0;function l(){const x=document.getElementById(n);x&&x.remove()}function c(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function f(x,y){x.setAttribute("width","24"),x.setAttribute("id",y),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function d(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{JS=!0,l()},x}function m(x,y){x.setAttribute("id",y),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function _(){const x=rU(n),y=t("text"),T=document.getElementById(y)||document.createElement("span"),E=t("learnmore"),S=document.getElementById(E)||document.createElement("a"),D=t("preprendIcon"),U=document.getElementById(D)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const k=x.element;c(k),m(S,E);const W=d();f(U,D),k.append(U,T,S,W),document.body.appendChild(k)}s?(T.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function un(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(un())}function RC(){const r=tg()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DC(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function aU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sU(){const r=un();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function NC(){return!RC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OC(){return!RC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Zx(){try{return typeof indexedDB=="object"}catch{return!1}}function FC(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}function oU(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const lU="FirebaseError";class Da extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=lU,Object.setPrototypeOf(this,Da.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ic.prototype.create)}}class Ic{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],l=s?cU(s,n):"Error",c=`${this.serviceName}: ${l} (${i}).`;return new Da(i,c,n)}}function cU(r,e){return r.replace(uU,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const uU=/\{\$([^}]+)}/g;function fU(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function tl(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],l=e[i];if(ZS(s)&&ZS(l)){if(!tl(s,l))return!1}else if(s!==l)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function ZS(r){return r!==null&&typeof r=="object"}function pf(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function hU(r,e){const t=new dU(r,e);return t.subscribe.bind(t)}class dU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");mU(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=G_),i.error===void 0&&(i.error=G_),i.complete===void 0&&(i.complete=G_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mU(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function G_(){}const pU=1e3,gU=2,_U=14400*1e3,vU=.5;function eA(r,e=pU,t=gU){const n=e*Math.pow(t,r),i=Math.round(vU*n*(Math.random()-.5)*2);return Math.min(_U,n+i)}function Ir(r){return r&&r._delegate?r._delegate:r}class Ra{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Vl="[DEFAULT]";class xU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Z7;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(EU(e))try{this.getOrInitializeService({instanceIdentifier:Vl})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Vl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vl){return this.instances.has(e)}getOptions(e=Vl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(s);n===c&&l.resolve(i)}return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:yU(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Vl){return this.component?this.component.multipleInstances?e:Vl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yU(r){return r===Vl?void 0:r}function EU(r){return r.instantiationMode==="EAGER"}class TU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new xU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Dt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Dt||(Dt={}));const wU={debug:Dt.DEBUG,verbose:Dt.VERBOSE,info:Dt.INFO,warn:Dt.WARN,error:Dt.ERROR,silent:Dt.SILENT},SU=Dt.INFO,AU={[Dt.DEBUG]:"log",[Dt.VERBOSE]:"log",[Dt.INFO]:"info",[Dt.WARN]:"warn",[Dt.ERROR]:"error"},bU=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=AU[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class rg{constructor(e){this.name=e,this._logLevel=SU,this._logHandler=bU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dt.DEBUG,...e),this._logHandler(this,Dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dt.VERBOSE,...e),this._logHandler(this,Dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dt.INFO,...e),this._logHandler(this,Dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dt.WARN,...e),this._logHandler(this,Dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dt.ERROR,...e),this._logHandler(this,Dt.ERROR,...e)}}const IU=(r,e)=>e.some(t=>r instanceof t);let tA,rA;function kU(){return tA||(tA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CU(){return rA||(rA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const PC=new WeakMap,Av=new WeakMap,MC=new WeakMap,q_=new WeakMap,ey=new WeakMap;function RU(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",l)},s=()=>{t(Go(r.result)),i()},l=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&PC.set(t,r)}).catch(()=>{}),ey.set(e,r),e}function DU(r){if(Av.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",l),r.removeEventListener("abort",l)},s=()=>{t(),i()},l=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",l),r.addEventListener("abort",l)});Av.set(r,e)}let bv={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Av.get(r);if(e==="objectStoreNames")return r.objectStoreNames||MC.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Go(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function NU(r){bv=r(bv)}function OU(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(K_(this),e,...t);return MC.set(n,e.sort?e.sort():[e]),Go(n)}:CU().includes(r)?function(...e){return r.apply(K_(this),e),Go(PC.get(this))}:function(...e){return Go(r.apply(K_(this),e))}}function FU(r){return typeof r=="function"?OU(r):(r instanceof IDBTransaction&&DU(r),IU(r,kU())?new Proxy(r,bv):r)}function Go(r){if(r instanceof IDBRequest)return RU(r);if(q_.has(r))return q_.get(r);const e=FU(r);return e!==r&&(q_.set(r,e),ey.set(e,r)),e}const K_=r=>ey.get(r);function LC(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const l=indexedDB.open(r,e),c=Go(l);return n&&l.addEventListener("upgradeneeded",f=>{n(Go(l.result),f.oldVersion,f.newVersion,Go(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),c.then(f=>{s&&f.addEventListener("close",()=>s()),i&&f.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const PU=["get","getKey","getAll","getAllKeys","count"],MU=["put","add","delete","clear"],W_=new Map;function nA(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(W_.get(e))return W_.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=MU.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||PU.includes(t)))return;const s=async function(l,...c){const f=this.transaction(l,i?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&f.done]))[0]};return W_.set(e,s),s}NU(r=>({...r,get:(e,t,n)=>nA(e,t)||r.get(e,t,n),has:(e,t)=>!!nA(e,t)||r.has(e,t)}));class LU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(VU(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function VU(r){return r.getComponent()?.type==="VERSION"}const Iv="@firebase/app",iA="0.14.6";const Bs=new rg("@firebase/app"),BU="@firebase/app-compat",UU="@firebase/analytics-compat",zU="@firebase/analytics",jU="@firebase/app-check-compat",HU="@firebase/app-check",GU="@firebase/auth",qU="@firebase/auth-compat",KU="@firebase/database",WU="@firebase/data-connect",XU="@firebase/database-compat",YU="@firebase/functions",$U="@firebase/functions-compat",QU="@firebase/installations",JU="@firebase/installations-compat",ZU="@firebase/messaging",ez="@firebase/messaging-compat",tz="@firebase/performance",rz="@firebase/performance-compat",nz="@firebase/remote-config",iz="@firebase/remote-config-compat",az="@firebase/storage",sz="@firebase/storage-compat",oz="@firebase/firestore",lz="@firebase/ai",cz="@firebase/firestore-compat",uz="firebase",fz="12.6.0";const kv="[DEFAULT]",hz={[Iv]:"fire-core",[BU]:"fire-core-compat",[zU]:"fire-analytics",[UU]:"fire-analytics-compat",[HU]:"fire-app-check",[jU]:"fire-app-check-compat",[GU]:"fire-auth",[qU]:"fire-auth-compat",[KU]:"fire-rtdb",[WU]:"fire-data-connect",[XU]:"fire-rtdb-compat",[YU]:"fire-fn",[$U]:"fire-fn-compat",[QU]:"fire-iid",[JU]:"fire-iid-compat",[ZU]:"fire-fcm",[ez]:"fire-fcm-compat",[tz]:"fire-perf",[rz]:"fire-perf-compat",[nz]:"fire-rc",[iz]:"fire-rc-compat",[az]:"fire-gcs",[sz]:"fire-gcs-compat",[oz]:"fire-fst",[cz]:"fire-fst-compat",[lz]:"fire-vertex","fire-js":"fire-js",[uz]:"fire-js-all"};const vp=new Map,dz=new Map,Cv=new Map;function aA(r,e){try{r.container.addComponent(e)}catch(t){Bs.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ns(r){const e=r.name;if(Cv.has(e))return Bs.debug(`There were multiple attempts to register component ${e}.`),!1;Cv.set(e,r);for(const t of vp.values())aA(t,r);for(const t of dz.values())aA(t,r);return!0}function kc(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Aa(r){return r==null?!1:r.settings!==void 0}const mz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qo=new Ic("app","Firebase",mz);class pz{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ra("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qo.create("app-deleted",{appName:this._name})}}const gf=fz;function VC(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:kv,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw qo.create("bad-app-name",{appName:String(i)});if(t||(t=bC()),!t)throw qo.create("no-options");const s=vp.get(i);if(s){if(tl(t,s.options)&&tl(n,s.config))return s;throw qo.create("duplicate-app",{appName:i})}const l=new TU(i);for(const f of Cv.values())l.addComponent(f);const c=new pz(t,n,l);return vp.set(i,c),c}function ty(r=kv){const e=vp.get(r);if(!e&&r===kv&&bC())return VC();if(!e)throw qo.create("no-app",{appName:r});return e}function la(r,e,t){let n=hz[r]??r;t&&(n+=`-${t}`);const i=n.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const l=[`Unable to register library "${n}" with version "${e}":`];i&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&l.push("and"),s&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bs.warn(l.join(" "));return}ns(new Ra(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const gz="firebase-heartbeat-database",_z=1,_0="firebase-heartbeat-store";let X_=null;function BC(){return X_||(X_=LC(gz,_z,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(_0)}catch(t){console.warn(t)}}}}).catch(r=>{throw qo.create("idb-open",{originalErrorMessage:r.message})})),X_}async function vz(r){try{const t=(await BC()).transaction(_0),n=await t.objectStore(_0).get(UC(r));return await t.done,n}catch(e){if(e instanceof Da)Bs.warn(e.message);else{const t=qo.create("idb-get",{originalErrorMessage:e?.message});Bs.warn(t.message)}}}async function sA(r,e){try{const n=(await BC()).transaction(_0,"readwrite");await n.objectStore(_0).put(e,UC(r)),await n.done}catch(t){if(t instanceof Da)Bs.warn(t.message);else{const n=qo.create("idb-set",{originalErrorMessage:t?.message});Bs.warn(n.message)}}}function UC(r){return`${r.name}!${r.options.appId}`}const xz=1024,yz=30;class Ez{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wz(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=oA();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>yz){const i=Sz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Bs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=oA(),{heartbeatsToSend:t,unsentEntries:n}=Tz(this._heartbeatsCache.heartbeats),i=_p(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Bs.warn(e),""}}}function oA(){return new Date().toISOString().substring(0,10)}function Tz(r,e=xz){const t=[];let n=r.slice();for(const i of r){const s=t.find(l=>l.agent===i.agent);if(s){if(s.dates.push(i.date),lA(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),lA(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class wz{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Zx()?FC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await vz(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return sA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return sA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function lA(r){return _p(JSON.stringify({version:2,heartbeats:r})).length}function Sz(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}function Az(r){ns(new Ra("platform-logger",e=>new LU(e),"PRIVATE")),ns(new Ra("heartbeat",e=>new Ez(e),"PRIVATE")),la(Iv,iA,r),la(Iv,iA,"esm2020"),la("fire-js","")}Az("");var bz="firebase",Iz="12.6.0";la(bz,Iz,"app");const zC="@firebase/installations",ry="0.6.19";const jC=1e4,HC=`w:${ry}`,GC="FIS_v2",kz="https://firebaseinstallations.googleapis.com/v1",Cz=3600*1e3,Rz="installations",Dz="Installations";const Nz={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},cc=new Ic(Rz,Dz,Nz);function qC(r){return r instanceof Da&&r.code.includes("request-failed")}function KC({projectId:r}){return`${kz}/projects/${r}/installations`}function WC(r){return{token:r.token,requestStatus:2,expiresIn:Fz(r.expiresIn),creationTime:Date.now()}}async function XC(r,e){const n=(await e.json()).error;return cc.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function YC({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Oz(r,{refreshToken:e}){const t=YC(r);return t.append("Authorization",Pz(e)),t}async function $C(r){const e=await r();return e.status>=500&&e.status<600?r():e}function Fz(r){return Number(r.replace("s","000"))}function Pz(r){return`${GC} ${r}`}async function Mz({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=KC(r),i=YC(r),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const l={fid:t,authVersion:GC,appId:r.appId,sdkVersion:HC},c={method:"POST",headers:i,body:JSON.stringify(l)},f=await $C(()=>fetch(n,c));if(f.ok){const d=await f.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:WC(d.authToken)}}else throw await XC("Create Installation",f)}function QC(r){return new Promise(e=>{setTimeout(e,r)})}function Lz(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}const Vz=/^[cdef][\w-]{21}$/,Rv="";function Bz(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=Uz(r);return Vz.test(t)?t:Rv}catch{return Rv}}function Uz(r){return Lz(r).substr(0,22)}function ng(r){return`${r.appName}!${r.appId}`}const JC=new Map;function ZC(r,e){const t=ng(r);e4(t,e),zz(t,e)}function e4(r,e){const t=JC.get(r);if(t)for(const n of t)n(e)}function zz(r,e){const t=jz();t&&t.postMessage({key:r,fid:e}),Hz()}let Kl=null;function jz(){return!Kl&&"BroadcastChannel"in self&&(Kl=new BroadcastChannel("[Firebase] FID Change"),Kl.onmessage=r=>{e4(r.data.key,r.data.fid)}),Kl}function Hz(){JC.size===0&&Kl&&(Kl.close(),Kl=null)}const Gz="firebase-installations-database",qz=1,uc="firebase-installations-store";let Y_=null;function ny(){return Y_||(Y_=LC(Gz,qz,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(uc)}}})),Y_}async function xp(r,e){const t=ng(r),i=(await ny()).transaction(uc,"readwrite"),s=i.objectStore(uc),l=await s.get(t);return await s.put(e,t),await i.done,(!l||l.fid!==e.fid)&&ZC(r,e.fid),e}async function t4(r){const e=ng(r),n=(await ny()).transaction(uc,"readwrite");await n.objectStore(uc).delete(e),await n.done}async function ig(r,e){const t=ng(r),i=(await ny()).transaction(uc,"readwrite"),s=i.objectStore(uc),l=await s.get(t),c=e(l);return c===void 0?await s.delete(t):await s.put(c,t),await i.done,c&&(!l||l.fid!==c.fid)&&ZC(r,c.fid),c}async function iy(r){let e;const t=await ig(r.appConfig,n=>{const i=Kz(n),s=Wz(r,i);return e=s.registrationPromise,s.installationEntry});return t.fid===Rv?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Kz(r){const e=r||{fid:Bz(),registrationStatus:0};return r4(e)}function Wz(r,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(cc.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=Xz(r,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Yz(r)}:{installationEntry:e}}async function Xz(r,e){try{const t=await Mz(r,e);return xp(r.appConfig,t)}catch(t){throw qC(t)&&t.customData.serverCode===409?await t4(r.appConfig):await xp(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Yz(r){let e=await cA(r.appConfig);for(;e.registrationStatus===1;)await QC(100),e=await cA(r.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await iy(r);return n||t}return e}function cA(r){return ig(r,e=>{if(!e)throw cc.create("installation-not-found");return r4(e)})}function r4(r){return $z(r)?{fid:r.fid,registrationStatus:0}:r}function $z(r){return r.registrationStatus===1&&r.registrationTime+jC<Date.now()}async function Qz({appConfig:r,heartbeatServiceProvider:e},t){const n=Jz(r,t),i=Oz(r,t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const l={installation:{sdkVersion:HC,appId:r.appId}},c={method:"POST",headers:i,body:JSON.stringify(l)},f=await $C(()=>fetch(n,c));if(f.ok){const d=await f.json();return WC(d)}else throw await XC("Generate Auth Token",f)}function Jz(r,{fid:e}){return`${KC(r)}/${e}/authTokens:generate`}async function ay(r,e=!1){let t;const n=await ig(r.appConfig,s=>{if(!n4(s))throw cc.create("not-registered");const l=s.authToken;if(!e&&tj(l))return s;if(l.requestStatus===1)return t=Zz(r,e),s;{if(!navigator.onLine)throw cc.create("app-offline");const c=nj(s);return t=ej(r,c),c}});return t?await t:n.authToken}async function Zz(r,e){let t=await uA(r.appConfig);for(;t.authToken.requestStatus===1;)await QC(100),t=await uA(r.appConfig);const n=t.authToken;return n.requestStatus===0?ay(r,e):n}function uA(r){return ig(r,e=>{if(!n4(e))throw cc.create("not-registered");const t=e.authToken;return ij(t)?{...e,authToken:{requestStatus:0}}:e})}async function ej(r,e){try{const t=await Qz(r,e),n={...e,authToken:t};return await xp(r.appConfig,n),t}catch(t){if(qC(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await t4(r.appConfig);else{const n={...e,authToken:{requestStatus:0}};await xp(r.appConfig,n)}throw t}}function n4(r){return r!==void 0&&r.registrationStatus===2}function tj(r){return r.requestStatus===2&&!rj(r)}function rj(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+Cz}function nj(r){const e={requestStatus:1,requestTime:Date.now()};return{...r,authToken:e}}function ij(r){return r.requestStatus===1&&r.requestTime+jC<Date.now()}async function aj(r){const e=r,{installationEntry:t,registrationPromise:n}=await iy(e);return n?n.catch(console.error):ay(e).catch(console.error),t.fid}async function sj(r,e=!1){const t=r;return await oj(t),(await ay(t,e)).token}async function oj(r){const{registrationPromise:e}=await iy(r);e&&await e}function lj(r){if(!r||!r.options)throw $_("App Configuration");if(!r.name)throw $_("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw $_(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function $_(r){return cc.create("missing-app-config-values",{valueName:r})}const i4="installations",cj="installations-internal",uj=r=>{const e=r.getProvider("app").getImmediate(),t=lj(e),n=kc(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},fj=r=>{const e=r.getProvider("app").getImmediate(),t=kc(e,i4).getImmediate();return{getId:()=>aj(t),getToken:i=>sj(t,i)}};function hj(){ns(new Ra(i4,uj,"PUBLIC")),ns(new Ra(cj,fj,"PRIVATE"))}hj();la(zC,ry);la(zC,ry,"esm2020");const yp="analytics",dj="firebase_id",mj="origin",pj=60*1e3,gj="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",sy="https://www.googletagmanager.com/gtag/js";const ii=new rg("@firebase/analytics");const _j={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Pi=new Ic("analytics","Analytics",_j);function vj(r){if(!r.startsWith(sy)){const e=Pi.create("invalid-gtag-resource",{gtagURL:r});return ii.warn(e.message),""}return r}function a4(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function xj(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}function yj(r,e){const t=xj("firebase-js-sdk-policy",{createScriptURL:vj}),n=document.createElement("script"),i=`${sy}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function Ej(r){let e=[];return Array.isArray(window[r])?e=window[r]:window[r]=e,e}async function Tj(r,e,t,n,i,s){const l=n[i];try{if(l)await e[l];else{const f=(await a4(t)).find(d=>d.measurementId===i);f&&await e[f.appId]}}catch(c){ii.error(c)}r("config",i,s)}async function wj(r,e,t,n,i){try{let s=[];if(i&&i.send_to){let l=i.send_to;Array.isArray(l)||(l=[l]);const c=await a4(t);for(const f of l){const d=c.find(_=>_.measurementId===f),m=d&&e[d.appId];if(m)s.push(m);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),r("event",n,i||{})}catch(s){ii.error(s)}}function Sj(r,e,t,n){async function i(s,...l){try{if(s==="event"){const[c,f]=l;await wj(r,e,t,c,f)}else if(s==="config"){const[c,f]=l;await Tj(r,e,t,n,c,f)}else if(s==="consent"){const[c,f]=l;r("consent",c,f)}else if(s==="get"){const[c,f,d]=l;r("get",c,f,d)}else if(s==="set"){const[c]=l;r("set",c)}else r(s,...l)}catch(c){ii.error(c)}}return i}function Aj(r,e,t,n,i){let s=function(...l){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=Sj(s,r,e,t),{gtagCore:s,wrappedGtag:window[i]}}function bj(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(sy)&&t.src.includes(r))return t;return null}const Ij=30,kj=1e3;class Cj{constructor(e={},t=kj){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const s4=new Cj;function Rj(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function Dj(r){const{appId:e,apiKey:t}=r,n={method:"GET",headers:Rj(t)},i=gj.replace("{app-id}",e),s=await fetch(i,n);if(s.status!==200&&s.status!==304){let l="";try{const c=await s.json();c.error?.message&&(l=c.error.message)}catch{}throw Pi.create("config-fetch-failed",{httpStatus:s.status,responseMessage:l})}return s.json()}async function Nj(r,e=s4,t){const{appId:n,apiKey:i,measurementId:s}=r.options;if(!n)throw Pi.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw Pi.create("no-api-key")}const l=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new Pj;return setTimeout(async()=>{c.abort()},pj),o4({appId:n,apiKey:i,measurementId:s},l,c,e)}async function o4(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=s4){const{appId:s,measurementId:l}=r;try{await Oj(n,e)}catch(c){if(l)return ii.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:s,measurementId:l};throw c}try{const c=await Dj(r);return i.deleteThrottleMetadata(s),c}catch(c){const f=c;if(!Fj(f)){if(i.deleteThrottleMetadata(s),l)return ii.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${f?.message}]`),{appId:s,measurementId:l};throw c}const d=Number(f?.customData?.httpStatus)===503?eA(t,i.intervalMillis,Ij):eA(t,i.intervalMillis),m={throttleEndTimeMillis:Date.now()+d,backoffCount:t+1};return i.setThrottleMetadata(s,m),ii.debug(`Calling attemptFetch again in ${d} millis`),o4(r,m,n,i)}}function Oj(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(Pi.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Fj(r){if(!(r instanceof Da)||!r.customData)return!1;const e=Number(r.customData.httpStatus);return e===429||e===500||e===503||e===504}class Pj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Mj(r,e,t,n,i){if(i&&i.global){r("event",t,n);return}else{const s=await e,l={...n,send_to:s};r("event",t,l)}}async function Lj(r,e,t,n){if(n&&n.global){const i={};for(const s of Object.keys(t))i[`user_properties.${s}`]=t[s];return r("set",i),Promise.resolve()}else{const i=await e;r("config",i,{update:!0,user_properties:t})}}async function Vj(){if(Zx())try{await FC()}catch(r){return ii.warn(Pi.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}else return ii.warn(Pi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Bj(r,e,t,n,i,s,l){const c=Nj(r);c.then(x=>{t[x.measurementId]=x.appId,r.options.measurementId&&x.measurementId!==r.options.measurementId&&ii.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${x.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(x=>ii.error(x)),e.push(c);const f=Vj().then(x=>{if(x)return n.getId()}),[d,m]=await Promise.all([c,f]);bj(s)||yj(s,d.measurementId),i("js",new Date);const _=l?.config??{};return _[mj]="firebase",_.update=!0,m!=null&&(_[dj]=m),i("config",d.measurementId,_),d.measurementId}class Uj{constructor(e){this.app=e}_delete(){return delete Bu[this.app.options.appId],Promise.resolve()}}let Bu={},fA=[];const hA={};let Q_="dataLayer",zj="gtag",dA,oy,mA=!1;function jj(){const r=[];if(DC()&&r.push("This is a browser extension environment."),oU()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=Pi.create("invalid-analytics-context",{errorInfo:e});ii.warn(t.message)}}function Hj(r,e,t){jj();const n=r.options.appId;if(!n)throw Pi.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)ii.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Pi.create("no-api-key");if(Bu[n]!=null)throw Pi.create("already-exists",{id:n});if(!mA){Ej(Q_);const{wrappedGtag:s,gtagCore:l}=Aj(Bu,fA,hA,Q_,zj);oy=s,dA=l,mA=!0}return Bu[n]=Bj(r,fA,hA,e,dA,Q_,t),new Uj(r)}function Gj(r=ty()){r=Ir(r);const e=kc(r,yp);return e.isInitialized()?e.getImmediate():qj(r)}function qj(r,e={}){const t=kc(r,yp);if(t.isInitialized()){const i=t.getImmediate();if(tl(e,t.getOptions()))return i;throw Pi.create("already-initialized")}return t.initialize({options:e})}function Kj(r,e,t){r=Ir(r),Lj(oy,Bu[r.app.options.appId],e,t).catch(n=>ii.error(n))}function Wj(r,e,t,n){r=Ir(r),Mj(oy,Bu[r.app.options.appId],e,t,n).catch(i=>ii.error(i))}const pA="@firebase/analytics",gA="0.10.19";function Xj(){ns(new Ra(yp,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return Hj(n,i,t)},"PUBLIC")),ns(new Ra("analytics-internal",r,"PRIVATE")),la(pA,gA),la(pA,gA,"esm2020");function r(e){try{const t=e.getProvider(yp).getImmediate();return{logEvent:(n,i,s)=>Wj(t,n,i,s),setUserProperties:(n,i)=>Kj(t,n,i)}}catch(t){throw Pi.create("interop-component-reg-failed",{reason:t})}}}Xj();function l4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yj=l4,c4=new Ic("auth","Firebase",l4());const Ep=new rg("@firebase/auth");function $j(r,...e){Ep.logLevel<=Dt.WARN&&Ep.warn(`Auth (${gf}): ${r}`,...e)}function jm(r,...e){Ep.logLevel<=Dt.ERROR&&Ep.error(`Auth (${gf}): ${r}`,...e)}function Us(r,...e){throw ly(r,...e)}function Mi(r,...e){return ly(r,...e)}function u4(r,e,t){const n={...Yj(),[e]:t};return new Ic("auth","Firebase",n).create(e,{appName:r.name})}function Ko(r){return u4(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ly(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return c4.create(r,...e)}function Qe(r,e,...t){if(!r)throw ly(e,...t)}function Os(r){const e="INTERNAL ASSERTION FAILED: "+r;throw jm(e),new Error(e)}function zs(r,e){r||Os(e)}function Dv(){return typeof self<"u"&&self.location?.href||""}function f4(){return _A()==="http:"||_A()==="https:"}function _A(){return typeof self<"u"&&self.location?.protocol||null}function Qj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(f4()||DC()||"connection"in navigator)?navigator.onLine:!0}function Jj(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}class H0{constructor(e,t){this.shortDelay=e,this.longDelay=t,zs(t>e,"Short delay should be less than long delay!"),this.isMobile=nU()||aU()}get(){return Qj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cy(r,e){zs(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class h4{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Zj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const eH=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],tH=new H0(3e4,6e4);function ls(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function Na(r,e,t,n,i={}){return d4(r,i,async()=>{let s={},l={};n&&(e==="GET"?l=n:s={body:JSON.stringify(n)});const c=pf({key:r.config.apiKey,...l}).slice(1),f=await r._getAdditionalHeaders();f["Content-Type"]="application/json",r.languageCode&&(f["X-Firebase-Locale"]=r.languageCode);const d={method:e,headers:f,...s};return iU()||(d.referrerPolicy="no-referrer"),r.emulatorConfig&&mf(r.emulatorConfig.host)&&(d.credentials="include"),h4.fetch()(await m4(r,r.config.apiHost,t,c),d)})}async function d4(r,e,t){r._canInitEmulator=!1;const n={...Zj,...e};try{const i=new nH(r),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await s.json();if("needConfirmation"in l)throw Rh(r,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{const c=s.ok?l.errorMessage:l.error.message,[f,d]=c.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rh(r,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Rh(r,"email-already-in-use",l);if(f==="USER_DISABLED")throw Rh(r,"user-disabled",l);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw u4(r,m,d);Us(r,m)}}catch(i){if(i instanceof Da)throw i;Us(r,"network-request-failed",{message:String(i)})}}async function ag(r,e,t,n,i={}){const s=await Na(r,e,t,n,i);return"mfaPendingCredential"in s&&Us(r,"multi-factor-auth-required",{_serverResponse:s}),s}async function m4(r,e,t,n){const i=`${e}${t}?${n}`,s=r,l=s.config.emulator?cy(r.config,i):`${r.config.apiScheme}://${i}`;return eH.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(l).toString():l}function rH(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class nH{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Mi(this.auth,"network-request-failed")),tH.get())})}}function Rh(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=Mi(r,e,n);return i.customData._tokenResponse=t,i}function vA(r){return r!==void 0&&r.getResponse!==void 0}function xA(r){return r!==void 0&&r.enterprise!==void 0}class p4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rH(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function iH(r){return(await Na(r,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function g4(r,e){return Na(r,"GET","/v2/recaptchaConfig",ls(r,e))}async function aH(r,e){return Na(r,"POST","/v1/accounts:delete",e)}async function Tp(r,e){return Na(r,"POST","/v1/accounts:lookup",e)}function Gh(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sH(r,e=!1){const t=Ir(r),n=await t.getIdToken(e),i=uy(n);Qe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,l=s?.sign_in_provider;return{claims:i,token:n,authTime:Gh(J_(i.auth_time)),issuedAtTime:Gh(J_(i.iat)),expirationTime:Gh(J_(i.exp)),signInProvider:l||null,signInSecondFactor:s?.sign_in_second_factor||null}}function J_(r){return Number(r)*1e3}function uy(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return jm("JWT malformed, contained fewer than 3 sections"),null;try{const i=wC(t);return i?JSON.parse(i):(jm("Failed to decode base64 JWT payload"),null)}catch(i){return jm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function yA(r){const e=uy(r);return Qe(e,"internal-error"),Qe(typeof e.exp<"u","internal-error"),Qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function v0(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Da&&oH(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function oH({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}class lH{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Nv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gh(this.lastLoginAt),this.creationTime=Gh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wp(r){const e=r.auth,t=await r.getIdToken(),n=await v0(r,Tp(e,{idToken:t}));Qe(n?.users.length,e,"internal-error");const i=n.users[0];r._notifyReloadListener(i);const s=i.providerUserInfo?.length?_4(i.providerUserInfo):[],l=uH(r.providerData,s),c=r.isAnonymous,f=!(r.email&&i.passwordHash)&&!l?.length,d=c?f:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Nv(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(r,m)}async function cH(r){const e=Ir(r);await wp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uH(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function _4(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function fH(r,e){const t=await d4(r,{},async()=>{const n=pf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,l=await m4(r,i,"/v1/token",`key=${s}`),c=await r._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:c,body:n};return r.emulatorConfig&&mf(r.emulatorConfig.host)&&(f.credentials="include"),h4.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hH(r,e){return Na(r,"POST","/v2/accounts:revokeToken",ls(r,e))}class Uu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qe(e.idToken,"internal-error"),Qe(typeof e.idToken<"u","internal-error"),Qe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Qe(e.length!==0,"internal-error");const t=yA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await fH(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,l=new Uu;return n&&(Qe(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),i&&(Qe(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),s&&(Qe(typeof s=="number","internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Uu,this.toJSON())}_performRefresh(){return Os("not implemented")}}function Co(r,e){Qe(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class Ia{constructor({uid:e,auth:t,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new lH(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Nv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await v0(this,this.stsTokenManager.getToken(this.auth,e));return Qe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return sH(this,e)}reload(){return cH(this)}_assign(e){this!==e&&(Qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ia({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await wp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Aa(this.auth.app))return Promise.reject(Ko(this.auth));const e=await this.getIdToken();return await v0(this,aH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,f=t._redirectEventId??void 0,d=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:_,emailVerified:x,isAnonymous:y,providerData:T,stsTokenManager:E}=t;Qe(_&&E,e,"internal-error");const S=Uu.fromJSON(this.name,E);Qe(typeof _=="string",e,"internal-error"),Co(n,e.name),Co(i,e.name),Qe(typeof x=="boolean",e,"internal-error"),Qe(typeof y=="boolean",e,"internal-error"),Co(s,e.name),Co(l,e.name),Co(c,e.name),Co(f,e.name),Co(d,e.name),Co(m,e.name);const D=new Ia({uid:_,auth:e,email:i,emailVerified:x,displayName:n,isAnonymous:y,photoURL:l,phoneNumber:s,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:m});return T&&Array.isArray(T)&&(D.providerData=T.map(U=>({...U}))),f&&(D._redirectEventId=f),D}static async _fromIdTokenResponse(e,t,n=!1){const i=new Uu;i.updateFromServerResponse(t);const s=new Ia({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await wp(s),s}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];Qe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?_4(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!s?.length,c=new Uu;c.updateFromIdToken(n);const f=new Ia({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:l}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Nv(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(f,d),f}}const EA=new Map;function Fs(r){zs(r instanceof Function,"Expected a class definition");let e=EA.get(r);return e?(zs(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,EA.set(r,e),e)}class v4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}v4.type="NONE";const TA=v4;function Hm(r,e,t){return`firebase:${r}:${e}:${t}`}class zu{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Hm(this.userKey,i.apiKey,s),this.fullPersistenceKey=Hm("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Tp(this.auth,{idToken:e}).catch(()=>{});return t?Ia._fromGetAccountInfoResponse(this.auth,t,e):null}return Ia._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new zu(Fs(TA),e,n);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Fs(TA);const l=Hm(n,e.config.apiKey,e.name);let c=null;for(const d of t)try{const m=await d._get(l);if(m){let _;if(typeof m=="string"){const x=await Tp(e,{idToken:m}).catch(()=>{});if(!x)break;_=await Ia._fromGetAccountInfoResponse(e,x,m)}else _=Ia._fromJSON(e,m);d!==s&&(c=_),s=d;break}}catch{}const f=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!f.length?new zu(s,e,n):(s=f[0],c&&await s._set(l,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(l)}catch{}})),new zu(s,e,n))}}function wA(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(T4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(x4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(S4(e))return"Blackberry";if(A4(e))return"Webos";if(y4(e))return"Safari";if((e.includes("chrome/")||E4(e))&&!e.includes("edge/"))return"Chrome";if(w4(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if(n?.length===2)return n[1]}return"Other"}function x4(r=un()){return/firefox\//i.test(r)}function y4(r=un()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function E4(r=un()){return/crios\//i.test(r)}function T4(r=un()){return/iemobile/i.test(r)}function w4(r=un()){return/android/i.test(r)}function S4(r=un()){return/blackberry/i.test(r)}function A4(r=un()){return/webos/i.test(r)}function fy(r=un()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function dH(r=un()){return fy(r)&&!!window.navigator?.standalone}function mH(){return sU()&&document.documentMode===10}function b4(r=un()){return fy(r)||w4(r)||A4(r)||S4(r)||/windows phone/i.test(r)||T4(r)}function I4(r,e=[]){let t;switch(r){case"Browser":t=wA(un());break;case"Worker":t=`${wA(un())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${gf}/${n}`}class pH{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((l,c)=>{try{const f=e(s);l(f)}catch(f){c(f)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function gH(r,e={}){return Na(r,"GET","/v2/passwordPolicy",ls(r,e))}const _H=6;class vH{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??_H,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class xH{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new SA(this),this.idTokenSubscription=new SA(this),this.beforeStateQueue=new pH(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=c4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Fs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await zu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Tp(this,{idToken:e}),n=await Ia._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Aa(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,l=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!s||s===l)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(s){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Jj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Aa(this.app))return Promise.reject(Ko(this));const t=e?Ir(e):null;return t&&Qe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Aa(this.app)?Promise.reject(Ko(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Aa(this.app)?Promise.reject(Ko(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gH(this),t=new vH(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ic("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await hH(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Fs(e)||this._popupRedirectResolver;Qe(t,this,"argument-error"),this.redirectPersistenceManager=await zu.create(this,[Fs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qe(c,this,"internal-error"),c.then(()=>{l||s(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,n,i);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=I4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Aa(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&$j(`Error while retrieving App Check token: ${e.error}`),e?.token}}function cl(r){return Ir(r)}class SA{constructor(e){this.auth=e,this.observer=null,this.addObserver=hU(t=>this.observer=t)}get next(){return Qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let G0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yH(r){G0=r}function hy(r){return G0.loadJS(r)}function EH(){return G0.recaptchaV2Script}function TH(){return G0.recaptchaEnterpriseScript}function wH(){return G0.gapiScript}function k4(r){return`__${r}${Math.floor(Math.random()*1e6)}`}const SH=500,AH=6e4,Nm=1e12;class bH{constructor(e){this.auth=e,this.counter=Nm,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new CH(e,this.auth.name,t||{})),this.counter++,n}reset(e){const t=e||Nm;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Nm;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Nm;return this._widgets.get(t)?.execute(),""}}class IH{constructor(){this.enterprise=new kH}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class kH{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CH{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;Qe(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=RH(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},AH)},SH))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function RH(r){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<r;n++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const DH="recaptcha-enterprise",qh="NO_RECAPTCHA";class C4{constructor(e){this.type=DH,this.auth=cl(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(l,c)=>{g4(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new p4(f);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,l(d.siteKey)}}).catch(f=>{c(f)})})}function i(s,l,c){const f=window.grecaptcha;xA(f)?f.enterprise.ready(()=>{f.enterprise.execute(s,{action:e}).then(d=>{l(d)}).catch(()=>{l(qh)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new IH().execute("siteKey",{action:"verify"}):new Promise((s,l)=>{n(this.auth).then(c=>{if(!t&&xA(window.grecaptcha))i(c,s,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=TH();f.length!==0&&(f+=c),hy(f).then(()=>{i(c,s,l)}).catch(d=>{l(d)})}}).catch(c=>{l(c)})})}}async function Z_(r,e,t,n=!1,i=!1){const s=new C4(r);let l;if(i)l=qh;else try{l=await s.verify(t)}catch{l=await s.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const f=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const f=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function ev(r,e,t,n,i){if(r._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const s=await Z_(r,e,t);return n(r,s).catch(async l=>{if(r._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const c=await Z_(r,e,t,!1,!0);return n(r,c)}return Promise.reject(l)})}else{const s=await Z_(r,e,t,!1,!0);return n(r,s)}}async function NH(r){const e=cl(r),t=await g4(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new p4(t);e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.isAnyProviderEnabled()&&new C4(e).verify()}function OH(r,e){const t=kc(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(tl(s,e??{}))return i;Us(i,"already-initialized")}return t.initialize({options:e})}function FH(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(Fs);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}function PH(r,e,t){const n=cl(r);Qe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=R4(e),{host:l,port:c}=MH(e),f=c===null?"":`:${c}`,d={url:`${s}//${l}${f}/`},m=Object.freeze({host:l,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Qe(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Qe(tl(d,n.config.emulator)&&tl(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,mf(l)?(kC(`${s}//${l}${f}`),CC("Auth",!0)):LH()}function R4(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function MH(r){const e=R4(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:AA(n.substr(s.length+1))}}else{const[s,l]=n.split(":");return{host:s,port:AA(l)}}}function AA(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function LH(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}class dy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Os("not implemented")}_getIdTokenResponse(e){return Os("not implemented")}_linkToIdToken(e,t){return Os("not implemented")}_getReauthenticationResolver(e){return Os("not implemented")}}async function ju(r,e){return ag(r,"POST","/v1/accounts:signInWithIdp",ls(r,e))}const VH="http://localhost";class fc extends dy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Us("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...s}=t;if(!n||!i)return null;const l=new fc(n,i);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return ju(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ju(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ju(e,t)}buildRequest(){const e={requestUri:VH,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pf(t)}return e}}async function bA(r,e){return Na(r,"POST","/v1/accounts:sendVerificationCode",ls(r,e))}async function BH(r,e){return ag(r,"POST","/v1/accounts:signInWithPhoneNumber",ls(r,e))}async function UH(r,e){const t=await ag(r,"POST","/v1/accounts:signInWithPhoneNumber",ls(r,e));if(t.temporaryProof)throw Rh(r,"account-exists-with-different-credential",t);return t}const zH={USER_NOT_FOUND:"user-not-found"};async function jH(r,e){const t={...e,operation:"REAUTH"};return ag(r,"POST","/v1/accounts:signInWithPhoneNumber",ls(r,t),zH)}class Kh extends dy{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Kh({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Kh({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return BH(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return UH(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return jH(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s}=e;return!n&&!t&&!i&&!s?null:new Kh({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s})}}class D4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class q0 extends D4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Oo extends q0{constructor(){super("facebook.com")}static credential(e){return fc._fromParams({providerId:Oo.PROVIDER_ID,signInMethod:Oo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oo.credentialFromTaggedObject(e)}static credentialFromError(e){return Oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oo.credential(e.oauthAccessToken)}catch{return null}}}Oo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Oo.PROVIDER_ID="facebook.com";class Fo extends q0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Fo.credential(t,n)}catch{return null}}}Fo.GOOGLE_SIGN_IN_METHOD="google.com";Fo.PROVIDER_ID="google.com";class Po extends q0{constructor(){super("github.com")}static credential(e){return fc._fromParams({providerId:Po.PROVIDER_ID,signInMethod:Po.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Po.credentialFromTaggedObject(e)}static credentialFromError(e){return Po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Po.credential(e.oauthAccessToken)}catch{return null}}}Po.GITHUB_SIGN_IN_METHOD="github.com";Po.PROVIDER_ID="github.com";class Mo extends q0{constructor(){super("twitter.com")}static credential(e,t){return fc._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Mo.credential(t,n)}catch{return null}}}Mo.TWITTER_SIGN_IN_METHOD="twitter.com";Mo.PROVIDER_ID="twitter.com";class Yu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await Ia._fromIdTokenResponse(e,n,i),l=IA(n);return new Yu({user:s,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=IA(n);return new Yu({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function IA(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class Sp extends Da{constructor(e,t,n,i){super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Sp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Sp(e,t,n,i)}}function N4(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Sp._fromErrorAndOperation(r,s,e,n):s})}async function HH(r,e,t=!1){const n=await v0(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Yu._forOperation(r,"link",n)}async function GH(r,e,t=!1){const{auth:n}=r;if(Aa(n.app))return Promise.reject(Ko(n));const i="reauthenticate";try{const s=await v0(r,N4(n,i,e,r),t);Qe(s.idToken,n,"internal-error");const l=uy(s.idToken);Qe(l,n,"internal-error");const{sub:c}=l;return Qe(r.uid===c,n,"user-mismatch"),Yu._forOperation(r,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Us(n,"user-mismatch"),s}}async function O4(r,e,t=!1){if(Aa(r.app))return Promise.reject(Ko(r));const n="signIn",i=await N4(r,n,e),s=await Yu._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(s.user),s}async function qH(r,e){return O4(cl(r),e)}function KH(r,e,t,n){return Ir(r).onIdTokenChanged(e,t,n)}function WH(r,e,t){return Ir(r).beforeAuthStateChanged(e,t)}function XH(r,e,t,n){return Ir(r).onAuthStateChanged(e,t,n)}function YH(r){return Ir(r).signOut()}function kA(r,e){return Na(r,"POST","/v2/accounts/mfaEnrollment:start",ls(r,e))}const Ap="__sak";class F4{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ap,"1"),this.storage.removeItem(Ap),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const $H=1e3,QH=10;class P4 extends F4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=b4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,f)=>{this.notifyListeners(l,f)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},s=this.storage.getItem(n);mH()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,QH):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},$H)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}P4.type="LOCAL";const JH=P4;class M4 extends F4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}M4.type="SESSION";const L4=M4;function ZH(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class sg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new sg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,l=this.handlersMap[i];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(l).map(async d=>d(t.origin,s)),f=await ZH(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sg.receivers=[];function my(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}class eG{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,l;return new Promise((c,f)=>{const d=my("",20);i.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(_){const x=_;if(x.data.eventId===d)switch(x.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(x.data.response);break;default:clearTimeout(m),clearTimeout(s),f(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function tn(){return window}function tG(r){tn().location.href=r}function py(){return typeof tn().WorkerGlobalScope<"u"&&typeof tn().importScripts=="function"}async function rG(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nG(){return navigator?.serviceWorker?.controller||null}function iG(){return py()?self:null}const V4="firebaseLocalStorageDb",aG=1,bp="firebaseLocalStorage",B4="fbase_key";class K0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function og(r,e){return r.transaction([bp],e?"readwrite":"readonly").objectStore(bp)}function sG(){const r=indexedDB.deleteDatabase(V4);return new K0(r).toPromise()}function Ov(){const r=indexedDB.open(V4,aG);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(bp,{keyPath:B4})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(bp)?e(n):(n.close(),await sG(),e(await Ov()))})})}async function CA(r,e,t){const n=og(r,!0).put({[B4]:e,value:t});return new K0(n).toPromise()}async function oG(r,e){const t=og(r,!1).get(e),n=await new K0(t).toPromise();return n===void 0?null:n.value}function RA(r,e){const t=og(r,!0).delete(e);return new K0(t).toPromise()}const lG=800,cG=3;class U4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ov(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>cG)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return py()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sg._getInstance(iG()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await rG(),!this.activeServiceWorker)return;this.sender=new eG(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nG()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ov();return await CA(e,Ap,"1"),await RA(e,Ap),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>CA(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>oG(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>RA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=og(i,!1).getAll();return new K0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}U4.type="LOCAL";const uG=U4;function DA(r,e){return Na(r,"POST","/v2/accounts/mfaSignIn:start",ls(r,e))}const tv=k4("rcb"),fG=new H0(3e4,6e4);class hG{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!tn().grecaptcha?.render}load(e,t=""){return Qe(dG(t),e,"argument-error"),this.shouldResolveImmediately(t)&&vA(tn().grecaptcha)?Promise.resolve(tn().grecaptcha):new Promise((n,i)=>{const s=tn().setTimeout(()=>{i(Mi(e,"network-request-failed"))},fG.get());tn()[tv]=()=>{tn().clearTimeout(s),delete tn()[tv];const c=tn().grecaptcha;if(!c||!vA(c)){i(Mi(e,"internal-error"));return}const f=c.render;c.render=(d,m)=>{const _=f(d,m);return this.counter++,_},this.hostLanguage=t,n(c)};const l=`${EH()}?${pf({onload:tv,render:"explicit",hl:t})}`;hy(l).catch(()=>{clearTimeout(s),i(Mi(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!tn().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function dG(r){return r.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(r)}class mG{async load(e){return new bH(e)}clearedOneInstance(){}}const Wh="recaptcha",pG={theme:"light",type:"image"};class gG{constructor(e,t,n={...pG}){this.parameters=n,this.type=Wh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=cl(e),this.isInvisible=this.parameters.size==="invisible",Qe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;Qe(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new mG:new hG,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(i=>{const s=l=>{l&&(this.tokenChangeListeners.delete(s),i(l))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Qe(!this.parameters.sitekey,this.auth,"argument-error"),Qe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Qe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(n=>n(t)),typeof e=="function")e(t);else if(typeof e=="string"){const n=tn()[e];typeof n=="function"&&n(t)}}}assertNotDestroyed(){Qe(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Qe(f4()&&!py(),this.auth,"internal-error"),await _G(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await iH(this.auth);Qe(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Qe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function _G(){let r=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}r=()=>e(),window.addEventListener("load",r)}).catch(e=>{throw r&&window.removeEventListener("load",r),e})}class vG{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Kh._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function xG(r,e,t){if(Aa(r.app))return Promise.reject(Ko(r));const n=cl(r),i=await yG(n,e,Ir(t));return new vG(i,s=>qH(n,s))}async function yG(r,e,t){if(!r._getRecaptchaConfig())try{await NH(r)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let n;if(typeof e=="string"?n={phoneNumber:e}:n=e,"session"in n){const i=n.session;if("phoneNumber"in n){Qe(i.type==="enroll",r,"internal-error");const s={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await ev(r,s,"mfaSmsEnrollment",async(d,m)=>{if(m.phoneEnrollmentInfo.captchaResponse===qh){Qe(t?.type===Wh,d,"argument-error");const _=await rv(d,m,t);return kA(d,_)}return kA(d,m)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneSessionInfo.sessionInfo}else{Qe(i.type==="signin",r,"internal-error");const s=n.multiFactorHint?.uid||n.multiFactorUid;Qe(s,r,"missing-multi-factor-info");const l={mfaPendingCredential:i.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await ev(r,l,"mfaSmsSignIn",async(m,_)=>{if(_.phoneSignInInfo.captchaResponse===qh){Qe(t?.type===Wh,m,"argument-error");const x=await rv(m,_,t);return DA(m,x)}return DA(m,_)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await ev(r,i,"sendVerificationCode",async(f,d)=>{if(d.captchaResponse===qh){Qe(t?.type===Wh,f,"argument-error");const m=await rv(f,d,t);return bA(f,m)}return bA(f,d)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{t?._reset()}}async function rv(r,e,t){Qe(t.type===Wh,r,"argument-error");const n=await t.verify();Qe(typeof n=="string",r,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const s=i.phoneEnrollmentInfo.phoneNumber,l=i.phoneEnrollmentInfo.captchaResponse,c=i.phoneEnrollmentInfo.clientType,f=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:n,captchaResponse:l,clientType:c,recaptchaVersion:f}}),i}else if("phoneSignInInfo"in i){const s=i.phoneSignInInfo.captchaResponse,l=i.phoneSignInInfo.clientType,c=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:s,clientType:l,recaptchaVersion:c}}),i}else return Object.assign(i,{recaptchaToken:n}),i}function EG(r,e){return e?Fs(e):(Qe(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}class gy extends dy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ju(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ju(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ju(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function TG(r){return O4(r.auth,new gy(r),r.bypassAuthState)}function wG(r){const{auth:e,user:t}=r;return Qe(t,e,"internal-error"),GH(t,new gy(r),r.bypassAuthState)}async function SG(r){const{auth:e,user:t}=r;return Qe(t,e,"internal-error"),HH(t,new gy(r),r.bypassAuthState)}class z4{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:l,type:c}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return TG;case"linkViaPopup":case"linkViaRedirect":return SG;case"reauthViaPopup":case"reauthViaRedirect":return wG;default:Us(this.auth,"internal-error")}}resolve(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const AG=new H0(2e3,1e4);class Ou extends z4{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Ou.currentPopupAction&&Ou.currentPopupAction.cancel(),Ou.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qe(e,this.auth,"internal-error"),e}async onExecution(){zs(this.filter.length===1,"Popup operations only handle one event");const e=my();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Mi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Mi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ou.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AG.get())};e()}}Ou.currentPopupAction=null;const bG="pendingRedirect",Gm=new Map;class IG extends z4{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Gm.get(this.auth._key());if(!e){try{const n=await kG(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Gm.set(this.auth._key(),e)}return this.bypassAuthState||Gm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function kG(r,e){const t=DG(e),n=RG(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function CG(r,e){Gm.set(r._key(),e)}function RG(r){return Fs(r._redirectPersistence)}function DG(r){return Hm(bG,r.config.apiKey,r.name)}async function NG(r,e,t=!1){if(Aa(r.app))return Promise.reject(Ko(r));const n=cl(r),i=EG(n,e),l=await new IG(n,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}const OG=600*1e3;class FG{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!PG(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!j4(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Mi(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=OG&&this.cachedEventUids.clear(),this.cachedEventUids.has(NA(e))}saveEventToCache(e){this.cachedEventUids.add(NA(e)),this.lastProcessedEventTime=Date.now()}}function NA(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function j4({type:r,error:e}){return r==="unknown"&&e?.code==="auth/no-auth-event"}function PG(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return j4(r);default:return!1}}async function MG(r,e={}){return Na(r,"GET","/v1/projects",e)}const LG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,VG=/^https?/;async function BG(r){if(r.config.emulator)return;const{authorizedDomains:e}=await MG(r);for(const t of e)try{if(UG(t))return}catch{}Us(r,"unauthorized-domain")}function UG(r){const e=Dv(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const l=new URL(r);return l.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!VG.test(t))return!1;if(LG.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const zG=new H0(3e4,6e4);function OA(){const r=tn().___jsl;if(r?.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function jG(r){return new Promise((e,t)=>{function n(){OA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{OA(),t(Mi(r,"network-request-failed"))},timeout:zG.get()})}if(tn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(tn().gapi?.load)n();else{const i=k4("iframefcb");return tn()[i]=()=>{gapi.load?n():t(Mi(r,"network-request-failed"))},hy(`${wH()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw qm=null,e})}let qm=null;function HG(r){return qm=qm||jG(r),qm}const GG=new H0(5e3,15e3),qG="__/auth/iframe",KG="emulator/auth/iframe",WG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function YG(r){const e=r.config;Qe(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?cy(e,KG):`https://${r.config.authDomain}/${qG}`,n={apiKey:e.apiKey,appName:r.name,v:gf},i=XG.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${pf(n).slice(1)}`}async function $G(r){const e=await HG(r),t=tn().gapi;return Qe(t,r,"internal-error"),e.open({where:document.body,url:YG(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:WG,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const l=Mi(r,"network-request-failed"),c=tn().setTimeout(()=>{s(l)},GG.get());function f(){tn().clearTimeout(c),i(n)}n.ping(f).then(f,()=>{s(l)})}))}const QG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},JG=500,ZG=600,eq="_blank",tq="http://localhost";class FA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rq(r,e,t,n=JG,i=ZG){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const f={...QG,width:n.toString(),height:i.toString(),top:s,left:l},d=un().toLowerCase();t&&(c=E4(d)?eq:t),x4(d)&&(e=e||tq,f.scrollbars="yes");const m=Object.entries(f).reduce((x,[y,T])=>`${x}${y}=${T},`,"");if(dH(d)&&c!=="_self")return nq(e||"",c),new FA(null);const _=window.open(e||"",c,m);Qe(_,r,"popup-blocked");try{_.focus()}catch{}return new FA(_)}function nq(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}const iq="__/auth/handler",aq="emulator/auth/handler",sq=encodeURIComponent("fac");async function PA(r,e,t,n,i,s){Qe(r.config.authDomain,r,"auth-domain-config-required"),Qe(r.config.apiKey,r,"invalid-api-key");const l={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:gf,eventId:i};if(e instanceof D4){e.setDefaultLanguage(r.languageCode),l.providerId=e.providerId||"",fU(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,_]of Object.entries({}))l[m]=_}if(e instanceof q0){const m=e.getScopes().filter(_=>_!=="");m.length>0&&(l.scopes=m.join(","))}r.tenantId&&(l.tid=r.tenantId);const c=l;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const f=await r._getAppCheckToken(),d=f?`#${sq}=${encodeURIComponent(f)}`:"";return`${oq(r)}?${pf(c).slice(1)}${d}`}function oq({config:r}){return r.emulator?cy(r,aq):`https://${r.authDomain}/${iq}`}const nv="webStorageSupport";class lq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=L4,this._completeRedirectFn=NG,this._overrideRedirectResult=CG}async _openPopup(e,t,n,i){zs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await PA(e,t,n,Dv(),i);return rq(e,s,my())}async _openRedirect(e,t,n,i){await this._originValidation(e);const s=await PA(e,t,n,Dv(),i);return tG(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(zs(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await $G(e),n=new FG(e);return t.register("authEvent",i=>(Qe(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(nv,{type:nv},i=>{const s=i?.[0]?.[nv];s!==void 0&&t(!!s),Us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=BG(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return b4()||y4()||fy()}}const cq=lq;var MA="@firebase/auth",LA="1.11.1";class uq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function fq(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hq(r){ns(new Ra("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;Qe(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:l,authDomain:c,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:I4(r)},d=new xH(n,i,s,f);return FH(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ns(new Ra("auth-internal",e=>{const t=cl(e.getProvider("auth").getImmediate());return(n=>new uq(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),la(MA,LA,fq(r)),la(MA,LA,"esm2020")}const dq=300,mq=IC("authIdTokenMaxAge")||dq;let VA=null;const pq=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>mq)return;const i=t?.token;VA!==i&&(VA=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gq(r=ty()){const e=kc(r,"auth");if(e.isInitialized())return e.getImmediate();const t=OH(r,{popupRedirectResolver:cq,persistence:[uG,JH,L4]}),n=IC("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const l=pq(s.toString());WH(t,l,()=>l(t.currentUser)),KH(t,c=>l(c))}}const i=AC("auth");return i&&PH(t,`http://${i}`),t}function _q(){return document.getElementsByTagName("head")?.[0]??document}yH({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=Mi("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",_q().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hq("Browser");var BA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Wo,H4;(function(){var r;function e(A,R){function C(){}C.prototype=R.prototype,A.F=R.prototype,A.prototype=new C,A.prototype.constructor=A,A.D=function(V,N,M){for(var B=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)B[ve-2]=arguments[ve];return R.prototype[N].apply(V,B)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,R,C){C||(C=0);const V=Array(16);if(typeof R=="string")for(var N=0;N<16;++N)V[N]=R.charCodeAt(C++)|R.charCodeAt(C++)<<8|R.charCodeAt(C++)<<16|R.charCodeAt(C++)<<24;else for(N=0;N<16;++N)V[N]=R[C++]|R[C++]<<8|R[C++]<<16|R[C++]<<24;R=A.g[0],C=A.g[1],N=A.g[2];let M=A.g[3],B;B=R+(M^C&(N^M))+V[0]+3614090360&4294967295,R=C+(B<<7&4294967295|B>>>25),B=M+(N^R&(C^N))+V[1]+3905402710&4294967295,M=R+(B<<12&4294967295|B>>>20),B=N+(C^M&(R^C))+V[2]+606105819&4294967295,N=M+(B<<17&4294967295|B>>>15),B=C+(R^N&(M^R))+V[3]+3250441966&4294967295,C=N+(B<<22&4294967295|B>>>10),B=R+(M^C&(N^M))+V[4]+4118548399&4294967295,R=C+(B<<7&4294967295|B>>>25),B=M+(N^R&(C^N))+V[5]+1200080426&4294967295,M=R+(B<<12&4294967295|B>>>20),B=N+(C^M&(R^C))+V[6]+2821735955&4294967295,N=M+(B<<17&4294967295|B>>>15),B=C+(R^N&(M^R))+V[7]+4249261313&4294967295,C=N+(B<<22&4294967295|B>>>10),B=R+(M^C&(N^M))+V[8]+1770035416&4294967295,R=C+(B<<7&4294967295|B>>>25),B=M+(N^R&(C^N))+V[9]+2336552879&4294967295,M=R+(B<<12&4294967295|B>>>20),B=N+(C^M&(R^C))+V[10]+4294925233&4294967295,N=M+(B<<17&4294967295|B>>>15),B=C+(R^N&(M^R))+V[11]+2304563134&4294967295,C=N+(B<<22&4294967295|B>>>10),B=R+(M^C&(N^M))+V[12]+1804603682&4294967295,R=C+(B<<7&4294967295|B>>>25),B=M+(N^R&(C^N))+V[13]+4254626195&4294967295,M=R+(B<<12&4294967295|B>>>20),B=N+(C^M&(R^C))+V[14]+2792965006&4294967295,N=M+(B<<17&4294967295|B>>>15),B=C+(R^N&(M^R))+V[15]+1236535329&4294967295,C=N+(B<<22&4294967295|B>>>10),B=R+(N^M&(C^N))+V[1]+4129170786&4294967295,R=C+(B<<5&4294967295|B>>>27),B=M+(C^N&(R^C))+V[6]+3225465664&4294967295,M=R+(B<<9&4294967295|B>>>23),B=N+(R^C&(M^R))+V[11]+643717713&4294967295,N=M+(B<<14&4294967295|B>>>18),B=C+(M^R&(N^M))+V[0]+3921069994&4294967295,C=N+(B<<20&4294967295|B>>>12),B=R+(N^M&(C^N))+V[5]+3593408605&4294967295,R=C+(B<<5&4294967295|B>>>27),B=M+(C^N&(R^C))+V[10]+38016083&4294967295,M=R+(B<<9&4294967295|B>>>23),B=N+(R^C&(M^R))+V[15]+3634488961&4294967295,N=M+(B<<14&4294967295|B>>>18),B=C+(M^R&(N^M))+V[4]+3889429448&4294967295,C=N+(B<<20&4294967295|B>>>12),B=R+(N^M&(C^N))+V[9]+568446438&4294967295,R=C+(B<<5&4294967295|B>>>27),B=M+(C^N&(R^C))+V[14]+3275163606&4294967295,M=R+(B<<9&4294967295|B>>>23),B=N+(R^C&(M^R))+V[3]+4107603335&4294967295,N=M+(B<<14&4294967295|B>>>18),B=C+(M^R&(N^M))+V[8]+1163531501&4294967295,C=N+(B<<20&4294967295|B>>>12),B=R+(N^M&(C^N))+V[13]+2850285829&4294967295,R=C+(B<<5&4294967295|B>>>27),B=M+(C^N&(R^C))+V[2]+4243563512&4294967295,M=R+(B<<9&4294967295|B>>>23),B=N+(R^C&(M^R))+V[7]+1735328473&4294967295,N=M+(B<<14&4294967295|B>>>18),B=C+(M^R&(N^M))+V[12]+2368359562&4294967295,C=N+(B<<20&4294967295|B>>>12),B=R+(C^N^M)+V[5]+4294588738&4294967295,R=C+(B<<4&4294967295|B>>>28),B=M+(R^C^N)+V[8]+2272392833&4294967295,M=R+(B<<11&4294967295|B>>>21),B=N+(M^R^C)+V[11]+1839030562&4294967295,N=M+(B<<16&4294967295|B>>>16),B=C+(N^M^R)+V[14]+4259657740&4294967295,C=N+(B<<23&4294967295|B>>>9),B=R+(C^N^M)+V[1]+2763975236&4294967295,R=C+(B<<4&4294967295|B>>>28),B=M+(R^C^N)+V[4]+1272893353&4294967295,M=R+(B<<11&4294967295|B>>>21),B=N+(M^R^C)+V[7]+4139469664&4294967295,N=M+(B<<16&4294967295|B>>>16),B=C+(N^M^R)+V[10]+3200236656&4294967295,C=N+(B<<23&4294967295|B>>>9),B=R+(C^N^M)+V[13]+681279174&4294967295,R=C+(B<<4&4294967295|B>>>28),B=M+(R^C^N)+V[0]+3936430074&4294967295,M=R+(B<<11&4294967295|B>>>21),B=N+(M^R^C)+V[3]+3572445317&4294967295,N=M+(B<<16&4294967295|B>>>16),B=C+(N^M^R)+V[6]+76029189&4294967295,C=N+(B<<23&4294967295|B>>>9),B=R+(C^N^M)+V[9]+3654602809&4294967295,R=C+(B<<4&4294967295|B>>>28),B=M+(R^C^N)+V[12]+3873151461&4294967295,M=R+(B<<11&4294967295|B>>>21),B=N+(M^R^C)+V[15]+530742520&4294967295,N=M+(B<<16&4294967295|B>>>16),B=C+(N^M^R)+V[2]+3299628645&4294967295,C=N+(B<<23&4294967295|B>>>9),B=R+(N^(C|~M))+V[0]+4096336452&4294967295,R=C+(B<<6&4294967295|B>>>26),B=M+(C^(R|~N))+V[7]+1126891415&4294967295,M=R+(B<<10&4294967295|B>>>22),B=N+(R^(M|~C))+V[14]+2878612391&4294967295,N=M+(B<<15&4294967295|B>>>17),B=C+(M^(N|~R))+V[5]+4237533241&4294967295,C=N+(B<<21&4294967295|B>>>11),B=R+(N^(C|~M))+V[12]+1700485571&4294967295,R=C+(B<<6&4294967295|B>>>26),B=M+(C^(R|~N))+V[3]+2399980690&4294967295,M=R+(B<<10&4294967295|B>>>22),B=N+(R^(M|~C))+V[10]+4293915773&4294967295,N=M+(B<<15&4294967295|B>>>17),B=C+(M^(N|~R))+V[1]+2240044497&4294967295,C=N+(B<<21&4294967295|B>>>11),B=R+(N^(C|~M))+V[8]+1873313359&4294967295,R=C+(B<<6&4294967295|B>>>26),B=M+(C^(R|~N))+V[15]+4264355552&4294967295,M=R+(B<<10&4294967295|B>>>22),B=N+(R^(M|~C))+V[6]+2734768916&4294967295,N=M+(B<<15&4294967295|B>>>17),B=C+(M^(N|~R))+V[13]+1309151649&4294967295,C=N+(B<<21&4294967295|B>>>11),B=R+(N^(C|~M))+V[4]+4149444226&4294967295,R=C+(B<<6&4294967295|B>>>26),B=M+(C^(R|~N))+V[11]+3174756917&4294967295,M=R+(B<<10&4294967295|B>>>22),B=N+(R^(M|~C))+V[2]+718787259&4294967295,N=M+(B<<15&4294967295|B>>>17),B=C+(M^(N|~R))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+R&4294967295,A.g[1]=A.g[1]+(N+(B<<21&4294967295|B>>>11))&4294967295,A.g[2]=A.g[2]+N&4294967295,A.g[3]=A.g[3]+M&4294967295}n.prototype.v=function(A,R){R===void 0&&(R=A.length);const C=R-this.blockSize,V=this.C;let N=this.h,M=0;for(;M<R;){if(N==0)for(;M<=C;)i(this,A,M),M+=this.blockSize;if(typeof A=="string"){for(;M<R;)if(V[N++]=A.charCodeAt(M++),N==this.blockSize){i(this,V),N=0;break}}else for(;M<R;)if(V[N++]=A[M++],N==this.blockSize){i(this,V),N=0;break}}this.h=N,this.o+=R},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var R=1;R<A.length-8;++R)A[R]=0;R=this.o*8;for(var C=A.length-8;C<A.length;++C)A[C]=R&255,R/=256;for(this.v(A),A=Array(16),R=0,C=0;C<4;++C)for(let V=0;V<32;V+=8)A[R++]=this.g[C]>>>V&255;return A};function s(A,R){var C=c;return Object.prototype.hasOwnProperty.call(C,A)?C[A]:C[A]=R(A)}function l(A,R){this.h=R;const C=[];let V=!0;for(let N=A.length-1;N>=0;N--){const M=A[N]|0;V&&M==R||(C[N]=M,V=!1)}this.g=C}var c={};function f(A){return-128<=A&&A<128?s(A,function(R){return new l([R|0],R<0?-1:0)}):new l([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return _;if(A<0)return S(d(-A));const R=[];let C=1;for(let V=0;A>=C;V++)R[V]=A/C|0,C*=4294967296;return new l(R,0)}function m(A,R){if(A.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(A.charAt(0)=="-")return S(m(A.substring(1),R));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=d(Math.pow(R,8));let V=_;for(let M=0;M<A.length;M+=8){var N=Math.min(8,A.length-M);const B=parseInt(A.substring(M,M+N),R);N<8?(N=d(Math.pow(R,N)),V=V.j(N).add(d(B))):(V=V.j(C),V=V.add(d(B)))}return V}var _=f(0),x=f(1),y=f(16777216);r=l.prototype,r.m=function(){if(E(this))return-S(this).m();let A=0,R=1;for(let C=0;C<this.g.length;C++){const V=this.i(C);A+=(V>=0?V:4294967296+V)*R,R*=4294967296}return A},r.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(T(this))return"0";if(E(this))return"-"+S(this).toString(A);const R=d(Math.pow(A,6));var C=this;let V="";for(;;){const N=W(C,R).g;C=D(C,N.j(R));let M=((C.g.length>0?C.g[0]:C.h)>>>0).toString(A);if(C=N,T(C))return M+V;for(;M.length<6;)M="0"+M;V=M+V}},r.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function T(A){if(A.h!=0)return!1;for(let R=0;R<A.g.length;R++)if(A.g[R]!=0)return!1;return!0}function E(A){return A.h==-1}r.l=function(A){return A=D(this,A),E(A)?-1:T(A)?0:1};function S(A){const R=A.g.length,C=[];for(let V=0;V<R;V++)C[V]=~A.g[V];return new l(C,~A.h).add(x)}r.abs=function(){return E(this)?S(this):this},r.add=function(A){const R=Math.max(this.g.length,A.g.length),C=[];let V=0;for(let N=0;N<=R;N++){let M=V+(this.i(N)&65535)+(A.i(N)&65535),B=(M>>>16)+(this.i(N)>>>16)+(A.i(N)>>>16);V=B>>>16,M&=65535,B&=65535,C[N]=B<<16|M}return new l(C,C[C.length-1]&-2147483648?-1:0)};function D(A,R){return A.add(S(R))}r.j=function(A){if(T(this)||T(A))return _;if(E(this))return E(A)?S(this).j(S(A)):S(S(this).j(A));if(E(A))return S(this.j(S(A)));if(this.l(y)<0&&A.l(y)<0)return d(this.m()*A.m());const R=this.g.length+A.g.length,C=[];for(var V=0;V<2*R;V++)C[V]=0;for(V=0;V<this.g.length;V++)for(let N=0;N<A.g.length;N++){const M=this.i(V)>>>16,B=this.i(V)&65535,ve=A.i(N)>>>16,xe=A.i(N)&65535;C[2*V+2*N]+=B*xe,U(C,2*V+2*N),C[2*V+2*N+1]+=M*xe,U(C,2*V+2*N+1),C[2*V+2*N+1]+=B*ve,U(C,2*V+2*N+1),C[2*V+2*N+2]+=M*ve,U(C,2*V+2*N+2)}for(A=0;A<R;A++)C[A]=C[2*A+1]<<16|C[2*A];for(A=R;A<2*R;A++)C[A]=0;return new l(C,0)};function U(A,R){for(;(A[R]&65535)!=A[R];)A[R+1]+=A[R]>>>16,A[R]&=65535,R++}function k(A,R){this.g=A,this.h=R}function W(A,R){if(T(R))throw Error("division by zero");if(T(A))return new k(_,_);if(E(A))return R=W(S(A),R),new k(S(R.g),S(R.h));if(E(R))return R=W(A,S(R)),new k(S(R.g),R.h);if(A.g.length>30){if(E(A)||E(R))throw Error("slowDivide_ only works with positive integers.");for(var C=x,V=R;V.l(A)<=0;)C=Z(C),V=Z(V);var N=X(C,1),M=X(V,1);for(V=X(V,2),C=X(C,2);!T(V);){var B=M.add(V);B.l(A)<=0&&(N=N.add(C),M=B),V=X(V,1),C=X(C,1)}return R=D(A,N.j(R)),new k(N,R)}for(N=_;A.l(R)>=0;){for(C=Math.max(1,Math.floor(A.m()/R.m())),V=Math.ceil(Math.log(C)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),M=d(C),B=M.j(R);E(B)||B.l(A)>0;)C-=V,M=d(C),B=M.j(R);T(M)&&(M=x),N=N.add(M),A=D(A,B)}return new k(N,A)}r.B=function(A){return W(this,A).h},r.and=function(A){const R=Math.max(this.g.length,A.g.length),C=[];for(let V=0;V<R;V++)C[V]=this.i(V)&A.i(V);return new l(C,this.h&A.h)},r.or=function(A){const R=Math.max(this.g.length,A.g.length),C=[];for(let V=0;V<R;V++)C[V]=this.i(V)|A.i(V);return new l(C,this.h|A.h)},r.xor=function(A){const R=Math.max(this.g.length,A.g.length),C=[];for(let V=0;V<R;V++)C[V]=this.i(V)^A.i(V);return new l(C,this.h^A.h)};function Z(A){const R=A.g.length+1,C=[];for(let V=0;V<R;V++)C[V]=A.i(V)<<1|A.i(V-1)>>>31;return new l(C,A.h)}function X(A,R){const C=R>>5;R%=32;const V=A.g.length-C,N=[];for(let M=0;M<V;M++)N[M]=R>0?A.i(M+C)>>>R|A.i(M+C+1)<<32-R:A.i(M+C);return new l(N,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,H4=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=m,Wo=l}).apply(typeof BA<"u"?BA:typeof self<"u"?self:typeof window<"u"?window:{});var Om=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var G4,Dh,q4,Km,Fv,K4,W4,X4;(function(){var r,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Om=="object"&&Om];for(var w=0;w<p.length;++w){var I=p[w];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=t(this);function i(p,w){if(w)e:{var I=n;p=p.split(".");for(var j=0;j<p.length-1;j++){var ue=p[j];if(!(ue in I))break e;I=I[ue]}p=p[p.length-1],j=I[p],w=w(j),w!=j&&w!=null&&e(I,p,{configurable:!0,writable:!0,value:w})}}i("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(p){return p||function(w){var I=[],j;for(j in w)Object.prototype.hasOwnProperty.call(w,j)&&I.push([j,w[j]]);return I}});var s=s||{},l=this||self;function c(p){var w=typeof p;return w=="object"&&p!=null||w=="function"}function f(p,w,I){return p.call.apply(p.bind,arguments)}function d(p,w,I){return d=f,d.apply(null,arguments)}function m(p,w){var I=Array.prototype.slice.call(arguments,1);return function(){var j=I.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function _(p,w){function I(){}I.prototype=w.prototype,p.Z=w.prototype,p.prototype=new I,p.prototype.constructor=p,p.Ob=function(j,ue,ye){for(var je=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)je[_t-2]=arguments[_t];return w.prototype[ue].apply(j,je)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function y(p){const w=p.length;if(w>0){const I=Array(w);for(let j=0;j<w;j++)I[j]=p[j];return I}return[]}function T(p,w){for(let j=1;j<arguments.length;j++){const ue=arguments[j];var I=typeof ue;if(I=I!="object"?I:ue?Array.isArray(ue)?"array":I:"null",I=="array"||I=="object"&&typeof ue.length=="number"){I=p.length||0;const ye=ue.length||0;p.length=I+ye;for(let je=0;je<ye;je++)p[I+je]=ue[je]}else p.push(ue)}}class E{constructor(w,I){this.i=w,this.j=I,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function S(p){l.setTimeout(()=>{throw p},0)}function D(){var p=A;let w=null;return p.g&&(w=p.g,p.g=p.g.next,p.g||(p.h=null),w.next=null),w}class U{constructor(){this.h=this.g=null}add(w,I){const j=k.get();j.set(w,I),this.h?this.h.next=j:this.g=j,this.h=j}}var k=new E(()=>new W,p=>p.reset());class W{constructor(){this.next=this.g=this.h=null}set(w,I){this.h=w,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,X=!1,A=new U,R=()=>{const p=Promise.resolve(void 0);Z=()=>{p.then(C)}};function C(){for(var p;p=D();){try{p.h.call(p.g)}catch(I){S(I)}var w=k;w.j(p),w.h<100&&(w.h++,p.next=w.g,w.g=p)}X=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(p,w){this.type=p,this.g=this.target=w,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,w=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};l.addEventListener("test",I,w),l.removeEventListener("test",I,w)}catch{}return p})();function B(p){return/^[\s\xa0]*$/.test(p)}function ve(p,w){N.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,w)}_(ve,N),ve.prototype.init=function(p,w){const I=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=w,w=p.relatedTarget,w||(I=="mouseover"?w=p.fromElement:I=="mouseout"&&(w=p.toElement)),this.relatedTarget=w,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var xe="closure_listenable_"+(Math.random()*1e6|0),ne=0;function le(p,w,I,j,ue){this.listener=p,this.proxy=null,this.src=w,this.type=I,this.capture=!!j,this.ha=ue,this.key=++ne,this.da=this.fa=!1}function Le(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ae(p,w,I){for(const j in p)w.call(I,p[j],j,p)}function Pe(p,w){for(const I in p)w.call(void 0,p[I],I,p)}function J(p){const w={};for(const I in p)w[I]=p[I];return w}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(p,w){let I,j;for(let ue=1;ue<arguments.length;ue++){j=arguments[ue];for(I in j)p[I]=j[I];for(let ye=0;ye<O.length;ye++)I=O[ye],Object.prototype.hasOwnProperty.call(j,I)&&(p[I]=j[I])}}function q(p){this.src=p,this.g={},this.h=0}q.prototype.add=function(p,w,I,j,ue){const ye=p.toString();p=this.g[ye],p||(p=this.g[ye]=[],this.h++);const je=oe(p,w,j,ue);return je>-1?(w=p[je],I||(w.fa=!1)):(w=new le(w,this.src,ye,!!j,ue),w.fa=I,p.push(w)),w};function ee(p,w){const I=w.type;if(I in p.g){var j=p.g[I],ue=Array.prototype.indexOf.call(j,w,void 0),ye;(ye=ue>=0)&&Array.prototype.splice.call(j,ue,1),ye&&(Le(w),p.g[I].length==0&&(delete p.g[I],p.h--))}}function oe(p,w,I,j){for(let ue=0;ue<p.length;++ue){const ye=p[ue];if(!ye.da&&ye.listener==w&&ye.capture==!!I&&ye.ha==j)return ue}return-1}var Te="closure_lm_"+(Math.random()*1e6|0),Re={};function Se(p,w,I,j,ue){if(Array.isArray(w)){for(let ye=0;ye<w.length;ye++)Se(p,w[ye],I,j,ue);return null}return I=nt(I),p&&p[xe]?p.J(w,I,c(j)?!!j.capture:!1,ue):De(p,w,I,!1,j,ue)}function De(p,w,I,j,ue,ye){if(!w)throw Error("Invalid event type");const je=c(ue)?!!ue.capture:!!ue;let _t=Xe(p);if(_t||(p[Te]=_t=new q(p)),I=_t.add(w,I,j,je,ye),I.proxy)return I;if(j=st(),I.proxy=j,j.src=p,j.listener=I,p.addEventListener)M||(ue=je),ue===void 0&&(ue=!1),p.addEventListener(w.toString(),j,ue);else if(p.attachEvent)p.attachEvent(lt(w.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return I}function st(){function p(I){return w.call(p.src,p.listener,I)}const w=At;return p}function te(p,w,I,j,ue){if(Array.isArray(w))for(var ye=0;ye<w.length;ye++)te(p,w[ye],I,j,ue);else j=c(j)?!!j.capture:!!j,I=nt(I),p&&p[xe]?(p=p.i,ye=String(w).toString(),ye in p.g&&(w=p.g[ye],I=oe(w,I,j,ue),I>-1&&(Le(w[I]),Array.prototype.splice.call(w,I,1),w.length==0&&(delete p.g[ye],p.h--)))):p&&(p=Xe(p))&&(w=p.g[w.toString()],p=-1,w&&(p=oe(w,I,j,ue)),(I=p>-1?w[p]:null)&&St(I))}function St(p){if(typeof p!="number"&&p&&!p.da){var w=p.src;if(w&&w[xe])ee(w.i,p);else{var I=p.type,j=p.proxy;w.removeEventListener?w.removeEventListener(I,j,p.capture):w.detachEvent?w.detachEvent(lt(I),j):w.addListener&&w.removeListener&&w.removeListener(j),(I=Xe(w))?(ee(I,p),I.h==0&&(I.src=null,w[Te]=null)):Le(p)}}}function lt(p){return p in Re?Re[p]:Re[p]="on"+p}function At(p,w){if(p.da)p=!0;else{w=new ve(w,this);const I=p.listener,j=p.ha||p.src;p.fa&&St(p),p=I.call(j,w)}return p}function Xe(p){return p=p[Te],p instanceof q?p:null}var Oe="__closure_events_fn_"+(Math.random()*1e9>>>0);function nt(p){return typeof p=="function"?p:(p[Oe]||(p[Oe]=function(w){return p.handleEvent(w)}),p[Oe])}function gt(){V.call(this),this.i=new q(this),this.M=this,this.G=null}_(gt,V),gt.prototype[xe]=!0,gt.prototype.removeEventListener=function(p,w,I,j){te(this,p,w,I,j)};function Mt(p,w){var I,j=p.G;if(j)for(I=[];j;j=j.G)I.push(j);if(p=p.M,j=w.type||w,typeof w=="string")w=new N(w,p);else if(w instanceof N)w.target=w.target||p;else{var ue=w;w=new N(j,p),Q(w,ue)}ue=!0;let ye,je;if(I)for(je=I.length-1;je>=0;je--)ye=w.g=I[je],ue=qr(ye,j,!0,w)&&ue;if(ye=w.g=p,ue=qr(ye,j,!0,w)&&ue,ue=qr(ye,j,!1,w)&&ue,I)for(je=0;je<I.length;je++)ye=w.g=I[je],ue=qr(ye,j,!1,w)&&ue}gt.prototype.N=function(){if(gt.Z.N.call(this),this.i){var p=this.i;for(const w in p.g){const I=p.g[w];for(let j=0;j<I.length;j++)Le(I[j]);delete p.g[w],p.h--}}this.G=null},gt.prototype.J=function(p,w,I,j){return this.i.add(String(p),w,!1,I,j)},gt.prototype.K=function(p,w,I,j){return this.i.add(String(p),w,!0,I,j)};function qr(p,w,I,j){if(w=p.i.g[String(w)],!w)return!0;w=w.concat();let ue=!0;for(let ye=0;ye<w.length;++ye){const je=w[ye];if(je&&!je.da&&je.capture==I){const _t=je.listener,Br=je.ha||je.src;je.fa&&ee(p.i,je),ue=_t.call(Br,j)!==!1&&ue}}return ue&&!j.defaultPrevented}function fa(p,w){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=d(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:l.setTimeout(p,w||0)}function Qn(p){p.g=fa(()=>{p.g=null,p.i&&(p.i=!1,Qn(p))},p.l);const w=p.h;p.h=null,p.m.apply(null,w)}class qt extends V{constructor(w,I){super(),this.m=w,this.l=I,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Qn(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function an(p){V.call(this),this.h=p,this.g={}}_(an,V);var Pn=[];function _i(p){ae(p.g,function(w,I){this.g.hasOwnProperty(I)&&St(w)},p),p.g={}}an.prototype.N=function(){an.Z.N.call(this),_i(this)},an.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gr=l.JSON.stringify,dt=l.JSON.parse,Ye=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function Ut(){}function Tr(){}var Ot={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Kt(){N.call(this,"d")}_(Kt,N);function sn(){N.call(this,"c")}_(sn,N);var Yt={},cs=null;function En(){return cs=cs||new gt}Yt.Ia="serverreachability";function Oa(p){N.call(this,Yt.Ia,p)}_(Oa,N);function Jn(p){const w=En();Mt(w,new Oa(w))}Yt.STAT_EVENT="statevent";function Tn(p,w){N.call(this,Yt.STAT_EVENT,p),this.stat=w}_(Tn,N);function $t(p){const w=En();Mt(w,new Tn(w,p))}Yt.Ja="timingevent";function wn(p,w){N.call(this,Yt.Ja,p),this.size=w}_(wn,N);function Ui(p,w){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},w)}function vi(){this.g=!0}vi.prototype.ua=function(){this.g=!1};function Tf(p,w,I,j,ue,ye){p.info(function(){if(p.g)if(ye){var je="",_t=ye.split("&");for(let Wt=0;Wt<_t.length;Wt++){var Br=_t[Wt].split("=");if(Br.length>1){const wr=Br[0];Br=Br[1];const Gi=wr.split("_");je=Gi.length>=2&&Gi[1]=="type"?je+(wr+"="+Br+"&"):je+(wr+"=redacted&")}}}else je=null;else je=ye;return"XMLHTTP REQ ("+j+") [attempt "+ue+"]: "+w+`
`+I+`
`+je})}function Dc(p,w,I,j,ue,ye,je){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ue+"]: "+w+`
`+I+`
`+ye+" "+je})}function zi(p,w,I,j){p.info(function(){return"XMLHTTP TEXT ("+w+"): "+wf(p,I)+(j?" "+j:"")})}function us(p,w){p.info(function(){return"TIMEOUT: "+w})}vi.prototype.info=function(){};function wf(p,w){if(!p.g)return w;if(!w)return null;try{const ye=JSON.parse(w);if(ye){for(p=0;p<ye.length;p++)if(Array.isArray(ye[p])){var I=ye[p];if(!(I.length<2)){var j=I[1];if(Array.isArray(j)&&!(j.length<1)){var ue=j[0];if(ue!="noop"&&ue!="stop"&&ue!="close")for(let je=1;je<j.length;je++)j[je]=""}}}}return gr(ye)}catch{return w}}var fs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},hs={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hl;function ds(){}_(ds,Ut),ds.prototype.g=function(){return new XMLHttpRequest},hl=new ds;function ha(p){return encodeURIComponent(String(p))}function F(p){var w=1;p=p.split(":");const I=[];for(;w>0&&p.length;)I.push(p.shift()),w--;return p.length&&I.push(p.join(":")),I}function K(p,w,I,j){this.j=p,this.i=w,this.l=I,this.S=j||1,this.V=new an(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new z}function z(){this.i=null,this.g="",this.h=!1}var H={},G={};function Y(p,w,I){p.M=1,p.A=dl(Kr(w)),p.u=I,p.R=!0,he(p,null)}function he(p,w){p.F=Date.now(),pe(p),p.B=Kr(p.A);var I=p.B,j=p.S;Array.isArray(j)||(j=[String(j)]),Oc(I.i,"t",j),p.C=0,I=p.j.L,p.h=new z,p.g=pd(p.j,I?w:null,!p.u),p.P>0&&(p.O=new qt(d(p.Y,p,p.g),p.P)),w=p.V,I=p.g,j=p.ba;var ue="readystatechange";Array.isArray(ue)||(ue&&(Pn[0]=ue.toString()),ue=Pn);for(let ye=0;ye<ue.length;ye++){const je=Se(I,ue[ye],j||w.handleEvent,!1,w.h||w);if(!je)break;w.g[je.key]=je}w=p.J?J(p.J):{},p.u?(p.v||(p.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,w)):(p.v="GET",p.g.ea(p.B,p.v,null,w)),Jn(),Tf(p.i,p.v,p.B,p.l,p.S,p.u)}K.prototype.ba=function(p){p=p.target;const w=this.O;w&&_a(p)==3?w.j():this.Y(p)},K.prototype.Y=function(p){try{if(p==this.g)e:{const _t=_a(this.g),Br=this.g.ya(),Wt=this.g.ca();if(!(_t<3)&&(_t!=3||this.g&&(this.h.h||this.g.la()||Sn(this.g)))){this.K||_t!=4||Br==7||(Br==8||Wt<=0?Jn(3):Jn(2)),Be(this);var w=this.g.ca();this.X=w;var I=Ae(this);if(this.o=w==200,Dc(this.i,this.v,this.B,this.l,this.S,_t,w),this.o){if(this.U&&!this.L){t:{if(this.g){var j,ue=this.g;if((j=ue.g?ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(j)){var ye=j;break t}}ye=null}if(p=ye)zi(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,He(this,p);else{this.o=!1,this.m=3,$t(12),Fe(this),Ge(this);break e}}if(this.R){p=!0;let wr;for(;!this.K&&this.C<I.length;)if(wr=ge(this,I),wr==G){_t==4&&(this.m=4,$t(14),p=!1),zi(this.i,this.l,null,"[Incomplete Response]");break}else if(wr==H){this.m=4,$t(15),zi(this.i,this.l,I,"[Invalid Chunk]"),p=!1;break}else zi(this.i,this.l,wr,null),He(this,wr);if(de(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_t!=4||I.length!=0||this.h.h||(this.m=1,$t(16),p=!1),this.o=this.o&&p,!p)zi(this.i,this.l,I,"[Invalid Chunked Response]"),Fe(this),Ge(this);else if(I.length>0&&!this.W){this.W=!0;var je=this.j;je.g==this&&je.aa&&!je.P&&(je.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),Of(je),je.P=!0,$t(11))}}else zi(this.i,this.l,I,null),He(this,I);_t==4&&Fe(this),this.o&&!this.K&&(_t==4?fd(this.j,this):(this.o=!1,pe(this)))}else ps(this.g),w==400&&I.indexOf("Unknown SID")>0?(this.m=3,$t(12)):(this.m=0,$t(13)),Fe(this),Ge(this)}}}catch{}finally{}};function Ae(p){if(!de(p))return p.g.la();const w=Sn(p.g);if(w==="")return"";let I="";const j=w.length,ue=_a(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Fe(p),Ge(p),"";p.h.i=new l.TextDecoder}for(let ye=0;ye<j;ye++)p.h.h=!0,I+=p.h.i.decode(w[ye],{stream:!(ue&&ye==j-1)});return w.length=0,p.h.g+=I,p.C=0,p.h.g}function de(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function ge(p,w){var I=p.C,j=w.indexOf(`
`,I);return j==-1?G:(I=Number(w.substring(I,j)),isNaN(I)?H:(j+=1,j+I>w.length?G:(w=w.slice(j,j+I),p.C=j+I,w)))}K.prototype.cancel=function(){this.K=!0,Fe(this)};function pe(p){p.T=Date.now()+p.H,Me(p,p.H)}function Me(p,w){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Ui(d(p.aa,p),w)}function Be(p){p.D&&(l.clearTimeout(p.D),p.D=null)}K.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(us(this.i,this.B),this.M!=2&&(Jn(),$t(17)),Fe(this),this.m=2,Ge(this)):Me(this,this.T-p)};function Ge(p){p.j.I==0||p.K||fd(p.j,p)}function Fe(p){Be(p);var w=p.O;w&&typeof w.dispose=="function"&&w.dispose(),p.O=null,_i(p.V),p.g&&(w=p.g,p.g=null,w.abort(),w.dispose())}function He(p,w){try{var I=p.j;if(I.I!=0&&(I.g==p||Mn(I.h,p))){if(!p.L&&Mn(I.h,p)&&I.I==3){try{var j=I.Ba.g.parse(w)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ue=j;if(ue[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<p.F)Vc(I),no(I);else break e;yl(I),$t(18)}}else I.xa=ue[1],0<I.xa-I.K&&ue[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Ui(d(I.Va,I),6e3));dr(I.h)<=1&&I.ta&&(I.ta=void 0)}else Ba(I,11)}else if((p.L||I.g==p)&&Vc(I),!B(w))for(ue=I.Ba.g.parse(w),w=0;w<ue.length;w++){let Wt=ue[w];const wr=Wt[0];if(!(wr<=I.K))if(I.K=wr,Wt=Wt[1],I.I==2)if(Wt[0]=="c"){I.M=Wt[1],I.ba=Wt[2];const Gi=Wt[3];Gi!=null&&(I.ka=Gi,I.j.info("VER="+I.ka));const Ua=Wt[4];Ua!=null&&(I.za=Ua,I.j.info("SVER="+I.za));const va=Wt[5];va!=null&&typeof va=="number"&&va>0&&(j=1.5*va,I.O=j,I.j.info("backChannelRequestTimeoutMs_="+j)),j=I;const xa=p.g;if(xa){const El=xa.g?xa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(El){var ye=j.h;ye.g||El.indexOf("spdy")==-1&&El.indexOf("quic")==-1&&El.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(da(ye,ye.h),ye.h=null))}if(j.G){const Bc=xa.g?xa.g.getResponseHeader("X-HTTP-Session-Id"):null;Bc&&(j.wa=Bc,Zt(j.J,j.G,Bc))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-p.F,I.j.info("Handshake RTT: "+I.T+"ms")),j=I;var je=p;if(j.na=md(j,j.L?j.ba:null,j.W),je.L){ma(j.h,je);var _t=je,Br=j.O;Br&&(_t.H=Br),_t.D&&(Be(_t),pe(_t)),j.g=je}else cd(j);I.i.length>0&&Va(I)}else Wt[0]!="stop"&&Wt[0]!="close"||Ba(I,7);else I.I==3&&(Wt[0]=="stop"||Wt[0]=="close"?Wt[0]=="stop"?Ba(I,7):Df(I):Wt[0]!="noop"&&I.l&&I.l.qa(Wt),I.A=0)}}Jn(4)}catch{}}var Ze=class{constructor(p,w){this.g=p,this.map=w}};function Qt(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Jt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function dr(p){return p.h?1:p.g?p.g.size:0}function Mn(p,w){return p.h?p.h==w:p.g?p.g.has(w):!1}function da(p,w){p.g?p.g.add(w):p.h=w}function ma(p,w){p.h&&p.h==w?p.h=null:p.g&&p.g.has(w)&&p.g.delete(w)}Qt.prototype.cancel=function(){if(this.i=xi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function xi(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let w=p.i;for(const I of p.g.values())w=w.concat(I.G);return w}return y(p.i)}var Ys=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ln(p,w){if(p){p=p.split("&");for(let I=0;I<p.length;I++){const j=p[I].indexOf("=");let ue,ye=null;j>=0?(ue=p[I].substring(0,j),ye=p[I].substring(j+1)):ue=p[I],w(ue,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function yi(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;p instanceof yi?(this.l=p.l,hn(this,p.j),this.o=p.o,this.g=p.g,$s(this,p.u),this.h=p.h,Sf(this,od(p.i)),this.m=p.m):p&&(w=String(p).match(Ys))?(this.l=!1,hn(this,w[1]||"",!0),this.o=Fa(w[2]||""),this.g=Fa(w[3]||"",!0),$s(this,w[4]),this.h=Fa(w[5]||"",!0),Sf(this,w[6]||"",!0),this.m=Fa(w[7]||"")):(this.l=!1,this.i=new Js(null,this.l))}yi.prototype.toString=function(){const p=[];var w=this.j;w&&p.push(ml(w,Nc,!0),":");var I=this.g;return(I||w=="file")&&(p.push("//"),(w=this.o)&&p.push(ml(w,Nc,!0),"@"),p.push(ha(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&p.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(ml(I,I.charAt(0)=="/"?Af:id,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",ml(I,ad)),p.join("")},yi.prototype.resolve=function(p){const w=Kr(this);let I=!!p.j;I?hn(w,p.j):I=!!p.o,I?w.o=p.o:I=!!p.g,I?w.g=p.g:I=p.u!=null;var j=p.h;if(I)$s(w,p.u);else if(I=!!p.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var ue=w.h.lastIndexOf("/");ue!=-1&&(j=w.h.slice(0,ue+1)+j)}if(ue=j,ue==".."||ue==".")j="";else if(ue.indexOf("./")!=-1||ue.indexOf("/.")!=-1){j=ue.lastIndexOf("/",0)==0,ue=ue.split("/");const ye=[];for(let je=0;je<ue.length;){const _t=ue[je++];_t=="."?j&&je==ue.length&&ye.push(""):_t==".."?((ye.length>1||ye.length==1&&ye[0]!="")&&ye.pop(),j&&je==ue.length&&ye.push("")):(ye.push(_t),j=!0)}j=ye.join("/")}else j=ue}return I?w.h=j:I=p.i.toString()!=="",I?Sf(w,od(p.i)):I=!!p.m,I&&(w.m=p.m),w};function Kr(p){return new yi(p)}function hn(p,w,I){p.j=I?Fa(w,!0):w,p.j&&(p.j=p.j.replace(/:$/,""))}function $s(p,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);p.u=w}else p.u=null}function Sf(p,w,I){w instanceof Js?(p.i=w,Fc(p.i,p.l)):(I||(w=ml(w,Qs)),p.i=new Js(w,p.l))}function Zt(p,w,I){p.i.set(w,I)}function dl(p){return Zt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Fa(p,w){return p?w?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function ml(p,w,I){return typeof p=="string"?(p=encodeURI(p).replace(w,si),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function si(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Nc=/[#\/\?@]/g,id=/[#\?:]/g,Af=/[#\?]/g,Qs=/[#\?@]/g,ad=/#/g;function Js(p,w){this.h=this.g=null,this.i=p||null,this.j=!!w}function oi(p){p.g||(p.g=new Map,p.h=0,p.i&&Ln(p.i,function(w,I){p.add(decodeURIComponent(w.replace(/\+/g," ")),I)}))}r=Js.prototype,r.add=function(p,w){oi(this),this.i=null,p=Zs(this,p);let I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(w),this.h+=1,this};function sd(p,w){oi(p),w=Zs(p,w),p.g.has(w)&&(p.i=null,p.h-=p.g.get(w).length,p.g.delete(w))}function bf(p,w){return oi(p),w=Zs(p,w),p.g.has(w)}r.forEach=function(p,w){oi(this),this.g.forEach(function(I,j){I.forEach(function(ue){p.call(w,ue,j,this)},this)},this)};function If(p,w){oi(p);let I=[];if(typeof w=="string")bf(p,w)&&(I=I.concat(p.g.get(Zs(p,w))));else for(p=Array.from(p.g.values()),w=0;w<p.length;w++)I=I.concat(p[w]);return I}r.set=function(p,w){return oi(this),this.i=null,p=Zs(this,p),bf(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[w]),this.h+=1,this},r.get=function(p,w){return p?(p=If(this,p),p.length>0?String(p[0]):w):w};function Oc(p,w,I){sd(p,w),I.length>0&&(p.i=null,p.g.set(Zs(p,w),y(I)),p.h+=I.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],w=Array.from(this.g.keys());for(let j=0;j<w.length;j++){var I=w[j];const ue=ha(I);I=If(this,I);for(let ye=0;ye<I.length;ye++){let je=ue;I[ye]!==""&&(je+="="+ha(I[ye])),p.push(je)}}return this.i=p.join("&")};function od(p){const w=new Js;return w.i=p.i,p.g&&(w.g=new Map(p.g),w.h=p.h),w}function Zs(p,w){return w=String(w),p.j&&(w=w.toLowerCase()),w}function Fc(p,w){w&&!p.j&&(oi(p),p.i=null,p.g.forEach(function(I,j){const ue=j.toLowerCase();j!=ue&&(sd(this,j),Oc(this,ue,I))},p)),p.j=w}function pa(p,w){const I=new vi;if(l.Image){const j=new Image;j.onload=m(ji,I,"TestLoadImage: loaded",!0,w,j),j.onerror=m(ji,I,"TestLoadImage: error",!1,w,j),j.onabort=m(ji,I,"TestLoadImage: abort",!1,w,j),j.ontimeout=m(ji,I,"TestLoadImage: timeout",!1,w,j),l.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else w(!1)}function kf(p,w){const I=new vi,j=new AbortController,ue=setTimeout(()=>{j.abort(),ji(I,"TestPingServer: timeout",!1,w)},1e4);fetch(p,{signal:j.signal}).then(ye=>{clearTimeout(ue),ye.ok?ji(I,"TestPingServer: ok",!0,w):ji(I,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(ue),ji(I,"TestPingServer: error",!1,w)})}function ji(p,w,I,j,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),j(I)}catch{}}function eo(){this.g=new Ye}function Pa(p){this.i=p.Sb||null,this.h=p.ab||!1}_(Pa,Ut),Pa.prototype.g=function(){return new pl(this.i,this.h)};function pl(p,w){gt.call(this),this.H=p,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(pl,gt),r=pl.prototype,r.open=function(p,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=w,this.readyState=1,ga(this)},r.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(w.body=p),(this.H||l).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,to(this)),this.readyState=0},r.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ga(this)),this.g&&(this.readyState=3,ga(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Pc(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Pc(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}r.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var w=p.value?p.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!p.done}))&&(this.response=this.responseText+=w)}p.done?to(this):ga(this),this.readyState==3&&Pc(this)}},r.Oa=function(p){this.g&&(this.response=this.responseText=p,to(this))},r.Na=function(p){this.g&&(this.response=p,to(this))},r.ga=function(){this.g&&to(this)};function to(p){p.readyState=4,p.l=null,p.j=null,p.B=null,ga(p)}r.setRequestHeader=function(p,w){this.A.append(p,w)},r.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],w=this.h.entries();for(var I=w.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=w.next();return p.join(`\r
`)};function ga(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(pl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Hi(p){let w="";return ae(p,function(I,j){w+=j,w+=":",w+=I,w+=`\r
`}),w}function gl(p,w,I){e:{for(j in I){var j=!1;break e}j=!0}j||(I=Hi(I),typeof p=="string"?I!=null&&ha(I):Zt(p,w,I))}function or(p){gt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(or,gt);var Ma=/^https?$/i,Cf=["POST","PUT"];r=or.prototype,r.Fa=function(p){this.H=p},r.ea=function(p,w,I,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);w=w?w.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hl.g(),this.g.onreadystatechange=x(d(this.Ca,this));try{this.B=!0,this.g.open(w,String(p),!0),this.B=!1}catch(ye){_l(this,ye);return}if(p=I||"",I=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ue in j)I.set(ue,j[ue]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ye of j.keys())I.set(ye,j.get(ye));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(I.keys()).find(ye=>ye.toLowerCase()=="content-type"),ue=l.FormData&&p instanceof l.FormData,!(Array.prototype.indexOf.call(Cf,w,void 0)>=0)||j||ue||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,je]of I)this.g.setRequestHeader(ye,je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ye){_l(this,ye)}};function _l(p,w){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=w,p.o=5,Rf(p),ms(p)}function Rf(p){p.A||(p.A=!0,Mt(p,"complete"),Mt(p,"error"))}r.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Mt(this,"complete"),Mt(this,"abort"),ms(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ms(this,!0)),or.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?vl(this):this.Xa())},r.Xa=function(){vl(this)};function vl(p){if(p.h&&typeof s<"u"){if(p.v&&_a(p)==4)setTimeout(p.Ca.bind(p),0);else if(Mt(p,"readystatechange"),_a(p)==4){p.h=!1;try{const ye=p.ca();e:switch(ye){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var I;if(!(I=w)){var j;if(j=ye===0){let je=String(p.D).match(Ys)[1]||null;!je&&l.self&&l.self.location&&(je=l.self.location.protocol.slice(0,-1)),j=!Ma.test(je?je.toLowerCase():"")}I=j}if(I)Mt(p,"complete"),Mt(p,"success");else{p.o=6;try{var ue=_a(p)>2?p.g.statusText:""}catch{ue=""}p.l=ue+" ["+p.ca()+"]",Rf(p)}}finally{ms(p)}}}}function ms(p,w){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const I=p.g;p.g=null,w||Mt(p,"ready");try{I.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function _a(p){return p.g?p.g.readyState:0}r.ca=function(){try{return _a(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(p){if(this.g){var w=this.g.responseText;return p&&w.indexOf(p)==0&&(w=w.substring(p.length)),dt(w)}};function Sn(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ps(p){const w={};p=(p.g&&_a(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(B(p[j]))continue;var I=F(p[j]);const ue=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const ye=w[ue]||[];w[ue]=ye,ye.push(I)}Pe(w,function(j){return j.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function La(p,w,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||w}function ro(p){this.za=0,this.i=[],this.j=new vi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=La("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=La("baseRetryDelayMs",5e3,p),this.Za=La("retryDelaySeedMs",1e4,p),this.Ta=La("forwardChannelMaxRetries",2,p),this.va=La("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Qt(p&&p.concurrentRequestLimit),this.Ba=new eo,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=ro.prototype,r.ka=8,r.I=1,r.connect=function(p,w,I,j){$t(0),this.W=p,this.H=w||{},I&&j!==void 0&&(this.H.OSID=I,this.H.OAID=j),this.F=this.X,this.J=md(this,null,this.W),Va(this)};function Df(p){if(Mc(p),p.I==3){var w=p.V++,I=Kr(p.J);if(Zt(I,"SID",p.M),Zt(I,"RID",w),Zt(I,"TYPE","terminate"),xl(p,I),w=new K(p,p.j,w),w.M=2,w.A=dl(Kr(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(w.A.toString(),"")}catch{}!I&&l.Image&&(new Image().src=w.A,I=!0),I||(w.g=pd(w.j,null),w.g.ea(w.A)),w.F=Date.now(),pe(w)}dd(p)}function no(p){p.g&&(Of(p),p.g.cancel(),p.g=null)}function Mc(p){no(p),p.v&&(l.clearTimeout(p.v),p.v=null),Vc(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&l.clearTimeout(p.m),p.m=null)}function Va(p){if(!Jt(p.h)&&!p.m){p.m=!0;var w=p.Ea;Z||R(),X||(Z(),X=!0),A.add(w,p),p.D=0}}function Lc(p,w){return dr(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=w.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Ui(d(p.Ea,p,w),hd(p,p.D)),p.D++,!0)}r.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ue=new K(this,this.j,p);let ye=this.o;if(this.U&&(ye?(ye=J(ye),Q(ye,this.U)):ye=this.U),this.u!==null||this.R||(ue.J=ye,ye=null),this.S)e:{for(var w=0,I=0;I<this.i.length;I++){t:{var j=this.i[I];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(w+=j,w>4096){w=I;break e}if(w===4096||I===this.i.length-1){w=I+1;break e}}w=1e3}else w=1e3;w=ld(this,ue,w),I=Kr(this.J),Zt(I,"RID",p),Zt(I,"CVER",22),this.G&&Zt(I,"X-HTTP-Session-Id",this.G),xl(this,I),ye&&(this.R?w="headers="+ha(Hi(ye))+"&"+w:this.u&&gl(I,this.u,ye)),da(this.h,ue),this.Ra&&Zt(I,"TYPE","init"),this.S?(Zt(I,"$req",w),Zt(I,"SID","null"),ue.U=!0,Y(ue,I,null)):Y(ue,I,w),this.I=2}}else this.I==3&&(p?Nf(this,p):this.i.length==0||Jt(this.h)||Nf(this))};function Nf(p,w){var I;w?I=w.l:I=p.V++;const j=Kr(p.J);Zt(j,"SID",p.M),Zt(j,"RID",I),Zt(j,"AID",p.K),xl(p,j),p.u&&p.o&&gl(j,p.u,p.o),I=new K(p,p.j,I,p.D+1),p.u===null&&(I.J=p.o),w&&(p.i=w.G.concat(p.i)),w=ld(p,I,1e3),I.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),da(p.h,I),Y(I,j,w)}function xl(p,w){p.H&&ae(p.H,function(I,j){Zt(w,j,I)}),p.l&&ae({},function(I,j){Zt(w,j,I)})}function ld(p,w,I){I=Math.min(p.i.length,I);const j=p.l?d(p.l.Ka,p.l,p):null;e:{var ue=p.i;let _t=-1;for(;;){const Br=["count="+I];_t==-1?I>0?(_t=ue[0].g,Br.push("ofs="+_t)):_t=0:Br.push("ofs="+_t);let Wt=!0;for(let wr=0;wr<I;wr++){var ye=ue[wr].g;const Gi=ue[wr].map;if(ye-=_t,ye<0)_t=Math.max(0,ue[wr].g-100),Wt=!1;else try{ye="req"+ye+"_"||"";try{var je=Gi instanceof Map?Gi:Object.entries(Gi);for(const[Ua,va]of je){let xa=va;c(va)&&(xa=gr(va)),Br.push(ye+Ua+"="+encodeURIComponent(xa))}}catch(Ua){throw Br.push(ye+"type="+encodeURIComponent("_badmap")),Ua}}catch{j&&j(Gi)}}if(Wt){je=Br.join("&");break e}}je=void 0}return p=p.i.splice(0,I),w.G=p,je}function cd(p){if(!p.g&&!p.v){p.Y=1;var w=p.Da;Z||R(),X||(Z(),X=!0),A.add(w,p),p.A=0}}function yl(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Ui(d(p.Da,p),hd(p,p.A)),p.A++,!0)}r.Da=function(){if(this.v=null,ud(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Ui(d(this.Wa,this),p)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,$t(10),no(this),ud(this))};function Of(p){p.B!=null&&(l.clearTimeout(p.B),p.B=null)}function ud(p){p.g=new K(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var w=Kr(p.na);Zt(w,"RID","rpc"),Zt(w,"SID",p.M),Zt(w,"AID",p.K),Zt(w,"CI",p.F?"0":"1"),!p.F&&p.ia&&Zt(w,"TO",p.ia),Zt(w,"TYPE","xmlhttp"),xl(p,w),p.u&&p.o&&gl(w,p.u,p.o),p.O&&(p.g.H=p.O);var I=p.g;p=p.ba,I.M=1,I.A=dl(Kr(w)),I.u=null,I.R=!0,he(I,p)}r.Va=function(){this.C!=null&&(this.C=null,no(this),yl(this),$t(19))};function Vc(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function fd(p,w){var I=null;if(p.g==w){Vc(p),Of(p),p.g=null;var j=2}else if(Mn(p.h,w))I=w.G,ma(p.h,w),j=1;else return;if(p.I!=0){if(w.o)if(j==1){I=w.u?w.u.length:0,w=Date.now()-w.F;var ue=p.D;j=En(),Mt(j,new wn(j,I)),Va(p)}else cd(p);else if(ue=w.m,ue==3||ue==0&&w.X>0||!(j==1&&Lc(p,w)||j==2&&yl(p)))switch(I&&I.length>0&&(w=p.h,w.i=w.i.concat(I)),ue){case 1:Ba(p,5);break;case 4:Ba(p,10);break;case 3:Ba(p,6);break;default:Ba(p,2)}}}function hd(p,w){let I=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(I*=2),I*w}function Ba(p,w){if(p.j.info("Error code "+w),w==2){var I=d(p.bb,p),j=p.Ua;const ue=!j;j=new yi(j||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||hn(j,"https"),dl(j),ue?pa(j.toString(),I):kf(j.toString(),I)}else $t(2);p.I=0,p.l&&p.l.pa(w),dd(p),Mc(p)}r.bb=function(p){p?(this.j.info("Successfully pinged google.com"),$t(2)):(this.j.info("Failed to ping google.com"),$t(1))};function dd(p){if(p.I=0,p.ja=[],p.l){const w=xi(p.h);(w.length!=0||p.i.length!=0)&&(T(p.ja,w),T(p.ja,p.i),p.h.i.length=0,y(p.i),p.i.length=0),p.l.oa()}}function md(p,w,I){var j=I instanceof yi?Kr(I):new yi(I);if(j.g!="")w&&(j.g=w+"."+j.g),$s(j,j.u);else{var ue=l.location;j=ue.protocol,w=w?w+"."+ue.hostname:ue.hostname,ue=+ue.port;const ye=new yi(null);j&&hn(ye,j),w&&(ye.g=w),ue&&$s(ye,ue),I&&(ye.h=I),j=ye}return I=p.G,w=p.wa,I&&w&&Zt(j,I,w),Zt(j,"VER",p.ka),xl(p,j),j}function pd(p,w,I){if(w&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=p.Aa&&!p.ma?new or(new Pa({ab:I})):new or(p.ma),w.Fa(p.L),w}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function gd(){}r=gd.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function io(){}io.prototype.g=function(p,w){return new Zn(p,w)};function Zn(p,w){gt.call(this),this.g=new ro(w),this.l=p,this.h=w&&w.messageUrlParams||null,p=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(p?p["X-WebChannel-Content-Type"]=w.messageContentType:p={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(p?p["X-WebChannel-Client-Profile"]=w.sa:p={"X-WebChannel-Client-Profile":w.sa}),this.g.U=p,(p=w&&w.Qb)&&!B(p)&&(this.g.u=p),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!B(w)&&(this.g.G=w,p=this.h,p!==null&&w in p&&(p=this.h,w in p&&delete p[w])),this.j=new gs(this)}_(Zn,gt),Zn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zn.prototype.close=function(){Df(this.g)},Zn.prototype.o=function(p){var w=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.v&&(I={},I.__data__=gr(p),p=I);w.i.push(new Ze(w.Ya++,p)),w.I==3&&Va(w)},Zn.prototype.N=function(){this.g.l=null,delete this.j,Df(this.g),delete this.g,Zn.Z.N.call(this)};function _d(p){Kt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var w=p.__sm__;if(w){e:{for(const I in w){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,w=w!==null&&p in w?w[p]:void 0),this.data=w}else this.data=p}_(_d,Kt);function vd(){sn.call(this),this.status=1}_(vd,sn);function gs(p){this.g=p}_(gs,gd),gs.prototype.ra=function(){Mt(this.g,"a")},gs.prototype.qa=function(p){Mt(this.g,new _d(p))},gs.prototype.pa=function(p){Mt(this.g,new vd)},gs.prototype.oa=function(){Mt(this.g,"b")},io.prototype.createWebChannel=io.prototype.g,Zn.prototype.send=Zn.prototype.o,Zn.prototype.open=Zn.prototype.m,Zn.prototype.close=Zn.prototype.close,X4=function(){return new io},W4=function(){return En()},K4=Yt,Fv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},fs.NO_ERROR=0,fs.TIMEOUT=8,fs.HTTP_ERROR=6,Km=fs,hs.COMPLETE="complete",q4=hs,Tr.EventType=Ot,Ot.OPEN="a",Ot.CLOSE="b",Ot.ERROR="c",Ot.MESSAGE="d",gt.prototype.listen=gt.prototype.J,Dh=Tr,or.prototype.listenOnce=or.prototype.K,or.prototype.getLastError=or.prototype.Ha,or.prototype.getLastErrorCode=or.prototype.ya,or.prototype.getStatus=or.prototype.ca,or.prototype.getResponseJson=or.prototype.La,or.prototype.getResponseText=or.prototype.la,or.prototype.send=or.prototype.ea,or.prototype.setWithCredentials=or.prototype.Fa,G4=or}).apply(typeof Om<"u"?Om:typeof self<"u"?self:typeof window<"u"?window:{});const UA="@firebase/firestore",zA="4.9.2";class Rn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Rn.UNAUTHENTICATED=new Rn(null),Rn.GOOGLE_CREDENTIALS=new Rn("google-credentials-uid"),Rn.FIRST_PARTY=new Rn("first-party-uid"),Rn.MOCK_USER=new Rn("mock-user");let _f="12.3.0";const hc=new rg("@firebase/firestore");function Au(){return hc.logLevel}function Ve(r,...e){if(hc.logLevel<=Dt.DEBUG){const t=e.map(_y);hc.debug(`Firestore (${_f}): ${r}`,...t)}}function ni(r,...e){if(hc.logLevel<=Dt.ERROR){const t=e.map(_y);hc.error(`Firestore (${_f}): ${r}`,...t)}}function dc(r,...e){if(hc.logLevel<=Dt.WARN){const t=e.map(_y);hc.warn(`Firestore (${_f}): ${r}`,...t)}}function _y(r){if(typeof r=="string")return r;try{return(function(t){return JSON.stringify(t)})(r)}catch{return r}}function $e(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,Y4(r,n,t)}function Y4(r,e,t){let n=`FIRESTORE (${_f}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw ni(n),new Error(n)}function et(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||Y4(e,i,n)}function ht(r,e){return r}const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends Da{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Za{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class $4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vq{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Rn.UNAUTHENTICATED)))}shutdown(){}}class xq{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class yq{constructor(e){this.t=e,this.currentUser=Rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){et(this.o===void 0,42304);let n=this.i;const i=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let s=new Za;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Za,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const f=s;e.enqueueRetryable((async()=>{await f.promise,await i(this.currentUser)}))},c=f=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>c(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?c(f):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Za)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(et(typeof n.accessToken=="string",31837,{l:n}),new $4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return et(e===null||typeof e=="string",2055,{h:e}),new Rn(e)}}class Eq{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Rn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Tq{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Eq(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Rn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class jA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wq{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Aa(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){et(this.o===void 0,3512);const n=s=>{s.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const l=s.token!==this.m;return this.m=s.token,Ve("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>n(s)))};const i=s=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new jA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(et(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new jA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Sq(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class vy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=Sq(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function mt(r,e){return r<e?-1:r>e?1:0}function Pv(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const i=r.charAt(n),s=e.charAt(n);if(i!==s)return iv(i)===iv(s)?mt(i,s):iv(i)?1:-1}return mt(r.length,e.length)}const Aq=55296,bq=57343;function iv(r){const e=r.charCodeAt(0);return e>=Aq&&e<=bq}function $u(r,e,t){return r.length===e.length&&r.every(((n,i)=>t(n,e[i])))}function Q4(r){return r+"\0"}const HA="__name__";class Xa{constructor(e,t,n){t===void 0?t=0:t>e.length&&$e(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&$e(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Xa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Xa?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=Xa.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return mt(e.length,t.length)}static compareSegments(e,t){const n=Xa.isNumericId(e),i=Xa.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Xa.extractNumericId(e).compare(Xa.extractNumericId(t)):Pv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Wo.fromString(e.substring(4,e.length-2))}}class Gt extends Xa{construct(e,t,n){return new Gt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ke(Ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((i=>i.length>0)))}return new Gt(t)}static emptyPath(){return new Gt([])}}const Iq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cr extends Xa{construct(e,t,n){return new Cr(e,t,n)}static isValidIdentifier(e){return Iq.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===HA}static keyField(){return new Cr([HA])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Ke(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ke(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Ke(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,i+=2}else c==="`"?(l=!l,i++):c!=="."||l?(n+=c,i++):(s(),i++)}if(s(),l)throw new Ke(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Cr(t)}static emptyPath(){return new Cr([])}}class We{constructor(e){this.path=e}static fromPath(e){return new We(Gt.fromString(e))}static fromName(e){return new We(Gt.fromString(e).popFirst(5))}static empty(){return new We(Gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new We(new Gt(e.slice()))}}function J4(r,e,t){if(!t)throw new Ke(Ie.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function kq(r,e,t,n){if(e===!0&&n===!0)throw new Ke(Ie.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function GA(r){if(!We.isDocumentKey(r))throw new Ke(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function qA(r){if(We.isDocumentKey(r))throw new Ke(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Z4(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function xy(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":$e(12329,{type:typeof r})}function gi(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Ke(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xy(r);throw new Ke(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function rn(r,e){const t={typeString:r};return e&&(t.value=e),t}function W0(r,e){if(!Z4(r))throw new Ke(Ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const l=r[n];if(i&&typeof l!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(s!==void 0&&l!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new Ke(Ie.INVALID_ARGUMENT,t);return!0}const KA=-62135596800,WA=1e6;class ir{static now(){return ir.fromMillis(Date.now())}static fromDate(e){return ir.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*WA);return new ir(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ke(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ke(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<KA)throw new Ke(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ke(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/WA}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ir._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(W0(e,ir._jsonSchema))return new ir(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-KA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ir._jsonSchemaVersion="firestore/timestamp/1.0",ir._jsonSchema={type:rn("string",ir._jsonSchemaVersion),seconds:rn("number"),nanoseconds:rn("number")};class rt{static fromTimestamp(e){return new rt(e)}static min(){return new rt(new ir(0,0))}static max(){return new rt(new ir(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const x0=-1;class Ip{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function Mv(r){return r.fields.find((e=>e.kind===2))}function Bl(r){return r.fields.filter((e=>e.kind!==2))}Ip.UNKNOWN_ID=-1;class Wm{constructor(e,t){this.fieldPath=e,this.kind=t}}class y0{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new y0(0,Bi.min())}}function Cq(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=rt.fromTimestamp(n===1e9?new ir(t+1,0):new ir(t,n));return new Bi(i,We.empty(),e)}function eR(r){return new Bi(r.readTime,r.key,x0)}class Bi{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Bi(rt.min(),We.empty(),x0)}static max(){return new Bi(rt.max(),We.empty(),x0)}}function yy(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=We.comparator(r.documentKey,e.documentKey),t!==0?t:mt(r.largestBatchId,e.largestBatchId))}const tR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Cc(r){if(r.code!==Ie.FAILED_PRECONDITION||r.message!==tR)throw r;Ve("LocalStore","Unexpectedly lost primary lease")}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce(((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.reject(t)}static resolve(e){return new ce(((t,n)=>{t(e)}))}static reject(e){return new ce(((t,n)=>{n(e)}))}static waitFor(e){return new ce(((t,n)=>{let i=0,s=0,l=!1;e.forEach((c=>{++i,c.next((()=>{++s,l&&s===i&&t()}),(f=>n(f)))})),l=!0,s===i&&t()}))}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next((i=>i?ce.resolve(i):n()));return t}static forEach(e,t){const n=[];return e.forEach(((i,s)=>{n.push(t.call(this,i,s))})),this.waitFor(n)}static mapArray(e,t){return new ce(((n,i)=>{const s=e.length,l=new Array(s);let c=0;for(let f=0;f<s;f++){const d=f;t(e[d]).next((m=>{l[d]=m,++c,c===s&&n(l)}),(m=>i(m)))}}))}static doWhile(e,t){return new ce(((n,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):n()};s()}))}}const ki="SimpleDb";class lg{static open(e,t,n,i){try{return new lg(t,e.transaction(i,n))}catch(s){throw new Xh(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Za,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Xh(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=Ey(n.target.error);this.S.reject(new Xh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ve(ki,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Dq(t)}}class Xo{static delete(e){return Ve(ki,"Removing database:",e),jl(SC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Zx())return!1;if(Xo.F())return!0;const e=un(),t=Xo.M(e),n=0<t&&t<10,i=nR(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,Xo.M(un())===12.2&&ni("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ve(ki,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const l=s.target.result;t(l)},i.onblocked=()=>{n(new Xh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const l=s.target.error;l.name==="VersionError"?n(new Ke(Ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?n(new Ke(Ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):n(new Xh(e,l))},i.onupgradeneeded=s=>{Ve(ki,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const l=s.target.result;this.N.k(l,i.transaction,s.oldVersion,this.version).next((()=>{Ve(ki,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const s=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const c=lg.open(this.db,e,s?"readonly":"readwrite",n),f=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),ce.reject(d)))).toPromise();return f.catch((()=>{})),await c.D,f}catch(c){const f=c,d=f.name!=="FirebaseError"&&l<3;if(Ve(ki,"Transaction failed with error:",f.message,"Retrying:",d),this.close(),!d)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function nR(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Rq{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return jl(this.U.delete())}}class Xh extends Ke{constructor(e,t){super(Ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ul(r){return r.name==="IndexedDbTransactionError"}class Dq{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(Ve(ki,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Ve(ki,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),jl(n)}add(e){return Ve(ki,"ADD",this.store.name,e,e),jl(this.store.add(e))}get(e){return jl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ve(ki,"GET",this.store.name,e,t),t)))}delete(e){return Ve(ki,"DELETE",this.store.name,e),jl(this.store.delete(e))}count(){return Ve(ki,"COUNT",this.store.name),jl(this.store.count())}J(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(n.range);return new ce(((l,c)=>{s.onerror=f=>{c(f.target.error)},s.onsuccess=f=>{l(f.target.result)}}))}{const s=this.cursor(n),l=[];return this.H(s,((c,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new ce(((i,s)=>{n.onerror=l=>{s(l.target.error)},n.onsuccess=l=>{i(l.target.result)}}))}Z(e,t){Ve(ki,"DELETE ALL",this.store.name);const n=this.options(e,t);n.X=!1;const i=this.cursor(n);return this.H(i,((s,l,c)=>c.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.H(i,t)}te(e){const t=this.cursor({});return new ce(((n,i)=>{t.onerror=s=>{const l=Ey(s.target.error);i(l)},t.onsuccess=s=>{const l=s.target.result;l?e(l.primaryKey,l.value).next((c=>{c?l.continue():n()})):n()}}))}H(e,t){const n=[];return new ce(((i,s)=>{e.onerror=l=>{s(l.target.error)},e.onsuccess=l=>{const c=l.target.result;if(!c)return void i();const f=new Rq(c),d=t(c.primaryKey,c.value,f);if(d instanceof ce){const m=d.catch((_=>(f.done(),ce.reject(_))));n.push(m)}f.isDone?i():f.G===null?c.continue():c.continue(f.G)}})).next((()=>ce.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function jl(r){return new ce(((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=Ey(n.target.error);t(i)}}))}let XA=!1;function Ey(r){const e=Xo.M(un());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Ke("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return XA||(XA=!0,setTimeout((()=>{throw n}),0)),n}}return r}const Yh="IndexBackfiller";class Nq{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ve(Yh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ve(Yh,`Documents written: ${t}`)}catch(t){ul(t)?Ve(Yh,"Ignoring IndexedDB error during index backfill: ",t):await Cc(t)}await this.re(6e4)}))}}class Oq{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let i=t,s=!0;return ce.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!n.has(l))return Ve(Yh,`Processing collection: ${l}`),this.oe(e,l,i).next((c=>{i-=c,n.add(l)}));s=!1})))).next((()=>t-i))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next((s=>{const l=s.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(i,s))).next((c=>(Ve(Yh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>l.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((i,s)=>{const l=eR(s);yy(l,n)>0&&(n=l)})),new Bi(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class sa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}sa.ce=-1;const Zl=-1;function X0(r){return r==null}function E0(r){return r===0&&1/r==-1/0}function Fq(r){return typeof r=="number"&&Number.isInteger(r)&&!E0(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}const kp="";function Xn(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=YA(e)),e=Pq(r.get(t),e);return YA(e)}function Pq(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case kp:t+="";break;default:t+=s}}return t}function YA(r){return r+kp+""}function $a(r){const e=r.length;if(et(e>=2,64408,{path:r}),e===2)return et(r.charAt(0)===kp&&r.charAt(1)==="",56145,{path:r}),Gt.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const l=r.indexOf(kp,s);switch((l<0||l>t)&&$e(50515,{path:r}),r.charAt(l+1)){case"":const c=r.substring(s,l);let f;i.length===0?f=c:(i+=c,f=i,i=""),n.push(f);break;case"":i+=r.substring(s,l),i+="\0";break;case"":i+=r.substring(s,l+1);break;default:$e(61167,{path:r})}s=l+2}return new Gt(n)}const Ul="remoteDocuments",Y0="owner",vu="owner",T0="mutationQueues",Mq="userId",Sa="mutations",$A="batchId",Wl="userMutationsIndex",QA=["userId","batchId"];function Xm(r,e){return[r,Xn(e)]}function iR(r,e,t){return[r,Xn(e),t]}const Lq={},Qu="documentMutations",Cp="remoteDocumentsV14",Vq=["prefixPath","collectionGroup","readTime","documentId"],Ym="documentKeyIndex",Bq=["prefixPath","collectionGroup","documentId"],aR="collectionGroupIndex",Uq=["collectionGroup","readTime","prefixPath","documentId"],w0="remoteDocumentGlobal",Lv="remoteDocumentGlobalKey",Ju="targets",sR="queryTargetsIndex",zq=["canonicalId","targetId"],Zu="targetDocuments",jq=["targetId","path"],Ty="documentTargetsIndex",Hq=["path","targetId"],Rp="targetGlobalKey",ec="targetGlobal",S0="collectionParents",Gq=["collectionId","parent"],ef="clientMetadata",qq="clientId",cg="bundles",Kq="bundleId",ug="namedQueries",Wq="name",wy="indexConfiguration",Xq="indexId",Vv="collectionGroupIndex",Yq="collectionGroup",$h="indexState",$q=["indexId","uid"],oR="sequenceNumberIndex",Qq=["uid","sequenceNumber"],Qh="indexEntries",Jq=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],lR="documentKeyIndex",Zq=["indexId","uid","orderedDocumentKey"],fg="documentOverlays",eK=["userId","collectionPath","documentId"],Bv="collectionPathOverlayIndex",tK=["userId","collectionPath","largestBatchId"],cR="collectionGroupOverlayIndex",rK=["userId","collectionGroup","largestBatchId"],Sy="globals",nK="name",uR=[T0,Sa,Qu,Ul,Ju,Y0,ec,Zu,ef,w0,S0,cg,ug],iK=[...uR,fg],fR=[T0,Sa,Qu,Cp,Ju,Y0,ec,Zu,ef,w0,S0,cg,ug,fg],hR=fR,Ay=[...hR,wy,$h,Qh],aK=Ay,dR=[...Ay,Sy],sK=dR;class Uv extends rR{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function fn(r,e){const t=ht(r);return Xo.O(t.le,e)}function JA(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function fl(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function mR(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class kr{constructor(e,t){this.comparator=e,this.root=t||Dn.EMPTY}insert(e,t){return new kr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dn.BLACK,null,null))}remove(e){return new kr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fm(this.root,e,this.comparator,!0)}}class Fm{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dn{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Dn.RED,this.left=i??Dn.EMPTY,this.right=s??Dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Dn(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Dn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw $e(27949);return e+(this.isRed()?0:1)}}Dn.EMPTY=null,Dn.RED=!0,Dn.BLACK=!1;Dn.EMPTY=new class{constructor(){this.size=0}get key(){throw $e(57766)}get value(){throw $e(16141)}get color(){throw $e(16727)}get left(){throw $e(29726)}get right(){throw $e(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new Dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sr{constructor(e){this.comparator=e,this.data=new kr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ZA(this.data.getIterator())}getIteratorFrom(e){return new ZA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof sr)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new sr(this.comparator);return t.data=e,t}}class ZA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xu(r){return r.hasNext()?r.getNext():void 0}class mi{constructor(e){this.fields=e,e.sort(Cr.comparator)}static empty(){return new mi([])}unionWith(e){let t=new sr(Cr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new mi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $u(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}class pR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class nn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new pR("Invalid base64 string: "+s):s}})(e);return new nn(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let l=0;l<i.length;++l)s+=String.fromCharCode(i[l]);return s})(e);return new nn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nn.EMPTY_BYTE_STRING=new nn("");const oK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function js(r){if(et(!!r,39018),typeof r=="string"){let e=0;const t=oK.exec(r);if(et(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ar(r.seconds),nanos:Ar(r.nanos)}}function Ar(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Hs(r){return typeof r=="string"?nn.fromBase64String(r):nn.fromUint8Array(r)}const gR="server_timestamp",_R="__type__",vR="__previous_value__",xR="__local_write_time__";function by(r){return(r?.mapValue?.fields||{})[_R]?.stringValue===gR}function hg(r){const e=r.mapValue.fields[vR];return by(e)?hg(e):e}function A0(r){const e=js(r.mapValue.fields[xR].timestampValue);return new ir(e.seconds,e.nanos)}class lK{constructor(e,t,n,i,s,l,c,f,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=m}}const Dp="(default)";class mc{constructor(e,t){this.projectId=e,this.database=t||Dp}static empty(){return new mc("","")}get isDefaultDatabase(){return this.database===Dp}isEqual(e){return e instanceof mc&&e.projectId===this.projectId&&e.database===this.database}}const Iy="__type__",yR="__max__",jo={mapValue:{fields:{__type__:{stringValue:yR}}}},ky="__vector__",tf="value",$m={nullValue:"NULL_VALUE"};function rl(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?by(r)?4:ER(r)?9007199254740991:dg(r)?10:11:$e(28295,{value:r})}function is(r,e){if(r===e)return!0;const t=rl(r);if(t!==rl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return A0(r).isEqual(A0(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const l=js(i.timestampValue),c=js(s.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(i,s){return Hs(i.bytesValue).isEqual(Hs(s.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(i,s){return Ar(i.geoPointValue.latitude)===Ar(s.geoPointValue.latitude)&&Ar(i.geoPointValue.longitude)===Ar(s.geoPointValue.longitude)})(r,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Ar(i.integerValue)===Ar(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const l=Ar(i.doubleValue),c=Ar(s.doubleValue);return l===c?E0(l)===E0(c):isNaN(l)&&isNaN(c)}return!1})(r,e);case 9:return $u(r.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return(function(i,s){const l=i.mapValue.fields||{},c=s.mapValue.fields||{};if(JA(l)!==JA(c))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(c[f]===void 0||!is(l[f],c[f])))return!1;return!0})(r,e);default:return $e(52216,{left:r})}}function b0(r,e){return(r.values||[]).find((t=>is(t,e)))!==void 0}function nl(r,e){if(r===e)return 0;const t=rl(r),n=rl(e);if(t!==n)return mt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return mt(r.booleanValue,e.booleanValue);case 2:return(function(s,l){const c=Ar(s.integerValue||s.doubleValue),f=Ar(l.integerValue||l.doubleValue);return c<f?-1:c>f?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1})(r,e);case 3:return eb(r.timestampValue,e.timestampValue);case 4:return eb(A0(r),A0(e));case 5:return Pv(r.stringValue,e.stringValue);case 6:return(function(s,l){const c=Hs(s),f=Hs(l);return c.compareTo(f)})(r.bytesValue,e.bytesValue);case 7:return(function(s,l){const c=s.split("/"),f=l.split("/");for(let d=0;d<c.length&&d<f.length;d++){const m=mt(c[d],f[d]);if(m!==0)return m}return mt(c.length,f.length)})(r.referenceValue,e.referenceValue);case 8:return(function(s,l){const c=mt(Ar(s.latitude),Ar(l.latitude));return c!==0?c:mt(Ar(s.longitude),Ar(l.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return tb(r.arrayValue,e.arrayValue);case 10:return(function(s,l){const c=s.fields||{},f=l.fields||{},d=c[tf]?.arrayValue,m=f[tf]?.arrayValue,_=mt(d?.values?.length||0,m?.values?.length||0);return _!==0?_:tb(d,m)})(r.mapValue,e.mapValue);case 11:return(function(s,l){if(s===jo.mapValue&&l===jo.mapValue)return 0;if(s===jo.mapValue)return 1;if(l===jo.mapValue)return-1;const c=s.fields||{},f=Object.keys(c),d=l.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let _=0;_<f.length&&_<m.length;++_){const x=Pv(f[_],m[_]);if(x!==0)return x;const y=nl(c[f[_]],d[m[_]]);if(y!==0)return y}return mt(f.length,m.length)})(r.mapValue,e.mapValue);default:throw $e(23264,{he:t})}}function eb(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return mt(r,e);const t=js(r),n=js(e),i=mt(t.seconds,n.seconds);return i!==0?i:mt(t.nanos,n.nanos)}function tb(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=nl(t[i],n[i]);if(s)return s}return mt(t.length,n.length)}function rf(r){return zv(r)}function zv(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=js(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return Hs(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return We.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=zv(s);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const l of n)s?s=!1:i+=",",i+=`${l}:${zv(t.fields[l])}`;return i+"}"})(r.mapValue):$e(61005,{value:r})}function Qm(r){switch(rl(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hg(r);return e?16+Qm(e):16;case 5:return 2*r.stringValue.length;case 6:return Hs(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,s)=>i+Qm(s)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return fl(n.fields,((s,l)=>{i+=s.length+Qm(l)})),i})(r.mapValue);default:throw $e(13486,{value:r})}}function Cy(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function jv(r){return!!r&&"integerValue"in r}function I0(r){return!!r&&"arrayValue"in r}function rb(r){return!!r&&"nullValue"in r}function nb(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Jm(r){return!!r&&"mapValue"in r}function dg(r){return(r?.mapValue?.fields||{})[Iy]?.stringValue===ky}function Jh(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return fl(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Jh(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Jh(r.arrayValue.values[t]);return e}return{...r}}function ER(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===yR}const TR={mapValue:{fields:{[Iy]:{stringValue:ky},[tf]:{arrayValue:{}}}}};function cK(r){return"nullValue"in r?$m:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Cy(mc.empty(),We.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?dg(r)?TR:{mapValue:{}}:$e(35942,{value:r})}function uK(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Cy(mc.empty(),We.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?TR:"mapValue"in r?dg(r)?{mapValue:{}}:jo:$e(61959,{value:r})}function ib(r,e){const t=nl(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function ab(r,e){const t=nl(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}class Fn{constructor(e){this.value=e}static empty(){return new Fn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Jm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jh(t)}setAll(e){let t=Cr.emptyPath(),n={},i=[];e.forEach(((l,c)=>{if(!t.isImmediateParentOf(c)){const f=this.getFieldsMap(t);this.applyChanges(f,n,i),n={},i=[],t=c.popLast()}l?n[c.lastSegment()]=Jh(l):i.push(c.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());Jm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Jm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){fl(t,((i,s)=>e[i]=s));for(const i of n)delete e[i]}clone(){return new Fn(Jh(this.value))}}function wR(r){const e=[];return fl(r.fields,((t,n)=>{const i=new Cr([t]);if(Jm(n)){const s=wR(n.mapValue).fields;if(s.length===0)e.push(i);else for(const l of s)e.push(i.child(l))}else e.push(i)})),new mi(e)}class br{constructor(e,t,n,i,s,l,c){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=l,this.documentState=c}static newInvalidDocument(e){return new br(e,0,rt.min(),rt.min(),rt.min(),Fn.empty(),0)}static newFoundDocument(e,t,n,i){return new br(e,1,t,rt.min(),n,i,0)}static newNoDocument(e,t){return new br(e,2,t,rt.min(),rt.min(),Fn.empty(),0)}static newUnknownDocument(e,t){return new br(e,3,t,rt.min(),rt.min(),Fn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof br&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new br(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class nf{constructor(e,t){this.position=e,this.inclusive=t}}function sb(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],l=r.position[i];if(s.field.isKeyField()?n=We.comparator(We.fromName(l.referenceValue),t.key):n=nl(l,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function ob(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!is(r.position[t],e.position[t]))return!1;return!0}class Np{constructor(e,t="asc"){this.field=e,this.dir=t}}function fK(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class SR{}class Pt extends SR{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new hK(e,t,n):t==="array-contains"?new pK(e,n):t==="in"?new RR(e,n):t==="not-in"?new gK(e,n):t==="array-contains-any"?new _K(e,n):new Pt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new dK(e,n):new mK(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(nl(t,this.value)):t!==null&&rl(this.value)===rl(t)&&this.matchesComparison(nl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class hr extends SR{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new hr(e,t)}matches(e){return af(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function af(r){return r.op==="and"}function Hv(r){return r.op==="or"}function Ry(r){return AR(r)&&af(r)}function AR(r){for(const e of r.filters)if(e instanceof hr)return!1;return!0}function Gv(r){if(r instanceof Pt)return r.field.canonicalString()+r.op.toString()+rf(r.value);if(Ry(r))return r.filters.map((e=>Gv(e))).join(",");{const e=r.filters.map((t=>Gv(t))).join(",");return`${r.op}(${e})`}}function bR(r,e){return r instanceof Pt?(function(n,i){return i instanceof Pt&&n.op===i.op&&n.field.isEqual(i.field)&&is(n.value,i.value)})(r,e):r instanceof hr?(function(n,i){return i instanceof hr&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((s,l,c)=>s&&bR(l,i.filters[c])),!0):!1})(r,e):void $e(19439)}function IR(r,e){const t=r.filters.concat(e);return hr.create(t,r.op)}function kR(r){return r instanceof Pt?(function(t){return`${t.field.canonicalString()} ${t.op} ${rf(t.value)}`})(r):r instanceof hr?(function(t){return t.op.toString()+" {"+t.getFilters().map(kR).join(" ,")+"}"})(r):"Filter"}class hK extends Pt{constructor(e,t,n){super(e,t,n),this.key=We.fromName(n.referenceValue)}matches(e){const t=We.comparator(e.key,this.key);return this.matchesComparison(t)}}class dK extends Pt{constructor(e,t){super(e,"in",t),this.keys=CR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class mK extends Pt{constructor(e,t){super(e,"not-in",t),this.keys=CR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function CR(r,e){return(e.arrayValue?.values||[]).map((t=>We.fromName(t.referenceValue)))}class pK extends Pt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return I0(t)&&b0(t.arrayValue,this.value)}}class RR extends Pt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&b0(this.value.arrayValue,t)}}class gK extends Pt{constructor(e,t){super(e,"not-in",t)}matches(e){if(b0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!b0(this.value.arrayValue,t)}}class _K extends Pt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!I0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>b0(this.value.arrayValue,n)))}}class vK{constructor(e,t=null,n=[],i=[],s=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=l,this.endAt=c,this.Te=null}}function qv(r,e=null,t=[],n=[],i=null,s=null,l=null){return new vK(r,e,t,n,i,s,l)}function pc(r){const e=ht(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>Gv(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(s){return s.field.canonicalString()+s.dir})(n))).join(","),X0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>rf(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>rf(n))).join(",")),e.Te=t}return e.Te}function $0(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!fK(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!bR(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!ob(r.startAt,e.startAt)&&ob(r.endAt,e.endAt)}function Op(r){return We.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Fp(r,e){return r.filters.filter((t=>t instanceof Pt&&t.field.isEqual(e)))}function lb(r,e,t){let n=$m,i=!0;for(const s of Fp(r,e)){let l=$m,c=!0;switch(s.op){case"<":case"<=":l=cK(s.value);break;case"==":case"in":case">=":l=s.value;break;case">":l=s.value,c=!1;break;case"!=":case"not-in":l=$m}ib({value:n,inclusive:i},{value:l,inclusive:c})<0&&(n=l,i=c)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const l=t.position[s];ib({value:n,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(n=l,i=t.inclusive);break}}return{value:n,inclusive:i}}function cb(r,e,t){let n=jo,i=!0;for(const s of Fp(r,e)){let l=jo,c=!0;switch(s.op){case">=":case">":l=uK(s.value),c=!1;break;case"==":case"in":case"<=":l=s.value;break;case"<":l=s.value,c=!1;break;case"!=":case"not-in":l=jo}ab({value:n,inclusive:i},{value:l,inclusive:c})>0&&(n=l,i=c)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const l=t.position[s];ab({value:n,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(n=l,i=t.inclusive);break}}return{value:n,inclusive:i}}class mg{constructor(e,t=null,n=[],i=[],s=null,l="F",c=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=l,this.startAt=c,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function xK(r,e,t,n,i,s,l,c){return new mg(r,e,t,n,i,s,l,c)}function pg(r){return new mg(r)}function ub(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function yK(r){return r.collectionGroup!==null}function Zh(r){const e=ht(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new sr(Cr.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Np(s,n))})),t.has(Cr.keyField().canonicalString())||e.Ie.push(new Np(Cr.keyField(),n))}return e.Ie}function ca(r){const e=ht(r);return e.Ee||(e.Ee=EK(e,Zh(r))),e.Ee}function EK(r,e){if(r.limitType==="F")return qv(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Np(i.field,s)}));const t=r.endAt?new nf(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new nf(r.startAt.position,r.startAt.inclusive):null;return qv(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Kv(r,e,t){return new mg(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function gg(r,e){return $0(ca(r),ca(e))&&r.limitType===e.limitType}function DR(r){return`${pc(ca(r))}|lt:${r.limitType}`}function bu(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((i=>kR(i))).join(", ")}]`),X0(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((i=>rf(i))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((i=>rf(i))).join(",")),`Target(${n})`})(ca(r))}; limitType=${r.limitType})`}function Q0(r,e){return e.isFoundDocument()&&(function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):We.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)})(r,e)&&(function(n,i){for(const s of Zh(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(r,e)&&(function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0})(r,e)&&(function(n,i){return!(n.startAt&&!(function(l,c,f){const d=sb(l,c,f);return l.inclusive?d<=0:d<0})(n.startAt,Zh(n),i)||n.endAt&&!(function(l,c,f){const d=sb(l,c,f);return l.inclusive?d>=0:d>0})(n.endAt,Zh(n),i))})(r,e)}function TK(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function NR(r){return(e,t)=>{let n=!1;for(const i of Zh(r)){const s=wK(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function wK(r,e,t){const n=r.field.isKeyField()?We.comparator(e.key,t.key):(function(s,l,c){const f=l.data.field(s),d=c.data.field(s);return f!==null&&d!==null?nl(f,d):$e(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return $e(19790,{direction:r.dir})}}class Ws{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){fl(this.inner,((t,n)=>{for(const[i,s]of n)e(i,s)}))}isEmpty(){return mR(this.inner)}size(){return this.innerSize}}const SK=new kr(We.comparator);function Oi(){return SK}const OR=new kr(We.comparator);function Nh(...r){let e=OR;for(const t of r)e=e.insert(t.key,t);return e}function FR(r){let e=OR;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Qa(){return e0()}function PR(){return e0()}function e0(){return new Ws((r=>r.toString()),((r,e)=>r.isEqual(e)))}const AK=new kr(We.comparator),bK=new sr(We.comparator);function wt(...r){let e=bK;for(const t of r)e=e.add(t);return e}const IK=new sr(mt);function kK(){return IK}function Dy(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:E0(e)?"-0":e}}function MR(r){return{integerValue:""+r}}function CK(r,e){return Fq(e)?MR(e):Dy(r,e)}class _g{constructor(){this._=void 0}}function RK(r,e,t){return r instanceof k0?(function(i,s){const l={fields:{[_R]:{stringValue:gR},[xR]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&by(s)&&(s=hg(s)),s&&(l.fields[vR]=s),{mapValue:l}})(t,e):r instanceof sf?VR(r,e):r instanceof of?BR(r,e):(function(i,s){const l=LR(i,s),c=fb(l)+fb(i.Ae);return jv(l)&&jv(i.Ae)?MR(c):Dy(i.serializer,c)})(r,e)}function DK(r,e,t){return r instanceof sf?VR(r,e):r instanceof of?BR(r,e):t}function LR(r,e){return r instanceof C0?(function(n){return jv(n)||(function(s){return!!s&&"doubleValue"in s})(n)})(e)?e:{integerValue:0}:null}class k0 extends _g{}class sf extends _g{constructor(e){super(),this.elements=e}}function VR(r,e){const t=UR(e);for(const n of r.elements)t.some((i=>is(i,n)))||t.push(n);return{arrayValue:{values:t}}}class of extends _g{constructor(e){super(),this.elements=e}}function BR(r,e){let t=UR(e);for(const n of r.elements)t=t.filter((i=>!is(i,n)));return{arrayValue:{values:t}}}class C0 extends _g{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function fb(r){return Ar(r.integerValue||r.doubleValue)}function UR(r){return I0(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class NK{constructor(e,t){this.field=e,this.transform=t}}function OK(r,e){return r.field.isEqual(e.field)&&(function(n,i){return n instanceof sf&&i instanceof sf||n instanceof of&&i instanceof of?$u(n.elements,i.elements,is):n instanceof C0&&i instanceof C0?is(n.Ae,i.Ae):n instanceof k0&&i instanceof k0})(r.transform,e.transform)}class FK{constructor(e,t){this.version=e,this.transformResults=t}}class Rr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rr}static exists(e){return new Rr(void 0,e)}static updateTime(e){return new Rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zm(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class vg{}function zR(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new xf(r.key,Rr.none()):new vf(r.key,r.data,Rr.none());{const t=r.data,n=Fn.empty();let i=new sr(Cr.comparator);for(let s of e.fields)if(!i.has(s)){let l=t.field(s);l===null&&s.length>1&&(s=s.popLast(),l=t.field(s)),l===null?n.delete(s):n.set(s,l),i=i.add(s)}return new Xs(r.key,n,new mi(i.toArray()),Rr.none())}}function PK(r,e,t){r instanceof vf?(function(i,s,l){const c=i.value.clone(),f=db(i.fieldTransforms,s,l.transformResults);c.setAll(f),s.convertToFoundDocument(l.version,c).setHasCommittedMutations()})(r,e,t):r instanceof Xs?(function(i,s,l){if(!Zm(i.precondition,s))return void s.convertToUnknownDocument(l.version);const c=db(i.fieldTransforms,s,l.transformResults),f=s.data;f.setAll(jR(i)),f.setAll(c),s.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(r,e,t):(function(i,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function t0(r,e,t,n){return r instanceof vf?(function(s,l,c,f){if(!Zm(s.precondition,l))return c;const d=s.value.clone(),m=mb(s.fieldTransforms,f,l);return d.setAll(m),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(r,e,t,n):r instanceof Xs?(function(s,l,c,f){if(!Zm(s.precondition,l))return c;const d=mb(s.fieldTransforms,f,l),m=l.data;return m.setAll(jR(s)),m.setAll(d),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((_=>_.field)))})(r,e,t,n):(function(s,l,c){return Zm(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c})(r,e,t)}function MK(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=LR(n.transform,i||null);s!=null&&(t===null&&(t=Fn.empty()),t.set(n.field,s))}return t||null}function hb(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&$u(n,i,((s,l)=>OK(s,l)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class vf extends vg{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xs extends vg{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function jR(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function db(r,e,t){const n=new Map;et(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let i=0;i<t.length;i++){const s=r[i],l=s.transform,c=e.data.field(s.field);n.set(s.field,DK(l,c,t[i]))}return n}function mb(r,e,t){const n=new Map;for(const i of r){const s=i.transform,l=t.data.field(i.field);n.set(i.field,RK(s,l,e))}return n}class xf extends vg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ny extends vg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Oy{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&PK(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=t0(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=t0(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=PR();return this.mutations.forEach((i=>{const s=e.get(i.key),l=s.overlayedDocument;let c=this.applyToLocalView(l,s.mutatedFields);c=t.has(i.key)?null:c;const f=zR(l,c);f!==null&&n.set(i.key,f),l.isValidDocument()||l.convertToNoDocument(rt.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),wt())}isEqual(e){return this.batchId===e.batchId&&$u(this.mutations,e.mutations,((t,n)=>hb(t,n)))&&$u(this.baseMutations,e.baseMutations,((t,n)=>hb(t,n)))}}class Fy{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){et(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=(function(){return AK})();const s=e.mutations;for(let l=0;l<s.length;l++)i=i.insert(s[l].key,n[l].version);return new Fy(e,t,n,i)}}class Py{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class LK{constructor(e,t){this.count=e,this.unchangedNames=t}}var Jr,Lt;function HR(r){switch(r){case Ie.OK:return $e(64938);case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0;default:return $e(15467,{code:r})}}function GR(r){if(r===void 0)return ni("GRPC error has no .code"),Ie.UNKNOWN;switch(r){case Jr.OK:return Ie.OK;case Jr.CANCELLED:return Ie.CANCELLED;case Jr.UNKNOWN:return Ie.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return Ie.INTERNAL;case Jr.UNAVAILABLE:return Ie.UNAVAILABLE;case Jr.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case Jr.NOT_FOUND:return Ie.NOT_FOUND;case Jr.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case Jr.ABORTED:return Ie.ABORTED;case Jr.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case Jr.DATA_LOSS:return Ie.DATA_LOSS;default:return $e(39323,{code:r})}}(Lt=Jr||(Jr={}))[Lt.OK=0]="OK",Lt[Lt.CANCELLED=1]="CANCELLED",Lt[Lt.UNKNOWN=2]="UNKNOWN",Lt[Lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Lt[Lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Lt[Lt.NOT_FOUND=5]="NOT_FOUND",Lt[Lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Lt[Lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Lt[Lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Lt[Lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Lt[Lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Lt[Lt.ABORTED=10]="ABORTED",Lt[Lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Lt[Lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Lt[Lt.INTERNAL=13]="INTERNAL",Lt[Lt.UNAVAILABLE=14]="UNAVAILABLE",Lt[Lt.DATA_LOSS=15]="DATA_LOSS";function VK(){return new TextEncoder}const BK=new Wo([4294967295,4294967295],0);function pb(r){const e=VK().encode(r),t=new H4;return t.update(e),new Uint8Array(t.digest())}function gb(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Wo([t,n],0),new Wo([i,s],0)]}class My{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Oh(`Invalid padding: ${t}`);if(n<0)throw new Oh(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Oh(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Oh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Wo.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply(Wo.fromNumber(n)));return i.compare(BK)===1&&(i=new Wo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=pb(e),[n,i]=gb(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,i,s);if(!this.we(l))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new My(s,i,t);return n.forEach((c=>l.insert(c))),l}insert(e){if(this.ge===0)return;const t=pb(e),[n,i]=gb(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,i,s);this.Se(l)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Oh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class xg{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,J0.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new xg(rt.min(),i,new kr(mt),Oi(),wt())}}class J0{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new J0(n,t,wt(),wt(),wt())}}class ep{constructor(e,t,n,i){this.be=e,this.removedTargetIds=t,this.key=n,this.De=i}}class qR{constructor(e,t){this.targetId=e,this.Ce=t}}class KR{constructor(e,t,n=nn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class _b{constructor(){this.ve=0,this.Fe=vb(),this.Me=nn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=wt(),t=wt(),n=wt();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:$e(38017,{changeType:s})}})),new J0(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=vb()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class UK{constructor(e){this.Ge=e,this.ze=new Map,this.je=Oi(),this.Je=Pm(),this.He=Pm(),this.Ye=new kr(mt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:$e(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,n=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(Op(s))if(n===0){const l=new We(s.path);this.et(t,l,br.newNoDocument(l,rt.min()))}else et(n===1,20013,{expectedCount:n});else{const l=this._t(t);if(l!==n){const c=this.ut(e),f=c?this.ct(c,e,l):1;if(f!==0){this.it(t);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let l,c;try{l=Hs(n).toUint8Array()}catch(f){if(f instanceof pR)return dc("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{c=new My(l,i,s)}catch(f){return dc(f instanceof Oh?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let i=0;return n.forEach((s=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,l)=>{const c=this.ot(l);if(c){if(s.current&&Op(c.target)){const f=new We(c.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,br.newNoDocument(f,e))}s.Be&&(t.set(l,s.ke()),s.qe())}}));let n=wt();this.He.forEach(((s,l)=>{let c=!0;l.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(s))})),this.je.forEach(((s,l)=>l.setReadTime(e)));const i=new xg(e,t,this.Ye,this.je,n);return this.je=Oi(),this.Je=Pm(),this.He=Pm(),this.Ye=new kr(mt),i}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new _b,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new sr(mt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new sr(mt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new _b),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Pm(){return new kr(We.comparator)}function vb(){return new kr(We.comparator)}const zK={asc:"ASCENDING",desc:"DESCENDING"},jK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HK={and:"AND",or:"OR"};class GK{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Wv(r,e){return r.useProto3Json||X0(e)?e:{value:e}}function lf(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function WR(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function qK(r,e){return lf(r,e.toTimestamp())}function yn(r){return et(!!r,49232),rt.fromTimestamp((function(t){const n=js(t);return new ir(n.seconds,n.nanos)})(r))}function Ly(r,e){return Xv(r,e).canonicalString()}function Xv(r,e){const t=(function(i){return new Gt(["projects",i.projectId,"databases",i.database])})(r).child("documents");return e===void 0?t:t.child(e)}function XR(r){const e=Gt.fromString(r);return et(nD(e),10190,{key:e.toString()}),e}function R0(r,e){return Ly(r.databaseId,e.path)}function Vs(r,e){const t=XR(e);if(t.get(1)!==r.databaseId.projectId)throw new Ke(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Ke(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new We(QR(t))}function YR(r,e){return Ly(r.databaseId,e)}function $R(r){const e=XR(r);return e.length===4?Gt.emptyPath():QR(e)}function Yv(r){return new Gt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function QR(r){return et(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function xb(r,e,t){return{name:R0(r,e),fields:t.value.mapValue.fields}}function KK(r,e,t){const n=Vs(r,e.name),i=yn(e.updateTime),s=e.createTime?yn(e.createTime):rt.min(),l=new Fn({mapValue:{fields:e.fields}}),c=br.newFoundDocument(n,i,s,l);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function WK(r,e){return"found"in e?(function(n,i){et(!!i.found,43571),i.found.name,i.found.updateTime;const s=Vs(n,i.found.name),l=yn(i.found.updateTime),c=i.found.createTime?yn(i.found.createTime):rt.min(),f=new Fn({mapValue:{fields:i.found.fields}});return br.newFoundDocument(s,l,c,f)})(r,e):"missing"in e?(function(n,i){et(!!i.missing,3894),et(!!i.readTime,22933);const s=Vs(n,i.missing),l=yn(i.readTime);return br.newNoDocument(s,l)})(r,e):$e(7234,{result:e})}function XK(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:$e(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,m){return d.useProto3Json?(et(m===void 0||typeof m=="string",58123),nn.fromBase64String(m||"")):(et(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),nn.fromUint8Array(m||new Uint8Array))})(r,e.targetChange.resumeToken),l=e.targetChange.cause,c=l&&(function(d){const m=d.code===void 0?Ie.UNKNOWN:GR(d.code);return new Ke(m,d.message||"")})(l);t=new KR(n,i,s,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Vs(r,n.document.name),s=yn(n.document.updateTime),l=n.document.createTime?yn(n.document.createTime):rt.min(),c=new Fn({mapValue:{fields:n.document.fields}}),f=br.newFoundDocument(i,s,l,c),d=n.targetIds||[],m=n.removedTargetIds||[];t=new ep(d,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Vs(r,n.document),s=n.readTime?yn(n.readTime):rt.min(),l=br.newNoDocument(i,s),c=n.removedTargetIds||[];t=new ep([],c,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Vs(r,n.document),s=n.removedTargetIds||[];t=new ep([],s,i,null)}else{if(!("filter"in e))return $e(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,l=new LK(i,s),c=n.targetId;t=new qR(c,l)}}return t}function D0(r,e){let t;if(e instanceof vf)t={update:xb(r,e.key,e.value)};else if(e instanceof xf)t={delete:R0(r,e.key)};else if(e instanceof Xs)t={update:xb(r,e.key,e.data),updateMask:eW(e.fieldMask)};else{if(!(e instanceof Ny))return $e(16599,{Vt:e.type});t={verify:R0(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(s,l){const c=l.transform;if(c instanceof k0)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof sf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof of)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof C0)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw $e(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:qK(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$e(27497)})(r,e.precondition)),t}function $v(r,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Rr.updateTime(yn(s.updateTime)):s.exists!==void 0?Rr.exists(s.exists):Rr.none()})(e.currentDocument):Rr.none(),n=e.updateTransforms?e.updateTransforms.map((i=>(function(l,c){let f=null;if("setToServerValue"in c)et(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),f=new k0;else if("appendMissingElements"in c){const m=c.appendMissingElements.values||[];f=new sf(m)}else if("removeAllFromArray"in c){const m=c.removeAllFromArray.values||[];f=new of(m)}else"increment"in c?f=new C0(l,c.increment):$e(16584,{proto:c});const d=Cr.fromServerFormat(c.fieldPath);return new NK(d,f)})(r,i))):[];if(e.update){e.update.name;const i=Vs(r,e.update.name),s=new Fn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const d=f.fieldPaths||[];return new mi(d.map((m=>Cr.fromServerFormat(m))))})(e.updateMask);return new Xs(i,s,l,t,n)}return new vf(i,s,t,n)}if(e.delete){const i=Vs(r,e.delete);return new xf(i,t)}if(e.verify){const i=Vs(r,e.verify);return new Ny(i,t)}return $e(1463,{proto:e})}function YK(r,e){return r&&r.length>0?(et(e!==void 0,14353),r.map((t=>(function(i,s){let l=i.updateTime?yn(i.updateTime):yn(s);return l.isEqual(rt.min())&&(l=yn(s)),new FK(l,i.transformResults||[])})(t,e)))):[]}function JR(r,e){return{documents:[YR(r,e.path)]}}function ZR(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=YR(r,i);const s=(function(d){if(d.length!==0)return rD(hr.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const l=(function(d){if(d.length!==0)return d.map((m=>(function(x){return{field:Iu(x.field),direction:QK(x.dir)}})(m)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const c=Wv(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function eD(r){let e=$R(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){et(n===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=(function(_){const x=tD(_);return x instanceof hr&&Ry(x)?x.getFilters():[x]})(t.where));let l=[];t.orderBy&&(l=(function(_){return _.map((x=>(function(T){return new Np(ku(T.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(x)))})(t.orderBy));let c=null;t.limit&&(c=(function(_){let x;return x=typeof _=="object"?_.value:_,X0(x)?null:x})(t.limit));let f=null;t.startAt&&(f=(function(_){const x=!!_.before,y=_.values||[];return new nf(y,x)})(t.startAt));let d=null;return t.endAt&&(d=(function(_){const x=!_.before,y=_.values||[];return new nf(y,x)})(t.endAt)),xK(e,i,l,s,c,"F",f,d)}function $K(r,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $e(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function tD(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ku(t.unaryFilter.field);return Pt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ku(t.unaryFilter.field);return Pt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ku(t.unaryFilter.field);return Pt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=ku(t.unaryFilter.field);return Pt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $e(61313);default:return $e(60726)}})(r):r.fieldFilter!==void 0?(function(t){return Pt.create(ku(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $e(58110);default:return $e(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return hr.create(t.compositeFilter.filters.map((n=>tD(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $e(1026)}})(t.compositeFilter.op))})(r):$e(30097,{filter:r})}function QK(r){return zK[r]}function JK(r){return jK[r]}function ZK(r){return HK[r]}function Iu(r){return{fieldPath:r.canonicalString()}}function ku(r){return Cr.fromServerFormat(r.fieldPath)}function rD(r){return r instanceof Pt?(function(t){if(t.op==="=="){if(nb(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NAN"}};if(rb(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nb(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NOT_NAN"}};if(rb(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Iu(t.field),op:JK(t.op),value:t.value}}})(r):r instanceof hr?(function(t){const n=t.getFilters().map((i=>rD(i)));return n.length===1?n[0]:{compositeFilter:{op:ZK(t.op),filters:n}}})(r):$e(54877,{filter:r})}function eW(r){const e=[];return r.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function nD(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}class Ps{constructor(e,t,n,i,s=rt.min(),l=rt.min(),c=nn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=f}withSequenceNumber(e){return new Ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class iD{constructor(e){this.yt=e}}function tW(r,e){let t;if(e.document)t=KK(r.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=We.fromSegments(e.noDocument.path),i=_c(e.noDocument.readTime);t=br.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $e(56709);{const n=We.fromSegments(e.unknownDocument.path),i=_c(e.unknownDocument.version);t=br.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime((function(i){const s=new ir(i[0],i[1]);return rt.fromTimestamp(s)})(e.readTime)),t}function yb(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(s,l){return{name:R0(s,l.key),fields:l.data.value.mapValue.fields,updateTime:lf(s,l.version.toTimestamp()),createTime:lf(s,l.createTime.toTimestamp())}})(r.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:gc(e.version)};else{if(!e.isUnknownDocument())return $e(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:gc(e.version)}}return n}function Pp(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function gc(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _c(r){const e=new ir(r.seconds,r.nanoseconds);return rt.fromTimestamp(e)}function Hl(r,e){const t=(e.baseMutations||[]).map((s=>$v(r.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const l=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const c=e.mutations[s+1];l.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map((s=>$v(r.yt,s))),i=ir.fromMillis(e.localWriteTimeMs);return new Oy(e.batchId,i,t,n)}function Fh(r){const e=_c(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?_c(r.lastLimboFreeSnapshotVersion):rt.min();let n;return n=(function(s){return s.documents!==void 0})(r.query)?(function(s){const l=s.documents.length;return et(l===1,1966,{count:l}),ca(pg($R(s.documents[0])))})(r.query):(function(s){return ca(eD(s))})(r.query),new Ps(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,nn.fromBase64String(r.resumeToken))}function aD(r,e){const t=gc(e.snapshotVersion),n=gc(e.lastLimboFreeSnapshotVersion);let i;i=Op(e.target)?JR(r.yt,e.target):ZR(r.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function sD(r){const e=eD({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Kv(e,e.limit,"L"):e}function av(r,e){return new Py(e.largestBatchId,$v(r.yt,e.overlayMutation))}function Eb(r,e){const t=e.path.lastSegment();return[r,Xn(e.path.popLast()),t]}function Tb(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:gc(n.readTime),documentKey:Xn(n.documentKey.path),largestBatchId:n.largestBatchId}}class rW{getBundleMetadata(e,t){return wb(e).get(t).next((n=>{if(n)return(function(s){return{id:s.bundleId,createTime:_c(s.createTime),version:s.version}})(n)}))}saveBundleMetadata(e,t){return wb(e).put((function(i){return{bundleId:i.id,createTime:gc(yn(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return Sb(e).get(t).next((n=>{if(n)return(function(s){return{name:s.name,query:sD(s.bundledQuery),readTime:_c(s.readTime)}})(n)}))}saveNamedQuery(e,t){return Sb(e).put((function(i){return{name:i.name,readTime:gc(yn(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function wb(r){return fn(r,cg)}function Sb(r){return fn(r,ug)}class yg{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new yg(e,n)}getOverlay(e,t){return xh(e).get(Eb(this.userId,t)).next((n=>n?av(this.serializer,n):null))}getOverlays(e,t){const n=Qa();return ce.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&n.set(i,s)})))).next((()=>n))}saveOverlays(e,t,n){const i=[];return n.forEach(((s,l)=>{const c=new Py(t,l);i.push(this.St(e,c))})),ce.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach((l=>i.add(Xn(l.getCollectionPath()))));const s=[];return i.forEach((l=>{const c=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,n+1],!1,!0);s.push(xh(e).Z(Bv,c))})),ce.waitFor(s)}getOverlaysForCollection(e,t,n){const i=Qa(),s=Xn(t),l=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return xh(e).J(Bv,l).next((c=>{for(const f of c){const d=av(this.serializer,f);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,n,i){const s=Qa();let l;const c=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xh(e).ee({index:cR,range:c},((f,d,m)=>{const _=av(this.serializer,d);s.size()<i||_.largestBatchId===l?(s.set(_.getKey(),_),l=_.largestBatchId):m.done()})).next((()=>s))}St(e,t){return xh(e).put((function(i,s,l){const[c,f,d]=Eb(s,l.mutation.key);return{userId:s,collectionPath:f,documentId:d,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:D0(i.yt,l.mutation)}})(this.serializer,this.userId,t))}}function xh(r){return fn(r,fg)}class nW{bt(e){return fn(e,Sy)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const n=t?.value;return n?nn.fromUint8Array(n):nn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Gl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ar(e.integerValue));else if("doubleValue"in e){const n=Ar(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),E0(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=js(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Hs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?ER(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):dg(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):$e(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const i of Object.keys(n))this.Ot(i,t),this.Ct(n[i],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const i=tf,s=n[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ar(s)),this.Ot(i,t),this.Ct(n[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const i of n)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),We.fromName(e).path.forEach((n=>{this.Ft(t,60),this.Ut(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Gl.Kt=new Gl;const yu=255;function iW(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function Ab(r){const e=64-(function(n){let i=0;for(let s=0;s<8;++s){const l=iW(255&n[s]);if(i+=l,l!==8)break}return i})(r);return Math.ceil(e/8)}class aW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),n=Ab(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),n=Ab(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(yu),this.sn(255)}_n(){this.an(yu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,s,!1),new Uint8Array(l.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===yu?(this.sn(yu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===yu?(this.an(yu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class sW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class oW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class yh{constructor(){this.cn=new aW,this.ln=new sW(this.cn),this.hn=new oW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class ql{constructor(e,t,n,i){this.Tn=e,this.In=t,this.En=n,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new ql(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:tp(this.En),directionalValue:tp(this.dn),orderedDocumentKey:tp(t),documentKey:n.path.toArray()}}Vn(e,t,n){const i=this.Rn(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ro(r,e){let t=r.Tn-e.Tn;return t!==0?t:(t=bb(r.En,e.En),t!==0?t:(t=bb(r.dn,e.dn),t!==0?t:We.comparator(r.In,e.In)))}function bb(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function tp(r){return OC()?(function(t){let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return n})(r):r}function Ib(r){return typeof r!="string"?r:(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(r)}class kb{constructor(e){this.mn=new sr(((t,n)=>Cr.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const n=t;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(et(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Mv(e);if(t!==void 0&&!this.wn(t))return!1;const n=Bl(e);let i=new Set,s=0,l=0;for(;s<n.length&&this.wn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const f=n[s];if(!this.Sn(c,f)||!this.bn(this.fn[l++],f))return!1}++s}for(;s<n.length;++s){const c=n[s];if(l>=this.fn.length||!this.bn(this.fn[l++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new sr(Cr.comparator);const t=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Wm(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Wm(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Wm(n.field,n.dir==="asc"?0:1)));return new Ip(Ip.UNKNOWN_ID,this.collectionId,t,y0.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function oD(r){if(et(r instanceof Pt||r instanceof hr,20012),r instanceof Pt){if(r instanceof RR){const t=r.value.arrayValue?.values?.map((n=>Pt.create(r.field,"==",n)))||[];return hr.create(t,"or")}return r}const e=r.filters.map((t=>oD(t)));return hr.create(e,r.op)}function lW(r){if(r.getFilters().length===0)return[];const e=Zv(oD(r));return et(lD(e),7391),Qv(e)||Jv(e)?[e]:e.getFilters()}function Qv(r){return r instanceof Pt}function Jv(r){return r instanceof hr&&Ry(r)}function lD(r){return Qv(r)||Jv(r)||(function(t){if(t instanceof hr&&Hv(t)){for(const n of t.getFilters())if(!Qv(n)&&!Jv(n))return!1;return!0}return!1})(r)}function Zv(r){if(et(r instanceof Pt||r instanceof hr,34018),r instanceof Pt)return r;if(r.filters.length===1)return Zv(r.filters[0]);const e=r.filters.map((n=>Zv(n)));let t=hr.create(e,r.op);return t=Mp(t),lD(t)?t:(et(t instanceof hr,64498),et(af(t),40251),et(t.filters.length>1,57927),t.filters.reduce(((n,i)=>Vy(n,i))))}function Vy(r,e){let t;return et(r instanceof Pt||r instanceof hr,38388),et(e instanceof Pt||e instanceof hr,25473),t=r instanceof Pt?e instanceof Pt?(function(i,s){return hr.create([i,s],"and")})(r,e):Cb(r,e):e instanceof Pt?Cb(e,r):(function(i,s){if(et(i.filters.length>0&&s.filters.length>0,48005),af(i)&&af(s))return IR(i,s.getFilters());const l=Hv(i)?i:s,c=Hv(i)?s:i,f=l.filters.map((d=>Vy(d,c)));return hr.create(f,"or")})(r,e),Mp(t)}function Cb(r,e){if(af(e))return IR(e,r.getFilters());{const t=e.filters.map((n=>Vy(r,n)));return hr.create(t,"or")}}function Mp(r){if(et(r instanceof Pt||r instanceof hr,11850),r instanceof Pt)return r;const e=r.getFilters();if(e.length===1)return Mp(e[0]);if(AR(r))return r;const t=e.map((i=>Mp(i))),n=[];return t.forEach((i=>{i instanceof Pt?n.push(i):i instanceof hr&&(i.op===r.op?n.push(...i.filters):n.push(i))})),n.length===1?n[0]:hr.create(n,r.op)}class cW{constructor(){this.Cn=new By}addToCollectionParentIndex(e,t){return this.Cn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(Bi.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class By{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new sr(Gt.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new sr(Gt.comparator)).toArray()}}const Rb="IndexedDbIndexManager",Mm=new Uint8Array(0);class uW{constructor(e,t){this.databaseId=t,this.vn=new By,this.Fn=new Ws((n=>pc(n)),((n,i)=>$0(n,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:n,parent:Xn(i)};return Db(e).put(s)}return ce.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[Q4(t),""],!1,!0);return Db(e).J(i).next((s=>{for(const l of s){if(l.collectionId!==t)break;n.push($a(l.parent))}return n}))}addFieldIndex(e,t){const n=Eh(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete i.indexId;const s=n.add(i);if(t.indexState){const l=Tu(e);return s.next((c=>{l.put(Tb(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const n=Eh(e),i=Tu(e),s=Eu(e);return n.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Eh(e),n=Eu(e),i=Tu(e);return t.Z().next((()=>n.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return ce.forEach(this.Mn(t),(n=>this.getIndexType(e,n).next((i=>{if(i===0||i===1){const s=new kb(n).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const n=Eu(e);let i=!0;const s=new Map;return ce.forEach(this.Mn(t),(l=>this.xn(e,l).next((c=>{i&&(i=!!c),s.set(l,c)})))).next((()=>{if(i){let l=wt();const c=[];return ce.forEach(s,((f,d)=>{Ve(Rb,`Using index ${(function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map((W=>`${W.fieldPath}:${W.kind}`)).join(",")}`})(f)} to execute ${pc(t)}`);const m=(function(k,W){const Z=Mv(W);if(Z===void 0)return null;for(const X of Fp(k,Z.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null})(d,f),_=(function(k,W){const Z=new Map;for(const X of Bl(W))for(const A of Fp(k,X.fieldPath))switch(A.op){case"==":case"in":Z.set(X.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return Z.set(X.fieldPath.canonicalString(),A.value),Array.from(Z.values())}return null})(d,f),x=(function(k,W){const Z=[];let X=!0;for(const A of Bl(W)){const R=A.kind===0?lb(k,A.fieldPath,k.startAt):cb(k,A.fieldPath,k.startAt);Z.push(R.value),X&&(X=R.inclusive)}return new nf(Z,X)})(d,f),y=(function(k,W){const Z=[];let X=!0;for(const A of Bl(W)){const R=A.kind===0?cb(k,A.fieldPath,k.endAt):lb(k,A.fieldPath,k.endAt);Z.push(R.value),X&&(X=R.inclusive)}return new nf(Z,X)})(d,f),T=this.On(f,d,x),E=this.On(f,d,y),S=this.Nn(f,d,_),D=this.Bn(f.indexId,m,T,x.inclusive,E,y.inclusive,S);return ce.forEach(D,(U=>n.Y(U,t.limit).next((k=>{k.forEach((W=>{const Z=We.fromSegments(W.documentKey);l.has(Z)||(l=l.add(Z),c.push(Z))}))}))))})).next((()=>c))}return ce.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=lW(hr.create(e.filters,"and")).map((n=>qv(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,n,i,s,l,c){const f=(t!=null?t.length:1)*Math.max(n.length,s.length),d=f/(t!=null?t.length:1),m=[];for(let _=0;_<f;++_){const x=t?this.Ln(t[_/d]):Mm,y=this.kn(e,x,n[_%d],i),T=this.qn(e,x,s[_%d],l),E=c.map((S=>this.kn(e,x,S,!0)));m.push(...this.createRange(y,T,E))}return m}kn(e,t,n,i){const s=new ql(e,We.empty(),t,n);return i?s:s.An()}qn(e,t,n,i){const s=new ql(e,We.empty(),t,n);return i?s.An():s}xn(e,t){const n=new kb(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let l=null;for(const c of s)n.yn(c)&&(!l||c.fields.length>l.fields.length)&&(l=c);return l}))}getIndexType(e,t){let n=2;const i=this.Mn(t);return ce.forEach(i,(s=>this.xn(e,s).next((l=>{l?n!==0&&l.fields.length<(function(f){let d=new sr(Cr.comparator),m=!1;for(const _ of f.filters)for(const x of _.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?m=!0:d=d.add(x.field));for(const _ of f.orderBy)_.field.isKeyField()||(d=d.add(_.field));return d.size+(m?1:0)})(s)&&(n=1):n=0})))).next((()=>(function(l){return l.limit!==null})(t)&&i.length>1&&n===2?1:n))}Qn(e,t){const n=new yh;for(const i of Bl(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const l=n.Pn(i.kind);Gl.Kt.Dt(s,l)}return n.un()}Ln(e){const t=new yh;return Gl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const n=new yh;return Gl.Kt.Dt(Cy(this.databaseId,t),n.Pn((function(s){const l=Bl(s);return l.length===0?0:l[l.length-1].kind})(e))),n.un()}Nn(e,t,n){if(n===null)return[];let i=[];i.push(new yh);let s=0;for(const l of Bl(e)){const c=n[s++];for(const f of i)if(this.Un(t,l.fieldPath)&&I0(c))i=this.Kn(i,l,c);else{const d=f.Pn(l.kind);Gl.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){const i=[...e],s=[];for(const l of n.arrayValue.values||[])for(const c of i){const f=new yh;f.seed(c.un()),Gl.Kt.Dt(l,f.Pn(t.kind)),s.push(f)}return s}Un(e,t){return!!e.filters.find((n=>n instanceof Pt&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=Eh(e),i=Tu(e);return(t?n.J(Vv,IDBKeyRange.bound(t,t)):n.J()).next((s=>{const l=[];return ce.forEach(s,(c=>i.get([c.indexId,this.uid]).next((f=>{l.push((function(m,_){const x=_?new y0(_.sequenceNumber,new Bi(_c(_.readTime),new We($a(_.documentKey)),_.largestBatchId)):y0.empty(),y=m.fields.map((([T,E])=>new Wm(Cr.fromServerFormat(T),E)));return new Ip(m.indexId,m.collectionGroup,y,x)})(c,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:mt(n.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const i=Eh(e),s=Tu(e);return this.Gn(e).next((l=>i.J(Vv,IDBKeyRange.bound(t,t)).next((c=>ce.forEach(c,(f=>s.put(Tb(f.indexId,this.uid,l,n))))))))}updateIndexEntries(e,t){const n=new Map;return ce.forEach(t,((i,s)=>{const l=n.get(i.collectionGroup);return(l?ce.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(n.set(i.collectionGroup,c),ce.forEach(c,(f=>this.zn(e,i,f).next((d=>{const m=this.jn(s,f);return d.isEqual(m)?ce.resolve():this.Jn(e,s,f,d,m)})))))))}))}Hn(e,t,n,i){return Eu(e).put(i.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,i){return Eu(e).delete(i.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){const i=Eu(e);let s=new sr(Ro);return i.ee({index:lR,range:IDBKeyRange.only([n.indexId,this.uid,tp(this.$n(n,t))])},((l,c)=>{s=s.add(new ql(n.indexId,t,Ib(c.arrayValue),Ib(c.directionalValue)))})).next((()=>s))}jn(e,t){let n=new sr(Ro);const i=this.Qn(t,e);if(i==null)return n;const s=Mv(t);if(s!=null){const l=e.data.field(s.fieldPath);if(I0(l))for(const c of l.arrayValue.values||[])n=n.add(new ql(t.indexId,e.key,this.Ln(c),i))}else n=n.add(new ql(t.indexId,e.key,Mm,i));return n}Jn(e,t,n,i,s){Ve(Rb,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,d,m,_,x){const y=f.getIterator(),T=d.getIterator();let E=xu(y),S=xu(T);for(;E||S;){let D=!1,U=!1;if(E&&S){const k=m(E,S);k<0?U=!0:k>0&&(D=!0)}else E!=null?U=!0:D=!0;D?(_(S),S=xu(T)):U?(x(E),E=xu(y)):(E=xu(y),S=xu(T))}})(i,s,Ro,(c=>{l.push(this.Hn(e,t,n,c))}),(c=>{l.push(this.Yn(e,t,n,c))})),ce.waitFor(l)}Gn(e){let t=1;return Tu(e).ee({index:oR,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((l,c)=>Ro(l,c))).filter(((l,c,f)=>!c||Ro(l,f[c-1])!==0));const i=[];i.push(e);for(const l of n){const c=Ro(l,e),f=Ro(l,t);if(c===0)i[0]=e.An();else if(c>0&&f<0)i.push(l),i.push(l.An());else if(f>0)break}i.push(t);const s=[];for(let l=0;l<i.length;l+=2){if(this.Zn(i[l],i[l+1]))return[];const c=i[l].Vn(this.uid,Mm,We.empty()),f=i[l+1].Vn(this.uid,Mm,We.empty());s.push(IDBKeyRange.bound(c,f))}return s}Zn(e,t){return Ro(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Nb)}getMinOffset(e,t){return ce.mapArray(this.Mn(t),(n=>this.xn(e,n).next((i=>i||$e(44426))))).next(Nb)}}function Db(r){return fn(r,S0)}function Eu(r){return fn(r,Qh)}function Eh(r){return fn(r,wy)}function Tu(r){return fn(r,$h)}function Nb(r){et(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;yy(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Bi(e.readTime,e.documentKey,t)}const Ob={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cD=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function uD(r,e,t){const n=r.store(Sa),i=r.store(Qu),s=[],l=IDBKeyRange.only(t.batchId);let c=0;const f=n.ee({range:l},((m,_,x)=>(c++,x.delete())));s.push(f.next((()=>{et(c===1,47070,{batchId:t.batchId})})));const d=[];for(const m of t.mutations){const _=iR(e,m.key.path,t.batchId);s.push(i.delete(_)),d.push(m.key)}return ce.waitFor(s).next((()=>d))}function Lp(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw $e(14731);e=r.noDocument}return JSON.stringify(e).length}jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(cD,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class Eg{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Xn={}}static wt(e,t,n,i){et(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Eg(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).ee({index:Wl,range:n},((i,s,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,n,i){const s=Cu(e),l=Do(e);return l.add({}).next((c=>{et(typeof c=="number",49019);const f=new Oy(c,t,n,i),d=(function(y,T,E){const S=E.baseMutations.map((U=>D0(y.yt,U))),D=E.mutations.map((U=>D0(y.yt,U)));return{userId:T,batchId:E.batchId,localWriteTimeMs:E.localWriteTime.toMillis(),baseMutations:S,mutations:D}})(this.serializer,this.userId,f),m=[];let _=new sr(((x,y)=>mt(x.canonicalString(),y.canonicalString())));for(const x of i){const y=iR(this.userId,x.key.path,c);_=_.add(x.key.path.popLast()),m.push(l.put(d)),m.push(s.put(y,Lq))}return _.forEach((x=>{m.push(this.indexManager.addToCollectionParentIndex(e,x))})),e.addOnCommittedListener((()=>{this.Xn[c]=f.keys()})),ce.waitFor(m).next((()=>f))}))}lookupMutationBatch(e,t){return Do(e).get(t).next((n=>n?(et(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Hl(this.serializer,n)):null))}er(e,t){return this.Xn[t]?ce.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const i=n.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Do(e).ee({index:Wl,range:i},((l,c,f)=>{c.userId===this.userId&&(et(c.batchId>=n,47524,{tr:n}),s=Hl(this.serializer,c)),f.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Zl;return Do(e).ee({index:Wl,range:t,reverse:!0},((i,s,l)=>{n=s.batchId,l.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Zl],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).J(Wl,t).next((n=>n.map((i=>Hl(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Xm(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return Cu(e).ee({range:i},((l,c,f)=>{const[d,m,_]=l,x=$a(m);if(d===this.userId&&t.path.isEqual(x))return Do(e).get(_).next((y=>{if(!y)throw $e(61480,{nr:l,batchId:_});et(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:_}),s.push(Hl(this.serializer,y))}));f.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new sr(mt);const i=[];return t.forEach((s=>{const l=Xm(this.userId,s.path),c=IDBKeyRange.lowerBound(l),f=Cu(e).ee({range:c},((d,m,_)=>{const[x,y,T]=d,E=$a(y);x===this.userId&&s.path.isEqual(E)?n=n.add(T):_.done()}));i.push(f)})),ce.waitFor(i).next((()=>this.rr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=Xm(this.userId,n),l=IDBKeyRange.lowerBound(s);let c=new sr(mt);return Cu(e).ee({range:l},((f,d,m)=>{const[_,x,y]=f,T=$a(x);_===this.userId&&n.isPrefixOf(T)?T.length===i&&(c=c.add(y)):m.done()})).next((()=>this.rr(e,c)))}rr(e,t){const n=[],i=[];return t.forEach((s=>{i.push(Do(e).get(s).next((l=>{if(l===null)throw $e(35274,{batchId:s});et(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:s}),n.push(Hl(this.serializer,l))})))})),ce.waitFor(i).next((()=>n))}removeMutationBatch(e,t){return uD(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ce.forEach(n,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ce.resolve();const n=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),i=[];return Cu(e).ee({range:n},((s,l,c)=>{if(s[0]===this.userId){const f=$a(s[1]);i.push(f)}else c.done()})).next((()=>{et(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return fD(e,this.userId,t)}_r(e){return hD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Zl,lastStreamToken:""}))}}function fD(r,e,t){const n=Xm(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let l=!1;return Cu(r).ee({range:s,X:!0},((c,f,d)=>{const[m,_,x]=c;m===e&&_===i&&(l=!0),d.done()})).next((()=>l))}function Do(r){return fn(r,Sa)}function Cu(r){return fn(r,Qu)}function hD(r){return fn(r,T0)}class vc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new vc(0)}static cr(){return new vc(-1)}}class fW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const n=new vc(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>rt.fromTimestamp(new ir(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>wu(e).delete(t.targetId))).next((()=>this.lr(e))).next((n=>(et(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n))))}removeTargets(e,t,n){let i=0;const s=[];return wu(e).ee(((l,c)=>{const f=Fh(c);f.sequenceNumber<=t&&n.get(f.targetId)===null&&(i++,s.push(this.removeTargetData(e,f)))})).next((()=>ce.waitFor(s))).next((()=>i))}forEachTarget(e,t){return wu(e).ee(((n,i)=>{const s=Fh(i);t(s)}))}lr(e){return Fb(e).get(Rp).next((t=>(et(t!==null,2888),t)))}hr(e,t){return Fb(e).put(Rp,t)}Pr(e,t){return wu(e).put(aD(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const n=pc(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return wu(e).ee({range:i,index:sR},((l,c,f)=>{const d=Fh(c);$0(t,d.target)&&(s=d,f.done())})).next((()=>s))}addMatchingKeys(e,t,n){const i=[],s=Lo(e);return t.forEach((l=>{const c=Xn(l.path);i.push(s.put({targetId:n,path:c})),i.push(this.referenceDelegate.addReference(e,n,l))})),ce.waitFor(i)}removeMatchingKeys(e,t,n){const i=Lo(e);return ce.forEach(t,(s=>{const l=Xn(s.path);return ce.waitFor([i.delete([n,l]),this.referenceDelegate.removeReference(e,n,s)])}))}removeMatchingKeysForTargetId(e,t){const n=Lo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Lo(e);let s=wt();return i.ee({range:n,X:!0},((l,c,f)=>{const d=$a(l[1]),m=new We(d);s=s.add(m)})).next((()=>s))}containsKey(e,t){const n=Xn(t.path),i=IDBKeyRange.bound([n],[Q4(n)],!1,!0);let s=0;return Lo(e).ee({index:Ty,X:!0,range:i},(([l,c],f,d)=>{l!==0&&(s++,d.done())})).next((()=>s>0))}At(e,t){return wu(e).get(t).next((n=>n?Fh(n):null))}}function wu(r){return fn(r,Ju)}function Fb(r){return fn(r,ec)}function Lo(r){return fn(r,Zu)}const Pb="LruGarbageCollector",hW=1048576;function Mb([r,e],[t,n]){const i=mt(r,t);return i===0?mt(e,n):i}class dW{constructor(e){this.Ir=e,this.buffer=new sr(Mb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Mb(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dD{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ve(Pb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ul(t)?Ve(Pb,"Ignoring IndexedDB error during garbage collection: ",t):await Cc(t)}await this.Vr(3e5)}))}}class mW{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(sa.ce);const n=new dW(t);return this.mr.forEachTarget(e,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ve("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(Ob)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ob):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,i,s,l,c,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(Ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,l=Date.now(),this.nthSequenceNumber(e,i)))).next((_=>(n=_,c=Date.now(),this.removeTargets(e,n,t)))).next((_=>(s=_,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((_=>(d=Date.now(),Au()<=Dt.DEBUG&&Ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${i} in `+(c-l)+`ms
	Removed ${s} targets in `+(f-c)+`ms
	Removed ${_} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:_}))))}}function mD(r,e){return new mW(r,e)}class pW{constructor(e,t){this.db=e,this.garbageCollector=mD(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((n,i)=>t(i)))}addReference(e,t,n){return Lm(e,n)}removeReference(e,t,n){return Lm(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Lm(e,t)}br(e,t){return(function(i,s){let l=!1;return hD(i).te((c=>fD(i,c,s).next((f=>(f&&(l=!0),ce.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((l,c)=>{if(c<=t){const f=this.br(e,l).next((d=>{if(!d)return s++,n.getEntry(e,l).next((()=>(n.removeEntry(l,rt.min()),Lo(e).delete((function(_){return[0,Xn(_.path)]})(l)))))}));i.push(f)}})).next((()=>ce.waitFor(i))).next((()=>n.apply(e))).next((()=>s))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Lm(e,t)}Sr(e,t){const n=Lo(e);let i,s=sa.ce;return n.ee({index:Ty},(([l,c],{path:f,sequenceNumber:d})=>{l===0?(s!==sa.ce&&t(new We($a(i)),s),s=d,i=f):s=sa.ce})).next((()=>{s!==sa.ce&&t(new We($a(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Lm(r,e){return Lo(r).put((function(n,i){return{targetId:0,path:Xn(n.path),sequenceNumber:i}})(e,r.currentSequenceNumber))}class pD{constructor(){this.changes=new Ws((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,br.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class gW{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Ll(e).put(n)}removeEntry(e,t,n){return Ll(e).delete((function(s,l){const c=s.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Pp(l),c[c.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Dr(e,n))))}getEntry(e,t){let n=br.newInvalidDocument(t);return Ll(e).ee({index:Ym,range:IDBKeyRange.only(Th(t))},((i,s)=>{n=this.Cr(t,s)})).next((()=>n))}vr(e,t){let n={size:0,document:br.newInvalidDocument(t)};return Ll(e).ee({index:Ym,range:IDBKeyRange.only(Th(t))},((i,s)=>{n={document:this.Cr(t,s),size:Lp(s)}})).next((()=>n))}getEntries(e,t){let n=Oi();return this.Fr(e,t,((i,s)=>{const l=this.Cr(i,s);n=n.insert(i,l)})).next((()=>n))}Mr(e,t){let n=Oi(),i=new kr(We.comparator);return this.Fr(e,t,((s,l)=>{const c=this.Cr(s,l);n=n.insert(s,c),i=i.insert(s,Lp(l))})).next((()=>({documents:n,Or:i})))}Fr(e,t,n){if(t.isEmpty())return ce.resolve();let i=new sr(Bb);t.forEach((f=>i=i.add(f)));const s=IDBKeyRange.bound(Th(i.first()),Th(i.last())),l=i.getIterator();let c=l.getNext();return Ll(e).ee({index:Ym,range:s},((f,d,m)=>{const _=We.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&Bb(c,_)<0;)n(c,null),c=l.getNext();c&&c.isEqual(_)&&(n(c,d),c=l.hasNext()?l.getNext():null),c?m.j(Th(c)):m.done()})).next((()=>{for(;c;)n(c,null),c=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,n,i,s){const l=t.path,c=[l.popLast().toArray(),l.lastSegment(),Pp(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ll(e).J(IDBKeyRange.bound(c,f,!0)).next((d=>{s?.incrementDocumentReadCount(d.length);let m=Oi();for(const _ of d){const x=this.Cr(We.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);x.isFoundDocument()&&(Q0(t,x)||i.has(x.key))&&(m=m.insert(x.key,x))}return m}))}getAllFromCollectionGroup(e,t,n,i){let s=Oi();const l=Vb(t,n),c=Vb(t,Bi.max());return Ll(e).ee({index:aR,range:IDBKeyRange.bound(l,c,!0)},((f,d,m)=>{const _=this.Cr(We.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(_.key,_),s.size===i&&m.done()})).next((()=>s))}newChangeBuffer(e){return new _W(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Lb(e).get(Lv).next((t=>(et(!!t,20021),t)))}Dr(e,t){return Lb(e).put(Lv,t)}Cr(e,t){if(t){const n=tW(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(rt.min())))return n}return br.newInvalidDocument(e)}}function gD(r){return new gW(r)}class _W extends pD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ws((n=>n.toString()),((n,i)=>n.isEqual(i)))}applyChanges(e){const t=[];let n=0,i=new sr(((s,l)=>mt(s.canonicalString(),l.canonicalString())));return this.changes.forEach(((s,l)=>{const c=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,c.readTime)),l.isValidDocument()){const f=yb(this.Nr.serializer,l);i=i.add(s.path.popLast());const d=Lp(f);n+=d-c.size,t.push(this.Nr.addEntry(e,s,f))}else if(n-=c.size,this.trackRemovals){const f=yb(this.Nr.serializer,l.convertToNoDocument(rt.min()));t.push(this.Nr.addEntry(e,s,f))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,n)),ce.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((n=>(this.Br.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:n,Or:i})=>(i.forEach(((s,l)=>{this.Br.set(s,{size:l,readTime:n.get(s).readTime})})),n)))}}function Lb(r){return fn(r,w0)}function Ll(r){return fn(r,Cp)}function Th(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Vb(r,e){const t=e.documentKey.path.toArray();return[r,Pp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Bb(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=mt(t[s],n[s]),i)return i;return i=mt(t.length,n.length),i||(i=mt(t[t.length-2],n[n.length-2]),i||mt(t[t.length-1],n[n.length-1]))}class vW{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class _D{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(n!==null&&t0(n.mutation,i,mi.empty(),ir.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,wt()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=wt()){const i=Qa();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((s=>{let l=Nh();return s.forEach(((c,f)=>{l=l.insert(c,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const n=Qa();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,wt())))}populateOverlays(e,t,n){const i=[];return n.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((l,c)=>{t.set(l,c)}))}))}computeViews(e,t,n,i){let s=Oi();const l=e0(),c=(function(){return e0()})();return t.forEach(((f,d)=>{const m=n.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof Xs)?s=s.insert(d.key,d):m!==void 0?(l.set(d.key,m.mutation.getFieldMask()),t0(m.mutation,d,m.mutation.getFieldMask(),ir.now())):l.set(d.key,mi.empty())})),this.recalculateAndSaveOverlays(e,s).next((f=>(f.forEach(((d,m)=>l.set(d,m))),t.forEach(((d,m)=>c.set(d,new vW(m,l.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const n=e0();let i=new kr(((l,c)=>l-c)),s=wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const c of l)c.keys().forEach((f=>{const d=t.get(f);if(d===null)return;let m=n.get(f)||mi.empty();m=c.applyToLocalView(d,m),n.set(f,m);const _=(i.get(c.batchId)||wt()).add(f);i=i.insert(c.batchId,_)}))})).next((()=>{const l=[],c=i.getReverseIterator();for(;c.hasNext();){const f=c.getNext(),d=f.key,m=f.value,_=PR();m.forEach((x=>{if(!s.has(x)){const y=zR(t.get(x),n.get(x));y!==null&&_.set(x,y),s=s.add(x)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,_))}return ce.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,i){return(function(l){return We.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):yK(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((s=>{const l=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ce.resolve(Qa());let c=x0,f=s;return l.next((d=>ce.forEach(d,((m,_)=>(c<_.largestBatchId&&(c=_.largestBatchId),s.get(m)?ce.resolve():this.remoteDocumentCache.getEntry(e,m).next((x=>{f=f.insert(m,x)}))))).next((()=>this.populateOverlays(e,d,s))).next((()=>this.computeViews(e,f,d,wt()))).next((m=>({batchId:c,changes:FR(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new We(t)).next((n=>{let i=Nh();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let l=Nh();return this.indexManager.getCollectionParents(e,s).next((c=>ce.forEach(c,(f=>{const d=(function(_,x){return new mg(x,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next((m=>{m.forEach(((_,x)=>{l=l.insert(_,x)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i)))).next((l=>{s.forEach(((f,d)=>{const m=d.getKey();l.get(m)===null&&(l=l.insert(m,br.newInvalidDocument(m)))}));let c=Nh();return l.forEach(((f,d)=>{const m=s.get(f);m!==void 0&&t0(m.mutation,d,mi.empty(),ir.now()),Q0(t,d)&&(c=c.insert(f,d))})),c}))}}class xW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ce.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:yn(i.createTime)}})(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:sD(i.bundledQuery),readTime:yn(i.readTime)}})(t)),ce.resolve()}}class yW{constructor(){this.overlays=new kr(We.comparator),this.qr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Qa();return ce.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&n.set(i,s)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((i,s)=>{this.St(e,t,s)})),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=Qa(),s=t.length+1,l=new We(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const f=c.getNext().value,d=f.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&f.largestBatchId>n&&i.set(f.getKey(),f)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new kr(((d,m)=>d-m));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let m=s.get(d.largestBatchId);m===null&&(m=Qa(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const c=Qa(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,m)=>c.set(d,m))),!(c.size()>=i)););return ce.resolve(c)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new Py(t,n));let s=this.qr.get(t);s===void 0&&(s=wt(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class EW{constructor(){this.sessionToken=nn.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}class Uy{constructor(){this.Qr=new sr(gn.$r),this.Ur=new sr(gn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new gn(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new gn(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new We(new Gt([])),n=new gn(t,e),i=new gn(t,e+1),s=[];return this.Ur.forEachInRange([n,i],(l=>{this.Gr(l),s.push(l.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new We(new Gt([])),n=new gn(t,e),i=new gn(t,e+1);let s=wt();return this.Ur.forEachInRange([n,i],(l=>{s=s.add(l.key)})),s}containsKey(e){const t=new gn(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class gn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return We.comparator(e.key,t.key)||mt(e.Yr,t.Yr)}static Kr(e,t){return mt(e.Yr,t.Yr)||We.comparator(e.key,t.key)}}class TW{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new sr(gn.$r)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Oy(s,t,n,i);this.mutationQueue.push(l);for(const c of i)this.Zr=this.Zr.add(new gn(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ce.resolve(l)}lookupMutationBatch(e,t){return ce.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ei(n),s=i<0?0:i;return ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?Zl:this.tr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new gn(t,0),i=new gn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,i],(l=>{const c=this.Xr(l.Yr);s.push(c)})),ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new sr(mt);return t.forEach((i=>{const s=new gn(i,0),l=new gn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,l],(c=>{n=n.add(c.Yr)}))})),ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;We.isDocumentKey(s)||(s=s.child(""));const l=new gn(new We(s),0);let c=new sr(mt);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(c=c.add(f.Yr)),!0)}),l),ce.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((n=>{const i=this.Xr(n);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){et(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ce.forEach(t.mutations,(i=>{const s=new gn(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new gn(t,0),i=this.Zr.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class wW{constructor(e){this.ri=e,this.docs=(function(){return new kr(We.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():br.newInvalidDocument(t))}getEntries(e,t){let n=Oi();return t.forEach((i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():br.newInvalidDocument(i))})),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Oi();const l=t.path,c=new We(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(c);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||yy(eR(m),n)<=0||(i.has(m.key)||Q0(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return ce.resolve(s)}getAllFromCollectionGroup(e,t,n,i){$e(9500)}ii(e,t){return ce.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new SW(this)}getSize(e){return ce.resolve(this.size)}}class SW extends pD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)})),ce.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class AW{constructor(e){this.persistence=e,this.si=new Ws((t=>pc(t)),$0),this.lastRemoteSnapshotVersion=rt.min(),this.highestTargetId=0,this.oi=0,this._i=new Uy,this.targetCount=0,this.ai=vc.ur()}forEachTarget(e,t){return this.si.forEach(((n,i)=>t(i))),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ce.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new vc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Pr(t),ce.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.si.forEach(((l,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.si.delete(l),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),ce.waitFor(s).next((()=>i))}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((l=>{s.push(i.markPotentiallyOrphaned(e,l))})),ce.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this._i.containsKey(t))}}class zy{constructor(e,t){this.ui={},this.overlays={},this.ci=new sa(0),this.li=!1,this.li=!0,this.hi=new EW,this.referenceDelegate=e(this),this.Pi=new AW(this),this.indexManager=new cW,this.remoteDocumentCache=(function(i){return new wW(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new iD(t),this.Ii=new xW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new yW,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new TW(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Ve("MemoryPersistence","Starting transaction:",e);const i=new bW(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return ce.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class bW extends rR{constructor(e){super(),this.currentSequenceNumber=e}}class Tg{constructor(e){this.persistence=e,this.Ri=new Uy,this.Vi=null}static mi(e){return new Tg(e)}get fi(){if(this.Vi)return this.Vi;throw $e(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.fi,(n=>{const i=We.fromPath(n);return this.gi(e,i).next((s=>{s||t.removeEntry(i,rt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ce.or([()=>ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Vp{constructor(e,t){this.persistence=e,this.pi=new Ws((n=>Xn(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=mD(this,t)}static mi(e,t){return new Vp(e,t)}Ei(){}di(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return ce.forEach(this.pi,((n,i)=>this.br(e,n,i).next((s=>s?ce.resolve():t(i)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(l=>this.br(e,l,t).next((c=>{c||(n++,s.removeEntry(l,rt.min()))})))).next((()=>s.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ce.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Qm(e.data.value)),t}br(e,t,n){return ce.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return ce.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class IW{constructor(e){this.serializer=e}k(e,t,n,i){const s=new lg("createOrUpgrade",t);n<1&&i>=1&&((function(f){f.createObjectStore(Y0)})(e),(function(f){f.createObjectStore(T0,{keyPath:Mq}),f.createObjectStore(Sa,{keyPath:$A,autoIncrement:!0}).createIndex(Wl,QA,{unique:!0}),f.createObjectStore(Qu)})(e),Ub(e),(function(f){f.createObjectStore(Ul)})(e));let l=ce.resolve();return n<3&&i>=3&&(n!==0&&((function(f){f.deleteObjectStore(Zu),f.deleteObjectStore(Ju),f.deleteObjectStore(ec)})(e),Ub(e)),l=l.next((()=>(function(f){const d=f.store(ec),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:rt.min().toTimestamp(),targetCount:0};return d.put(Rp,m)})(s)))),n<4&&i>=4&&(n!==0&&(l=l.next((()=>(function(f,d){return d.store(Sa).J().next((_=>{f.deleteObjectStore(Sa),f.createObjectStore(Sa,{keyPath:$A,autoIncrement:!0}).createIndex(Wl,QA,{unique:!0});const x=d.store(Sa),y=_.map((T=>x.put(T)));return ce.waitFor(y)}))})(e,s)))),l=l.next((()=>{(function(f){f.createObjectStore(ef,{keyPath:qq})})(e)}))),n<5&&i>=5&&(l=l.next((()=>this.yi(s)))),n<6&&i>=6&&(l=l.next((()=>((function(f){f.createObjectStore(w0)})(e),this.wi(s))))),n<7&&i>=7&&(l=l.next((()=>this.Si(s)))),n<8&&i>=8&&(l=l.next((()=>this.bi(e,s)))),n<9&&i>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&i>=10&&(l=l.next((()=>this.Di(s)))),n<11&&i>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(cg,{keyPath:Kq})})(e),(function(f){f.createObjectStore(ug,{keyPath:Wq})})(e)}))),n<12&&i>=12&&(l=l.next((()=>{(function(f){const d=f.createObjectStore(fg,{keyPath:eK});d.createIndex(Bv,tK,{unique:!1}),d.createIndex(cR,rK,{unique:!1})})(e)}))),n<13&&i>=13&&(l=l.next((()=>(function(f){const d=f.createObjectStore(Cp,{keyPath:Vq});d.createIndex(Ym,Bq),d.createIndex(aR,Uq)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ul)))),n<14&&i>=14&&(l=l.next((()=>this.Fi(e,s)))),n<15&&i>=15&&(l=l.next((()=>(function(f){f.createObjectStore(wy,{keyPath:Xq,autoIncrement:!0}).createIndex(Vv,Yq,{unique:!1}),f.createObjectStore($h,{keyPath:$q}).createIndex(oR,Qq,{unique:!1}),f.createObjectStore(Qh,{keyPath:Jq}).createIndex(lR,Zq,{unique:!1})})(e)))),n<16&&i>=16&&(l=l.next((()=>{t.objectStore($h).clear()})).next((()=>{t.objectStore(Qh).clear()}))),n<17&&i>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(Sy,{keyPath:nK})})(e)}))),n<18&&i>=18&&OC()&&(l=l.next((()=>{t.objectStore($h).clear()})).next((()=>{t.objectStore(Qh).clear()}))),l}wi(e){let t=0;return e.store(Ul).ee(((n,i)=>{t+=Lp(i)})).next((()=>{const n={byteSize:t};return e.store(w0).put(Lv,n)}))}yi(e){const t=e.store(T0),n=e.store(Sa);return t.J().next((i=>ce.forEach(i,(s=>{const l=IDBKeyRange.bound([s.userId,Zl],[s.userId,s.lastAcknowledgedBatchId]);return n.J(Wl,l).next((c=>ce.forEach(c,(f=>{et(f.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const d=Hl(this.serializer,f);return uD(e,s.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(Zu),n=e.store(Ul);return e.store(ec).get(Rp).next((i=>{const s=[];return n.ee(((l,c)=>{const f=new Gt(l),d=(function(_){return[0,Xn(_)]})(f);s.push(t.get(d).next((m=>m?ce.resolve():(_=>t.put({targetId:0,path:Xn(_),sequenceNumber:i.highestListenSequenceNumber}))(f))))})).next((()=>ce.waitFor(s)))}))}bi(e,t){e.createObjectStore(S0,{keyPath:Gq});const n=t.store(S0),i=new By,s=l=>{if(i.add(l)){const c=l.lastSegment(),f=l.popLast();return n.put({collectionId:c,parent:Xn(f)})}};return t.store(Ul).ee({X:!0},((l,c)=>{const f=new Gt(l);return s(f.popLast())})).next((()=>t.store(Qu).ee({X:!0},(([l,c,f],d)=>{const m=$a(c);return s(m.popLast())}))))}Di(e){const t=e.store(Ju);return t.ee(((n,i)=>{const s=Fh(i),l=aD(this.serializer,s);return t.put(l)}))}Ci(e,t){const n=t.store(Ul),i=[];return n.ee(((s,l)=>{const c=t.store(Cp),f=(function(_){return _.document?new We(Gt.fromString(_.document.name).popFirst(5)):_.noDocument?We.fromSegments(_.noDocument.path):_.unknownDocument?We.fromSegments(_.unknownDocument.path):$e(36783)})(l).path.toArray(),d={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(c.put(d))})).next((()=>ce.waitFor(i)))}Fi(e,t){const n=t.store(Sa),i=gD(this.serializer),s=new zy(Tg.mi,this.serializer.yt);return n.J().next((l=>{const c=new Map;return l.forEach((f=>{let d=c.get(f.userId)??wt();Hl(this.serializer,f).keys().forEach((m=>d=d.add(m))),c.set(f.userId,d)})),ce.forEach(c,((f,d)=>{const m=new Rn(d),_=yg.wt(this.serializer,m),x=s.getIndexManager(m),y=Eg.wt(m,this.serializer,x,s.referenceDelegate);return new _D(i,y,_,x).recalculateAndSaveOverlaysForDocumentKeys(new Uv(t,sa.ce),f).next()}))}))}}function Ub(r){r.createObjectStore(Zu,{keyPath:jq}).createIndex(Ty,Hq,{unique:!0}),r.createObjectStore(Ju,{keyPath:"targetId"}).createIndex(sR,zq,{unique:!0}),r.createObjectStore(ec)}const No="IndexedDbPersistence",sv=18e5,ov=5e3,lv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",kW="main";class jy{constructor(e,t,n,i,s,l,c,f,d,m,_=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=s,this.window=l,this.document=c,this.xi=d,this.Oi=m,this.Ni=_,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=x=>Promise.resolve(),!jy.v())throw new Ke(Ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new pW(this,i),this.$i=t+kW,this.serializer=new iD(f),this.Ui=new Xo(this.$i,this.Ni,new IW(this.serializer)),this.hi=new nW,this.Pi=new fW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=gD(this.serializer),this.Ii=new rW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,m===!1&&ni(No,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ke(Ie.FAILED_PRECONDITION,lv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new sa(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Vm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(ul(e))return Ve(No,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ve(No,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return wh(e).get(vu).next((t=>ce.resolve(this.es(t))))}ts(e){return Vm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,sv)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=fn(t,ef);return n.J().next((i=>{const s=this.ss(i,sv),l=i.filter((c=>s.indexOf(c)===-1));return ce.forEach(l,(c=>n.delete(c.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ce.resolve(!0):wh(e).get(vu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,ov)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ke(Ie.FAILED_PRECONDITION,lv);return!1}}return!(!this.networkEnabled||!this.inForeground)||Vm(e).J().next((n=>this.ss(n,ov).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(s||l&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ve(No,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Y0,ef],(e=>{const t=new Uv(e,sa.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((n=>this.rs(n.updateTimeMs,t)&&!this.us(n.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Vm(e).J().next((t=>this.ss(t,sv).map((n=>n.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Eg.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new uW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return yg.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){Ve(No,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(f){return f===18?sK:f===17?dR:f===16?aK:f===15?Ay:f===14?hR:f===13?fR:f===12?iK:f===11?uR:void $e(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,i,s,(c=>(l=new Uv(c,this.ci?this.ci.next():sa.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw ni(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ke(Ie.FAILED_PRECONDITION,tR);return n(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>n(l)))))).then((c=>(l.raiseOnCommittedEvent(),c)))}Is(e){return wh(e).get(vu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,ov)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ke(Ie.FAILED_PRECONDITION,lv)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return wh(e).put(vu,t)}static v(){return Xo.v()}Zi(e){const t=wh(e);return t.get(vu).next((n=>this.es(n)?(Ve(No,"Releasing primary lease."),t.delete(vu)):ce.resolve()))}rs(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(ni(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;NC()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ve(No,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ni(No,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ni("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function wh(r){return fn(r,Y0)}function Vm(r){return fn(r,ef)}function CW(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}class Hy{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=i}static As(e,t){let n=wt(),i=wt();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Hy(e,t.fromCache,n,i)}}class RW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class vD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return NC()?8:nR(un())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ys(e,t).next((l=>{s.result=l})).next((()=>{if(!s.result)return this.ws(e,t,i,n).next((l=>{s.result=l}))})).next((()=>{if(s.result)return;const l=new RW;return this.Ss(e,t,l).next((c=>{if(s.result=c,this.Vs)return this.bs(e,t,l,c.size)}))})).next((()=>s.result))}bs(e,t,n,i){return n.documentReadCount<this.fs?(Au()<=Dt.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",bu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ce.resolve()):(Au()<=Dt.DEBUG&&Ve("QueryEngine","Query:",bu(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Au()<=Dt.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",bu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ca(t))):ce.resolve())}ys(e,t){if(ub(t))return ce.resolve(null);let n=ca(t);return this.indexManager.getIndexType(e,n).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Kv(t,null,"F"),n=ca(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((s=>{const l=wt(...s);return this.ps.getDocuments(e,l).next((c=>this.indexManager.getMinOffset(e,n).next((f=>{const d=this.Ds(t,c);return this.Cs(t,d,l,f.readTime)?this.ys(e,Kv(t,null,"F")):this.vs(e,d,t,f)}))))})))))}ws(e,t,n,i){return ub(t)||i.isEqual(rt.min())?ce.resolve(null):this.ps.getDocuments(e,n).next((s=>{const l=this.Ds(t,s);return this.Cs(t,l,n,i)?ce.resolve(null):(Au()<=Dt.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bu(t)),this.vs(e,l,t,Cq(i,x0)).next((c=>c)))}))}Ds(e,t){let n=new sr(NR(e));return t.forEach(((i,s)=>{Q0(e,s)&&(n=n.add(s))})),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,n){return Au()<=Dt.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",bu(t)),this.ps.getDocumentsMatchingQuery(e,t,Bi.min(),n)}vs(e,t,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next((s=>(t.forEach((l=>{s=s.insert(l.key,l)})),s)))}}const Gy="LocalStore",DW=3e8;class NW{constructor(e,t,n,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new kr(mt),this.xs=new Ws((s=>pc(s)),$0),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _D(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function xD(r,e,t,n){return new NW(r,e,t,n)}async function yD(r,e){const t=ht(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((s=>{const l=[],c=[];let f=wt();for(const d of i){l.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of s){c.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return t.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:c})))}))}))}function OW(r,e){const t=ht(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,f,d,m){const _=d.batch,x=_.keys();let y=ce.resolve();return x.forEach((T=>{y=y.next((()=>m.getEntry(f,T))).next((E=>{const S=d.docVersions.get(T);et(S!==null,48541),E.version.compareTo(S)<0&&(_.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),m.addEntry(E)))}))})),y.next((()=>c.mutationQueue.removeMutationBatch(f,_)))})(t,n,e,s).next((()=>s.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let f=wt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(f=f.add(c.batch.mutations[d].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(n,i)))}))}function ED(r){const e=ht(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function FW(r,e){const t=ht(r),n=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((m,_)=>{const x=i.get(_);if(!x)return;c.push(t.Pi.removeMatchingKeys(s,m.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(s,m.addedDocuments,_))));let y=x.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(_)!==null?y=y.withResumeToken(nn.EMPTY_BYTE_STRING,rt.min()).withLastLimboFreeSnapshotVersion(rt.min()):m.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(m.resumeToken,n)),i=i.insert(_,y),(function(E,S,D){return E.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=DW?!0:D.addedDocuments.size+D.modifiedDocuments.size+D.removedDocuments.size>0})(x,y,m)&&c.push(t.Pi.updateTargetData(s,y))}));let f=Oi(),d=wt();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))})),c.push(PW(s,l,e.documentUpdates).next((m=>{f=m.ks,d=m.qs}))),!n.isEqual(rt.min())){const m=t.Pi.getLastRemoteSnapshotVersion(s).next((_=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n)));c.push(m)}return ce.waitFor(c).next((()=>l.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,f,d))).next((()=>f))})).then((s=>(t.Ms=i,s)))}function PW(r,e,t){let n=wt(),i=wt();return t.forEach((s=>n=n.add(s))),e.getEntries(r,n).next((s=>{let l=Oi();return t.forEach(((c,f)=>{const d=s.get(c);f.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),f.isNoDocument()&&f.version.isEqual(rt.min())?(e.removeEntry(c,f.readTime),l=l.insert(c,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),l=l.insert(c,f)):Ve(Gy,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",f.version)})),{ks:l,qs:i}}))}function MW(r,e){const t=ht(r);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Zl),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function LW(r,e){const t=ht(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return t.Pi.getTargetData(n,e).next((s=>s?(i=s,ce.resolve(i)):t.Pi.allocateTargetId(n).next((l=>(i=new Ps(e,l,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=t.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function ex(r,e,t){const n=ht(r),i=n.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,(l=>n.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!ul(l))throw l;Ve(Gy,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function zb(r,e,t){const n=ht(r);let i=rt.min(),s=wt();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,d,m){const _=ht(f),x=_.xs.get(m);return x!==void 0?ce.resolve(_.Ms.get(x)):_.Pi.getTargetData(d,m)})(n,l,ca(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,c.targetId).next((f=>{s=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,t?i:rt.min(),t?s:wt()))).next((c=>(VW(n,TK(e),c),{documents:c,Qs:s})))))}function VW(r,e,t){let n=r.Os.get(e)||rt.min();t.forEach(((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)})),r.Os.set(e,n)}class jb{constructor(){this.activeTargetIds=kK()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class TD{constructor(){this.Mo=new jb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jb,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class BW{Oo(e){}shutdown(){}}const Hb="ConnectivityMonitor";class Gb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ve(Hb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ve(Hb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Bm=null;function tx(){return Bm===null?Bm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bm++,"0x"+Bm.toString(16)}const cv="RestConnection",UW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class zW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Dp?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,t,n,i,s){const l=tx(),c=this.zo(e,t.toUriEncodedString());Ve(cv,`Sending RPC '${e}' ${l}:`,c,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,i,s);const{host:d}=new URL(c),m=mf(d);return this.Jo(e,c,f,n,m).then((_=>(Ve(cv,`Received RPC '${e}' ${l}: `,_),_)),(_=>{throw dc(cv,`RPC '${e}' ${l} failed with error: `,_,"url: ",c,"request:",n),_}))}Ho(e,t,n,i,s,l){return this.Go(e,t,n,i,s)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+_f})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),n&&n.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const n=UW[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class jW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Un="WebChannelConnection";class HW extends zW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,s){const l=tx();return new Promise(((c,f)=>{const d=new G4;d.setWithCredentials(!0),d.listenOnce(q4.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Km.NO_ERROR:const _=d.getResponseJson();Ve(Un,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(_)),c(_);break;case Km.TIMEOUT:Ve(Un,`RPC '${e}' ${l} timed out`),f(new Ke(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case Km.HTTP_ERROR:const x=d.getStatus();if(Ve(Un,`RPC '${e}' ${l} failed with status:`,x,"response text:",d.getResponseText()),x>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const T=y?.error;if(T&&T.status&&T.message){const E=(function(D){const U=D.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(U)>=0?U:Ie.UNKNOWN})(T.status);f(new Ke(E,T.message))}else f(new Ke(Ie.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new Ke(Ie.UNAVAILABLE,"Connection failed."));break;default:$e(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ve(Un,`RPC '${e}' ${l} completed.`)}}));const m=JSON.stringify(i);Ve(Un,`RPC '${e}' ${l} sending request:`,i),d.send(t,"POST",m,n,15)}))}T_(e,t,n){const i=tx(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=X4(),c=W4(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,n),f.encodeInitMessageHeaders=!0;const m=s.join("");Ve(Un,`Creating RPC '${e}' stream ${i}: ${m}`,f);const _=l.createWebChannel(m,f);this.I_(_);let x=!1,y=!1;const T=new jW({Yo:S=>{y?Ve(Un,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(x||(Ve(Un,`Opening RPC '${e}' stream ${i} transport.`),_.open(),x=!0),Ve(Un,`RPC '${e}' stream ${i} sending:`,S),_.send(S))},Zo:()=>_.close()}),E=(S,D,U)=>{S.listen(D,(k=>{try{U(k)}catch(W){setTimeout((()=>{throw W}),0)}}))};return E(_,Dh.EventType.OPEN,(()=>{y||(Ve(Un,`RPC '${e}' stream ${i} transport opened.`),T.o_())})),E(_,Dh.EventType.CLOSE,(()=>{y||(y=!0,Ve(Un,`RPC '${e}' stream ${i} transport closed`),T.a_(),this.E_(_))})),E(_,Dh.EventType.ERROR,(S=>{y||(y=!0,dc(Un,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),T.a_(new Ke(Ie.UNAVAILABLE,"The operation could not be completed")))})),E(_,Dh.EventType.MESSAGE,(S=>{if(!y){const D=S.data[0];et(!!D,16349);const U=D,k=U?.error||U[0]?.error;if(k){Ve(Un,`RPC '${e}' stream ${i} received error:`,k);const W=k.status;let Z=(function(R){const C=Jr[R];if(C!==void 0)return GR(C)})(W),X=k.message;Z===void 0&&(Z=Ie.INTERNAL,X="Unknown error status: "+W+" with message "+k.message),y=!0,T.a_(new Ke(Z,X)),_.close()}else Ve(Un,`RPC '${e}' stream ${i} received:`,D),T.u_(D)}})),E(c,K4.STAT_EVENT,(S=>{S.stat===Fv.PROXY?Ve(Un,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Fv.NOPROXY&&Ve(Un,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function GW(){return typeof window<"u"?window:null}function rp(){return typeof document<"u"?document:null}function wg(r){return new GK(r,!0)}class qy{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&Ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const qb="PersistentStream";class wD{constructor(e,t,n,i,s,l,c,f){this.Mi=e,this.S_=n,this.b_=i,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new qy(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ie.RESOURCE_EXHAUSTED?(ni(t.toString()),ni("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===t&&this.G_(n,i)}),(n=>{e((()=>{const i=new Ke(Ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ve(qb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ve(qb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qW extends wD{constructor(e,t,n,i,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,l),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=XK(this.serializer,e),n=(function(s){if(!("targetChange"in s))return rt.min();const l=s.targetChange;return l.targetIds&&l.targetIds.length?rt.min():l.readTime?yn(l.readTime):rt.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Yv(this.serializer),t.addTarget=(function(s,l){let c;const f=l.target;if(c=Op(f)?{documents:JR(s,f)}:{query:ZR(s,f).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=WR(s,l.resumeToken);const d=Wv(s,l.expectedCount);d!==null&&(c.expectedCount=d)}else if(l.snapshotVersion.compareTo(rt.min())>0){c.readTime=lf(s,l.snapshotVersion.toTimestamp());const d=Wv(s,l.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const n=$K(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Yv(this.serializer),t.removeTarget=e,this.q_(t)}}class KW extends wD{constructor(e,t,n,i,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,l),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=YK(e.writeResults,e.commitTime),n=yn(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Yv(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>D0(this.serializer,n)))};this.q_(t)}}class WW{}class XW extends WW{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ke(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,l])=>this.connection.Go(e,Xv(t,n),i,s,l))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ke(Ie.UNKNOWN,s.toString())}))}Ho(e,t,n,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Ho(e,Xv(t,n),i,l,c,s))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ke(Ie.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class YW{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ni(t),this.aa=!1):Ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const xc="RemoteStore";class $W{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{Rc(this)&&(Ve(xc,"Restarting streams for network reachability change."),await(async function(f){const d=ht(f);d.Ea.add(4),await Z0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Sg(d)})(this))}))})),this.Ra=new YW(n,i)}}async function Sg(r){if(Rc(r))for(const e of r.da)await e(!0)}async function Z0(r){for(const e of r.da)await e(!1)}function SD(r,e){const t=ht(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Yy(t)?Xy(t):yf(t).O_()&&Wy(t,e))}function Ky(r,e){const t=ht(r),n=yf(t);t.Ia.delete(e),n.O_()&&AD(t,e),t.Ia.size===0&&(n.O_()?n.L_():Rc(t)&&t.Ra.set("Unknown"))}function Wy(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(rt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}yf(r).Y_(e)}function AD(r,e){r.Va.Ue(e),yf(r).Z_(e)}function Xy(r){r.Va=new UK({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),yf(r).start(),r.Ra.ua()}function Yy(r){return Rc(r)&&!yf(r).x_()&&r.Ia.size>0}function Rc(r){return ht(r).Ea.size===0}function bD(r){r.Va=void 0}async function QW(r){r.Ra.set("Online")}async function JW(r){r.Ia.forEach(((e,t)=>{Wy(r,e)}))}async function ZW(r,e){bD(r),Yy(r)?(r.Ra.ha(e),Xy(r)):r.Ra.set("Unknown")}async function eX(r,e,t){if(r.Ra.set("Online"),e instanceof KR&&e.state===2&&e.cause)try{await(async function(i,s){const l=s.cause;for(const c of s.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,l),i.Ia.delete(c),i.Va.removeTarget(c))})(r,e)}catch(n){Ve(xc,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Bp(r,n)}else if(e instanceof ep?r.Va.Ze(e):e instanceof qR?r.Va.st(e):r.Va.tt(e),!t.isEqual(rt.min()))try{const n=await ED(r.localStore);t.compareTo(n)>=0&&await(function(s,l){const c=s.Va.Tt(l);return c.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const m=s.Ia.get(d);m&&s.Ia.set(d,m.withResumeToken(f.resumeToken,l))}})),c.targetMismatches.forEach(((f,d)=>{const m=s.Ia.get(f);if(!m)return;s.Ia.set(f,m.withResumeToken(nn.EMPTY_BYTE_STRING,m.snapshotVersion)),AD(s,f);const _=new Ps(m.target,f,d,m.sequenceNumber);Wy(s,_)})),s.remoteSyncer.applyRemoteEvent(c)})(r,t)}catch(n){Ve(xc,"Failed to raise snapshot:",n),await Bp(r,n)}}async function Bp(r,e,t){if(!ul(e))throw e;r.Ea.add(1),await Z0(r),r.Ra.set("Offline"),t||(t=()=>ED(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{Ve(xc,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await Sg(r)}))}function ID(r,e){return e().catch((t=>Bp(r,t,e)))}async function ed(r){const e=ht(r),t=il(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Zl;for(;tX(e);)try{const i=await MW(e.localStore,n);if(i===null){e.Ta.length===0&&t.L_();break}n=i.batchId,rX(e,i)}catch(i){await Bp(e,i)}kD(e)&&CD(e)}function tX(r){return Rc(r)&&r.Ta.length<10}function rX(r,e){r.Ta.push(e);const t=il(r);t.O_()&&t.X_&&t.ea(e.mutations)}function kD(r){return Rc(r)&&!il(r).x_()&&r.Ta.length>0}function CD(r){il(r).start()}async function nX(r){il(r).ra()}async function iX(r){const e=il(r);for(const t of r.Ta)e.ea(t.mutations)}async function aX(r,e,t){const n=r.Ta.shift(),i=Fy.from(n,e,t);await ID(r,(()=>r.remoteSyncer.applySuccessfulWrite(i))),await ed(r)}async function sX(r,e){e&&il(r).X_&&await(async function(n,i){if((function(l){return HR(l)&&l!==Ie.ABORTED})(i.code)){const s=n.Ta.shift();il(n).B_(),await ID(n,(()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i))),await ed(n)}})(r,e),kD(r)&&CD(r)}async function Kb(r,e){const t=ht(r);t.asyncQueue.verifyOperationInProgress(),Ve(xc,"RemoteStore received new credentials");const n=Rc(t);t.Ea.add(3),await Z0(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Sg(t)}async function oX(r,e){const t=ht(r);e?(t.Ea.delete(2),await Sg(t)):e||(t.Ea.add(2),await Z0(t),t.Ra.set("Unknown"))}function yf(r){return r.ma||(r.ma=(function(t,n,i){const s=ht(t);return s.sa(),new qW(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(r.datastore,r.asyncQueue,{Xo:QW.bind(null,r),t_:JW.bind(null,r),r_:ZW.bind(null,r),H_:eX.bind(null,r)}),r.da.push((async e=>{e?(r.ma.B_(),Yy(r)?Xy(r):r.Ra.set("Unknown")):(await r.ma.stop(),bD(r))}))),r.ma}function il(r){return r.fa||(r.fa=(function(t,n,i){const s=ht(t);return s.sa(),new KW(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:nX.bind(null,r),r_:sX.bind(null,r),ta:iX.bind(null,r),na:aX.bind(null,r)}),r.da.push((async e=>{e?(r.fa.B_(),await ed(r)):(await r.fa.stop(),r.Ta.length>0&&(Ve(xc,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}class $y{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Za,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const l=Date.now()+n,c=new $y(e,t,l,i,s);return c.start(n),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ke(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qy(r,e){if(ni("AsyncQueue",`${e}: ${r}`),ul(r))return new Ke(Ie.UNAVAILABLE,`${e}: ${r}`);throw r}class Hu{static emptySet(e){return new Hu(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||We.comparator(t.key,n.key):(t,n)=>We.comparator(t.key,n.key),this.keyedMap=Nh(),this.sortedSet=new kr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Hu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Hu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Wb{constructor(){this.ga=new kr(We.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):$e(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class cf{constructor(e,t,n,i,s,l,c,f,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,t,n,i,s){const l=[];return t.forEach((c=>{l.push({type:0,doc:c})})),new cf(e,t,Hu.emptySet(t),l,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class lX{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class cX{constructor(){this.queries=Xb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=ht(t),s=i.queries;i.queries=Xb(),s.forEach(((l,c)=>{for(const f of c.Sa)f.onError(n)}))})(this,new Ke(Ie.ABORTED,"Firestore shutting down"))}}function Xb(){return new Ws((r=>DR(r)),gg)}async function RD(r,e){const t=ht(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(n=2):(s=new lX,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const c=Qy(l,`Initialization of query '${bu(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Jy(t)}async function DD(r,e){const t=ht(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const l=s.Sa.indexOf(e);l>=0&&(s.Sa.splice(l,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function uX(r,e){const t=ht(r);let n=!1;for(const i of e){const s=i.query,l=t.queries.get(s);if(l){for(const c of l.Sa)c.Fa(i)&&(n=!0);l.wa=i}}n&&Jy(t)}function fX(r,e,t){const n=ht(r),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);n.queries.delete(e)}function Jy(r){r.Ca.forEach((e=>{e.next()}))}var rx,Yb;(Yb=rx||(rx={})).Ma="default",Yb.Cache="cache";class ND{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new cf(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=cf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==rx.Cache}}class OD{constructor(e){this.key=e}}class FD{constructor(e){this.key=e}}class hX{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=wt(),this.mutatedKeys=wt(),this.eu=NR(e),this.tu=new Hu(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Wb,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,l=i,c=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((m,_)=>{const x=i.get(m),y=Q0(this.query,_)?_:null,T=!!x&&this.mutatedKeys.has(x.key),E=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let S=!1;x&&y?x.data.isEqual(y.data)?T!==E&&(n.track({type:3,doc:y}),S=!0):this.su(x,y)||(n.track({type:2,doc:y}),S=!0,(f&&this.eu(y,f)>0||d&&this.eu(y,d)<0)&&(c=!0)):!x&&y?(n.track({type:0,doc:y}),S=!0):x&&!y&&(n.track({type:1,doc:x}),S=!0,(f||d)&&(c=!0)),S&&(y?(l=l.add(y),s=E?s.add(m):s.delete(m)):(l=l.delete(m),s=s.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{tu:l,iu:n,Cs:c,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((m,_)=>(function(y,T){const E=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $e(20277,{Rt:S})}};return E(y)-E(T)})(m.type,_.type)||this.eu(m.doc,_.doc))),this.ou(n),i=i??!1;const c=t&&!i?this._u():[],f=this.Xa.size===0&&this.current&&!i?1:0,d=f!==this.Za;return this.Za=f,l.length!==0||d?{snapshot:new cf(this.query,e.tu,s,l,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Wb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=wt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new FD(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new OD(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=wt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return cf.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Zy="SyncEngine";class dX{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class mX{constructor(e){this.key=e,this.hu=!1}}class pX{constructor(e,t,n,i,s,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Ws((c=>DR(c)),gg),this.Iu=new Map,this.Eu=new Set,this.du=new kr(We.comparator),this.Au=new Map,this.Ru=new Uy,this.Vu={},this.mu=new Map,this.fu=vc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function gX(r,e,t=!0){const n=UD(r);let i;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await PD(n,e,t,!0),i}async function _X(r,e){const t=UD(r);await PD(t,e,!0,!1)}async function PD(r,e,t,n){const i=await LW(r.localStore,ca(e)),s=i.targetId,l=r.sharedClientState.addLocalQueryTarget(s,t);let c;return n&&(c=await vX(r,e,s,l==="current",i.resumeToken)),r.isPrimaryClient&&t&&SD(r.remoteStore,i),c}async function vX(r,e,t,n,i){r.pu=(_,x,y)=>(async function(E,S,D,U){let k=S.view.ru(D);k.Cs&&(k=await zb(E.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,k))));const W=U&&U.targetChanges.get(S.targetId),Z=U&&U.targetMismatches.get(S.targetId)!=null,X=S.view.applyChanges(k,E.isPrimaryClient,W,Z);return Qb(E,S.targetId,X.au),X.snapshot})(r,_,x,y);const s=await zb(r.localStore,e,!0),l=new hX(e,s.Qs),c=l.ru(s.documents),f=J0.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),d=l.applyChanges(c,r.isPrimaryClient,f);Qb(r,t,d.au);const m=new dX(e,t,l);return r.Tu.set(e,m),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),d.snapshot}async function xX(r,e,t){const n=ht(r),i=n.Tu.get(e),s=n.Iu.get(i.targetId);if(s.length>1)return n.Iu.set(i.targetId,s.filter((l=>!gg(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await ex(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Ky(n.remoteStore,i.targetId),nx(n,i.targetId)})).catch(Cc)):(nx(n,i.targetId),await ex(n.localStore,i.targetId,!0))}async function yX(r,e){const t=ht(r),n=t.Tu.get(e),i=t.Iu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Ky(t.remoteStore,n.targetId))}async function EX(r,e,t){const n=zD(r);try{const i=await(function(l,c){const f=ht(l),d=ir.now(),m=c.reduce(((y,T)=>y.add(T.key)),wt());let _,x;return f.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let T=Oi(),E=wt();return f.Ns.getEntries(y,m).next((S=>{T=S,T.forEach(((D,U)=>{U.isValidDocument()||(E=E.add(D))}))})).next((()=>f.localDocuments.getOverlayedDocuments(y,T))).next((S=>{_=S;const D=[];for(const U of c){const k=MK(U,_.get(U.key).overlayedDocument);k!=null&&D.push(new Xs(U.key,k,wR(k.value.mapValue),Rr.exists(!0)))}return f.mutationQueue.addMutationBatch(y,d,D,c)})).next((S=>{x=S;const D=S.applyToLocalDocumentSet(_,E);return f.documentOverlayCache.saveOverlays(y,S.batchId,D)}))})).then((()=>({batchId:x.batchId,changes:FR(_)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),(function(l,c,f){let d=l.Vu[l.currentUser.toKey()];d||(d=new kr(mt)),d=d.insert(c,f),l.Vu[l.currentUser.toKey()]=d})(n,i.batchId,t),await td(n,i.changes),await ed(n.remoteStore)}catch(i){const s=Qy(i,"Failed to persist write");t.reject(s)}}async function MD(r,e){const t=ht(r);try{const n=await FW(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const l=t.Au.get(s);l&&(et(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?et(l.hu,14607):i.removedDocuments.size>0&&(et(l.hu,42227),l.hu=!1))})),await td(t,n,e)}catch(n){await Cc(n)}}function $b(r,e,t){const n=ht(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Tu.forEach(((s,l)=>{const c=l.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(l,c){const f=ht(l);f.onlineState=c;let d=!1;f.queries.forEach(((m,_)=>{for(const x of _.Sa)x.va(c)&&(d=!0)})),d&&Jy(f)})(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function TX(r,e,t){const n=ht(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Au.get(e),s=i&&i.key;if(s){let l=new kr(We.comparator);l=l.insert(s,br.newNoDocument(s,rt.min()));const c=wt().add(s),f=new xg(rt.min(),new Map,new kr(mt),l,c);await MD(n,f),n.du=n.du.remove(s),n.Au.delete(e),eE(n)}else await ex(n.localStore,e,!1).then((()=>nx(n,e,t))).catch(Cc)}async function wX(r,e){const t=ht(r),n=e.batch.batchId;try{const i=await OW(t.localStore,e);VD(t,n,null),LD(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await td(t,i)}catch(i){await Cc(i)}}async function SX(r,e,t){const n=ht(r);try{const i=await(function(l,c){const f=ht(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return f.mutationQueue.lookupMutationBatch(d,c).next((_=>(et(_!==null,37113),m=_.keys(),f.mutationQueue.removeMutationBatch(d,_)))).next((()=>f.mutationQueue.performConsistencyCheck(d))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,c))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>f.localDocuments.getDocuments(d,m)))}))})(n.localStore,e);VD(n,e,t),LD(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await td(n,i)}catch(i){await Cc(i)}}function LD(r,e){(r.mu.get(e)||[]).forEach((t=>{t.resolve()})),r.mu.delete(e)}function VD(r,e,t){const n=ht(r);let i=n.Vu[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function nx(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach((n=>{r.Ru.containsKey(n)||BD(r,n)}))}function BD(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(Ky(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),eE(r))}function Qb(r,e,t){for(const n of t)n instanceof OD?(r.Ru.addReference(n.key,e),AX(r,n)):n instanceof FD?(Ve(Zy,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||BD(r,n.key)):$e(19791,{wu:n})}function AX(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(Ve(Zy,"New document in limbo: "+t),r.Eu.add(n),eE(r))}function eE(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new We(Gt.fromString(e)),n=r.fu.next();r.Au.set(n,new mX(t)),r.du=r.du.insert(t,n),SD(r.remoteStore,new Ps(ca(pg(t.path)),n,"TargetPurposeLimboResolution",sa.ce))}}async function td(r,e,t){const n=ht(r),i=[],s=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,f)=>{l.push(n.pu(f,e,t).then((d=>{if((d||t)&&n.isPrimaryClient){const m=d?!d.fromCache:t?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,m?"current":"not-current")}if(d){i.push(d);const m=Hy.As(f.targetId,d);s.push(m)}})))})),await Promise.all(l),n.Pu.H_(i),await(async function(f,d){const m=ht(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>ce.forEach(d,(x=>ce.forEach(x.Es,(y=>m.persistence.referenceDelegate.addReference(_,x.targetId,y))).next((()=>ce.forEach(x.ds,(y=>m.persistence.referenceDelegate.removeReference(_,x.targetId,y)))))))))}catch(_){if(!ul(_))throw _;Ve(Gy,"Failed to update sequence numbers: "+_)}for(const _ of d){const x=_.targetId;if(!_.fromCache){const y=m.Ms.get(x),T=y.snapshotVersion,E=y.withLastLimboFreeSnapshotVersion(T);m.Ms=m.Ms.insert(x,E)}}})(n.localStore,s))}async function bX(r,e){const t=ht(r);if(!t.currentUser.isEqual(e)){Ve(Zy,"User change. New user:",e.toKey());const n=await yD(t.localStore,e);t.currentUser=e,(function(s,l){s.mu.forEach((c=>{c.forEach((f=>{f.reject(new Ke(Ie.CANCELLED,l))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await td(t,n.Ls)}}function IX(r,e){const t=ht(r),n=t.Au.get(e);if(n&&n.hu)return wt().add(n.key);{let i=wt();const s=t.Iu.get(e);if(!s)return i;for(const l of s){const c=t.Tu.get(l);i=i.unionWith(c.view.nu)}return i}}function UD(r){const e=ht(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=MD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IX.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TX.bind(null,e),e.Pu.H_=uX.bind(null,e.eventManager),e.Pu.yu=fX.bind(null,e.eventManager),e}function zD(r){const e=ht(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wX.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SX.bind(null,e),e}class N0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wg(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return xD(this.persistence,new vD,e.initialUser,this.serializer)}Cu(e){return new zy(Tg.mi,this.serializer)}Du(e){return new TD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}N0.provider={build:()=>new N0};class kX extends N0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){et(this.persistence.referenceDelegate instanceof Vp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new dD(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new zy((n=>Vp.mi(n,t)),this.serializer)}}class CX extends N0{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await zD(this.xu.syncEngine),await ed(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return xD(this.persistence,new vD,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new dD(n,e.asyncQueue,t)}Mu(e,t){const n=new Oq(t,this.persistence);return new Nq(e.asyncQueue,n)}Cu(e){const t=CW(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new jy(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,GW(),rp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new TD}}class Up{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>$b(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=bX.bind(null,this.syncEngine),await oX(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new cX})()}createDatastore(e){const t=wg(e.databaseInfo.databaseId),n=(function(s){return new HW(s)})(e.databaseInfo);return(function(s,l,c,f){return new XW(s,l,c,f)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,i,s,l,c){return new $W(n,i,s,l,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>$b(this.syncEngine,t,0)),(function(){return Gb.v()?new Gb:new BW})())}createSyncEngine(e,t){return(function(i,s,l,c,f,d,m){const _=new pX(i,s,l,c,f,d);return m&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=ht(t);Ve(xc,"RemoteStore shutting down."),n.Ea.add(5),await Z0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Up.provider={build:()=>new Up};class jD{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ni("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class RX{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ke(Ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,s){const l=ht(i),c={documents:s.map((_=>R0(l.serializer,_)))},f=await l.Ho("BatchGetDocuments",l.serializer.databaseId,Gt.emptyPath(),c,s.length),d=new Map;f.forEach((_=>{const x=WK(l.serializer,_);d.set(x.key.toString(),x)}));const m=[];return s.forEach((_=>{const x=d.get(_.toString());et(!!x,55234,{key:_}),m.push(x)})),m})(this.datastore,e);return t.forEach((n=>this.recordVersion(n))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new xf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,n)=>{const i=We.fromPath(n);this.mutations.push(new Ny(i,this.precondition(i)))})),await(async function(n,i){const s=ht(n),l={writes:i.map((c=>D0(s.serializer,c)))};await s.Go("Commit",s.serializer.databaseId,Gt.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $e(50498,{Gu:e.constructor.name});t=rt.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Ke(Ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(rt.min())?Rr.exists(!1):Rr.updateTime(t):Rr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(rt.min()))throw new Ke(Ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rr.updateTime(t)}return Rr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class DX{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this.zu=n.maxAttempts,this.M_=new qy(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new RX(this.datastore),t=this.Hu(e);t&&t.then((n=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(n)})).catch((i=>{this.Yu(i)}))))})).catch((n=>{this.Yu(n)}))}))}Hu(e){try{const t=this.updateFunction(e);return!X0(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!HR(t)}return!1}}const al="FirestoreClient";class NX{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Rn.UNAUTHENTICATED,this.clientId=vy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async l=>{Ve(al,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(Ve(al,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Za;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Qy(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function uv(r,e){r.asyncQueue.verifyOperationInProgress(),Ve(al,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await yD(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function Jb(r,e){r.asyncQueue.verifyOperationInProgress();const t=await OX(r);Ve(al,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>Kb(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>Kb(e.remoteStore,i))),r._onlineComponents=e}async function OX(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Ve(al,"Using user provided OfflineComponentProvider");try{await uv(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Ie.FAILED_PRECONDITION||i.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;dc("Error using user provided cache. Falling back to memory cache: "+t),await uv(r,new N0)}}else Ve(al,"Using default OfflineComponentProvider"),await uv(r,new kX(void 0));return r._offlineComponents}async function tE(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Ve(al,"Using user provided OnlineComponentProvider"),await Jb(r,r._uninitializedComponentsProvider._online)):(Ve(al,"Using default OnlineComponentProvider"),await Jb(r,new Up))),r._onlineComponents}function FX(r){return tE(r).then((e=>e.syncEngine))}function PX(r){return tE(r).then((e=>e.datastore))}async function ix(r){const e=await tE(r),t=e.eventManager;return t.onListen=gX.bind(null,e.syncEngine),t.onUnlisten=xX.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_X.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=yX.bind(null,e.syncEngine),t}function MX(r,e,t={}){const n=new Za;return r.asyncQueue.enqueueAndForget((async()=>(function(s,l,c,f,d){const m=new jD({next:x=>{m.Nu(),l.enqueueAndForget((()=>DD(s,_))),x.fromCache&&f.source==="server"?d.reject(new Ke(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(x)},error:x=>d.reject(x)}),_=new ND(c,m,{includeMetadataChanges:!0,qa:!0});return RD(s,_)})(await ix(r),r.asyncQueue,e,t,n))),n.promise}function HD(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}const Zb=new Map;const GD="firestore.googleapis.com",eI=!0;class tI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ke(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=GD,this.ssl=eI}else this.host=e.host,this.ssl=e.ssl??eI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=cD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<hW)throw new Ke(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kq("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HD(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ke(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ke(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ke(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ag{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ke(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ke(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new vq;switch(n.type){case"firstParty":return new Tq(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ke(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=Zb.get(t);n&&(Ve("ComponentProvider","Removing Datastore"),Zb.delete(t),n.terminate())})(this),Promise.resolve()}}function LX(r,e,t,n={}){r=gi(r,Ag);const i=mf(e),s=r._getSettings(),l={...s,emulatorOptions:r._getEmulatorOptions()},c=`${e}:${t}`;i&&(kC(`https://${c}`),CC("Firestore",!0)),s.host!==GD&&s.host!==c&&dc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...s,host:c,ssl:i,emulatorOptions:n};if(!tl(f,l)&&(r._setSettings(f),n.mockUserToken)){let d,m;if(typeof n.mockUserToken=="string")d=n.mockUserToken,m=Rn.MOCK_USER;else{d=eU(n.mockUserToken,r._app?.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new Ke(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Rn(_)}r._authCredentials=new xq(new $4(d,m))}}class rd{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new rd(this.firestore,e,this._query)}}class Hr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hr(this.firestore,e,this._key)}toJSON(){return{type:Hr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(W0(t,Hr._jsonSchema))return new Hr(e,n||null,new We(Gt.fromString(t.referencePath)))}}Hr._jsonSchemaVersion="firestore/documentReference/1.0",Hr._jsonSchema={type:rn("string",Hr._jsonSchemaVersion),referencePath:rn("string")};class Yo extends rd{constructor(e,t,n){super(e,t,pg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hr(this.firestore,null,new We(e))}withConverter(e){return new Yo(this.firestore,e,this._path)}}function fv(r,e,...t){if(r=Ir(r),J4("collection","path",e),r instanceof Ag){const n=Gt.fromString(e,...t);return qA(n),new Yo(r,null,n)}{if(!(r instanceof Hr||r instanceof Yo))throw new Ke(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Gt.fromString(e,...t));return qA(n),new Yo(r.firestore,null,n)}}function hv(r,e,...t){if(r=Ir(r),arguments.length===1&&(e=vy.newId()),J4("doc","path",e),r instanceof Ag){const n=Gt.fromString(e,...t);return GA(n),new Hr(r,null,new We(n))}{if(!(r instanceof Hr||r instanceof Yo))throw new Ke(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Gt.fromString(e,...t));return GA(n),new Hr(r.firestore,r instanceof Yo?r.converter:null,new We(n))}}const rI="AsyncQueue";class nI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new qy(this,"async_queue_retry"),this._c=()=>{const n=rp();n&&Ve(rI,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=rp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=rp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Za;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ul(e))throw e;Ve(rI,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ni("INTERNAL UNHANDLED ERROR: ",iI(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=$y.createAndSchedule(this,e,t,n,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&$e(47125,{Pc:iI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function iI(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}function aI(r){return(function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1})(r,["next","error","complete"])}class as extends Ag{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new nI,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new nI(e),this._firestoreClient=void 0,await e}}}function VX(r,e){const t=typeof r=="object"?r:ty(),n=typeof r=="string"?r:Dp,i=kc(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=J7("firestore");s&&LX(i,...s)}return i}function nd(r){if(r._terminated)throw new Ke(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||qD(r),r._firestoreClient}function qD(r){const e=r._freezeSettings(),t=(function(i,s,l,c){return new lK(i,s,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,HD(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(r._databaseId,r._app?.options.appId||"",r._persistenceKey,e);r._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new NX(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(r._componentsProvider))}function BX(r,e){dc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=r._freezeSettings();return UX(r,Up.provider,{build:n=>new CX(n,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function UX(r,e,t){if((r=gi(r,as))._firestoreClient||r._terminated)throw new Ke(Ie.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new Ke(Ie.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},qD(r)}class Ni{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ni(nn.fromBase64String(e))}catch(t){throw new Ke(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ni(nn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ni._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(W0(e,Ni._jsonSchema))return Ni.fromBase64String(e.bytes)}}Ni._jsonSchemaVersion="firestore/bytes/1.0",Ni._jsonSchema={type:rn("string",Ni._jsonSchemaVersion),bytes:rn("string")};class Ef{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ke(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class rE{constructor(e){this._methodName=e}}class es{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ke(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ke(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:es._jsonSchemaVersion}}static fromJSON(e){if(W0(e,es._jsonSchema))return new es(e.latitude,e.longitude)}}es._jsonSchemaVersion="firestore/geoPoint/1.0",es._jsonSchema={type:rn("string",es._jsonSchemaVersion),latitude:rn("number"),longitude:rn("number")};class ts{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ts._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(W0(e,ts._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ts(e.vectorValues);throw new Ke(Ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ts._jsonSchemaVersion="firestore/vectorValue/1.0",ts._jsonSchema={type:rn("string",ts._jsonSchemaVersion),vectorValues:rn("object")};const zX=/^__.*__$/;class jX{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Xs(e,this.data,this.fieldMask,t,this.fieldTransforms):new vf(e,this.data,t,this.fieldTransforms)}}class KD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Xs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function WD(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $e(40011,{Ac:r})}}class nE{constructor(e,t,n,i,s,l){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new nE({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return zp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(WD(this.Ac)&&zX.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class HX{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||wg(e)}Cc(e,t,n,i=!1){return new nE({Ac:e,methodName:t,Dc:n,path:Cr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bg(r){const e=r._freezeSettings(),t=wg(r._databaseId);return new HX(r._databaseId,!!e.ignoreUndefinedProperties,t)}function iE(r,e,t,n,i,s={}){const l=r.Cc(s.merge||s.mergeFields?2:0,e,t,i);oE("Data must be an object, but it was:",l,n);const c=XD(n,l);let f,d;if(s.merge)f=new mi(l.fieldMask),d=l.fieldTransforms;else if(s.mergeFields){const m=[];for(const _ of s.mergeFields){const x=ax(e,_,t);if(!l.contains(x))throw new Ke(Ie.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);$D(m,x)||m.push(x)}f=new mi(m),d=l.fieldTransforms.filter((_=>f.covers(_.field)))}else f=null,d=l.fieldTransforms;return new jX(new Fn(c),f,d)}class Ig extends rE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ig}}function aE(r,e,t,n){const i=r.Cc(1,e,t);oE("Data must be an object, but it was:",i,n);const s=[],l=Fn.empty();fl(n,((f,d)=>{const m=lE(e,f,t);d=Ir(d);const _=i.yc(m);if(d instanceof Ig)s.push(m);else{const x=kg(d,_);x!=null&&(s.push(m),l.set(m,x))}}));const c=new mi(s);return new KD(l,c,i.fieldTransforms)}function sE(r,e,t,n,i,s){const l=r.Cc(1,e,t),c=[ax(e,n,t)],f=[i];if(s.length%2!=0)throw new Ke(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<s.length;x+=2)c.push(ax(e,s[x])),f.push(s[x+1]);const d=[],m=Fn.empty();for(let x=c.length-1;x>=0;--x)if(!$D(d,c[x])){const y=c[x];let T=f[x];T=Ir(T);const E=l.yc(y);if(T instanceof Ig)d.push(y);else{const S=kg(T,E);S!=null&&(d.push(y),m.set(y,S))}}const _=new mi(d);return new KD(m,_,l.fieldTransforms)}function kg(r,e){if(YD(r=Ir(r)))return oE("Unsupported field value:",e,r),XD(r,e);if(r instanceof rE)return(function(n,i){if(!WD(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,i){const s=[];let l=0;for(const c of n){let f=kg(c,i.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),l++}return{arrayValue:{values:s}}})(r,e)}return(function(n,i){if((n=Ir(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return CK(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ir.fromDate(n);return{timestampValue:lf(i.serializer,s)}}if(n instanceof ir){const s=new ir(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:lf(i.serializer,s)}}if(n instanceof es)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ni)return{bytesValue:WR(i.serializer,n._byteString)};if(n instanceof Hr){const s=i.databaseId,l=n.firestore._databaseId;if(!l.isEqual(s))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ly(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ts)return(function(l,c){return{mapValue:{fields:{[Iy]:{stringValue:ky},[tf]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Dy(c.serializer,d)}))}}}}}})(n,i);throw i.Sc(`Unsupported field value: ${xy(n)}`)})(r,e)}function XD(r,e){const t={};return mR(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fl(r,((n,i)=>{const s=kg(i,e.mc(n));s!=null&&(t[n]=s)})),{mapValue:{fields:t}}}function YD(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof ir||r instanceof es||r instanceof Ni||r instanceof Hr||r instanceof rE||r instanceof ts)}function oE(r,e,t){if(!YD(t)||!Z4(t)){const n=xy(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function ax(r,e,t){if((e=Ir(e))instanceof Ef)return e._internalPath;if(typeof e=="string")return lE(r,e);throw zp("Field path arguments must be of type string or ",r,!1,void 0,t)}const GX=new RegExp("[~\\*/\\[\\]]");function lE(r,e,t){if(e.search(GX)>=0)throw zp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Ef(...e.split("."))._internalPath}catch{throw zp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function zp(r,e,t,n,i){const s=n&&!n.isEmpty(),l=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let f="";return(s||l)&&(f+=" (found",s&&(f+=` in field ${n}`),l&&(f+=` in document ${i}`),f+=")"),new Ke(Ie.INVALID_ARGUMENT,c+r+f)}function $D(r,e){return r.some((t=>t.isEqual(e)))}class jp{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Hr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(QD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class qX extends jp{data(){return super.data()}}function QD(r,e){return typeof e=="string"?lE(r,e):e instanceof Ef?e._internalPath:e._delegate._internalPath}function JD(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Ke(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ZD{convertValue(e,t="none"){switch(rl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ar(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $e(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return fl(e,((i,s)=>{n[i]=this.convertValue(s,t)})),n}convertVectorValue(e){const t=e.fields?.[tf].arrayValue?.values?.map((n=>Ar(n.doubleValue)));return new ts(t)}convertGeoPoint(e){return new es(Ar(e.latitude),Ar(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=hg(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(A0(e));default:return null}}convertTimestamp(e){const t=js(e);return new ir(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Gt.fromString(e);et(nD(n),9688,{name:e});const i=new mc(n.get(1),n.get(3)),s=new We(n.popFirst(5));return i.isEqual(t)||ni(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function cE(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class KX extends ZD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ni(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hr(this.firestore,null,t)}}class Fu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $o extends jp{constructor(e,t,n,i,s,l){super(e,t,n,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new np(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(QD("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ke(Ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=$o._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}$o._jsonSchemaVersion="firestore/documentSnapshot/1.0",$o._jsonSchema={type:rn("string",$o._jsonSchemaVersion),bundleSource:rn("string","DocumentSnapshot"),bundleName:rn("string"),bundle:rn("string")};class np extends $o{data(e={}){return super.data(e)}}class tc{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new np(this._firestore,this._userDataWriter,n.key,n,new Fu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ke(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((c=>{const f=new np(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Fu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>s||c.type!==3)).map((c=>{const f=new np(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Fu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return c.type!==0&&(d=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),m=l.indexOf(c.doc.key)),{type:WX(c.type),doc:f,oldIndex:d,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ke(Ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=vy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function WX(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $e(61501,{type:r})}}tc._jsonSchemaVersion="firestore/querySnapshot/1.0",tc._jsonSchema={type:rn("string",tc._jsonSchemaVersion),bundleSource:rn("string","QuerySnapshot"),bundleName:rn("string"),bundle:rn("string")};class Cg extends ZD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ni(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hr(this.firestore,null,t)}}function XX(r){r=gi(r,rd);const e=gi(r.firestore,as),t=nd(e),n=new Cg(e);return JD(r._query),MX(t,r._query).then((i=>new tc(e,n,r,i)))}function YX(r,e,t){r=gi(r,Hr);const n=gi(r.firestore,as),i=cE(r.converter,e,t);return Rg(n,[iE(bg(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,Rr.none())])}function $X(r,e,t,...n){r=gi(r,Hr);const i=gi(r.firestore,as),s=bg(i);let l;return l=typeof(e=Ir(e))=="string"||e instanceof Ef?sE(s,"updateDoc",r._key,e,t,n):aE(s,"updateDoc",r._key,e),Rg(i,[l.toMutation(r._key,Rr.exists(!0))])}function QX(r){return Rg(gi(r.firestore,as),[new xf(r._key,Rr.none())])}function JX(r,...e){r=Ir(r);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||aI(e[n])||(t=e[n++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(aI(e[n])){const f=e[n];e[n]=f.next?.bind(f),e[n+1]=f.error?.bind(f),e[n+2]=f.complete?.bind(f)}let s,l,c;if(r instanceof Hr)l=gi(r.firestore,as),c=pg(r._key.path),s={next:f=>{e[n]&&e[n](ZX(l,r,f))},error:e[n+1],complete:e[n+2]};else{const f=gi(r,rd);l=gi(f.firestore,as),c=f._query;const d=new Cg(l);s={next:m=>{e[n]&&e[n](new tc(l,d,f,m))},error:e[n+1],complete:e[n+2]},JD(r._query)}return(function(d,m,_,x){const y=new jD(x),T=new ND(m,y,_);return d.asyncQueue.enqueueAndForget((async()=>RD(await ix(d),T))),()=>{y.Nu(),d.asyncQueue.enqueueAndForget((async()=>DD(await ix(d),T)))}})(nd(l),c,i,s)}function Rg(r,e){return(function(n,i){const s=new Za;return n.asyncQueue.enqueueAndForget((async()=>EX(await FX(n),i,s))),s.promise})(nd(r),e)}function ZX(r,e,t){const n=t.docs.get(e._key),i=new Cg(r);return new $o(r,i,e._key,n,new Fu(t.hasPendingWrites,t.fromCache),e.converter)}const eY={maxAttempts:5};class tY{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=bg(e)}set(e,t,n){this._verifyNotCommitted();const i=Ho(e,this._firestore),s=cE(i.converter,t,n),l=iE(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(l.toMutation(i._key,Rr.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=Ho(e,this._firestore);let l;return l=typeof(t=Ir(t))=="string"||t instanceof Ef?sE(this._dataReader,"WriteBatch.update",s._key,t,n,i):aE(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(l.toMutation(s._key,Rr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Ho(e,this._firestore);return this._mutations=this._mutations.concat(new xf(t._key,Rr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ke(Ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ho(r,e){if((r=Ir(r)).firestore!==e)throw new Ke(Ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}class rY{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=bg(e)}get(e){const t=Ho(e,this._firestore),n=new KX(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return $e(24041);const s=i[0];if(s.isFoundDocument())return new jp(this._firestore,n,s.key,s,t.converter);if(s.isNoDocument())return new jp(this._firestore,n,t._key,null,t.converter);throw $e(18433,{doc:s})}))}set(e,t,n){const i=Ho(e,this._firestore),s=cE(i.converter,t,n),l=iE(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,n);return this._transaction.set(i._key,l),this}update(e,t,n,...i){const s=Ho(e,this._firestore);let l;return l=typeof(t=Ir(t))=="string"||t instanceof Ef?sE(this._dataReader,"Transaction.update",s._key,t,n,i):aE(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,l),this}delete(e){const t=Ho(e,this._firestore);return this._transaction.delete(t._key),this}}class nY extends rY{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Ho(e,this._firestore),n=new Cg(this._firestore);return super.get(e).then((i=>new $o(this._firestore,n,t._key,i._document,new Fu(!1,!1),t.converter)))}}function FY(r,e,t){r=gi(r,as);const n={...eY,...t};return(function(s){if(s.maxAttempts<1)throw new Ke(Ie.INVALID_ARGUMENT,"Max attempts must be at least 1")})(n),(function(s,l,c){const f=new Za;return s.asyncQueue.enqueueAndForget((async()=>{const d=await PX(s);new DX(s.asyncQueue,d,c,l,f).ju()})),f.promise})(nd(r),(i=>e(new nY(r,i))),n)}function PY(r){return nd(r=gi(r,as)),new tY(r,(e=>Rg(r,e)))}(function(e,t=!0){(function(i){_f=i})(gf),ns(new Ra("firestore",((n,{instanceIdentifier:i,options:s})=>{const l=n.getProvider("app").getImmediate(),c=new as(new yq(n.getProvider("auth-internal")),new wq(l,n.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ke(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new mc(d.options.projectId,m)})(l,i),l);return s={useFetchStreams:t,...s},c._setSettings(s),c}),"PUBLIC").setMultipleInstances(!0)),la(UA,zA,e),la(UA,zA,"esm2020")})();const iY={apiKey:"AIzaSyBs73Bei23kJZ1enZNVfMJhCqwUfPrxI8c",authDomain:"imis-id-manager.firebaseapp.com",projectId:"imis-id-manager",storageBucket:"imis-id-manager.firebasestorage.app",messagingSenderId:"6647190912",appId:"1:6647190912:web:85abc4585b1fa8b9281d65",measurementId:"G-925Q6R67S2"},uE=VC(iY);Gj(uE);const Um=gq(uE),Ru=VX(uE);BX(Ru).catch(r=>{r.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open."):r.code=="unimplemented"&&console.warn("Firestore persistence not supported in this environment.")});const Sh="imis_auth",Ah={getItem:r=>{try{return sessionStorage.getItem(r)}catch(e){return console.warn("SessionStorage access denied",e),null}},setItem:(r,e)=>{try{sessionStorage.setItem(r,e)}catch(t){console.warn("SessionStorage access denied",t)}},removeItem:r=>{try{sessionStorage.removeItem(r)}catch(e){console.warn("SessionStorage access denied",e)}}};class aY{constructor(){this.isAuthenticated=!1,this.user=null,this.confirmationResult=null,this.initAuth()}initAuth(){XH(Um,e=>{e?(this.isAuthenticated=!0,this.user=e,Ah.setItem(Sh,"true")):(this.isAuthenticated=!1,this.user=null,Ah.removeItem(Sh))})}initRecaptcha(e){if(window.recaptchaVerifier){try{window.recaptchaVerifier.clear()}catch(t){console.warn("Failed to clear old recaptcha",t)}window.recaptchaVerifier=null}window.recaptchaVerifier=new gG(Um,e,{size:"invisible",callback:()=>{},"expired-callback":()=>{console.warn("Recaptcha expired")}})}async sendOtp(e){try{const t=window.recaptchaVerifier;return this.confirmationResult=await xG(Um,e,t),!0}catch(t){throw console.error("SMS Error:",t),window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null),t}}async verifyOtp(e){if(!this.confirmationResult)throw new Error("No OTP request found.");try{const t=await this.confirmationResult.confirm(e);return this.user=t.user,this.isAuthenticated=!0,Ah.setItem(Sh,"true"),!0}catch(t){return console.error("OTP Verification Error:",t),!1}}async logout(){try{await YH(Um),this.isAuthenticated=!1,this.user=null,Ah.removeItem(Sh),window.location.reload()}catch(e){console.error("Logout Error:",e)}}isLoggedIn(){return this.isAuthenticated||Ah.getItem(Sh)==="true"}getExpiryTime(){return null}}const Gu=new aY,sY=({timeLeft:r})=>{const[e,t]=qe.useState(new Date);qe.useEffect(()=>{const i=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(i)},[]);const n=i=>{if(i===null)return"--:--";const s=Math.floor(i/1e3),l=Math.floor(s/60),c=s%60;return`${l}:${c.toString().padStart(2,"0")}`};return r===null?null:P.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",textAlign:"right",color:"rgba(255,255,255,0.8)",fontSize:"0.9rem",background:"rgba(0,0,0,0.2)",padding:"8px 15px",borderRadius:"20px",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.1)"},children:[P.jsx("div",{style:{fontWeight:"bold",fontSize:"1.1rem",color:"#fff"},children:e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),P.jsxs("div",{style:{fontSize:"0.8rem",opacity:.8,marginTop:"2px"},children:["Logout in: ",P.jsx("span",{style:{color:r<6e4?"#ff6b6b":"#4dabf5",fontWeight:"bold"},children:n(r)})]})]})},oY=({onDataEntryClick:r,onViewDataClick:e,onBulkUploadClick:t,remainingTime:n})=>P.jsxs("header",{style:{marginBottom:"2rem",position:"relative"},children:[Gu.isLoggedIn()&&P.jsx(sY,{timeLeft:n}),P.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"700",textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:"IMIS Data & ID Manager"}),P.jsx("p",{style:{opacity:.8},children:"Upload any Excel file with the required format to generate missing IDs."}),P.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"1rem",justifyContent:"center"},children:[P.jsx("button",{onClick:r,className:"glass-button",style:{background:"rgba(33, 150, 243, 0.3)"},children:" Data Entry"}),P.jsx("button",{onClick:t,className:"glass-button",style:{background:"rgba(255, 152, 0, 0.3)"},children:" Bulk Upload"}),P.jsx("button",{onClick:e,className:"glass-button",style:{background:"rgba(156, 39, 176, 0.3)"},children:" View Data Entry"})]})]}),lY=["District","Mandal","Grampanchayat","Benificiary Name","IMIS Id","Beneficiary Category","Beneficiary Type","Beneficiary Mobile Number","Ration Card Number","Ticket Number","Stage Level","FTR Status","FTR Number"],cY=[{label:"CFMS Bill Status",url:"https://prdcfms.apcfss.in:44300/sap/bc/ui5_ui5/sap/zexp_billstatus/index.html?sap-client=%27%27"},{label:"Create Multiple Beneficiary Requests",url:"https://prdcfms.apcfss.in:44300/sap/bc/ui5_ui5/sap/zexp_bf_mul_req/index.html"},{label:"SBM IMIS",url:"https://sbm.gov.in/SBMPhase2/Secure/Entry/UserMenu.aspx"},{label:"SAC",url:"https://sac.ap.gov.in/internal"},{label:"New Added Data Finder",url:"#"},{label:"Match CFMS with SAC",url:"#"},{label:"Show the commitments",url:"#"},{label:"IMIS id Generator",url:"#"}],MY={TICKET:{MIN:2e9,MAX:2999999999},FTR:{MIN:2e9,MAX:2999999999},REG:{MIN:1e9,MAX:1999999999}},uY=({onAadharClick:r,onTallyClick:e,onImisClick:t,onMatchClick:n,onCommitmentsClick:i})=>P.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",background:"rgba(255,255,255,0.05)",borderRadius:"8px"},children:[P.jsx("h3",{style:{marginBottom:"1rem",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"0.5rem"},children:"Quick Links"}),P.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[cY.map((s,l)=>s.label==="New Added Data Finder"?P.jsxs("button",{onClick:e,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):s.label==="Match CFMS with SAC"?P.jsxs("button",{onClick:n,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):s.label==="Show the commitments"?P.jsxs("button",{onClick:i,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):s.label==="IMIS id Generator"?P.jsxs("button",{onClick:t,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l):P.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer"},children:[" ",s.label]},l)),P.jsx("button",{onClick:r,className:"glass-button",style:{textDecoration:"none",fontSize:"0.9rem",cursor:"pointer",background:"rgba(255, 100, 100, 0.2)",border:"1px solid rgba(255, 100, 100, 0.4)"},children:" Aadhar Generator"})]})]}),fY=({isOpen:r,onClose:e,validCount:t,setValidCount:n,invalidCount:i,setInvalidCount:s,onGenerate:l})=>r?P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"500px",position:"relative"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"2rem",marginTop:0},children:"Aadhar Generator"}),P.jsxs("div",{style:{display:"flex",gap:"2rem",justifyContent:"space-between"},children:[P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"1rem"},children:[P.jsx("h3",{style:{borderBottom:"2px solid #4caf50",paddingBottom:"0.5rem"},children:"Valid Aadhar"}),P.jsx("label",{style:{fontSize:"0.9rem",textAlign:"left"},children:"How many?"}),P.jsx("input",{type:"number",className:"glass-input",placeholder:"Count...",value:t,onChange:c=>n(c.target.value)}),P.jsx("button",{className:"glass-button",style:{background:"rgba(76, 175, 80, 0.4)"},onClick:()=>l("valid"),children:"Download .xlsx"})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"1rem"},children:[P.jsx("h3",{style:{borderBottom:"2px solid #f44336",paddingBottom:"0.5rem"},children:"Invalid Aadhar"}),P.jsx("label",{style:{fontSize:"0.9rem",textAlign:"left"},children:"How many?"}),P.jsx("input",{type:"number",className:"glass-input",placeholder:"Count...",value:i,onChange:c=>s(c.target.value)}),P.jsx("button",{className:"glass-button",style:{background:"rgba(244, 67, 54, 0.4)"},onClick:()=>l("invalid"),children:"Download .xlsx"})]})]})]})}):null,hY=({data:r,headers:e,isVerifying:t,investigationReport:n,progress:i,synthesisCount:s,setSynthesisCount:l,onClear:c,onAnalyze:f,onGenerate:d,onExport:m})=>P.jsxs("div",{className:"glass-panel",children:[P.jsxs("div",{className:"preview-header",children:[P.jsxs("h2",{children:["Preview: ",r.length," Rows"]}),P.jsx("div",{style:{gap:"1rem",display:"flex"},children:P.jsx("button",{className:"glass-button",style:{background:"rgba(255,0,0,0.2)"},onClick:c,children:"Clear"})})]}),P.jsxs("div",{className:"action-area",children:[!n&&!t&&P.jsxs("div",{children:[P.jsx("p",{style:{marginBottom:"1rem",color:"#ccc"},children:"Step 1: Analyze file for missing data and consistency."}),P.jsx("button",{className:"glass-button",onClick:f,style:{fontSize:"1.1rem",padding:"12px 24px"},children:" Analyze & Verify Data"})]}),t&&P.jsxs("div",{style:{width:"100%"},children:[P.jsx("p",{style:{marginBottom:"0.5rem"},children:"Investigating Data Integrity..."}),P.jsx("div",{style:{width:"100%",height:"8px",background:"#333",borderRadius:"4px",overflow:"hidden"},children:P.jsx("div",{style:{width:`${i}%`,height:"100%",background:"#007bff",transition:"width 0.2s"}})})]}),n&&P.jsxs("div",{className:"fade-in",children:[P.jsx("h3",{style:{color:"#4caf50",marginBottom:"1rem"},children:" Data Verified"}),P.jsxs("div",{className:"stats-grid",children:[P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Valid Rows"}),P.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:n.validCount})]}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Missing IDs"}),P.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:n.missingStats.ticket+n.missingStats.ftr+n.missingStats.reg})]}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Action Needed"}),P.jsx("div",{style:{fontSize:"1.2rem",color:"#ffc107"},children:"Generate New IDs"})]})]}),P.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"rgba(0,123,255,0.1)",borderRadius:"8px",border:"1px solid rgba(0,123,255,0.2)"},children:[P.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem"},children:"Generate New Records (Append to file)"}),P.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",alignItems:"center",flexWrap:"wrap"},children:[P.jsx("input",{type:"number",min:"0",max:"1000",value:s,onChange:_=>l(_.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #555",background:"#222",color:"white",width:"100px",textAlign:"center"}}),P.jsx("span",{style:{fontSize:"0.9rem",opacity:.7},children:"rows"})]})]}),P.jsxs("div",{className:"action-buttons",children:[P.jsx("button",{className:"glass-button",onClick:d,style:{background:"#28a745",fontSize:"1.1rem",padding:"12px 24px",border:"none"},children:" Generate Smart IDs"}),P.jsx("button",{className:"glass-button",onClick:m,children:" Export Excel"})]})]})]}),P.jsx("div",{className:"table-container",children:P.jsxs("table",{className:"data-table",children:[P.jsx("thead",{children:P.jsx("tr",{children:e.map((_,x)=>P.jsx("th",{children:_},x))})}),P.jsx("tbody",{children:r.map((_,x)=>P.jsx("tr",{children:e.map((y,T)=>P.jsx("td",{children:_[T]||""},T))},x))})]})})]}),dY=({onLogin:r})=>{const[e,t]=qe.useState(""),[n,i]=qe.useState(""),[s,l]=qe.useState("PHONE"),[c,f]=qe.useState(""),[d,m]=qe.useState(!1);qe.useEffect(()=>{try{Gu.initRecaptcha("recaptcha-container")}catch(y){console.error("Recaptcha Init Error",y)}return()=>{if(window.recaptchaVerifier){try{window.recaptchaVerifier.clear()}catch(y){console.warn("Recaptcha cleanup failed",y)}window.recaptchaVerifier=null}}},[]);const _=async y=>{y.preventDefault(),f(""),m(!0);const T=e.replace(/\D/g,"");if(T.length!==10){f("Please enter a valid 10-digit mobile number"),m(!1);return}try{const E="+91"+T;await Gu.sendOtp(E)&&(l("OTP"),m(!1))}catch(E){console.error(E),f(E.message||"Failed to send OTP. Check console."),m(!1)}},x=async y=>{if(y.preventDefault(),f(""),m(!0),!n||n.length!==6){f("Please enter a valid 6-digit OTP"),m(!1);return}try{await Gu.verifyOtp(n)?r():(f("Invalid OTP"),m(!1))}catch(T){console.error(T),f("Verification Failed"),m(!1)}};return P.jsx("div",{className:"login-overlay",style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"#0f0f0f",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,backdropFilter:"blur(10px)"},children:P.jsxs("div",{className:"glass-panel login-container",style:{padding:"3rem",width:"100%",maxWidth:"400px",textAlign:"center"},children:[P.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem"},children:s==="PHONE"?"Admin Login":"Verify OTP"}),P.jsx("div",{id:"recaptcha-container"}),s==="PHONE"&&P.jsxs("form",{onSubmit:_,children:[P.jsx("p",{style:{marginBottom:"1.5rem",opacity:.7},children:"Enter Mobile Number"}),P.jsxs("div",{className:"input-group",style:{display:"flex",alignItems:"center",marginBottom:"1rem",background:"rgba(255,255,255,0.05)",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)"},children:[P.jsx("span",{style:{padding:"0 1rem",fontSize:"1.2rem",color:"#888",borderRight:"1px solid rgba(255,255,255,0.1)"},children:"+91"}),P.jsx("input",{type:"tel",value:e,onChange:y=>{const T=y.target.value.replace(/\D/g,"");T.length<=10&&t(T)},placeholder:"98765 43210",className:"glass-input-clean",style:{flex:1,border:"none",background:"transparent",padding:"1rem",fontSize:"1.2rem",color:"white",outline:"none"},autoFocus:!0})]}),P.jsx("button",{type:"submit",disabled:d,className:"glass-button",style:{width:"100%",justifyContent:"center",fontSize:"1rem",padding:"1rem"},children:d?"Sending OTP...":"Send OTP"})]}),s==="OTP"&&P.jsxs("form",{onSubmit:x,children:[P.jsx("p",{style:{marginBottom:"1.5rem",opacity:.7},children:"Enter the 6-digit code sent to your phone"}),P.jsx("input",{type:"text",value:n,onChange:y=>i(y.target.value),placeholder:"123456",className:"glass-input",style:{width:"100%",marginBottom:"1rem",fontSize:"1.2rem",textAlign:"center",letterSpacing:"0.5rem"},maxLength:6,autoFocus:!0}),P.jsx("button",{type:"submit",disabled:d,className:"glass-button",style:{width:"100%",justifyContent:"center",fontSize:"1rem",padding:"1rem"},children:d?"Verifying...":"Verify & Login"}),P.jsx("button",{type:"button",onClick:()=>{l("PHONE"),m(!1),f("")},style:{marginTop:"1rem",background:"none",border:"none",color:"#aaa",cursor:"pointer"},children:"Change Number"})]}),c&&P.jsx("p",{style:{color:"#ff4444",marginTop:"1rem",fontSize:"0.9rem"},children:c}),P.jsxs("div",{style:{marginTop:"2rem",fontSize:"0.7rem",opacity:.4},children:["This site is protected by reCAPTCHA and the Google",P.jsx("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noreferrer",style:{color:"inherit",textDecoration:"underline",margin:"0 4px"},children:"Privacy Policy"})," and",P.jsx("a",{href:"https://policies.google.com/terms",target:"_blank",rel:"noreferrer",style:{color:"inherit",textDecoration:"underline",margin:"0 4px"},children:"Terms of Service"})," apply."]})]})})},sI=r=>new Promise((e,t)=>{const n=new FileReader;n.onload=i=>{try{const s=new Uint8Array(i.target.result),l=Xu(s,{type:"array"}),c=l.SheetNames[0],f=l.Sheets[c],d=pn.sheet_to_json(f,{header:1});e(d)}catch(s){t(s)}},n.onerror=i=>t(i),n.readAsArrayBuffer(r)}),mY=async(r,e)=>{try{const[t,n]=await Promise.all([sI(r),sI(e)]);if(!t||t.length===0)throw new Error("Old file is empty");if(!n||n.length===0)throw new Error("New file is empty");const i=n[0],s=i.findIndex(f=>f&&f.toString().trim()==="Ticket Number");if(s===-1)throw new Error("Column 'Ticket Number' not found in the latest file. Please ensure both files have this column.");const l=new Set;t.slice(1).forEach(f=>{const d=f[s];d&&l.add(String(d).trim())});const c=[];return n.slice(1).forEach(f=>{const d=f[s];d&&!l.has(String(d).trim())&&c.push(f)}),{headers:i,newRows:c,count:c.length}}catch(t){return console.error("Comparison Error:",t),{error:t.message}}},pY=(r,e)=>{const t=pn.aoa_to_sheet([r,...e]),n=pn.book_new();pn.book_append_sheet(n,t,"NewEntries");const i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19);Jl(n,`tally_differences_${i}.xlsx`,{bookType:"xlsx",type:"array"})},gY=({isOpen:r,onClose:e})=>{const t=j0(),[n,i]=qe.useState(null),[s,l]=qe.useState(null),[c,f]=qe.useState(!1),[d,m]=qe.useState(null);if(!r)return null;const _=async()=>{if(!n||!s){t.error("Please upload both files.");return}f(!0),m(null);try{const{headers:y,newRows:T,count:E,error:S}=await mY(n,s);S?m({error:S}):(m({count:E}),E>0&&pY(y,T))}catch(y){m({error:y.message})}finally{f(!1)}},x=()=>{i(null),l(null),m(null)};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"600px",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:()=>{x(),e()},style:{position:"absolute",top:"15px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"0.5rem",marginTop:0},children:"Tally Analysis"}),P.jsx("p",{style:{marginBottom:"2rem",opacity:.7,fontSize:"0.9rem"},children:"Compare two Excel files to extract newly added rows."}),P.jsxs("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem"},children:[P.jsxs("div",{style:{flex:1},children:[P.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"1. Old File"}),P.jsx("div",{style:{border:"1px dashed rgba(255,255,255,0.3)",padding:"1.5rem",borderRadius:"8px",textAlign:"center",background:n?"rgba(76, 175, 80, 0.1)":"transparent"},children:n?P.jsxs("div",{children:[P.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),P.jsx("div",{style:{wordBreak:"break-all",fontSize:"0.8rem"},children:n.name}),P.jsx("button",{onClick:()=>i(null),style:{marginTop:"0.5rem",background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",fontSize:"0.8rem"},children:"Remove"})]}):P.jsxs(P.Fragment,{children:[P.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:y=>i(y.target.files[0]),style:{display:"none"},id:"old-file-upload"}),P.jsx("label",{htmlFor:"old-file-upload",className:"glass-button",style:{fontSize:"0.8rem"},children:"Browse Old"})]})})]}),P.jsxs("div",{style:{flex:1},children:[P.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"2. Latest File"}),P.jsx("div",{style:{border:"1px dashed rgba(255,255,255,0.3)",padding:"1.5rem",borderRadius:"8px",textAlign:"center",background:s?"rgba(76, 175, 80, 0.1)":"transparent"},children:s?P.jsxs("div",{children:[P.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),P.jsx("div",{style:{wordBreak:"break-all",fontSize:"0.8rem"},children:s.name}),P.jsx("button",{onClick:()=>l(null),style:{marginTop:"0.5rem",background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",fontSize:"0.8rem"},children:"Remove"})]}):P.jsxs(P.Fragment,{children:[P.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:y=>l(y.target.files[0]),style:{display:"none"},id:"new-file-upload"}),P.jsx("label",{htmlFor:"new-file-upload",className:"glass-button",style:{fontSize:"0.8rem"},children:"Browse Latest"})]})})]})]}),c&&P.jsxs("div",{style:{textAlign:"center",marginBottom:"1rem"},children:[P.jsx("div",{className:"spinner",style:{display:"inline-block",width:"20px",height:"20px",border:"2px solid rgba(255,255,255,0.3)",borderTop:"2px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",marginRight:"0.5rem"}}),P.jsx("span",{children:"Processing files..."})]}),d&&P.jsx("div",{style:{marginBottom:"1.5rem",padding:"1rem",borderRadius:"8px",background:d.error?"rgba(244, 67, 54, 0.1)":"rgba(76, 175, 80, 0.1)",border:`1px solid ${d.error?"#f44336":"#4caf50"}`},children:d.error?P.jsxs("div",{style:{color:"#ff6b6b"},children:[" ",d.error]}):P.jsxs("div",{style:{color:"#81c784"},children:[" Success! Found ",P.jsx("strong",{children:d.count})," new newly added rows.",d.count>0&&P.jsx("div",{children:"File downloaded automatically."})]})}),P.jsx("button",{onClick:_,disabled:!n||!s||c,className:"glass-button",style:{width:"100%",background:!n||!s?"rgba(255,255,255,0.1)":"rgba(0, 123, 255, 0.5)",cursor:!n||!s?"not-allowed":"pointer",padding:"1rem",fontSize:"1.1rem"},children:"Compare & Download Differences"})]})})},_Y=({isOpen:r,onClose:e,count:t,setCount:n,onGenerate:i})=>r?P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"400px",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"1.5rem",marginTop:0,textAlign:"center"},children:"IMIS ID Generator"}),P.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[P.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.9rem",textAlign:"left",opacity:.9},children:"Number of IDs to Generate:"}),P.jsx("input",{type:"number",className:"glass-input",placeholder:"Enter quantity...",value:t,onChange:s=>n(s.target.value),style:{padding:"0.8rem"}})]}),P.jsx("button",{className:"glass-button",style:{marginTop:"0.5rem",justifyContent:"center",background:"rgba(33, 150, 243, 0.3)"},onClick:i,children:"Generte & Download .xlsx"})]})]})}):null,vY=({isOpen:r,onClose:e})=>{const[t,n]=qe.useState(null),[i,s]=qe.useState(null),[l,c]=qe.useState(!1);if(!r)return null;const f=(m,_)=>{const x=m.target.files[0];_==="cfms"&&n(x),_==="sac"&&s(x)},d=async()=>{if(!t||!i){alert("Please upload both files.");return}c(!0);try{const{readExcelFile:m}=await Pr(async()=>{const{readExcelFile:Z}=await import("./excelUtils-1onNLjdQ.js");return{readExcelFile:Z}},[],import.meta.url),{matchAndMerge:_}=await Pr(async()=>{const{matchAndMerge:Z}=await import("./dataMatcher-DT7jLePl.js");return{matchAndMerge:Z}},[],import.meta.url),x=await Pr(()=>Promise.resolve().then(()=>g0),void 0,import.meta.url);console.log("Reading CFMS Excel...");const y=await m(t);if(console.log("CFMS Data:",y),!y||y.length===0){alert("No data found in CFMS Excel."),c(!1);return}console.log("Reading SAC Excel...");const T=await m(i);console.log("SAC Data:",T),console.log("Matching...");const E=_(T,y);console.log("Merged Data:",E);const S=x.utils.json_to_sheet(E),D=x.utils.book_new();x.utils.book_append_sheet(D,S,"Matched Data");const U=new Date,W=`matched_result_${`${String(U.getDate()).padStart(2,"0")}_${String(U.getMonth()+1).padStart(2,"0")}_${U.getFullYear()}`}.xlsx`;x.writeFile(D,W),alert("Matching Complete! File downloaded."),e()}catch(m){console.error("Match Error:",m),alert("Error matching files: "+m.message)}finally{c(!1)}};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"600px",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:e,disabled:l,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:l?"not-allowed":"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"1.5rem",marginTop:0,textAlign:"center"},children:"Match CFMS with SAC"}),P.jsxs("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem"},children:[P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.9rem",opacity:.9},children:"Upload CFMS Excel file"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:t?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:m=>f(m,"cfms"),style:{display:"none"},id:"cfms-upload",disabled:l}),P.jsx("label",{htmlFor:"cfms-upload",style:{cursor:l?"wait":"pointer",width:"100%",display:"block"},children:t?P.jsx("span",{style:{color:"#4caf50"},children:t.name}):P.jsx("span",{style:{opacity:.7},children:"Click to Browse"})})]})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.9rem",opacity:.9},children:"Upload SAC Excel file"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:i?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:m=>f(m,"sac"),style:{display:"none"},id:"sac-upload",disabled:l}),P.jsx("label",{htmlFor:"sac-upload",style:{cursor:l?"wait":"pointer",width:"100%",display:"block"},children:i?P.jsx("span",{style:{color:"#4caf50"},children:i.name}):P.jsx("span",{style:{opacity:.7},children:"Click to Browse"})})]})]})]}),P.jsxs("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",gap:"1rem"},children:[l&&P.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",color:"#ffeb3b",fontWeight:"bold"},children:[P.jsx("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"#ffeb3b",animation:"spin 1s ease-in-out infinite"}}),P.jsx("span",{children:"Processing... This may take a moment."}),P.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]}),P.jsx("button",{className:"glass-button",style:{padding:"0.8rem 2rem",background:l?"grey":"rgba(33, 150, 243, 0.3)",cursor:l?"not-allowed":"pointer"},onClick:d,disabled:l,children:l?"Matching...":"Match Data"})]})]})})},e3=qe.createContext(null),fE=()=>{const r=qe.useContext(e3);if(!r)throw new Error("useDataEntry must be used within a DataEntryProvider");return r},xY=({isOpen:r,onClose:e})=>{const{entries:t}=fE(),[n,i]=qe.useState(null),[s,l]=qe.useState("upload"),[c,f]=qe.useState(null),[d,m]=qe.useState(null),[_,x]=qe.useState(!1),[y,T]=qe.useState(null),[E,S]=qe.useState("upload"),[D,U]=qe.useState("All"),[k,W]=qe.useState([]);if(!r)return null;const Z=(ve,xe)=>{const ne=ve.target.files[0];xe==="commitment"&&i(ne),xe==="cfms"&&f(ne),xe==="sac"&&m(ne)},X=async()=>{if(s==="upload"&&!n){alert("Upload Commitment File is mandatory.");return}if(s==="server"&&(!t||t.length===0)){alert("No data found in server database. Please add entries in 'Data Entry' first.");return}if(!c&&!d){alert("Please upload at least one secondary file (CFMS or SAC) to process.");return}x(!0),setTimeout(async()=>{try{const ve=await Pr(()=>Promise.resolve().then(()=>g0),void 0,import.meta.url),{processCommitments:xe}=await Pr(async()=>{const{processCommitments:O}=await import("./commitmentsProcessor-COCoH_jg.js");return{processCommitments:O}},[],import.meta.url),ne=O=>new Promise((Q,q)=>{if(!O)return Q([]);const ee=new FileReader;ee.onload=oe=>{try{const Te=new Uint8Array(oe.target.result),Re=ve.read(Te,{type:"array"}),Se=Re.Sheets[Re.SheetNames[0]];Q(ve.utils.sheet_to_json(Se))}catch(Te){q(Te)}},ee.onerror=q,ee.readAsArrayBuffer(O)});let le=[];s==="server"?le=t.map(O=>({"NAME OF THE VENDOR":O.vendorName,"Beneficiary Name":O.beneficiaryName,"ACCOUNT NUMBER":O.accountNumber,"IFSC Code":O.ifscCode,AADHAR:O.aadharNumber,PAN:O.panCard,"CFMS ID":O.cfmsId,"Account Number":O.accountNumber})):le=await ne(n);const Le=await ne(c),ae=await ne(d);if(!le.length)throw new Error("Commitment data is empty.");if(!Le.length&&!ae.length)throw new Error("Secondary files are empty.");console.log("Processing...");const Pe=xe(le,Le,ae),J=[...new Set(Pe.map(O=>O["NAME OF THE VENDOR"]||"Unknown"))].sort();T(Pe),W(["All",...J]),U("All"),S("results"),alert(`Analysis Complete! Found ${Pe.length} matches.`)}catch(ve){console.error(ve),alert("Error: "+ve.message)}finally{x(!1)}},100)},A=async()=>{if(!y)return;let ve=D==="All"?y:y.filter(xe=>xe["NAME OF THE VENDOR"]===D);if(ve=ve.map((xe,ne)=>({"S.No":ne+1,...xe})),D!=="All")try{let xe="both";d&&!c?xe="sac":!d&&c&&(xe="cfms");const{generateVendorPdf:ne}=await Pr(async()=>{const{generateVendorPdf:le}=await import("./pdfGenerator-CIDG78H4.js");return{generateVendorPdf:le}},__vite__mapDeps([0,1,2]),import.meta.url);ne(ve,D,xe)}catch(xe){console.error(xe),alert("Error generating PDF: "+xe.message)}else try{const xe=M(ve),ne={"S.No":"","NAME OF THE VENDOR":"GRAND TOTAL","Proposed Payment Individual":V(xe.proposed),"Credited Payment Individual":V(xe.credited),"My Share":V(xe.share)};ve.push(ne);const le=await Pr(()=>Promise.resolve().then(()=>g0),void 0,import.meta.url),Le=le.utils.json_to_sheet(ve),ae=le.utils.book_new();le.utils.book_append_sheet(ae,Le,"Commitments");const Pe=new Date().toISOString().slice(0,10);le.writeFile(ae,`commitments_${Pe}.xlsx`)}catch(xe){console.error(xe),alert("Error generating Excel")}},R=()=>{S("upload"),T(null),i(null),f(null),m(null),U("All")},C=ve=>{if(!ve)return 0;const xe=String(ve).replace(/[^0-9.-]+/g,"");return parseFloat(xe)||0},V=ve=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(ve),N=y?D==="All"?y:y.filter(ve=>ve["NAME OF THE VENDOR"]===D):[],M=ve=>{let xe=0,ne=0,le=0;return ve.forEach(Le=>{xe+=C(Le["Proposed Payment Individual"]),ne+=C(Le["Credited Payment Individual"]),le+=C(Le["My Share"])}),{proposed:xe,credited:ne,share:le}},B=M(N);return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(8px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:E==="results"?"90%":"800px",height:E==="results"?"90%":"auto",position:"relative",padding:"2rem",display:"flex",flexDirection:"column"},children:[P.jsx("button",{onClick:()=>{e(),R()},style:{position:"absolute",top:10,right:15,background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{textAlign:"center",marginTop:0},children:E==="results"?"Analysis Results":"Show the Commitments"}),E==="upload"?P.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[P.jsxs("div",{style:{display:"flex",gap:"1.5rem",justifyContent:"space-between"},children:[P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.8rem",opacity:.9},children:"Commitment File"}),P.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:P.jsxs("select",{style:{flex:1,padding:"0.5rem",borderRadius:"4px",background:"rgba(255,255,255,0.1)",color:"white",border:"1px solid rgba(255,255,255,0.2)"},value:s,onChange:ve=>l(ve.target.value),children:[P.jsx("option",{value:"server",style:{color:"black"},children:"From Server"}),P.jsx("option",{value:"upload",style:{color:"black"},children:"Upload Device"})]})}),s==="server"?P.jsx("select",{style:{width:"100%",padding:"1rem",borderRadius:"8px",background:"rgba(255,255,255,0.05)",color:"white",border:"2px dashed rgba(255,255,255,0.2)"},disabled:!0,children:P.jsxs("option",{children:["Using ",t.length," Live Entries from Database"]})}):P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:n?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:ve=>Z(ve,"commitment"),style:{display:"none"},id:"comm-upload"}),P.jsx("label",{htmlFor:"comm-upload",style:{cursor:"pointer",width:"100%",display:"block",fontSize:"0.8rem"},children:n?P.jsx("span",{style:{color:"#4caf50"},children:n.name}):P.jsx("span",{children:"Click to Browse"})})]})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.8rem",opacity:.9},children:"CFMS Excel"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:c?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:ve=>Z(ve,"cfms"),style:{display:"none"},id:"cfms-upload"}),P.jsx("label",{htmlFor:"cfms-upload",style:{cursor:"pointer",width:"100%",display:"block",fontSize:"0.8rem"},children:c?P.jsx("span",{style:{color:"#4caf50"},children:c.name}):P.jsx("span",{children:"Click to Browse"})})]})]}),P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[P.jsx("label",{style:{fontSize:"0.8rem",opacity:.9},children:"SAC Excel"}),P.jsxs("div",{style:{border:"2px dashed rgba(255,255,255,0.2)",padding:"1rem",borderRadius:"8px",textAlign:"center",cursor:"pointer",background:d?"rgba(76, 175, 80, 0.1)":"transparent"},children:[P.jsx("input",{type:"file",accept:".xlsx",onChange:ve=>Z(ve,"sac"),style:{display:"none"},id:"sac-upload"}),P.jsx("label",{htmlFor:"sac-upload",style:{cursor:"pointer",width:"100%",display:"block",fontSize:"0.8rem"},children:d?P.jsx("span",{style:{color:"#4caf50"},children:d.name}):P.jsx("span",{children:"Click to Browse"})})]})]})]}),P.jsx("div",{style:{display:"flex",justifyContent:"center"},children:P.jsx("button",{className:"glass-button",style:{padding:"0.8rem 2rem",background:_?"grey":"rgba(33, 150, 243, 0.3)"},onClick:X,disabled:_,children:_?"Processing 3 Files...":"Process All Files"})})]}):P.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[P.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem",alignItems:"center"},children:[P.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[P.jsx("label",{children:"Filter by Vendor:"}),P.jsx("select",{value:D,onChange:ve=>U(ve.target.value),style:{padding:"5px",borderRadius:"4px",background:"rgba(0,0,0,0.3)",color:"white",border:"1px solid rgba(255,255,255,0.2)"},children:k.map(ve=>P.jsx("option",{value:ve,children:ve},ve))})]}),P.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[P.jsx("button",{className:"glass-button",onClick:R,children:"Back to Upload"}),P.jsx("button",{className:"glass-button",onClick:A,style:{background:"rgba(76, 175, 80, 0.3)"},children:D==="All"?"Download Excel":"Download PDF"})]})]}),P.jsx("div",{style:{flex:1,overflow:"auto",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px"},children:P.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[P.jsx("thead",{style:{position:"sticky",top:0,background:"#2c3e50",zIndex:1},children:P.jsxs("tr",{children:[P.jsx("th",{style:{padding:"10px",textAlign:"center",borderBottom:"1px solid #ddd"},children:"S.No"}),y&&y.length>0&&Object.keys(y[0]).map(ve=>{let xe="left";return(ve.includes("Payment")||ve.includes("Amount")||ve.includes("Share")||ve.includes("count"))&&(xe="right"),P.jsx("th",{style:{padding:"10px",textAlign:xe,borderBottom:"1px solid #ddd"},children:ve},ve)})]})}),P.jsx("tbody",{children:N.map((ve,xe)=>P.jsxs("tr",{style:{background:xe%2===0?"rgba(255,255,255,0.02)":"transparent"},children:[P.jsx("td",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:xe+1}),Object.keys(ve).map((ne,le)=>{const Le=ve[ne];let ae="left";return(ne.includes("Payment")||ne.includes("Amount")||ne.includes("Share")||ne.includes("count"))&&(ae="right"),P.jsx("td",{style:{padding:"8px",textAlign:ae,borderBottom:"1px solid rgba(255,255,255,0.05)"},children:Le},le)})]},xe))}),P.jsx("tfoot",{style:{position:"sticky",bottom:0,background:"#34495e",fontWeight:"bold"},children:P.jsxs("tr",{children:[P.jsx("td",{style:{padding:"10px"}}),y&&y.length>0&&Object.keys(y[0]).map((ve,xe)=>ve==="Proposed Payment Individual"?P.jsx("td",{style:{padding:"10px"},children:V(B.proposed)},xe):ve==="Credited Payment Individual"?P.jsx("td",{style:{padding:"10px"},children:V(B.credited)},xe):ve==="My Share"?P.jsx("td",{style:{padding:"10px"},children:V(B.share)},xe):ve==="NAME OF THE VENDOR"?P.jsx("td",{style:{padding:"10px"},children:"GRAND TOTAL"},xe):P.jsx("td",{},xe))]})})]})})]})]})})},yY=({isOpen:r,onClose:e,initialData:t,onSave:n})=>{const i=j0(),[s,l]=qe.useState({vendorName:"",beneficiaryName:"",cfmsId:"",aadharNumber:"",panCard:"",ifscCode:"",accountNumber:""});qe.useEffect(()=>{l(t||{vendorName:"",beneficiaryName:"",cfmsId:"",aadharNumber:"",panCard:"",ifscCode:"",accountNumber:""})},[t,r]);const c=S=>{const{name:D,value:U}=S.target;if(D==="accountNumber"){/^\d*$/.test(U)&&l(k=>({...k,[D]:U}));return}if(D==="aadharNumber"){/^\d{0,12}$/.test(U)&&l(k=>({...k,[D]:U}));return}if(["ifscCode","vendorName","beneficiaryName","cfmsId","panCard"].includes(D)){l(k=>({...k,[D]:U.toUpperCase()}));return}l(k=>({...k,[D]:U}))},[f,d]=qe.useState(null),[m,_]=qe.useState(!1);qe.useEffect(()=>{const S=s.ifscCode;S.length===11?x(S):d(null)},[s.ifscCode]);const x=async S=>{_(!0);try{const D=await fetch(`https://ifsc.razorpay.com/${S}`);if(D.ok){const U=await D.json();d(U)}else d(null)}catch(D){console.error("Error fetching IFSC:",D),d(null)}finally{_(!1)}},y=S=>{S.preventDefault();const D=/^[A-Z]{4}0[A-Z0-9]{6}$/,U=/^[0-9]{9,18}$/;if(!s.vendorName.trim()||!s.beneficiaryName.trim()||!s.ifscCode.trim()||!s.accountNumber.trim()){i.error("Please fill all mandatory fields: Vendor, Beneficiary, IFSC, Account");return}if(s.aadharNumber&&s.aadharNumber.length!==12){i.error("Aadhar Number must be exactly 12 digits.");return}if(!D.test(s.ifscCode)){i.error("Invalid IFSC Code Format. (e.g., SBIN0001234)");return}if(!U.test(s.accountNumber)){i.error("Invalid Account Number. Must be 9-18 digits.");return}n(s),t?e():(l({vendorName:"",beneficiaryName:"",cfmsId:"",aadharNumber:"",panCard:"",ifscCode:"",accountNumber:""}),d(null))},T={display:"block",width:"100%",padding:"0.8rem",marginBottom:"1rem",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"4px",color:"white",fontSize:"1rem"},E={display:"block",marginBottom:"0.5rem",textAlign:"left",fontSize:"0.9rem",opacity:.9};return r?P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1050,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"600px",maxHeight:"90vh",overflowY:"auto",position:"relative",padding:"2rem"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginBottom:"1.5rem",marginTop:0},children:t?"Edit Entry":"Data Entry"}),P.jsxs("form",{onSubmit:y,children:[P.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Vendor Name *"}),P.jsx("input",{type:"text",name:"vendorName",value:s.vendorName,onChange:c,style:T,placeholder:"Enter Vendor Name"})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Beneficiary Name *"}),P.jsx("input",{type:"text",name:"beneficiaryName",value:s.beneficiaryName,onChange:c,style:T,placeholder:"Enter Beneficiary Name"})]})]}),P.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[P.jsxs("div",{children:[P.jsx("label",{style:E,children:"CFMS ID"}),P.jsx("input",{type:"text",name:"cfmsId",value:s.cfmsId,onChange:c,style:T,placeholder:"Enter CFMS ID"})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Aadhar Number"}),P.jsx("input",{type:"text",name:"aadharNumber",value:s.aadharNumber,onChange:c,style:T,placeholder:"Enter Aadhar"})]})]}),P.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Pan Card"}),P.jsx("input",{type:"text",name:"panCard",value:s.panCard,onChange:c,style:T,placeholder:"Enter PAN"})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"IFSC Code *"}),P.jsx("input",{type:"text",name:"ifscCode",value:s.ifscCode,onChange:c,maxLength:11,style:{...T,textTransform:"uppercase"},placeholder:"Enter IFSC"}),m&&P.jsx("div",{style:{fontSize:"0.8rem",color:"#ccc"},children:"Fetching Bank Details..."}),f&&P.jsxs("div",{style:{fontSize:"0.85rem",color:"#4caf50",marginTop:"-0.5rem",marginBottom:"1rem",background:"rgba(76, 175, 80, 0.1)",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(76, 175, 80, 0.3)"},children:[" ",f.BANK," - ",f.BRANCH,", ",f.CITY]})]})]}),P.jsxs("div",{children:[P.jsx("label",{style:E,children:"Account Number *"}),P.jsx("input",{type:"text",name:"accountNumber",value:s.accountNumber,onChange:c,style:T,placeholder:"Enter Account Number"})]}),P.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[P.jsx("button",{type:"button",onClick:e,className:"glass-button",style:{background:"rgba(255, 255, 255, 0.1)"},children:"Cancel"}),P.jsx("button",{type:"submit",className:"glass-button",style:{background:"rgba(76, 175, 80, 0.5)"},children:t?"Update":"Submit"})]})]})]})}):null},EY=({isOpen:r,onClose:e})=>{const[t,n]=qe.useState(!1),{addEntry:i}=fE(),s=j0();if(!r)return null;const l=async()=>{try{const f=await Pr(()=>Promise.resolve().then(()=>g0),void 0,import.meta.url),d=[["Vendor Name","Beneficiary Name","CFMS ID","Aadhar Number","Pan Card","IFSC Code","Account Number"],["Example Vendor","Example Beneficiary","123456","123412341234","ABCDE1234F","SBIN0000300","12345678901"]],m=f.utils.aoa_to_sheet(d),_=f.utils.book_new();f.utils.book_append_sheet(_,m,"Template"),f.writeFile(_,"DataEntry_Template.xlsx"),s.success("Template downloaded successfully!")}catch(f){console.error("Template download failed:",f),s.error("Failed to download template.")}},c=async f=>{const d=f.target.files[0];if(d){n(!0);try{const{readExcelFile:m}=await Pr(async()=>{const{readExcelFile:E}=await import("./excelUtils-1onNLjdQ.js");return{readExcelFile:E}},[],import.meta.url),_=await m(d);if(!_||_.length===0){s.error("File is empty or invalid format."),n(!1);return}let x=0,y=0;const T=_.map(async E=>{const S={vendorName:(E["Vendor Name"]||"").toString().trim().toUpperCase(),beneficiaryName:(E["Beneficiary Name"]||"").toString().trim().toUpperCase(),cfmsId:(E["CFMS ID"]||"").toString().trim().toUpperCase(),aadharNumber:(E["Aadhar Number"]||"").toString().trim(),panCard:(E["Pan Card"]||"").toString().trim().toUpperCase(),ifscCode:(E["IFSC Code"]||"").toString().trim().toUpperCase(),accountNumber:(E["Account Number"]||"").toString().trim()};if(!S.vendorName||!S.beneficiaryName||!S.ifscCode||!S.accountNumber){y++;return}if(S.aadharNumber&&!/^\d{12}$/.test(S.aadharNumber)){y++;return}if(!/^[A-Z]{4}0[A-Z0-9]{6}$/.test(S.ifscCode)){y++;return}if(!/^\d{9,18}$/.test(S.accountNumber)){y++;return}await i(S)?x++:y++});await Promise.all(T),s.success(`Bulk Upload Complete: ${x} Added, ${y} Skipped.`),f.target.value="",x>0&&e()}catch(m){console.error("Bulk upload error:",m),s.error("Failed to process file.")}finally{n(!1)}}};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1050,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"500px",padding:"2rem",display:"flex",flexDirection:"column",gap:"1.5rem",position:"relative"},children:[P.jsx("button",{onClick:e,style:{position:"absolute",top:"10px",right:"15px",background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""}),P.jsx("h2",{style:{marginTop:0},children:"Bulk Data Entry"}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("p",{style:{margin:"0 0 1rem 0"},children:"Step 1: Download the template."}),P.jsx("button",{onClick:l,className:"glass-button",style:{width:"100%"},children:" Download Excel Template"})]}),P.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"1rem",borderRadius:"8px"},children:[P.jsx("p",{style:{margin:"0 0 1rem 0"},children:"Step 2: Upload filled Excel file."}),t?P.jsx("div",{style:{textAlign:"center",padding:"1rem"},children:"Processing..."}):P.jsxs(P.Fragment,{children:[P.jsx("input",{type:"file",id:"bulk-upload-input",accept:".xlsx, .xls",onChange:c,style:{display:"none"}}),P.jsx("label",{htmlFor:"bulk-upload-input",className:"glass-button",style:{display:"block",textAlign:"center",cursor:"pointer",background:"rgba(76, 175, 80, 0.4)"},children:" Upload & Process"})]})]})]})})},TY=({isOpen:r,onClose:e,entries:t=[],onEdit:n,onDelete:i})=>{const[s,l]=qe.useState(""),[c,f]=qe.useState(""),[d,m]=qe.useState({key:"vendorName",direction:"asc"}),_=qe.useMemo(()=>[...new Set(t.map(W=>W.vendorName))].sort(),[t]);if(!r)return null;const x=k=>{let W="asc";d.key===k&&d.direction==="asc"&&(W="desc"),m({key:k,direction:W})},T=[...t].sort((k,W)=>k[d.key]<W[d.key]?d.direction==="asc"?-1:1:k[d.key]>W[d.key]?d.direction==="asc"?1:-1:0).filter(k=>{const W=s===""||k.vendorName===s,Z=k.ifscCode.toLowerCase().includes(c.toLowerCase());return W&&Z}),E=k=>d.key===k?d.direction==="asc"?" ":" ":"",S=async()=>{try{const k=await Pr(()=>Promise.resolve().then(()=>g0),void 0,import.meta.url),W=T.map((A,R)=>({"S.No":R+1,"Vendor Name":A.vendorName,"Beneficiary Name":A.beneficiaryName,"CFMS ID":A.cfmsId||"-","Aadhar Number":A.aadharNumber||"-","PAN Card":A.panCard||"-","IFSC Code":A.ifscCode,"Account Number":A.accountNumber})),Z=k.utils.json_to_sheet(W),X=k.utils.book_new();k.utils.book_append_sheet(X,Z,"Data Entries"),k.writeFile(X,`Data_Entries_${new Date().toLocaleDateString().replace(/\//g,"-")}.xlsx`)}catch(k){console.error("Export failed:",k),alert("Failed to export Excel")}},D=async()=>{try{const{default:k}=await Pr(async()=>{const{default:C}=await import("./jspdf.es.min-DQ__GkXo.js").then(V=>V.j);return{default:C}},[],import.meta.url),{default:W}=await Pr(async()=>{const{default:C}=await import("./jspdf.plugin.autotable-DZlIrCiz.js");return{default:C}},[],import.meta.url),Z=new k,X=["S.No","Vendor Name","Beneficiary Name","IFSC Code","Account Number"],A=T.map((C,V)=>[V+1,C.vendorName,C.beneficiaryName,C.ifscCode,C.accountNumber]);Z.setFontSize(10);const R=new Date().toLocaleDateString();Z.text(`System Generated on: ${R}`,14,15),W(Z,{head:[X],body:A,startY:20,theme:"grid",styles:{overflow:"linebreak",fontSize:10,cellPadding:2},columnStyles:{0:{cellWidth:15},1:{cellWidth:"auto"},2:{cellWidth:"auto"},3:{cellWidth:30},4:{cellWidth:40}}}),Z.save(`Data_Entries_${new Date().toLocaleDateString().replace(/\//g,"-")}.pdf`)}catch(k){console.error("PDF Export failed:",k),alert(`Failed to export PDF: ${k.message}`)}},U={padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.1)",color:"white",width:"200px"};return P.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:P.jsxs("div",{className:"glass-panel",style:{width:"90%",maxWidth:"1200px",height:"90vh",display:"flex",flexDirection:"column",position:"relative"},children:[P.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[P.jsxs("h2",{style:{margin:0},children:["View Data Entries (",T.length,")"]}),P.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"white",fontSize:"1.5rem",cursor:"pointer"},children:""})]}),P.jsxs("div",{style:{padding:"1rem 1.5rem",display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[P.jsxs("select",{value:s,onChange:k=>l(k.target.value),style:U,children:[P.jsx("option",{value:"",style:{color:"black"},children:"All Vendors"}),_.map(k=>P.jsx("option",{value:k,style:{color:"black"},children:k},k))]}),P.jsx("input",{type:"text",placeholder:"Filter by IFSC...",value:c,onChange:k=>f(k.target.value),style:U}),P.jsx("div",{style:{flex:1}}),P.jsx("button",{className:"glass-button",onClick:S,style:{background:"rgba(76, 175, 80, 0.3)"},children:"Export Excel"}),P.jsx("button",{className:"glass-button",onClick:D,style:{background:"rgba(255, 152, 0, 0.3)"},children:"Export PDF"})]}),P.jsx("div",{style:{flex:1,overflow:"auto",padding:"1.5rem"},children:T.length===0?P.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"rgba(255,255,255,0.5)"},children:t.length===0?"No entries found. Please add some data.":"No matches found."}):P.jsxs("table",{className:"data-table",style:{width:"100%",borderCollapse:"collapse"},children:[P.jsx("thead",{children:P.jsxs("tr",{children:[P.jsx("th",{style:{textAlign:"left",padding:"0.75rem"},children:"S.No"}),P.jsxs("th",{onClick:()=>x("vendorName"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Vendor Name ",E("vendorName")]}),P.jsxs("th",{onClick:()=>x("beneficiaryName"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Beneficiary Name ",E("beneficiaryName")]}),P.jsxs("th",{onClick:()=>x("cfmsId"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["CFMS ID ",E("cfmsId")]}),P.jsxs("th",{onClick:()=>x("aadharNumber"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Aadhar Number ",E("aadharNumber")]}),P.jsxs("th",{onClick:()=>x("panCard"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Pan Card ",E("panCard")]}),P.jsxs("th",{onClick:()=>x("ifscCode"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["IFSC Code ",E("ifscCode")]}),P.jsxs("th",{onClick:()=>x("accountNumber"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem"},children:["Account Number ",E("accountNumber")]}),P.jsx("th",{style:{textAlign:"center",padding:"0.75rem"},children:"Actions"})]})}),P.jsx("tbody",{children:T.map((k,W)=>P.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:W+1}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.vendorName}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.beneficiaryName}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.cfmsId||"-"}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.aadharNumber||"-"}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.panCard||"-"}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.ifscCode}),P.jsx("td",{style:{textAlign:"left",padding:"0.75rem"},children:k.accountNumber}),P.jsx("td",{style:{textAlign:"center",padding:"0.75rem"},children:P.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[P.jsx("button",{onClick:()=>n(k),className:"glass-button",style:{padding:"5px 10px",fontSize:"0.8rem",background:"rgba(33, 150, 243, 0.3)"},children:"Edit"}),P.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this entry?")&&i(k.id)},className:"glass-button",style:{padding:"5px 10px",fontSize:"0.8rem",background:"rgba(244, 67, 54, 0.3)"},children:"Delete"})]})})]},k.id))})]})})]})})};class wY extends PN.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught Error:",e,t),this.setState({errorInfo:t})}handleReload=()=>{window.location.reload()};handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?P.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:"#ff6b6b"},children:P.jsxs("div",{className:"glass-panel",style:{padding:"3rem",maxWidth:"600px"},children:[P.jsx("h2",{style:{fontSize:"2rem",marginBottom:"1rem"},children:" Application Error"}),P.jsx("p",{style:{color:"white",marginBottom:"1rem",opacity:.9},children:"Something went wrong in the application specific logic."}),P.jsx("div",{style:{background:"rgba(0,0,0,0.3)",padding:"1rem",borderRadius:"8px",fontFamily:"monospace",marginBottom:"2rem",textAlign:"left",overflow:"auto",maxHeight:"200px",fontSize:"0.9rem",color:"#ffcccc"},children:this.state.error&&this.state.error.toString()}),P.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[P.jsx("button",{onClick:this.handleReset,className:"glass-button",children:"Try Again"}),P.jsx("button",{onClick:this.handleReload,className:"glass-button",style:{background:"rgba(255,255,255,0.1)"},children:"Reload Page"})]})]})}):this.props.children}}const SY=()=>{const[r,e]=qe.useState([]),[t,n]=qe.useState([]),[i,s]=qe.useState(""),[l,c]=qe.useState(!1),[f,d]=qe.useState(null),m=qe.useCallback(x=>{x&&(c(!0),s(x.name),d(null),e([]),setTimeout(()=>{const y=new FileReader;y.onload=T=>{try{const E=T.target.result,S=Xu(E,{type:"binary"}),D=S.SheetNames[0],U=S.Sheets[D];let k=pn.sheet_to_json(U,{header:1});if(!k||k.length===0)throw new Error("File is empty");let W=k[0];const Z=W.indexOf("Benificiary Registration Id");Z!==-1&&(W[Z]="IMIS Id");let X=[...W];X=X.filter(N=>N!=="CFMS Id"&&N!=="Aadhar Number"&&N!=="Amount");const A=X.findIndex(N=>N&&N.trim()==="Bank Account Number"),R=["CFMS Id","Aadhar Number"];A!==-1?X.splice(A,0,...R):X.push(...R),X.includes("Amount")||X.push("Amount");const C={};W.forEach((N,M)=>C[N]=M);const V=k.slice(1).map(N=>X.map(M=>{const B=C[M];return B!==void 0&&N[B]!==void 0?N[B]:""}));n(X),e(V)}catch(E){console.error(E),d(E.message||"Error reading file")}finally{c(!1)}},y.onerror=()=>{d("Failed to read file"),c(!1)},y.readAsBinaryString(x)},100))},[]),_=qe.useCallback(()=>{e([]),n([]),s(""),d(null)},[]);return{data:r,setData:e,headers:t,setHeaders:n,fileName:i,isUploading:l,error:f,processFile:m,clearData:_}},AY=()=>{const[r,e]=qe.useState(!1),[t,n]=qe.useState(null),[i,s]=qe.useState(null),[l,c]=qe.useState(0),[f,d]=qe.useState(0);return{isVerifying:r,investigationReport:t,generationContext:i,synthesisCount:l,setSynthesisCount:c,progress:f,analyzeAndVerify:async(x,y)=>{try{e(!0),d(0),n(null);const{validateRow:T}=await Pr(async()=>{const{validateRow:N}=await import("./idGenerator-CFu3fATh.js");return{validateRow:N}},[],import.meta.url),{analyzeContext:E}=await Pr(async()=>{const{analyzeContext:N}=await import("./dataAnalyzer-CEU6KrsT.js");return{analyzeContext:N}},[],import.meta.url),S=new Set(y.map(N=>N&&N.trim())),D=[];if(lY.forEach(N=>{S.has(N)||D.push(N)}),D.length>0)throw new Error(`CRITICAL ERROR: Missing required columns: ${D.join(", ")}`);const U=E(x,y);s(U);let k=0,W=0;const Z={ticket:0,ftr:0,reg:0,name:0},X=y.indexOf("Ticket Number"),A=y.indexOf("FTR Number"),R=y.indexOf("IMIS Id"),C=y.indexOf("Benificiary Name"),V=x.length;for(let N=0;N<V;N++){const M=x[N];T(M).valid?(k++,X!==-1&&!M[X]&&Z.ticket++,A!==-1&&!M[A]&&Z.ftr++,R!==-1&&!M[R]&&Z.reg++,C!==-1&&!M[C]&&Z.name++):W++,V>100&&N%Math.ceil(V/10)===0&&d(Math.round(N/V*100))}return d(100),n({total:V,validCount:k,invalidCount:W,missingStats:Z,context:U}),{success:!0}}catch(T){return console.error("Analysis failed:",T),{success:!1,error:T.message}}finally{e(!1)}},generateIds:async(x,y,T,E)=>{try{const{generateTicketNumber:S,generateFTRNumber:D,generateBeneficiaryRegId:U,generateName:k,validateRow:W}=await Pr(async()=>{const{generateTicketNumber:Xe,generateFTRNumber:Oe,generateBeneficiaryRegId:nt,generateName:gt,validateRow:Mt}=await import("./idGenerator-CFu3fATh.js");return{generateTicketNumber:Xe,generateFTRNumber:Oe,generateBeneficiaryRegId:nt,generateName:gt,validateRow:Mt}},[],import.meta.url),{synthesizeRows:Z}=await Pr(async()=>{const{synthesizeRows:Xe}=await import("./dataSynthesizer-BPWho-Jj.js");return{synthesizeRows:Xe}},__vite__mapDeps([3,4]),import.meta.url),{IdService:X}=await Pr(async()=>{const{IdService:Xe}=await import("./IdService-NB_u6ppK.js");return{IdService:Xe}},[],import.meta.url);let A;try{A=await X.getAllIds()}catch{return{success:!1,error:`CRITICAL: Cannot connect to Online Storage. 

Check your internet connection or configuration. 
ID Generation aborted to prevent duplicates.`}}const R=y.indexOf("Ticket Number"),C=y.indexOf("FTR Number"),V=y.indexOf("IMIS Id"),N=y.indexOf("Benificiary Name"),M=y.indexOf("District"),B=y.indexOf("Mandal"),ve=y.indexOf("Stage Level"),xe=y.indexOf("Amount"),ne=y.indexOf("Bank Account Number"),le=y.indexOf("Bank Branch"),Le=y.indexOf("IFSC Code"),ae=y.indexOf("Nank Account Number"),Pe={ticket:new Set(A.ticket),ftr:new Set(A.ftr),reg:new Set(A.reg)},J={ticket:new Set,ftr:new Set,reg:new Set};x.forEach(Xe=>{R!==-1&&Xe[R]&&Pe.ticket.add(String(Xe[R])),C!==-1&&Xe[C]&&Pe.ftr.add(String(Xe[C])),V!==-1&&Xe[V]&&Pe.reg.add(String(Xe[V]))});let O=i?.maxIds?.ticket||0,Q=i?.maxIds?.ftr||0,q=i?.maxIds?.reg||0,ee=x.map(Xe=>{if(!W(Xe).valid)return Xe;let Oe=[...Xe];if(M!==-1&&!Oe[M]&&i?.districtMode&&(Oe[M]=i.districtMode),B!==-1&&!Oe[B]&&i?.mandalMode&&(Oe[B]=i.mandalMode),N!==-1&&!Oe[N]&&i?.namePool&&(Oe[N]=k(i.namePool)),R!==-1&&!Oe[R]){const nt=S(Pe.ticket,O);Oe[R]=nt,Pe.ticket.add(String(nt)),J.ticket.add(String(nt)),O=nt}if(C!==-1&&!Oe[C]){const nt=D(Pe.ftr,Q);Oe[C]=nt,Pe.ftr.add(String(nt)),J.ftr.add(String(nt)),Q=nt}if(V!==-1&&!Oe[V]){const nt=U(Pe.reg,q);Oe[V]=nt,Pe.reg.add(String(nt)),J.reg.add(String(nt)),q=nt}return Oe});const oe=parseInt(l,10)||0;let Te=[],Re=0;if(oe>0){const Xe=Z(oe,i,y,Pe,{ticket:O,ftr:Q,reg:q});Re=Xe.length,Te=[...ee,...Xe],Xe.forEach(Oe=>{R!==-1&&J.ticket.add(String(Oe[R])),C!==-1&&J.ftr.add(String(Oe[C])),V!==-1&&J.reg.add(String(Oe[V]))})}else Te=ee;await X.saveBatch(J);const Se=y.findIndex(Xe=>{const Oe=String(Xe).toLowerCase().replace(".","").replace(/\s/g,"");return["sno","slno","serialno","serialnumber"].includes(Oe)});Te=Te.map((Xe,Oe)=>{if(Xe.length<y.length)for(;Xe.length<y.length;)Xe.push("");let nt=[...Xe];if(Se!==-1&&(nt[Se]=Oe+1),ne!==-1&&(nt[ne]=""),ae!==-1&&(nt[ae]=""),le!==-1&&(nt[le]=""),Le!==-1&&(nt[Le]=""),ve!==-1&&xe!==-1){const gt=String(nt[ve]||"").toLowerCase();gt.includes("after basement")||gt.includes("afterbasement")?nt[xe]=6e3:(gt.includes("final completion")||gt.includes("finalcompletion"))&&(nt[xe]=9e3)}return nt});const De=new Date,st=`${String(De.getDate()).padStart(2,"0")}.${String(De.getMonth()+1).padStart(2,"0")}.${De.getFullYear()}`,te=pn.aoa_to_sheet([y,...Te]),St=pn.book_new();pn.book_append_sheet(St,te,"Sheet1");const lt=`${st}_${E||"data.xlsx"}`;Jl(St,lt);const At=await X.getAllIds();return{success:!0,finalData:Te,newHistory:At,message:oe>0?`SUCCESS!

Generated ${Re} NEW rows.
IDs saved to Firebase.`:`SUCCESS!

Processed ${Te.length} rows.
IDs saved to Firebase.`}}catch(S){return console.error(S),{success:!1,error:S.message}}},reset:()=>{n(null),s(null),c(0),d(0),e(!1)}}},bY=()=>{document.addEventListener("contextmenu",r=>{r.preventDefault(),alert("Not permitted by the admin")}),document.addEventListener("dblclick",r=>{r.preventDefault(),alert("Not permitted by the admin")}),document.addEventListener("selectstart",r=>{r.preventDefault()}),document.addEventListener("keydown",r=>{r.key==="F12"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.shiftKey&&r.key==="I"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.shiftKey&&r.key==="J"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.shiftKey&&r.key==="C"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.key==="u"&&(r.preventDefault(),r.stopPropagation()),r.ctrlKey&&r.key==="c"&&(r.preventDefault(),r.stopPropagation())}),setInterval(()=>{(function(){}).constructor("debugger")()},1e3),console.log=function(){},console.warn=function(){},console.error=function(){}},IY=(r,e=!0,t=6e5)=>{const n=qe.useRef(Date.now()),[i,s]=qe.useState(t),l=qe.useRef(null),c=qe.useCallback(()=>{if(!e)return;const m=Date.now()-n.current,_=t-m;_<=0?(console.log("Inactivity detected. Logging out..."),s(0),r()):(s(_),l.current=setTimeout(c,1e3))},[e,r,t]),f=qe.useCallback(()=>{n.current=Date.now()},[]);return qe.useEffect(()=>{if(!e){s(t);return}n.current=Date.now(),c();const d=["mousemove","mousedown","keypress","scroll","touchstart","click"],m=()=>{f()};return d.forEach(_=>{window.addEventListener(_,m,{passive:!0})}),()=>{l.current&&clearTimeout(l.current),d.forEach(_=>{window.removeEventListener(_,m)})}},[e,c,f,t]),i},kY=()=>P.jsx("footer",{style:{marginTop:"auto",padding:"2rem 0 1rem 0",textAlign:"center",color:"rgba(255, 255, 255, 0.5)",fontSize:"0.85rem",letterSpacing:"0.5px"},children:P.jsxs("p",{style:{margin:0},children:["Powered by ",P.jsx("span",{style:{color:"#4fc3f7",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px"},children:"HRHKILLO"})]})});function CY(){const r=j0(),{data:e,setData:t,headers:n,isUploading:i,error:s,processFile:l,clearData:c,fileName:f}=SY(),{isVerifying:d,investigationReport:m,synthesisCount:_,setSynthesisCount:x,progress:y,analyzeAndVerify:T,generateIds:E,reset:S}=AY(),[D,U]=qe.useState(!1),[k,W]=qe.useState(""),[Z,X]=qe.useState(""),[A,R]=qe.useState(!1),[C,V]=qe.useState(!1),[N,M]=qe.useState(""),[B,ve]=qe.useState(!1),[xe,ne]=qe.useState(!1),[le,Le]=qe.useState({ticket:new Set,ftr:new Set,reg:new Set}),[ae,Pe]=qe.useState(!1),[J,O]=qe.useState(!0),Q=IY(()=>{r.info("Session expired due to inactivity."),Gu.logout()},ae,6e5),{entries:q,addEntry:ee,updateEntry:oe,deleteEntry:Te}=fE(),[Re,Se]=qe.useState(!1),[De,st]=qe.useState(!1),[te,St]=qe.useState(!1),[lt,At]=qe.useState(null),Xe=()=>{At(null),Se(!0)},Oe=()=>{st(!0)},nt=()=>{St(!0)},gt=async dt=>{let Ye=!1;lt?(Ye=await oe(lt.id,dt),Ye&&r.success("Entry updated successfully!")):(Ye=await ee(dt),Ye&&r.success("Entry added successfully!"))},Mt=dt=>{At(dt),Se(!0)},qr=dt=>{Te(dt),r.success("Entry deleted successfully!")};qe.useEffect(()=>{(async()=>{try{try{bY()}catch(Ye){console.warn("Security init failed",Ye)}Gu.isLoggedIn()&&Pe(!0)}catch(Ye){console.error("Init failed:",Ye)}finally{O(!1)}})()},[]);const fa=()=>{Pe(!0)};if(J)return P.jsx("div",{style:{height:"100vh",width:"100vw",background:"#242424"}});const Qn=dt=>{const Ye=dt.target.files[0];Ye&&(S(),l(Ye))},qt=async()=>{const dt=await T(e,n);!dt.success&&dt.error.includes("CRITICAL")?r.error(dt.error):dt.success||r.error("Analysis failed. Please check file.")},an=async()=>{const dt=await E(e,n,le,f);dt.success?(t(dt.finalData),Le(dt.newHistory),r.success(dt.message)):r.error("Generation failed: "+dt.error)},Pn=async dt=>{const Ye=Number(dt==="valid"?k:Z);if(!Ye||Ye<=0){r.error("Please enter a valid quantity.");return}try{const{generateValidAadhar:Ut,generateInvalidAadhar:Tr}=await Pr(async()=>{const{generateValidAadhar:Tn,generateInvalidAadhar:$t}=await import("./aadharGenerator-vgKUWlmk.js");return{generateValidAadhar:Tn,generateInvalidAadhar:$t}},[],import.meta.url),{IdService:Ot}=await Pr(async()=>{const{IdService:Tn}=await import("./IdService-NB_u6ppK.js");return{IdService:Tn}},[],import.meta.url);let Kt=[];if(dt==="valid"){console.log("Starting Valid Aadhar Generation..."),r.info("Generating Aadhar IDs (Checking Server)..."),console.log("Importing generator...");const{generateValidAadharString:Tn}=await Pr(async()=>{const{generateValidAadharString:wn}=await import("./aadharGenerator-vgKUWlmk.js");return{generateValidAadharString:wn}},[],import.meta.url);console.log("Generator imported. Calling ReserveIds...");const $t=await Ot.reserveIds("imis_history_aadhar",Ye,Tn);if(console.log("ReserveIds result:",$t),!$t.success){r.error($t.error);return}Kt=$t.ids,r.success(`Generated ${Ye} unique Aadhar IDs!`)}else Kt=Tr(Ye),r.success(`Generated ${Ye} Invalid Aadhar numbers.`);const sn=[["Aadhar Number"],...Kt.map(Tn=>[Tn])],Yt=new Date,cs=`${String(Yt.getDate()).padStart(2,"0")}.${String(Yt.getMonth()+1).padStart(2,"0")}.${Yt.getFullYear()}`,En=pn.aoa_to_sheet(sn),Oa=pn.book_new();pn.book_append_sheet(Oa,En,"Aadhar");const Jn=`${dt}_aadhar_${cs}.xlsx`;Jl(Oa,Jn)}catch(Ut){console.error("Error in generateAadharExcel:",Ut),r.dismiss(),r.error("Error: "+Ut.message)}},_i=async()=>{const dt=Number(N);if(!dt||dt<=0){r.error("Please enter a valid quantity.");return}try{console.log("Starting IMIS Generation...");const{generateBeneficiaryRegIdString:Ye}=await Pr(async()=>{const{generateBeneficiaryRegIdString:En}=await import("./idGenerator-CFu3fATh.js");return{generateBeneficiaryRegIdString:En}},[],import.meta.url),{IdService:Ut}=await Pr(async()=>{const{IdService:En}=await import("./IdService-NB_u6ppK.js");return{IdService:En}},[],import.meta.url);console.log("Imports done."),r.info("Generating IDs (Checking Server)..."),console.log("Calling reserveIds...");const Tr=await Ut.reserveIds("imis_history_reg",dt,Ye);if(console.log("Result:",Tr),!Tr.success){r.error(Tr.error);return}const Ot=Tr.ids,Kt=[["IMIS Id"],...Ot.map(En=>[En])],sn=pn.aoa_to_sheet(Kt),Yt=pn.book_new();pn.book_append_sheet(Yt,sn,"IMIS IDs"),Jl(Yt,"imis_ids_generated.xlsx"),r.success(`Successfully Generated ${dt} Unique IMIS IDs!`),M(""),V(!1)}catch(Ye){console.error(Ye),r.dismiss(),r.error("Error: "+Ye.message)}},gr=()=>{const dt=pn.aoa_to_sheet([n,...e]),Ye=pn.book_new();pn.book_append_sheet(Ye,dt,"Sheet1"),Jl(Ye,`processed_${f||"data.xlsx"}`)};return ae?(s&&console.error(s),P.jsx(wY,{children:P.jsxs("div",{className:"App",children:[P.jsx(fY,{isOpen:D,onClose:()=>U(!1),validCount:k,setValidCount:W,invalidCount:Z,setInvalidCount:X,onGenerate:Pn}),P.jsx(gY,{isOpen:A,onClose:()=>R(!1)}),P.jsx(_Y,{isOpen:C,onClose:()=>V(!1),count:N,setCount:M,onGenerate:_i}),P.jsx(vY,{isOpen:B,onClose:()=>ve(!1)}),P.jsx(xY,{isOpen:xe,onClose:()=>ne(!1)}),P.jsx(yY,{isOpen:Re,onClose:()=>Se(!1),initialData:lt,onSave:gt}),P.jsx(EY,{isOpen:De,onClose:()=>st(!1)}),P.jsx(TY,{isOpen:te,onClose:()=>St(!1),entries:q,onEdit:Mt,onDelete:qr}),P.jsx(oY,{onDataEntryClick:Xe,onBulkUploadClick:Oe,onViewDataClick:nt,remainingTime:Q}),e.length?P.jsx(hY,{data:e,headers:n,isVerifying:d,investigationReport:m,progress:y,synthesisCount:_,setSynthesisCount:x,onClear:c,onAnalyze:qt,onGenerate:an,onExport:gr}):P.jsx("div",{className:"glass-panel",style:{padding:"4rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderStyle:"dashed"},children:i?P.jsxs("div",{style:{textAlign:"center"},children:[P.jsx("div",{className:"spinner",style:{width:"40px",height:"40px",border:"4px solid rgba(255,255,255,0.3)",borderTop:"4px solid #fff",borderRadius:"50%",marginBottom:"1rem",animation:"spin 1s linear infinite"}}),P.jsx("p",{style:{fontSize:"1.2rem"},children:"Processing File... Please wait"})]}):P.jsxs(P.Fragment,{children:[P.jsx("p",{style:{fontSize:"1.2rem",marginBottom:"1rem"},children:"Drag & Drop Excel File Here"}),P.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:Qn,style:{display:"none"},id:"file-upload"}),P.jsx("label",{htmlFor:"file-upload",className:"glass-button",children:"Browse Files"}),s&&P.jsx("p",{style:{color:"#ff6b6b",marginTop:"1rem"},children:s})]})}),P.jsx(uY,{onAadharClick:()=>U(!0),onTallyClick:()=>R(!0),onImisClick:()=>V(!0),onMatchClick:()=>ve(!0),onCommitmentsClick:()=>ne(!0)}),P.jsx(kY,{})]})})):P.jsx(dY,{onLogin:fa})}const RY=({children:r})=>{const[e,t]=qe.useState([]),n=qe.useCallback((f,d="info")=>{const m=Date.now();t(_=>[..._,{id:m,message:f,type:d}]),setTimeout(()=>{t(_=>_.filter(x=>x.id!==m))},3e3)},[]),i=f=>n(f,"success"),s=f=>n(f,"error"),l=f=>n(f,"info"),c=f=>{t(d=>d.filter(m=>m.id!==f))};return P.jsxs(yC.Provider,{value:{success:i,error:s,info:l},children:[r,P.jsx("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:9999,display:"flex",flexDirection:"column",gap:"10px"},children:e.map(f=>P.jsxs("div",{className:`glass-panel toast-${f.type}`,style:{padding:"12px 20px",borderRadius:"8px",backdropFilter:"blur(10px)",background:f.type==="error"?"rgba(255, 68, 68, 0.9)":f.type==="success"?"rgba(0, 200, 81, 0.9)":"rgba(51, 181, 229, 0.9)",color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",minWidth:"250px",animation:"slideIn 0.3s ease-out",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[P.jsx("span",{children:f.message}),P.jsx("button",{onClick:()=>c(f.id),style:{background:"none",border:"none",color:"white",marginLeft:"10px",cursor:"pointer",fontSize:"1.2rem"},children:""})]},f.id))})]})},bh="imis_data_entries",zm={subscribeToEntries:r=>{const e=fv(Ru,bh);return JX(e,t=>{const n=[];t.forEach(i=>{n.push({id:i.id,...i.data()})}),r(n)},t=>{console.error("Error in real-time sync:",t)})},getAllEntries:async()=>{try{const r=await XX(fv(Ru,bh)),e=[];return r.forEach(t=>{e.push({id:t.id,...t.data()})}),e}catch(r){throw console.error("Error fetching entries:",r),r}},addEntry:async r=>{try{const e=hv(fv(Ru,bh)),t={...r,id:e.id,createdAt:new Date().toISOString()};return await YX(e,t),t}catch(e){throw console.error("Error adding entry:",e),e}},updateEntry:async(r,e)=>{try{const t=hv(Ru,bh,r);return await $X(t,{...e,updatedAt:new Date().toISOString()}),{id:r,...e}}catch(t){throw console.error("Error updating entry:",t),t}},deleteEntry:async r=>{try{return await QX(hv(Ru,bh,r)),r}catch(e){throw console.error("Error deleting entry:",e),e}}},DY=({children:r})=>{const[e,t]=qe.useState([]),[n,i]=qe.useState(!0),s=j0();qe.useEffect(()=>{const d=zm.subscribeToEntries(m=>{t(m),i(!1)});return()=>d()},[]);const l=async d=>{try{return await zm.addEntry(d),!0}catch(m){return console.error("Failed to add entry:",m),s.error(`Failed to save: ${m.message}`),!1}},c=async(d,m)=>{try{return await zm.updateEntry(d,m),!0}catch(_){return console.error("Failed to update entry:",_),s.error("Failed to update entry."),!1}},f=async d=>{try{return await zm.deleteEntry(d),!0}catch(m){return console.error("Failed to delete entry:",m),s.error("Failed to delete entry."),!1}};return P.jsx(e3.Provider,{value:{entries:e,addEntry:l,updateEntry:c,deleteEntry:f,loading:n},children:r})};jN.createRoot(document.getElementById("root")).render(P.jsx(qe.StrictMode,{children:P.jsx(RY,{children:P.jsx(DY,{children:P.jsx(CY,{})})})}));export{MY as I,Pr as _,hv as a,Xu as b,fv as c,Ru as d,NY as e,DN as f,XX as g,FY as r,pn as u,PY as w};
