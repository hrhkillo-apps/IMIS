const N=c=>{if(c.length===0)return null;const i={};let n=0,e=c[0];for(const a of c){if(!a)continue;const s=String(a).trim();s&&(i[s]=(i[s]||0)+1,i[s]>n&&(n=i[s],e=s))}return e},P=(c,i)=>{const n={districtMode:null,mandalMode:null,namePool:{firstNames:new Set,surnames:new Set},maxIds:{ticket:0,ftr:0,reg:0},columnOptions:{},locationPool:{districts:new Set,mandals:new Set}},e=i.indexOf("District"),a=i.indexOf("Mandal"),s=i.indexOf("Benificiary Name"),l=i.indexOf("Ticket Number"),d=i.indexOf("FTR Number"),f=i.indexOf("Benificiary Registration Id");i.forEach((o,t)=>{o&&(t===l||t===d||t===f||t===s||t===e||t===a||(n.columnOptions[o]=new Set))});const r=[],u=[];return c.forEach(o=>{if(o.forEach((t,m)=>{const x=i[m];n.columnOptions[x]&&t&&n.columnOptions[x].add(t)}),e!==-1&&o[e]&&(r.push(o[e]),n.locationPool.districts.add(o[e])),a!==-1&&o[a]&&(u.push(o[a]),n.locationPool.mandals.add(o[a])),s!==-1&&o[s]){const m=String(o[s]).trim().split(/\s+/);m.length>0&&(m.length>1?(n.namePool.surnames.add(m[0]),n.namePool.firstNames.add(m.slice(1).join(" "))):n.namePool.firstNames.add(m[0]))}if(l!==-1&&o[l]){const t=Number(o[l]);!isNaN(t)&&t>n.maxIds.ticket&&(n.maxIds.ticket=t)}if(d!==-1&&o[d]){const t=Number(o[d]);!isNaN(t)&&t>n.maxIds.ftr&&(n.maxIds.ftr=t)}if(f!==-1&&o[f]){const t=Number(o[f]);!isNaN(t)&&t>n.maxIds.reg&&(n.maxIds.reg=t)}}),n.districtMode=N(r),n.mandalMode=N(u),n.namePool.firstNames=Array.from(n.namePool.firstNames),n.namePool.surnames=Array.from(n.namePool.surnames),n.locationPool.districts=Array.from(n.locationPool.districts),n.locationPool.mandals=Array.from(n.locationPool.mandals),Object.keys(n.columnOptions).forEach(o=>{n.columnOptions[o]=Array.from(n.columnOptions[o])}),n};export{P as analyzeContext};
